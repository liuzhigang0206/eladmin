/*!
 * 
 * SpreadJS Library 13.0.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/core/core.entry.js")}({"./dist/core/celltype/basecelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/stylehelper.js"),h=c("./dist/core/celltype/celltype.ns.js"),i=c("CalcEngine"),j=d.Common.CultureManager,k=d.Common.o,l=d.Common.l,m=d.Common.pc,n=d.Common.j,o=n.Fa,p=n.Ma,q=f.Ul.fp,r=f.Ul.ol,s=f.Ul.uWa,t=f.Ul.lZa,u=f.Ul.hZa,v=f.Ul.K_a,w=f.Ul.pL,x=f.Ul.Fxb,y=e.GC$.extend,z="left",A="right",B="center",C="alphabetic",D=16,E="string",F="number",G=null,H=void 0,I=Math.floor,J=Math.ceil,K=Math.sin,L=Math.cos,M=Math.tan,N=Math.abs,O="none",P="General",Q=Math.max,R=.7,function(a){a[a.top=0]="top",a[a.right=1]="right",a[a.bottom=2]="bottom",a[a.left=3]="left"}(S||(S={})),T=function(){function a(){}return a.Gxb=function(a){var b,c,d=a.split("e")[1];if(d&&d.length>0&&("+"===d[0]?b=!0:"-"===d[0]&&(b=!1),c=d.slice(1)),void 0!==b)return{isAdd:b,length:c}},a.Apb=function(b,c,d){var e=a.Hxb,f=e[c+d];return f||(f=w(b,c,d),e[c+d]=f),f},a.Ixb=function(b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=e.font;if(d=d-1-3*f,g=e.textIndent&&0!==e.textIndent,h=e.isVerticalText,typeof c===F&&e.shrinkToFit!==!0&&!h&&!g){if(i=c<0,c=N(c),j=i?a.Apb(b,z,"-"):0,k=""+c,l=a.Gxb(k),m=void 0,n=a.Jxb(e._autoFormatter,c),l)return m=(""+l.length).length,m=Q(m,2),a.Kxb(b,d,e,m,j,l.isAdd,n);if(o=j,p=a.Apb(b,z,"0"),q=k.split("."),r=(""+Math.round(c)).length,s=p*r,o+=s,t=a.Apb(b,z,"."),u=void 0,s<=d){if(!q[1]||0===q[1].length)return e._autoFormatter;if(o=o+q[1].length*p+t,o<=d)return e._autoFormatter;if(c<.001)return m=(""+q[1].length).length,m=Q(m,2),a.Kxb(b,d,e,m,j,!1,n);for(v=d-j-s-t,w=Math.floor(v/p),w=Math.min(w,q[1].length),u="0",w>0&&(u+="."),x=0;x<w;x++)u+="0";return u}return y=Math.round(c),m=(""+(""+y).length).length,m=Q(m,2),a.Kxb(b,d,e,m,j,!0,n)}return e._autoFormatter},a.Kxb=function(b,c,d,e,f,g,h){var i,j,k,l=d.font,m=a.Apb(b,l,"0"),n=a.Apb(b,l,"E"),o=a.Apb(b,l,"+"),p=a.Apb(b,l,"-"),q=g?o:p,r=a.Apb(b,l,"."),s=c-f-e*m-n-q-m,t=s-r;if(t<=m)return g?"0E+00":s>0?"0E-00":"0";for(i=Math.floor(t/m),i=Math.min(i,h),j="0",k=0;k<i;k++)0===k&&(j+="."),j+="0";return j+=g?"E+00":"E-00"},a.Lxb=function(b,c,d,e,f){var g,h,i,j,k,l,m,n=e.font;if(d=d-1-3*f,g=e.textIndent||0,h=d-8*g,i=w(b,e.font,c),h<i){for(j=a.Apb(b,n,"#"),k=Math.floor(d/j),l="",m=0;m<k;m++)l+="#";return l}return c},a.ap=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s;if(f&&"none"!==f&&h)try{h.ko(f)?(i=h.lo(f),j=i.width,k=i.height,l=0,m=0,n=j,o=k,p=d,q=e,r=b,s=c,1===g?(n=d>=j?j:d,o=e>=k?k:e,r=d>j&&j>0?J(b+d/2-j/2):b,s=e>k&&k>0?J(c+e/2-k/2):c,p=n,q=o):2===g?e>0&&k>0&&d/e>j/k?(p=j/k*e,r=b+d/2-p/2):d>0&&j>0&&e/d>k/j&&(q=k/j*d,s=c+e/2-q/2):3===g&&(n=d>=j?j:d,o=e>=k?k:e,p=n,q=o),a.drawImage(i,l,m,n,o,r,s,p,q)):h.fo(f)}catch(a){}},a.cp=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,r,s,t,u,v,w,x,z,A,B,C,F=0,G=e&&e.sheet,H=c.textIndent,I=c.hAlign,J=c.isVerticalText,M=c.textOrientation,O=c.borderTop||c.borderBottom||c.borderLeft||c.borderRight,P=c.font,Q=e.row,R=e.col;if(M&&-90<=M&&M<=90&&(j=N(M*Math.PI/180),h=K(j),i=L(j)),G&&typeof b===E&&b)if(k=[],l=void 0,a&&a.richText)if(m=c.formatter||c._autoFormatter,n=G.getCellType(Q,R),o=n.T_a(m,a.text),l=y(!0,[],n.U_a(a,b,o,P,c.foreColor)),qa(l,P,d),J)if(c.wordWrap){if(p=e.sheetArea,r=G.Sl(Q),s=G.ITa.findSpan(Q,R,p),s&&s.row>=Q&&s.col>=R&&s.rowCount>1)for(t=Q+1;t<Q+s.rowCount;t++)r+=G.Sl(t);for(u=0,H>0&&(u=8*H),v=aa(c,0),w=aa(c,2),v>0&&(r-=v),w>0&&(r-=w),r++,k=f.Vn.M_a(b,r-3-u,P,l,J),g=0;g<k.length;g++)F+=W(k[g].textInfos,P,d)}else F=W(l,P,d);else{if(c.wordWrap){for(x=b.split(/\r\n|\r|\n/),g=0;g<x.length;g++)z=[],z.push(x[g]),k.push(z);for(k=f.Vn.O_a(k,f.Vn.P_a(l)),g=0;g<k.length;g++)F=Math.max(F,X(k[g],P,d,J,!0))}else F=X(l,P,d);1!==I&&H>0&&(F+=8*H/d),V(G,Q,R,e.sheetArea)&&(F+=_(G))}else if(k=b.split(/\r\n|\r|\n/),A=c.font,B=q(A)/d,J)if(c.wordWrap)for(g=0;g<k.length;g++)F+=B;else F=B;else{if(c.wordWrap){if(M)return C=G.Sl(Q),f.Vn.lHb(Q,R,h,i,b,A,C);for(g=0;g<k.length;g++)F=Math.max(F,f.Vn.Xn(k[g],A,!0)/d)}else F=M?O?(B+4)/h:i*(G.dp(b,A)/d)+B*h:G.dp(b,A)/d;1!==I&&H>0&&(F+=8*H/d),V(G,Q,R,e.sheetArea)&&(F+=D)}return F},a.ep=function(a,b,c,d,e){var g,h,i,j,k,l,m,n,o,p,r,s,t,u,v,w,z,A,B,C,D,F,G,H,I,J,M,O=0,P=e&&e.sheet,Q=c.font,R=c.isVerticalText,S=c.textIndent,T=c.vAlign,U=c.textOrientation,V=e.row,Y=e.col;if(U&&-90<=U&&U<=90&&(w=N(U*Math.PI/180),u=K(w),v=L(w)),P&&typeof b===E&&b)if(z=[],A=void 0,a&&a.richText)if(B=c.formatter||c._autoFormatter,C=P.getCellType(V,Y),D=C.T_a(B,a.text),A=y(!0,[],C.U_a(a,b,D,Q,c.foreColor)),qa(A,Q,d),R){if(c.wordWrap){for(F=b.split(/\r\n|\r|\n/),g=0;g<F.length;g++)G=[],G.push(F[g]),z.push(G);for(z=f.Vn.O_a(z,f.Vn.P_a(A)),g=0;g<z.length;g++)O=Math.max(O,X(z[g],Q,d,R,!0))}else O=X(A,Q,d,R);1!==T&&S>0&&(O+=8*S/d)}else if(c.wordWrap){if(h=e.sheetArea,i=P.Tl(Y),l=P.ITa.findSpan(V,Y,h),l&&l.row>=V&&l.col>=Y&&l.colCount>1)for(m=Y+1;m<Y+l.colCount;m++)i+=P.Tl(m);for(o=0,S>0&&(o=8*S),p=aa(c,1),r=aa(c,3),r>0&&(i-=r),p>0&&(i-=p),i++,z=f.Vn.M_a(b,i-3-o,Q,A),g=0;g<z.length;g++)O+=W(z[g].textInfos,Q,d)}else O=W(A,Q,d);else if(H=c.font,I=q(H)/d,R){if(c.wordWrap)for(z=b.split(/\r\n|\r|\n/),g=0;g<z.length;g++)J=z[g].length*I,O=Math.max(O,J);else O=b.length*I;1!==T&&S>0&&(O+=8*S/d)}else if(c.wordWrap){if(h=e.sheetArea,i=P.Tl(Y),j=P.Sl(V),l=P.ITa.findSpan(V,Y,h),l&&l.row>=V&&l.col>=Y&&l.colCount>1){for(m=Y+1;m<Y+l.colCount;m++)i+=P.Tl(m);for(n=V+1;n<V+l.colCount;n++)j+=P.Sl(n)}if(o=0,S>0&&(o=8*S),p=aa(c,1),r=aa(c,3),s=aa(c,0),t=aa(c,2),r>0&&(i-=r),p>0&&(i-=p),s>0&&(j-=s),t>0&&(j-=t),U)return M=(j-I*v)/u,z=f.Vn.Wn(b,M,H),k=P.dp(z[0],H)/d,O=u*k+I*v;z=x(a)?[b]:f.Vn.Wn(b,i-3-o,H),O=z.length*I}else U?(k=P.dp(b,H)/d,O=u*k+I*v):O=I;return O},a.gp=function(a,b,c,d,e,f,g,h,i,j,k){var l;1===i?(a.beginPath(),l=a.createLinearGradient(b,c+1,b,c+e-2),l.addColorStop(0,h.borderLeftColor),l.addColorStop(1,h.borderRightColor),a.strokeStyle!==l&&(a.strokeStyle=l),f.borderLeft||(a.moveTo(b+.5,c),a.lineTo(b+.5,c+e)),f.borderRight||(a.moveTo(b+d-.5,c),a.lineTo(b+d-.5,c+e)),j&&!f.borderTop&&(a.moveTo(b,c+.5),a.lineTo(b+d,c+.5)),a.stroke(),h.borderBottomWidth&&!f.borderBottom&&(a.beginPath(),a.strokeStyle!==h.borderBottomColor&&(a.strokeStyle=h.borderBottomColor),a.moveTo(b+1,c+e-.5),a.lineTo(b+d,c+e-.5),a.stroke())):(a.beginPath(),l=a.createLinearGradient(b,c,b+d-2,c),l.addColorStop(0,h.borderTopColor),l.addColorStop(1,h.borderBottomColor),a.strokeStyle!==l&&(a.strokeStyle=l),f.borderTop||(a.moveTo(b,c+.5),a.lineTo(b+d,c+.5)),f.borderBottom||(a.moveTo(b,c+e-.5),a.lineTo(b+d,c+e-.5)),k&&!f.borderLeft&&(a.moveTo(b+.5,c),a.lineTo(b+.5,c+e)),a.stroke(),h.borderRightWidth&&!f.borderRight&&(a.beginPath(),a.strokeStyle!==h.borderRightColor&&(a.strokeStyle=h.borderRightColor),a.moveTo(b+d-.5,c+1),a.lineTo(b+d-.5,c+e),a.stroke()))},a.hp=function(a,b){var c;c=2===b?"active":4===b?"inactive":0===b?"disabled":"auto",e.GC$(a).css("ime-mode",c)},a.Hxb={},a.Jxb=function(a,b){var c,d,e,f,g,h;return a&&a.Ud&&(c=a.Ud(b),d=c.format(b),d&&d[1]&&"decimalSeparator"===d[1].type)?(e=d[2],e&&"number"===e.type?(f=e.value,g=d[3],h=g&&"exponent"===g.type&&g.value&&g.value.indexOf("E")>-1,!o(f)&&h?f.length:5):0):5},a.u5=aa,a}(),b.Context=T,U=function(){function a(){this.allowOverflow=!1,this.typeName="0"}return a.prototype.uxb=function(b,c,d,e){var f={ctx:b,options:{rect:c,context:d,value:e}};return a.ao(d.sheet,"paintCellPadding",f),f.options.rect},a.prototype.RBb=function(b,c,d,e,f){var g={ctx:b,options:{rect:c,context:e,value:f,style:d}};return a.ao(e.sheet,"paintCellButton",g),g.options.rect},a.prototype.SBb=function(b,c,d){var e={context:b,options:{dom:c,cellRect:d}};return a.ao(b.sheet,"paintCellEditor",e),e.options.dom},a.prototype.TBb=function(b,c,d){var e={ctx:null,options:{rect:c.clone(),context:b,value:null,style:d}};return a.ao(b.sheet,"getCellButtonRect",e),e.options.rect},a.prototype.UBb=function(b,c,d,e){var f={context:b,options:{dom:c,cellRect:d,cellStyle:e}};return a.ao(b.sheet,"activateCellEditor",f),f.options.dom},a.prototype.VBb=function(b,c,d,e){var f={context:b,contentContainer:c,editorBounds:d,cellStyle:e};return a.ao(b.sheet,"adjustEditorContainer",f),f.contentContainer},a.prototype.WBb=function(b,c,d){var e={context:b,options:{dom:c,cellRect:d}};return a.ao(b.sheet,"deactivateCellEditor",e),e.options.dom},a.prototype.XBb=function(a,b,c){var d=this;d.deactivateEditor(a,b),d.WBb(b,a,c)},a.prototype.i5=function(a,b,c,d){var e,f,h,i,j,k,l,m,n,o,p=c.labelOptions;if(p&&(e=d.sheet,f=c.watermark)){if(h=p.visibility,i=e.getText(d.row,d.col,d.sheetArea),1===h||(2===h||h===H)&&""===i)return;j=e.zoom(),1!==j&&la(c,j),k=p.font,l=void 0,l=k?g.To.No(k,j):g.To.No(c.font,1),m=q(l.font),n=ha(b,c),o=void 0,ga(c,b)&&(o=ja(b,c,l,m)),o&&(a.save(),a.textAlign=ia(p.alignment),a.textBaseline="alphabetic",t(a,l.font),a.fillStyle=p.foreColor||c.foreColor||"grey",a.rect(n.x,n.y,n.width,n.height),a.clip(),a.beginPath(),a.fillText(f,o.x,o.y),a.restore())}},a.prototype.f5=function(a,b){var c=a.clone(),d=aa(b,0),e=aa(b,1),f=aa(b,2),g=aa(b,3);return d>0&&(c.y+=d,c.height-=d),f>0&&(c.height-=f),g>0&&(c.x+=g,c.width-=g),e>0&&(c.width-=e),e+g>=a.width&&(c.width=0),d+f>=a.height&&(c.height=0),c},a.prototype.Ama=function(b,c,d,e){var f,g=this;return c=g.f5(c,d),f={ctx:b,options:{rect:c,context:e}},a.ao(e.sheet,"getCellPaddingRect",f),f.options.rect},a.prototype.e5=function(a,b,c,d,g){var h,i,j,k,l,m,n,o,p,r,s,t,v,w=c.labelOptions;w&&(h=d.sheet,i=h.getText(d.row,d.col,d.sheetArea),j=c.watermark,k=w.visibility,1!==k&&j&&(l=w.font||c.font||h.yl.Bl(),m=h.zoom(),1!==m&&(l=h.yl.Cl(l),la(c,m)),n=q(l),ga(c,b)&&(o=ka(b,c,g)),o&&(p=e.GC$(f.Ul.Nl("span")),p.text(j),r=(2===k||k===H)&&""===i,s=o.height-n,t=o.y+(r&&s>0?s:0),p.css({display:"block",position:"absolute",left:o.x,top:t,width:o.width,height:o.height,font:u(l),color:w.foreColor||c.foreColor||"grey",textAlign:ia(w.alignment),overflow:"hidden",whiteSpace:"nowrap"}).attr("gcUIElement","gcEditorLabel"),e.GC$(a).append(p),r&&(v=setInterval(function(){t--,p.css("top",t),t<=o.y&&clearInterval(v)},20)))))},a.prototype.a5=function(a){var b,c,d=this,g=f.Ul.Nl("div");return e.GC$(g).css({position:"absolute",margin:0,padding:0,overflow:"hidden","box-sizing":"content-box",resize:O,outline:O,border:"2px #5292f7 solid","box-shadow":"1px 2px 5px rgba(0,0,0,0.4)","background-color":"white"}),b=e.GC$(f.Ul.Nl("div")),b.css({position:"absolute",outline:O,border:O}),e.GC$(g).append(b),c=d.createEditorElement(a,g),c&&b.append(e.GC$(c)),d.SBb(a,g,a.sheet.getCellRect(a.row,a.col)),g},a.prototype.d5=function(a,b,c,d){var e,f,g,h;a&&a.firstChild&&(e=this,f=pa(c),ea(a,b,f,d),e.UBb(d,a,f,b),g=e.TBb(d,f,b),e.e5&&e.e5(a,f,b,d,g),h=e.f5?e.f5(g,b):f,e.activateEditor(a.firstChild.firstChild,b,h,d))},a.prototype.updateEditorContainer=function(a,b,c){var d,f,g,h,i,j;c&&c.cellButtons&&c.cellButtons.length||a&&b&&(d=a.parentNode,d&&(f=d.parentNode,g=e.GC$(f),h=b.width,i=b.height,h>0&&(g.width(h),j=f.lastChild,c&&"gcEditorLabel"===j.getAttribute("gcUIElement")&&e.GC$(j).width(h-aa(c,3,!0)-aa(c,1,!0)-2)),i>0&&g.height(i),o(b.x)||g.css("left",b.x+"px"),o(b.y)||g.css("top",b.y+"px")))},a.prototype.g5=function(a,b,c,d,f){var g,h,i,j,k=this,l=a.firstChild,m=d.sheet,n=pa(c);ea(a,b,n,d),f&&m&&la(b,m.zoom()),k.VBb(d,l,n,b),g=k.TBb(d,n,b),e.GC$(l).css({left:g.x-n.x+aa(b,3),top:aa(b,0)}),h=l.firstChild,i=k.f5?k.f5(g,b):g,j=k.updateEditor(h,b,i,d),b&&b.cellButtons&&b.cellButtons.length||k.updateEditorContainer(h,j,b)},a.prototype.h5=function(a,b,c,d,e){return this.getCellAndPaddingHitInfo(a,b,c,d,e)},a.prototype.X4=function(a,b,c,d,e){var f=ca(e,c)+ba(e),g=this.getAutoFitWidth(a,b,c,d,e);return g>0&&(f+=g+aa(c,3,!1)+aa(c,1,!1)),f},a.prototype.Y4=function(a,b,c,d,e){var f=0,g=this.getAutoFitHeight(a,b,c,d,e);return g>0&&(f+=g+aa(c,0,!1)+aa(c,2,!1)),Math.max(da(e,c),f)},a.prototype.paintValue=function(a,b,c,d,e,f,g,h){var i={},j;h.quotePrefix=g.quotePrefix,j=this.format(v(b),g.formatter||g._autoFormatter,i,h),j&&this.paintText(a,b,c,d,e,f,g,h,j,i)},a.prototype.S_a=function(a,b,c){var d=0;return a>0&&(d=8*a),b&&b.XQa(c)&&(d=0),d},a.prototype.T_a=function(a,b){return!!(!a||p(a,E)&&a===P||a&&a.formatString&&a.formatString()===P)||!(b&&(!isNaN(b)||"TRUE"===b.toUpperCase()||"FALSE"===b.toUpperCase())&&"@"!==a)},a.prototype.paintText=function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,p=this;a.save(),a.beginPath(),l=g.textOrientation,m=g.textIndent&&0!==g.textIndent,n=g.isVerticalText,b&&b.richText&&b.richText.length>0||n?p.Fpb(a,b,c,d,e,f,g,h,i,j,k):0!==l&&!o(l)&&-90<=l&&l<=90&&!m&&!n?p.mHb(a,b,c,d,e,f,g,h,i,j,k):p.N$a(a,b,c,d,e,f,g,h,i,j,k),a.restore()},a.prototype.Fpb=function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p,q,t,u,v,w,x,z,A,B=this,C=B.S_a(g.textIndent,h.sheet.outlineColumn,h.col),D=g.hAlign;if(3===D&&(D=r(D,b,g.formatter)),l=g.isVerticalText,m=!!l&&s(i),n=g.font,o=g.formatter||g._autoFormatter,p=B.T_a(o,b.text),q=y(!0,[],B.U_a(b,i,p,n,g.foreColor)),b&&b.richText&&b.richText.length>0&&(t=h.sheet?h.sheet.zoom():1,B.V_a(q,n,t)),!g.wordWrap&&g.shrinkToFit&&B.W_a(q,e,f,g,n,1,l),u=B.X_a(a,i,g.font,l?f:e,C,l?g.vAlign:g.hAlign,g.wordWrap,l,q),v=B.Y_a(u,g,D,k),w=B.Z_a(a,g,c,d,e,f,g.wordWrap,h.cellOverflowLayout,D,C,l,u[0].textLength,v[0].lineHeight),x=B.$_a(c,d,e,f,D,g.vAlign,C,l,m,u,v),z=u.length,1===z&&j&&!p)B.__a(a,h.sheet,i,j,x[0].x,x[0].y,e,f,D,g,w.width,w.height,C,l,u[0].textLength);else for(A=0;A<z;A++)B.a0a(a,h.sheet,x[A].x,x[A].y,v[A],D,u[A])},a.prototype.N$a=function(a,b,c,d,e,h,i,j,k,l,n){var p,q,s,u,v,w,x,y,z,D,E,F,G,H,J,K,L,M,N,O,P,R,S,T,U,V=this,W=0,X=i.textIndent,Y=i.wordWrap,Z=i.hAlign,$=i.vAlign,_=i.shrinkToFit,ba=i.textDecoration,ca="left",da=2,ea=2,fa=i.font,ga=0,ha=j.lineHeight,ia=[],ja=0,ka=parseInt(j.fontInfo.fontSize,10),la=j.sheet,ma=i.foreColor;if(ma=f.Im._ob(la,ma),p=l.conditionalForeColor,p&&(ma=p),n=o(i.opacity)?n:i.opacity,o(n)||(q=m.ec(ma),q.a=n,ma=m.bc(q)),a.fillStyle!==ma&&(a.fillStyle=ma||"#000000"),X>0&&(W=8*X),la.outlineColumn&&la.outlineColumn.XQa(j.col)&&(W=0),3===Z&&(Z=r(Z,b,i.formatter)),t(a,fa),!Y&&_)for(s=0,u={value:!1},v=0;v<3&&u.value===!1&&(w=a.measureText(k).width,s=Q(0,e-4-(1===Z?0:W)),s<w);v++)fa=g.To.No(fa,s/w,u,!0).font,t(a,fa);if(da+=W,1===Z?(da=e/2,ca=B):2===Z&&(da=e-1-2,da-=W,ca=A),a.textAlign!==ca&&(a.textAlign=ca),Y&&(x=e-3-W,x-=1,ia=f.Vn.Wn(k,x,fa,!1,a),ja=ia.length,ja>1&&0!==$&&(ga=(ja-1)*ha)),y=ka>8?I((ka-8)/5+2):1,z=ha/2-ka/2+y-1,ea+=ha-z,1===$?ea=(h-ga)/2+ha/2-z:2===$&&(ea=h-ga-2-z),a.textBaseline!==C&&(a.textBaseline=C),D=j.cellOverflowLayout,E=D&&D.layout,F={x:E?E.x:c+1,y:E?E.y:d+1,width:E?E.width:e-2,height:E?E.height:h-2},G=E&&E.width>e,H=F.x,J=F.y,K=F.width,L=F.height,Y)if(a.rect(H,J,K,L),a.clip(),a.beginPath(),M=d+ea,ja>1)for(v=0;v<ja;v++)a.fillText(ia[v],c+da,M),ba&&(w=a.measureText(ia[v]).width,V.ip(a,ba,c+da,M,w,ka,y)),M+=ha;else V.Oja(a,k,l,c+da,d+ea,Z,K,W,ba,y,ka,G);else N=a.measureText(k).width,O=N>K-(c+1-H)||ha>L,P=aa(i,0),R=aa(i,1),S=aa(i,2),T=aa(i,3),O||(1===Z?D&&(U=N/2,(U>D.backgroundLeftWidth||U>D.backgroundRightWidth)&&(O=!0)):(N+W+P+S>K||ga+T+R>L)&&(O=!0)),O&&(a.rect(H,J,K,L),a.clip(),a.beginPath()),V.Oja(a,k,l,c+da,d+ea,Z,K,W,ba,y,ka,G)},a.prototype.mHb=function(a,b,c,d,e,h,i,j,k,l,n){var p,q,s,u,v,w,x,y,z,A,B,C,D,E,F,G,H,J,O,P,R,S,T,U,V,W,X,Y,Z,$,_,ba,ca,da=this,ea=i.wordWrap,fa=i.hAlign,ga=i.vAlign,ha=i.shrinkToFit,ia=i.textDecoration,ja=2,ka=2,la=i.font,ma=[],na=0,oa=parseInt(j.fontInfo.fontSize,10),pa=j.sheet,qa=j.cellOverflowLayout,ra=qa&&qa.layout,sa=i&&(i.borderLeft||i.borderTop||i.borderRight||i.borderBottom)&&!pa.getSpan(j.row,j.col),ta=i.textOrientation,ua=ta*Math.PI/180,va=N(ua),wa=L(va),xa=K(va),ya=M(va),za=j.lineHeight,Aa=90===ta||ta===-90;if(sa&&(ta>-90&&ta<0&&(u=!1),ta>0&&ta<90&&(u=!0)),v={x:ra?ra.x:c+1,y:ra?ra.y:d+1,width:ra?ra.width:e-2,height:ra?ra.height:h-2},w=v.x,x=v.y,y=v.width,z=v.height,A=za/2*K(va),B=za/2*L(va),C=oa>8?I((oa-8)/5+2):1,D=za/2-oa/2+C-1,l&&l.content&&l.content.length>0&&!ha&&(k=da.nHb(a,l.content,h-4)),E=pa.dp(k,la),F=i.foreColor,F=f.Im._ob(pa,F),G=l.conditionalForeColor,G&&(F=G),n=o(i.opacity)?n:i.opacity,o(n)||(H=m.ec(F),H.a=n,F=m.bc(H)),a.fillStyle!==F&&(a.fillStyle=F||"#000000"),3===fa&&(fa=r(fa,b,i.formatter,ta)),t(a,la),!ea&&ha)for(J=0,O={value:!1},P=0;P<3&&O.value===!1&&(J=Q(0,(h-4-2*B)/xa),J<E);P++)la=g.To.No(la,J/E,O,!0).font,t(a,la),oa=parseInt(j.fontInfo.fontSize,10),E=pa.dp(k,la),za=f.Ul.fp(la),A=za/2*K(va),B=za/2*L(va);if(R=0,ea)for(S=(h-4-2*B)/xa,ma=f.Vn.Wn(k,S,la,!1,a),na=ma.length,E=pa.dp(ma[0],la),T=0;T<na;T++)U=pa.dp(ma[T],la),U>R&&(R=U);switch(s=(ea?R:E)*xa+2*B,h<=s&&(ga=2),p=E/2*wa,q=(ea?R:E)/2*xa,V=""+fa+ga){case"00":ja+=p+A,ka+=q,Aa||(ka+=B),sa&&(ja=(u?1:-1)*((h-ka)/ya)+(za/2+2)/xa);break;case"01":ja+=p+A,ka=h/2,sa&&(ja=(u?1:-1)*((h-ka)/ya)+(za/2+2)/xa);break;case"02":ja+=p+A,ka+=q,Aa||(ka+=B),sa&&(ja=(u?1:-1)*(ka/ya)+(za/2+2)/xa),ka=h-ka;break;case"10":ja=e/2,ka+=q,Aa||(ka+=B),sa&&(ja+=(u?1:-1)*(h-ka)/ya);break;case"11":ja=e/2,ka=h/2,sa&&(ja+=(u?1:-1)*(h-ka)/ya);break;case"12":ja=e/2,ka+=q,Aa||(ka+=B),sa&&(ja+=(u?1:-1)*ka/ya),ka=h-ka;break;case"20":ja=e-2-p-A,ka+=q,Aa||(ka+=B),sa&&(ja=e+(u?1:-1)*((h-ka)/ya)-(za/2+2)/xa);break;case"21":ja=e-2-p-A,ka=h/2,sa&&(ja=e+(u?1:-1)*((h-ka)/ya)-(za/2+2)/xa);break;case"22":ja=e-2-p-A,ka+=q,Aa||(ka+=B),sa&&(ja=e+(u?1:-1)*(ka/ya)-(za/2+2)/xa),ka=h-ka}if(ea)if(W=c+ja,X=za/xa,Y=void 0,na>1)for(Z=na%2!==0,1===fa&&(W-=Z?X*(na-1)/2:X*(na/2)-.5*X),P=0;P<na;P++)Y=P,(i.textOrientation>0&&2===fa||i.textOrientation<0&&(0===fa||1===fa))&&(Y=na-P-1),da.oHb(a,ua,ma[Y],W,d+ka,ia,oa,C,D),W=2===fa?W-X:W+X;else da.oHb(a,ua,k,c+ja,d+ka,ia,oa,C,D);else $=E*xa+oa*xa+2,_=aa(i,0),ba=aa(i,2),ca=$>z-(d+1-x)||za>z||$+_+ba>z,ca&&(a.rect(w,x,y,z),a.clip()),da.oHb(a,ua,k,c+ja,d+ka,ia,oa,C,D)},a.prototype.V_a=function(a,b,c){qa(a,b,c)},a.prototype.W_a=function(a,b,c,d,e,f,h){var i,j,k,l=0,m={value:!1};for(i=0;i<3&&m.value===!1&&(j=X(a,e,f,h),l=Q(0,(h?c:b)-4),(h?d.vAlign:1!==d.hAlign&&d.textIndent)&&(l=Q(0,l-8*d.textIndent)),l<j);i++)for(k=0;k<a.length;k++)a[k].style.font=g.To.No(a[k].style.font,l/j,m,!0).font},a.prototype.U_a=function(a,b,c,d,e){var f=a.richText;return!o(f)&&c||(f=[{style:{font:d,foreColor:e},text:b}]),f},a.prototype.Z_a=function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,o=h&&h.layout,p={x:o?o.x:c+1,y:o?o.y:d+1,width:o?o.width:e-2,height:o?o.height:f-2},q=p.x,r=p.y,s=p.width,t=p.height;return g?(a.rect(q,r,s,t),a.clip(),a.beginPath()):(n=this.b0a(b,i,b.vAlign,c,d,t,s,q,r,l,m,j,k,h),n&&(a.rect(q,r,s,t),a.clip(),a.beginPath())),p},a.prototype.b0a=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o,p,q=aa(a,0),r=aa(a,1),s=aa(a,2),t=aa(a,3);return m?(o=j>f-(e+1-i)||k>g,(!o&&1!==c&&j+l+q+s>f||k+t+r>g)&&(o=!0)):(o=j>g-(d+1-h)||k>f,o||(1===b?n&&(p=j/2,(p>n.backgroundLeftWidth||p>n.backgroundRightWidth)&&(o=!0)):(j+l+t+r>g||k+q+s>f)&&(o=!0))),o},a.prototype.X_a=function(a,b,c,d,e,h,i,j,k){var l,m,n,o,p;if(1!==h?d=d-3-e:d-=3,i)return f.Vn.M_a(b,d,c,k,j,a);for(l=0,m=0;m<k.length;m++)n=k[m].text,j?l+=q(k[m].style.font)*(n?n.length:0):(o=g.To.No(k[m].style.font,1),p=k[m].style.vertAlign?o.fontSize*R+"px "+o.fontFamily:k[m].style.font,l+=w(a,p,n));return[{textLength:l,text:b,textInfos:k}]},a.prototype.__a=function(a,b,c,d,e,f,h,i,j,k,l,m,n,o,p){var r,s,t=k.font,u=q(t),v=g.To.No(t,1).fontSize,w=v>8?I((v-8)/5+2):1;this.L$a(a,b,k),r=d.conditionalForeColor,r&&a.fillStyle!==r&&(a.fillStyle=r),o?this.c0a(a,c,d,k,e,f,m,n,u):(s=l>h,this.Oja(a,c,d,e,f,j,l,n,k.textDecoration,w,v,s,p))},a.prototype.c0a=function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o=c.content;if(o&&o.length>0)for(k=ma(a,o,!0,i),l=g-h-k-2,l=l>0?l:0,m=void 0,j=0;j<o.length;j++)"fillingChar"===o[j].type?(n=oa(a,l,o[j].value,!0,i),this.vWa(a,n,e,f,i),f+=l):"placeholder"===o[j].type?f+=o[j].value?o[j].value.length*i:0:"numberPlaceholder"===o[j].type?f+=i:(this.vWa(a,o[j].value,e,f,i),m=o[j].value?o[j].value.length*i:0,f+=m);else if(b)for(j=0;j<b.length;j++)this.vWa(a,b[j],e,f,i)},a.prototype.d0a=function(a){var b=z;return 1===a?b=B:2===a&&(b=A),b},a.prototype.a0a=function(a,b,c,d,e,f,g){var h,i,j=[],k=g.textInfos;for(h=0;h<k.length;h++)j.push(y(!0,{},e,k[h].style));for(h=0;h<k.length;h++)i=this.f0a(a,b,c,d,j[h],k[h].text),c=i.x,d=i.y},a.prototype.Y_a=function(a,b,c,d){var e,f,g=[],h=a.length;for(e=0;e<h;e++)f=this.g0a(b,c,d,a[e].textInfos),g.push(f);return g},a.prototype.g0a=function(a,b,c,d){var e,f,h,i,j=this,k=0,l=0;for(e=0;e<d.length;e++)f=void 0,f=d[e].style&&d[e].style.font?d[e].style.font:a.font,k=Math.max(q(f,H,s(d[e].text)),k),l=Math.max(g.To.No(f,1).fontSize,l),(d[e].style&&1===d[e].style.vertAlign||2===d[e].style.vertAlign)&&(k=Math.max(q(f,H,s(d[e].text))+2*g.To.No(f,R).fontSize*.218,k));return h=l>8?I((l-8)/5+2):1,i=k/2-l/2+h-1,{lineHeight:k,fontSize:l,baselineOffset:h,lineOffset:i,font:a.font,foreColor:a.foreColor,textDecoration:a.textDecoration,isVerticalText:a.isVerticalText,textAlign:j.d0a(b),textBaseline:C,opacity:c}},a.prototype.h0a=function(a,b,c){var d=0,e=0,f;for(f=0;f<a.length;f++)e+=b[f].lineHeight,d=Math.max(a[f].textLength,d);return{width:c?e:d,height:c?d:e}},a.prototype.$_a=function(a,b,c,d,e,f,g,h,i,j,k){var l,m=this.h0a(j,k,h),n=m.height,o=m.width,p=[];if(h)for(l=0;l<j.length;l++)p.push(this.i0a(a,b,c,d,e,f,g,o,j[l].textLength,k[l].lineHeight,k[l].lineOffset,i)),i?a-=k[l].lineHeight:a+=k[l].lineHeight;else for(l=0;l<j.length;l++)p.push(this.j0a(a,b,c,d,e,f,g,j[l].textLength,n,k[l].lineHeight,k[l].lineOffset)),b+=k[l].lineHeight;return p},a.prototype.j0a=function(a,b,c,d,e,f,g,h,i,j,k){var l=0,m=0;return m=1===f?(d-i)/2+j-k:2===f?d-i-2+j-k:2+j-k,1===e?l=(c-h)/2:2===e?(l=c-1-2-h,l-=g):l=2+g,{x:a+l,y:b+m}},a.prototype.i0a=function(a,b,c,d,e,f,g,h,i,j,k,l){var m=0,n=0;return l?0===e?m=2+h-j/2:1===e?m=(c+h)/2-j/2:2===e&&(m=c-1-2-j/2):1===e?m=(c-h)/2+j/2:2===e?m=c-1-2-h+j/2:0===e&&(m=2+j/2),n=1===f?(d-i)/2+j-k:2===f?d-g-i-2+j-k:2+g+j-k,{x:a+m,y:b+n}},a.prototype.f0a=function(a,b,c,d,e,g){var h,i,j;return a.save(),this.L$a(a,b,e),h=e.vertAlign,i=f.Ul.fp(e.font),j=e.isVerticalText?this.vWa(a,g,c,d,i,e.textDecoration,e.baselineOffset):this.k0a(a,c,d,e,g,h),a.restore(),j},a.prototype.L$a=function(a,b,c){var d,e,g=c.foreColor,h=c.opacity;g=f.Im._ob(b,g),o(h)||(d=m.ec(g),d.a=h,g=m.bc(d)),a.fillStyle!==g&&(a.fillStyle=g),e=c.vertAlign?this.l0a(c.font):c.font,o(c.textBaseline)||a.textBaseline===c.textBaseline?o(a.textBaseline)&&a.textBaseline!==C&&(a.textBaseline=C):a.textBaseline=c.textBaseline,c.isVerticalText?a.textAlign!==B&&(a.textAlign=B):a.textAlign!==z&&(a.textAlign=z),t(a,e)},a.prototype.l0a=function(a){var b=g.To.Ko(a),c=parseFloat(b.fontSize)*R;return b.fontSize=c+"px",this.m0a(b)},a.prototype.m0a=function(a){var b="",c="normal",d="Calibri",e=a.fontStyle,f=a.fontSize,g=a.fontWeight,h=a.fontFamily;return b=void 0!==e?e:c,b+=void 0!==g?(b?" ":"")+g:(b?" ":"")+c,b+=(b?" ":"")+f,b+=void 0!==h?(b?" ":"")+h:(b?" ":"")+d},a.prototype.vWa=function(a,b,c,d,e,f,h){if(b&&b.length>0)for(var i=0;i<b.length;i++)a.fillText(b[i],c,d),this.Mxb(a,f,c,d,w(a,a.font,b[i]),g.To.No(a.font,1).fontSize,h),d+=e;return{x:c,y:d}},a.prototype.Mxb=function(a,b,c,d,e,f,g){var h,i,j,k,l;a.strokeStyle!==a.fillStyle&&(a.strokeStyle=a.fillStyle),h=0,i=0,j=.5,k=f<=12?12:f,i=I((k-12)/21+1),a.lineWidth!==i&&(a.lineWidth=i),0===(1&i)&&(j=0),l=a.textAlign,l===B?c-=e/2:l===A&&(c-=e),a.beginPath(),2===(2&b)&&(h=J(d+g-f/2)-j,a.moveTo(c,h),a.lineTo(c+e,h)),a.stroke()},a.prototype.k0a=function(a,b,c,d,e,f){var h,i,j,k,l;return o(e)?{x:b,y:c}:(h=g.To.No(a.font,1).fontSize,i=h>8?I((h-8)/5+2):1,j=0,f?(j=1===f?.74*h:.28*-h,a.fillText(e,b,c-j)):a.fillText(e,b,c),k=w(a,a.font,e),l=d.textDecoration,this.ip(a,l,b,c,k,h,i-j),{x:b+k,y:c})},a.prototype.WGb=function(a,b,c,d,e){d.cellOverflowLayout||this.RBb(a,b,c,d,v(e))},a.prototype.paint=function(a,b,c,d,e,g,h,i){var j,k,l;a&&(j=h.backColor,i.parentBackColor!==j&&Y(a,c,d,e,g,i.imageLoader,h,b,i),k=this,l=new f.Rect(c,d,e,g),k.WGb&&k.WGb(a,l,h,i,b),k.i5&&(k.i5(a,l,h,i),l=k.f5(l,h)),i.cellOverflowLayout||k.uxb(a,l,i,v(b)),l.width>0&&l.height>0&&k.paintContent(a,b,l.x,l.y,l.width,l.height,h,i))},a.prototype.paintContent=function(a,b,c,d,e,g,h,i){var j,k,l,m,n,o,p,q,r=i.sheetArea;2!==r&&1!==r||(j=i.visualState||0,k="columnHeader",2===r&&(k="rowHeader"),l=this.getThemeStyle(i.visualState,"gc-"+k+"-"+f.Im.Jm(j)),T.gp(a,c,d,e,g,h,k,l,r)),n=i.conditionalFormats,n&&(m=n.jp(a,v(b),c,d,e,g,h,i)),i.showBarIconOnly=m,o=i.sparkline,o&&o.paintSparkline(a,c,d,e,g),p=Z(a,v(b),c,d,e,g,i.sheet),i.cellOverflowLayout||m||p||(q=new f.Rect(c,d,e,g),$(h.hAlign,i.sheet,i.row,i.col,i.sheetArea,q),this.paintValue(a,b,q.x,q.y,q.width,q.height,h,i))},a.prototype.createEditorElement=function(a,b){return G},a.prototype.getEditorValue=function(a,b){return G},a.prototype.kp=function(a,b,c,d){return c},a.prototype.setEditorValue=function(a,b,c){},a.prototype.getEditingElement=function(){return G},a.prototype.parse=function(a,b,c){var e,f,g=o(b),h=o(a);try{if(e=d.Formatter&&d.Formatter.GeneralFormatter,!g&&!h&&e)return f=typeof b===E?new e(b):b,f.parse(a)}catch(a){}return h?"":""+a},a.prototype.format=function(a,b,c,e){var g,h,m,n;if(o(a)||""===a)return"";if(e&&e.quotePrefix)return""+a;if(typeof b===E&&"object"!=typeof a)return f.mn.un(a,b,c);if(!b)return"boolean"==typeof a||a instanceof Boolean?(i&&(a=a?i.getBoolean().boolean_true:i.getBoolean().boolean_false),(""+a).toUpperCase()):a instanceof Date?(g=j.q4(j.culture()).DateTimeFormat,h=g.shortDatePattern,0===a.getHours()&&0===a.getMinutes()&&0===a.getSeconds()&&0===a.getMilliseconds()||(h=g.defaultDatePattern),l.Vb(a,h)):(typeof a===F&&(a=k.nb(""+a)),""+a);try{return m=d.Formatter&&d.Formatter.GeneralFormatter,m?(n=G,n=typeof b===E?f.mn.tn(b):b,n.format(a,c)):""+a}catch(b){return""+a}},a.prototype.focus=function(a,b){a&&a.focus&&a.focus()},a.prototype.getThemeStyle=function(a,b){return f.Im.Km(a,b)},a.prototype.activateEditor=function(a,b,c,d){},a.prototype.deactivateEditor=function(a,b){},a.prototype.selectAll=function(a,b){a&&a.select&&a.select()},a.prototype.updateEditor=function(a,b,c,d){},a.prototype.setImeMode=function(a,b,c){this.isImeAware(c)?this.updateImeMode(a,b,c):a&&T.hp(a,0)},a.prototype.updateImeMode=function(a,b,c){a&&T.hp(a,b)},a.prototype.getHitInfo=function(a,b,c,d,e){return G},a.prototype.getCellAndPaddingHitInfo=function(b,c,d,e,f){var g,h,i,j=this;if(f){if(g={x:b,y:c,context:f,cellStyle:d,cellRect:e,paddingHitInfo:null},a.ao(f.sheet,"getCellButtonHitInfo",g,function(){return null!==g.paddingHitInfo&&void 0!==g.paddingHitInfo}),h=g.paddingHitInfo,g.paddingHitInfo&&g.paddingHitInfo.cellButtonHitInfo)return g.paddingHitInfo;if(3===f.sheetArea)return i=j.f5?j.f5(g.cellRect,d):g.cellRect,g={x:b,y:c,context:f,cellStyle:d,cellRect:i,paddingHitInfo:null},a.ao(f.sheet,"getCellPaddingHitInfo",g,function(){return null!==g.paddingHitInfo&&void 0!==g.paddingHitInfo}),g.paddingHitInfo?g.paddingHitInfo:h?h:this.getHitInfo(b,c,d,e,f)}return this.getHitInfo(b,c,d,e,f)},a.prototype.processCellAndPaddingMouseDown=function(b){return a.ao(b.sheet,"processMouseDownOnCellPadding",b),this.processMouseDown(b)},a.prototype.processMouseDown=function(a){return!1},a.prototype.YBb=function(b){return a.ao(b.sheet,"processMouseMoveOnCellPadding",b),this.processMouseMove(b)},a.prototype.processMouseMove=function(a){return!1},a.prototype.XGb=function(b){return a.ao(b.sheet,"processMouseUpOnCellPadding",b),this.processMouseUp(b)},a.prototype.processMouseUp=function(a){return!1},a.prototype.processMouseEnter=function(a){return!1},a.prototype.ZBb=function(b){return a.ao(b.sheet,"processMouseLeaveOnCellPadding",b),this.processMouseLeave(b)},a.prototype.processMouseLeave=function(a){return!1},a.prototype.isReservedKey=function(a,b){return!1},a.prototype.isEditingValueChanged=function(a,b,c){return a!==b},a.prototype.processKeyDown=function(a,b){return!1},a.prototype.processKeyUp=function(a,b){return!1},a.prototype.getAutoFitWidth=function(a,b,c,d,e){return T.cp(a,b,c,d,e)},a.prototype.getAutoFitHeight=function(a,b,c,d,e){return T.ep(a,b,c,d,e)},a.prototype.Oja=function(a,b,c,d,e,f,g,h,i,j,k,l,m){c&&c.content&&c.content.length>0&&!l?this.Pja(a,c.content,d,e,f,g,h,i,j,k,m):(a.fillText(b,d,e),i&&(m=w(a,a.font,b),this.ip(a,i,d,e,m,k,j)))},a.prototype.oHb=function(a,b,c,d,e,f,g,h,i){if(a.save(),a.textAlign="center",a.textBaseline="middle",a.translate(d,e),a.rotate(-b),a.fillText(c,0,0),f){var j=a.measureText(c).width;this.ip(a,f,0,i,j,g,h)}a.restore()},a.prototype.nHb=function(a,b,c){var d,e,f=ma(a,b),g=c-f;for(g=g>0?g:0,d=[],e=0;e<b.length;e++)if("fillingChar"===b[e].type)d.push(oa(a,g,b[e].value));else{if("placeholder"===b[e].type||"numberPlaceholder"===b[e].type)continue;d.push(b[e].value)}return d.join("")},a.prototype.Pja=function(a,b,c,d,e,f,g,h,i,j,k){var l,m;a.save(),a.textAlign!==z&&(a.textAlign=z),l=ma(a,b),m=f-g-l-2,m=m>0?m:0,o(k)?na(b)?1===e?(c-=f/2,c+=g):2===e&&(c=c-f+2,c+=g):o(l)||(1===e?c-=l/2:2===e&&(c-=l)):na(b)?1===e?(c=c+(k?k:l)/2-f/2,c+=g):2===e&&(c=c+(k?k:l)-f+2,c+=g):o(l)||(1===e?c=c+k/2-l/2:2===e&&(c=c+k-l)),this.Qja(a,b,c,d,m,h,i,j),a.restore()},a.prototype.Qja=function(a,b,c,d,e,f,g,h){var i,j;for(j=0;j<b.length;j++)"fillingChar"===b[j].type?(a.fillText(oa(a,e,b[j].value),c,d),f&&this.ip(a,f,c,d,e,h,g),c+=e):"placeholder"===b[j].type?c+=w(a,a.font,b[j].value):"numberPlaceholder"===b[j].type?c+=w(a,a.font,"0"):(a.fillText(b[j].value,c,d),i=w(a,a.font,b[j].value),f&&this.ip(a,f,c,d,i,h,g),c+=i)},a.prototype.ip=function(a,b,c,d,e,f,g){var h,i,j,k,l;a.strokeStyle!==a.fillStyle&&(a.strokeStyle=a.fillStyle),h=a.textAlign,i=0,j=0,k=.5,l=f<=12?12:f,j=I((l-12)/21+1),a.lineWidth!==j&&(a.lineWidth=j),0===(1&j)&&(k=0),h===B?c-=e/2:h===A&&(c-=e),a.beginPath(),4===(4&b)&&(i=J(d+g-f-1)-k,a.moveTo(c,i),a.lineTo(c+e,i)),2===(2&b)&&(i=J(d+g-f/2)-k,a.moveTo(c,i),a.lineTo(c+e,i)),1===(1&b)&&(i=J(d+g-1)-k,a.moveTo(c,i),a.lineTo(c+e,i)),8===(8&b)&&(i=J(d+g-1)-k,a.moveTo(c,i-j),a.lineTo(c+e,i-j),a.moveTo(c,i+j),a.lineTo(c+e,i+j)),a.stroke()},a.prototype.lp=function(a,b){var c="";4===(4&b)&&(c="overline"),2===(2&b)&&(c+=" line-through"),1===(1&b)&&(c+=" underline"),a.css("text-decoration",c)},a.prototype.gQa=function(){return G},a.prototype.isImeAware=function(a){return!1},a.prototype.isEditting=function(){return!1},a.prototype.toJSON=function(){var a,b={},c=this;for(a in c)c.hasOwnProperty(a)&&(b[a]=c[a]);return b},a.prototype.fromJSON=function(a){if(a)for(var b in a)o(a[b])||(this[b]=a[b])},a}(),b.Base=U,f.Zn(U),h._o[0]=U;function V(a,b,c,d){var e,f,g=a.conditionalFormats;if(g)return e=a.getValue(b,c,d),f=g.oRa(a,b,c,e).iconSet,g.bp(b,c,d)&&f}function W(a,b,c){var d,e,f=0;for(d=0;d<a.length;d++)e=void 0,e=a[d].style&&a[d].style.font?a[d].style.font:b,f=Math.max(q(e,H,s(a[d].text))/c,f),(a[d].style&&1===a[d].style.vertAlign||2===a[d].style.vertAlign)&&(f=Math.max(q(e,H,s(a[d].text))/c+2*g.To.No(e,R).fontSize*.218,f));return f}function X(a,b,c,d,e){var h,i,j,k,l,m=f.Vn.bm();if(!m)return 0;for(h=0,i=0;i<a.length;i++)j=void 0,j=a[i].style&&a[i].style.font?a[i].style.font:b,a[i].style&&a[i].style.vertAlign&&(j=g.To.No(j,R).font),
t(m,j),k="",k=i===a.length-1&&e?f.Vn.Rvb(a[i].text):a[i].text,l=0,d?l=q(j)*k.length/c:o(a[i].text)||(l=w(m,j,a[i].text)/c),h+=l;return h}function Y(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r=g.backColor,s=g.backgroundImage,t=g.textOrientation,u=g.isVerticalText,v=g.textIndent&&0!==g.textIndent,w=g.backgroundImageLayout;(r||s)&&(a.save(),a.beginPath(),r&&(a.fillStyle!==r&&(a.fillStyle=r),j=i.row,k=i.col,l=i.sheet&&i.sheet.getSpan(j,k),m=g&&(g.borderLeft||g.borderTop||g.borderRight||g.borderBottom),t&&0!==t&&m&&h&&!l&&!u&&!v?(n=void 0,o=void 0,p=void 0,q=b,n=N(t*Math.PI/180),o=M(n),p=I(e/o),t>-90&&t<0&&(q=b-p),t>0&&t<90&&(q=b+p),a.moveTo(q,c),a.lineTo(q+d,c),a.lineTo(b+d,c+e),a.lineTo(b,c+e),a.fill()):a.fillRect(b,c,d,e)),T.ap(a,b,c,d,e,s,w,f),a.restore())}function Z(a,b,c,d,e,f,g){var h,i;return!!(b&&"SparklineExValue"===b.typeName&&(h=g&&g.parent,h&&(i=h.getSparklineEx(b.name))))&&(i.paint(a,b.value,c,d,e,f,{zoomFactor:g.zoom(),sheet:g}),!0)}function $(a,b,c,d,e,f){if(0===a&&V(b,c,d,e)){var g=_(b);f.x+=g,f.width-=g}}function _(a){return parseInt(D*Math.min(1,a.zoom()),10)}function aa(a,b,c,d){var e=a.cellPadding,f=0,g=a.labelOptions;return c&&(e=g?g.margin:"0"),e&&(f=parseInt(fa(e)[b],10),f=typeof f===F&&f>0?f:0),d===H?f:f*d}function ba(a){var b={context:a,value:0};return U.ao(a.sheet,"getOutlineColumnOffset",b),b.value}function ca(a,b){var c={context:a,value:0,cellStyle:b};return U.ao(a.sheet,"getCellButtonAutoWidth",c),c.value}function da(a,b){var c={context:a,value:0,cellStyle:b};return U.ao(a.sheet,"getCellButtonAutoHeight",c),c.value}function ea(a,b,c,d){var f,g,h=d&&d.sheet;h&&c&&(f=d.canvasOffset||h.mm.bG(),g=h.Dr(),e.GC$(a).css("top",f.top+g.y+c.y-2).css("left",f.left+g.x+c.x-2).css("background-color",b.backColor||"white").width(c.width).height(c.height))}function fa(a){var b,c,d,e,f=["0","0","0","0"];return typeof a===E&&(b=a.split(" ",4),c=b.length,d=void 0,e=void 0,1===c?(d=b[0],f=[d,d,d,d]):2===c?(d=b[0],e=b[1],f=[d,e,d,e]):3===c?(e=b[1],f=[b[0],e,b[2],e]):4===c&&(f=[b[0],b[1],b[2],b[3]])),f}function ga(a,b){var c,d=aa(a,0),e=aa(a,2),f=aa(a,0,!0),g=aa(a,2,!0);if(aa(a,3,!0)+aa(a,1,!0)>=b.width)return!1;if(c=a.labelOptions.alignment,c===H&&(c=a.labelOptions.alignment=0),0===c||1===c||2===c){if(d>0&&f+g<d)return!0}else if((3===c||4===c||5===c)&&d<b.height&&e>0&&f+g<e)return!0;return!1}function ha(a,b){var c=aa(b,0),d=aa(b,3,!0),e=aa(b,2,!0),f=a.clone(),g=b.labelOptions.alignment;return 0===g||1===g||2===g?c<a.height&&(f.height=c-e+1):3!==g&&4!==g&&5!==g||(f.height=a.height-e),f.x+=d,f.width-=d+aa(b,1,!0),f}function ia(a){var b="left";return 1===a||4===a?b="center":2!==a&&5!==a||(b="right"),b}function ja(a,b,c,d){var e=new f.Point(a.x,a.y),g=parseInt(c.fontSize,10),h=aa(b,0),i=aa(b,2),j=aa(b,3,!0),k=aa(b,1,!0),l=a.width,m=a.height,n=g>8?Math.floor((g-8)/5+2):1,o=d/2-g/2+n-1,p=g>8?1:2,q=d-o+aa(b,0,!0),r=q+1,s=h+i>m?h+q:m-i+q-1;switch(b.labelOptions.alignment){case 0:e.x+=j+p+1,e.y+=r;break;case 1:e.x+=j+(l-j-k)/2,e.y+=r;break;case 2:e.x+=l-k-2,e.y+=r;break;case 3:e.x+=j+p+1,e.y+=s;break;case 4:e.x+=j+(l-j-k)/2,e.y+=s;break;case 5:e.x+=l-k-2,e.y+=s}return e}function ka(a,b,c){var d,e=aa(b,3,!0),f=aa(b,1,!0),g=aa(b,0,!0),h=aa(b,2,!0),i=a.clone();return i.width=c.width,d=b.labelOptions.alignment,i.x=e+1+c.x-a.x,i.width-=e+f,0===d||1===d||2===d?(i.y=g,i.height=aa(b,0)-g-h):3!==d&&4!==d&&5!==d||(i.y=a.height-aa(b,2)+g,i.height=aa(b,2)-g-h),2!==d&&5!==d||(i.width-=2),i}function la(a,b){var c,d,e;if(a.cellPadding){for(c=fa(a.cellPadding),d=void 0,e=[],d=0;d<4;d++)e[d]=parseInt(c[d],10),"number"==typeof e[d]&&e[d]>0&&(e[d]*=b);a.cellPadding=e.join(" ")}}function ma(a,b,c,d){var e,f;if(p(b,E))return w(a,a.font,b);if(c&&b&&b[0]&&b[0].value)return b[0].value.length*d;for(e=0,f=0;f<b.length;f++)"fillingChar"!==b[f].type&&(e+=w(a,a.font,b[f].value));return e}function na(a){for(var b=0;b<a.length;b++)if("fillingChar"===a[b].type)return!0;return!1}function oa(a,b,c,d,e){var f;return f=d?Math.floor(b/e):Math.floor(b/w(a,a.font,c)),Array(f+1).join(c)}function pa(a){var b=a.clone();return b.width--,b.height--,b}function qa(a,b,c){var d,e,f;for(d=0;d<a.length;d++)e=void 0,a[d].style=a[d].style||{},f=a[d].style,e=f.font?g.To.No(f.font,c).font:b,f.font=e}},"./dist/core/celltype/cellType.entry.js":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./dist/core/celltype/celltype.ns.js")),d(c("./dist/core/celltype/basecelltype.js")),d(c("./dist/core/celltype/textcelltype.js")),d(c("./dist/core/celltype/headercelltype.js"))},"./dist/core/celltype/celltype.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b._o={}},"./dist/core/celltype/headercelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/stylehelper.js"),h=c("./dist/core/celltype/celltype.ns.js"),i=c("./dist/core/celltype/basecelltype.js"),j=c("./dist/core/core.enum.js"),k=f.Im,l=f.Vn,m=f.Ul.wl,n=f.Ul.uWa,o=f.Ul.lZa,p=d.Common.j.Fa,q=f.Ul.K_a,r=e.GC$.extend,s="none",t=void 0,u=Math.floor;function z(a,b){return a=a||0,k.Km(a,"gc-"+b+"-"+k.Jm(a))}function A(a,b,c,d,e,f){var g=new Image,h=f;h=h.replace('url("',""),h=h.replace('")',""),g.src=h,a.drawImage(g,b,c,d,e)}function B(a,b,c,d,e,f,g,h,k){var l,n,o,q,r,t,u,v,w,x,y,z,B;if(!p(h)){if(a.save(),a.beginPath(),l=void 0,0===h&&f.backColor)l=f.backColor,a.fillStyle!==l&&(a.fillStyle=l),a.fillRect(b+1,c+1,d-1,e-1);else try{if(n=k&&k.backgroundColor,o=k&&k.backgroundImage,q=g.sheet,r=g.row,t=g.col,u=g.sheetArea,v=void 0,w=!1,q.cellStates&&h===j.VisualState.hover&&(v=q.cellStates.getStyle(r,t,u),v&&v.backColor&&(n=v.backColor,w=!0)),!w&&o&&o.indexOf("linear-gradient")!==-1){for(x=m(o),l=a.createLinearGradient(b+d/2,c,b+d/2,c+e),y=0,z=x.length;y<z;y++)B=x[y],l.addColorStop(B.point,B.color);a.fillStyle=l,a.fillRect(b+1,c+1,d-1,e-1)}else n?(a.fillStyle=n,a.fillRect(b+1,c+1,d-1,e-1)):o&&o!==s&&A(a,b+1,c+1,d-1,e-1,o)}catch(a){}i.Context.ap(a,b,c,d,e,f.backgroundImage,f.backgroundImageLayout,g.imageLoader),a.restore()}}function C(a,b,c,d,e,g,h,j,k,l,m,n){var o,p,q;b&&(o=k.visualState||0,p=z(o,l),B(b,d,e,g,h,j,k,o,p),i.Context.gp(b,d,e,g,h,j,l,p,m,k.needTopGridline,k.needLeftGridline),q=new f.Rect(d,e,g,h),a.WGb&&a.WGb(b,q,j,k,c),a.i5&&(a.i5(b,q,j,k),q=a.f5(q,j)),q.width>0&&q.height>0&&a.paintContent(b,c,q.x,q.y,q.width,q.height,j,k,n))}function D(a,b,c,d,e,f){var h,i={font:b,fillStyle:c},j=d.sheet;return 0!==d.visualState&&parseInt(f.zIndex,10)>2007&&j.vp(d.row,d.col,e)&&(h=void 0,h=j.wp(d.row,d.col,e)?a(d.visualState,"gc-columnHeader-selected"):a(d.visualState,"gc-columnHeader-highlight"),i.fillStyle=h.color,i.font=g.To.Ro(i.font,"bold")),i}function E(a,b,c,d,e,g,h,i,j,k,l,m){var n,o,p,r={},s=a.format(q(c),i.formatter,r),t=j.sheet;s&&(b.save(),b.beginPath(),n=t.rowFilter&&t.rowFilter(),o=!!(n&&n.Dl(j.row,j.col,k)&&n.filterButtonVisible(j.col)),(o||m)&&(g-=t.oK(new f.Rect(d,e,g,h),k).width),p=i.foreColor,p||(p=l.color),p&&b.fillStyle!==p&&(b.fillStyle=p),c&&c.richText&&c.richText.length>0||i.isVerticalText?F(a,t,b,c,d,e,g,h,i,s,r,j,k,l):G(a,b,c,d,e,g,h,i,s,r,j,k,l),b.restore())}function F(a,b,c,d,e,f,g,h,i,j,k,l,m,o){var p,q,s,u,v,w,x,y={x:e,y:f,width:g,height:h},z=D(a.getThemeStyle,i.font||c.font,c.fillStyle,l,m,o),A=i.isVerticalText,B=i.hAlign,C=I(i),E=a.T_a(i.formatter||i._autoFormatter,d.text),F=r(!0,[],a.U_a(d,j,E,z.font,z.fillStyle));if(d&&d.richText&&d.richText.length>0&&(p=l.sheet?l.sheet.zoom():1,a.V_a(F,z,p)),!i.wordWrap&&i.shrinkToFit&&a.W_a(F,g,h,i,z,1,A),q=a.X_a(c,j,i.font,A?h:g,C,A?i.vAlign:i.hAlign,i.wordWrap,A,F),s=a.Y_a(q,i,B),H(c,i,e,f,g,h,C,q[0].textLength,s[0].lineHeight),u=A?n(j):t,v=a.$_a(y.x,y.y,y.width,y.height,B,i.vAlign,C,A,u,q,s),w=q.length,1===w&&k.content&&!E)a.__a(c,b,j,k,v[0].x,v[0].y,g,h,B,i,y.width,y.height,C,A,q[0].textLength);else for(x=0;x<w;x++)a.a0a(c,b,v[x].x,v[x].y,s[x],B,q[x])}function G(a,b,c,d,e,f,g,h,i,j,k,m,n){var p,q,r,s,t,v,w,x,y,z,A,B,C,E,F,G,H,I,J,K,L,M,N,O,P,Q,R={x:d,y:e,width:f,height:g},S=D(a.getThemeStyle,h.font||b.font,b.fillStyle,k,m,n);if(o(b,S.font),b.fillStyle=S.fillStyle,p=0,q=h.textIndent,q>0&&(p=8*q),r=parseInt(k.fontInfo.fontSize,10),s=h.hAlign,t=h.vAlign,v="left",w=2,w+=p,1===s?(w=f/2,v="center"):2===s&&(w=f-1,w-=p,v="right"),b.textAlign!==v&&(b.textAlign=v),x=0,y="alphabetic",z=2,A=h.wordWrap,B=k.lineHeight,C=[],E=0,A&&(F=f-3-p,F-=1,C=l.Wn(i,F,S.font),E=C.length,E>1&&0!==t&&(x=(E-1)*B)),G=r>8?u((r-8)/5+2):1,H=B/2-r/2+G-1,z+=B-H,1===t?z=(g-x)/2+B/2-H:2===t&&(z=g-x-2-H),b.textBaseline!==y&&(b.textBaseline=y),I=h.textDecoration,J=R.x,K=R.y,L=R.width,M=R.height,h.wordWrap)if(b.rect(J,K,L,M),b.clip(),b.beginPath(),N=e+z,E>1)for(O=0;O<E;O++)b.fillText(C[O],d+w,N),I&&(P=b.measureText(C[O]).width,a.ip(b,I,d+w,N,P,r,G)),N+=B;else a.Oja(b,i,j,d+w,e+z,s,L,p,I,G,r);else Q=b.measureText(i).width,(Q>L||B>M)&&(b.rect(J,K,L,M),b.clip(),b.beginPath()),a.Oja(b,i,j,d+w,e+z,s,L,p,I,G,r)}function H(a,b,c,d,e,f,g,h,i){var j=!1;j=!!b.wordWrap||(b.isVerticalText?h+g>f||i>e:h+g>e||i>f),j&&(a.rect(c,d,e,f),a.clip(),a.beginPath())}function I(a){var b=0,c=a.textIndent;return c>0&&(b=8*c),b}v=function(a){y(b,a);function b(){var b=a.call(this)||this;return b.typeName="2",b}return b.prototype.paint=function(a,b,c,d,e,f,g,h,i){C(this,a,b,c,d,e,f,g,h,"columnHeader",1,i)},b.prototype.paintContent=function(a,b,c,d,e,f,g,h,i){var j=z(h.visualState,"columnHeader");E(this,a,b,c,d,e,f,g,h,1,j,i)},b}(i.Base),b.ColumnHeader=v,h._o[2]=v,w=function(a){y(b,a);function b(){var b=a.call(this)||this;return b.typeName="3",b}return b.prototype.paint=function(a,b,c,d,e,f,g,h){C(this,a,b,c,d,e,f,g,h,"rowHeader",2)},b.prototype.paintContent=function(a,b,c,d,e,f,g,h){var i=z(h.visualState,"rowHeader");E(this,a,b,c,d,e,f,g,h,2,i)},b}(i.Base),b.RowHeader=w,h._o[3]=w,x=function(a){y(b,a);function b(){var b=a.call(this)||this;return b.typeName="4",b}return b.prototype.paint=function(a,b,c,d,e,f,g,h){var i,j,l,n,o,p,q,r,t,u,v,w,x,y,z,B,C;if(a){a.save(),a.rect(c,d,e,f),a.clip(),a.beginPath(),i=this,j=h.visualState||0;try{l=i.getThemeStyle(h.visualState,"gc-corner-"+k.Jm(j)),n=l&&l.backgroundColor,o=l&&l.backgroundImage,n?(a.fillStyle=n,a.fillRect(c,d,e,f)):o&&o!==s&&A(a,c,d,e,f,o)}catch(a){}if(p=i.getThemeStyle(4,"gc-corner-triangle-"+k.Jm(j)),q=p&&p.backgroundImage,r=p&&p.backgroundColor,t=a.createLinearGradient(c+e/2,d,c+e/2,d+f),q&&q.indexOf("linear-gradient")!==-1){for(u=m(q),v=0,w=u.length;v<w;v++)x=u[v],t.addColorStop(x.point,x.color);a.fillStyle=t}else r&&(t.addColorStop(.125,"#f6fafb"),t.addColorStop(1,r),a.fillStyle=t);y=a.createLinearGradient(c+e,d+1,c+e,d+f-2),y.addColorStop(0,p.borderLeftColor),y.addColorStop(1,p.borderRightColor),a.beginPath(),a.strokeStyle=y,a.moveTo(c+e-.5,d),a.lineTo(c+e-.5,d+f),a.stroke(),h.needLeftGridline&&(a.beginPath(),a.strokeStyle=p.borderLeftColor,a.moveTo(c+.5,d),a.lineTo(c+.5,d+f),a.stroke()),z=a.createLinearGradient(c,d,c+e-2,d),z.addColorStop(0,p.borderTopColor),z.addColorStop(1,p.borderBottomColor),a.beginPath(),a.strokeStyle=z,a.moveTo(c,d+f-.5),a.lineTo(c+e,d+f-.5),a.stroke(),h.needTopGridline&&(a.beginPath(),a.strokeStyle=p.borderTopColor,a.moveTo(c,d+.5),a.lineTo(c+e,d+.5),a.stroke()),a.beginPath(),B=3,C=f,e<f&&(C=e),a.moveTo(c+e-C+B,d+f-B),a.lineTo(c+e-B,d+f-B),a.lineTo(c+e-B,d+f-C+B),a.fill(),a.restore()}},b}(i.Base),b.Corner=x,h._o[4]=x},"./dist/core/celltype/textcelltype.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/worksheet/worksheet.js"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),h=c("./dist/core/celltype/celltype.ns.js"),i=c("./dist/core/celltype/basecelltype.js"),j=d.Common.j.Fa,k=g.Vn,l=g.Events.EditChange,m=g.Vl,n=g.Ul,o=n.Nl,p=n.Ml,q=p.msie,r=p.edge,s=p.chrome,t=n.nl,u=n.ol,v=n.Il,w=n.vl,x=n.rl(),y=n.fp,z=n.Voa,A=n.Ika,B=n.hZa,C=n.K_a,D=n.Fxb,E="left",F="right",G="center",H="gcUIElement",I="none",J=".gcEditingInput",K="width",L="height",M="text-align",N="hidden",O="word-wrap",P="overflow",Q="vertical-align",R="normal",S="break-word",T="overflow-y",U="scroll",V="word-break",W="float",X=window,Y=document,Z=.337,$=x.iphone||x.ipad||x.android,_=null,aa=void 0,ba=Math.ceil,ca=Math.min,da=Math.sin,ea=Math.cos,fa=Math.abs,ga=Math.max,ha=parseInt,ia="\xa0",ja="\u200b";function na(a){return $||0===a}function oa(a){return na(a)?f.GC$(o("textarea")):f.GC$(o("div"))}function pa(a){return a&&"DIV"===a.tagName&&"true"===a.contentEditable}function qa(a){return pa(a)?q&&parseFloat(p.version)<10?n.Woa(a):a.innerText:a.value}function ra(a,b){pa(a)?a.innerText=b:a.value=b}function sa(a){if(pa(a)){var b=X.getSelection();b.selectAllChildren(a),b.rangeCount>0&&b.collapseToEnd()}else a.selectionStart=a.selectionEnd=a.value.length}function ta(a){var b,c;return pa(a)?(b=X.getSelection(),b.rangeCount>0?(c=b.getRangeAt(0),c.startOffset):0):a.selectionStart}function ua(a){var b,c;return pa(a)?(b=X.getSelection(),b.rangeCount>0?(c=b.getRangeAt(0),c.endOffset):0):a.selectionEnd}function va(a){var b=a.keyCode,c=a.shiftKey,d={106:42,107:43,109:45,110:46,111:47,173:45},e={186:59,187:61,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39},f={186:58,187:43,188:60,189:95,190:62,191:63,192:126,219:123,220:124,221:125,222:34},g=b;return b>=96&&b<=105?g=b-48:d[b]?g=d[b]:c&&f[b]?g=f[b]:!c&&e[b]?g=e[b]:!c&&b>=65&&b<=90&&(g=b+32),g}function wa(a){return a&&"BR"===a.tagName}function xa(a){return a&&"SPAN"===a.tagName}function ya(a){return a&&"DIV"===a.tagName}function za(a){return a instanceof Text}function Aa(a){return a===ja}function Ba(a){if(a&&za(a)){var b=a.textContent;if(1===b.length&&Aa(b[0]))return!0}return!1}function Ca(a){if(a){var b=a.childNodes;return xa(a)&&2===b.length&&wa(b[0])&&Ba(b[1])}return!1}function Da(a,b,c,d){var e=a.substr(0,b),f=a.substr(c,a.length-c);return e+d+f}function Ea(a,b,c,d,e,f){var g,h,i,j,k,l="",m=a.childNodes,n=m.length;for(g=0;g<n;g++)h=m[g],xa(h)?l+=Ea(h,b,c,d,e,f):za(h)?(i=b&&b.startContainer,j=b&&b.endContainer,k=h.textContent,h===i||h===j?i!==j?h===i?(l+=Da(k,c,k.length,e),f=!0):(l+=Da(k,0,d,""),f=!1):l+=Da(k,c,d,e):f||(l+=k)):wa(h)&&!f&&(l+="\n");return l}function Fa(a,b,c,d,e){var f,g,h=String.fromCharCode(va(e));return pa(a)?(f=X.getSelection(),f.rangeCount>0&&(g=f.getRangeAt(0),za(g.startContainer))?Ea(a,g,c,d,h):g&&g.startOffset===g.endOffset?b+h:h):Da(b,c,d,h)}function Ga(a,b){for(var c=a&&a.previousSibling;c;){if(b(c))return c;c=c.lastChild}return _}function Ha(a,b){var c,d,e,f,g,h=a.childNodes.length;if(!Aa(a.textContent[0])||0!==b&&1!==b)if(0===b)d=a,a===a.parentNode.firstChild&&(d=a.parentNode),e=Ga(d,Ca),c=e&&e.lastChild;else{if(ya(a))return 1===h&&1===b?c=a.firstChild.firstChild.lastChild:h>1&&b===h&&(c=a.lastChild),Ba(c)?{zeroWidthCharNode:c,previousTextNode:c.previousSibling.previousSibling}:Ca(c)?{zeroWidthCharNode:c,previousTextNode:Ga(d,za)}:_;!xa(a)||b!==h&&b!==h-1||(Ca(a)?c=a:Ca(a.lastChild)&&(c=a.lastChild))}else c=a;return c?(xa(c)?d=c:za(c)&&(f=c.previousSibling,g=c.parentNode,d=f===g.firstChild?g:f),{zeroWidthCharNode:c,previousTextNode:Ga(d,za)}):_}function Ia(a,b,c){if(1===b&&xa(c.firstChild)&&xa(c.firstChild.firstChild)){var d=c.firstChild.firstChild.lastChild,e=void 0;if(a===c)return e=d.textContent,1===e.length&&e[0]!==ja&&wa(d.previousSibling);if(d===a||wa(d)&&a===d.previousSibling)return e=a.textContent,1===e.length&&e[0]!==ja&&wa(a.previousSibling)}return!1}function Ja(a,b){var c,d,e,f,g,h,i,j,k,l,m=X.getSelection();if(!(m.rangeCount<=0)){if(c=m.anchorNode,d=m.anchorOffset,e=a.target,q&&!r&&b&&Ia(c,d,e))return f=parseFloat(p.version)<10?Ea(e):e.innerText,g=f.slice(0,-1),e.innerHTML=g.replace(/\r/g,"").replace(/\n/g,"<br>\u200b"),m.selectAllChildren(e),m.rangeCount>0&&m.collapseToEnd(),void t(a);if(h=Ha(c,d)){if(i=h.zeroWidthCharNode,j=h.previousTextNode,b)if(xa(i))i.parentNode.removeChild(i);else{if(i.parentNode.removeChild(i.previousSibling),wa(j))return void t(a);k=m.getRangeAt(0),k.setStart(i,0),k.setEnd(i,1),k.deleteContents()}l=Y.createRange(),l.setStartAfter(j),l.setEndAfter(j),l.collapse(!1),m.removeAllRanges(),m.addRange(l),t(a)}}}function Ka(a){for(var b,c=a;c;){if(b=c.parentNode,c!==b.lastChild)return c.nextSibling;c=b}return _}function La(a){var b,c,d=a.anchorNode,e=a.anchorOffset,f=d.textContent,g=f.length;if(e===g){if(b=Ka(d),c=void 0,!b)return _;if(xa(b)&&Aa(b.textContent[0])){for(;xa(b.firstChild);)b=b.firstChild;c=b.childNodes[1]}else wa(b)&&Aa(b.nextSibling.textContent[0])&&(c=b.nextSibling);return{node:c,offset:1}}return _}function Ma(a,b){var c,d,e,f,g,h=X.getSelection();h.rangeCount<=0||(c=La(h),c&&(d=c.node,e=c.offset,b?(f=h.getRangeAt(0),f.setStart(d,0),f.setEnd(d,1),f.deleteContents(),d.parentNode.removeChild(d.previousSibling)):(g=Y.createRange(),g.setStart(d,e),g.setEnd(d,e),g.collapse(!1),h.removeAllRanges(),h.addRange(g)),t(a)))}function Na(a){var b=Qa(a);return b&&b.indexOf(" ")>=0&&(b=A(b," ",ia)),b}function Oa(a,b){var c,d,f,g,h,i,j,k,l,n,o=a.srcElement||a.target;o&&"gcEditingInput"===o.getAttribute(H)&&13===a.keyCode&&(a.ctrlKey||a.altKey)&&(c=m.Xl(),c instanceof e.Worksheet&&(d=c.getCellType(c.Jl,c.Kl),d&&(pa(o)?(f=X.getSelection(),f.rangeCount>0&&(g=f.getRangeAt(0),h=Y.createElement("span"),h.innerHTML="<br/>"+ja,g.insertNode(h),i=Y.createRange(),i.setStartAfter(h),i.setEndAfter(h),i.collapse(!1),f.removeAllRanges(),f.addRange(i))):(j=o.selectionStart,k=o.value,l=k.substr(0,j),n=k.substr(j,k.length-j),o.value=l+"\n"+n,o.selectionStart=j+1,o.selectionEnd=j+1),d.updateEditor(c.BF,_,_,b))),t(a))}function Pa(a){var b,c=a;return c?c.indexOf(ja)<0&&c.indexOf("\n")<0?c:(b=a.split("\n"),b.forEach(function(a,b,c){Aa(a[0])&&(c[b]=a.substr(1))}),b.join("\n")):c}function Qa(a){var b,c=a;return c?(b=c.length,b>0&&"\n"===c[b-1]&&(c+=ja),c):c}function Ra(a){var b,c,d,e,f,g,h=X.getSelection(),i=!1,j=0,k=0;if(h.rangeCount>0)return b=h.getRangeAt(0),c=ta(a),d=ua(a),e=b.startContainer,f=b.endContainer,ya(e)&&(i=!0,j=c),ya(f)&&(k=d),g=Sa(a,c,d,e,f,i,j,k),g.content}function Sa(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o;if(d===e&&!f)return{content:Pa(d.textContent.slice(b,c))};for(i="",j=g,m=a.childNodes,n=h||m.length,j;j<n;j++)if(o=m[j],xa(o)){if(k=Sa(o,b,c,d,e,f,0,0),i+=k.content,k.startFlag&&(f=!0),k.endFlag){l=!0;break}}else if(za(o)&&o===d)i+=o.textContent.slice(b,o.textContent.length),f=!0;else{if(za(o)&&o===e){i+=o.textContent.slice(0,c),l=!0;break}f&&(i+=wa(o)?"\n":o.innerText||o.textContent)}return{content:Pa(i),startFlag:f,endFlag:l}}function Ta(a,b){var c,d=a.length,e=[];for(c=0;c<d;c++)e.push(z(a[c],b));return e}function Ua(a){var b,c=a.length,d=0;for(b=0;b<c;b++)d+=a[b];return d}function Va(a,b,c,d){var e,f,g=0,h=c;for(e=0;e<a.length;e++)s&&(h=d[e]),a[e]>b?(f=ba(a[e]/b),g+=h*f):g+=h;return g}function Wa(a,b,c){var d=qa(a);return d&&"="===d[0]||""===d&&"="===b[0]||0===c&&"="===b[0]}!function(a){a[a.textarea=0]="textarea",a[a.editableDiv=1]="editableDiv"}(ka=b.EditorType||(b.EditorType={})),la=function(a){ma(b,a);function b(b){var c=a.call(this)||this;return c.allowOverflow=!0,c.typeName="1",c.editorType=j(b)?1:b,c}return b.prototype.getText=function(a,b){return a},b.prototype.paintValue=function(a,b,c,d,e,f,g,h){var j,k,l,m,n,o,p,q,r,t,u,v,w,x,y=this,z=h.sheet,A=z.zoom?z.zoom():1;return b=y.getText(b,h),j={},h.quotePrefix=g.quotePrefix,l=g.formatter&&"General"!==g.formatter,m=g.textOrientation,n=g.textIndent&&0!==g.textIndent,o=g.isVerticalText,p=e,m&&-90<=m&&m<=90&&!n&&!o&&(q=fa(m*Math.PI/180),p=(f-h.lineHeight*ea(q))/da(q)),r=g._autoFormatter&&g._autoFormatter.formatCached&&"General"!==g._autoFormatter.formatCached,t=l?g.formatter:r?g._autoFormatter:i.Context.Ixb(a,b,p,g,A),k=y.format(C(b),t,j,h),D(b)&&g.shrinkToFit!==!0&&!o&&(u=i.Context.Lxb(a,k,p,g,A),k!==u&&(delete j.content,g.textIndent=0),k=u),v=g.labelOptions,w=g.watermark,x=!v||0!==v.visibility,w&&!k&&x?void y.paintText(a,w,c,d,e,f,g,h,w,j,Z):void((k||j.content&&j.content.length)&&(1===g.vAlign&&s&&d--,y.paintText(a,b,c,d,e,f,g,h,k,j)))},b.prototype.createEditorElement=function(a,b){var c,d,e=a&&a.sheet&&a.sheet.parent&&a.sheet.parent.qo,g=w(e)+1e3;return f.GC$(b).css("z-index",g),c=oa(this.editorType),f.GC$(c).css({font:"normal 11pt calibri",outline:I,resize:I,border:I,padding:"1px","vertical-align":"top","min-height":"0px","box-sizing":"content-box"}).css(O,R).attr({tabindex:-1,autocomplete:"off",contenteditable:!0}).css(P,N).attr(H,"gcEditingInput"),p.safari&&f.GC$(c).css("-webkit-user-select","auto"),d=pa(f.GC$(c)[0]),d&&(f.GC$(c).css("display","table-cell"),f.GC$(c).css(V,R)),f.GC$(c)[0]},b.prototype.getEditorValue=function(a,b){var c,d;return a&&(c=qa(a),!j(c)&&c.length>0)?(d=Pa(c),d=d.replace(/\r\n?/g,"\n"),d.indexOf(ia)<0?d:A(d,ia," ")):_},b.prototype.setEditorValue=function(a,b,c){var d,e;a&&(d=c&&c.sheet&&c.sheet.HF,e=Na(b),q?d&&c.isImeInput||ra(a,j(e)?"":e):ra(a,d?"":e))},b.prototype.selectAll=function(a,b){if(a&&a.select)a.select();else{var c=X.getSelection();c.selectAllChildren(a)}},b.prototype.focus=function(a,b){this.isImeAware()&&a?(a.focus(),sa(a)):a.parentNode.parentNode.focus()},b.prototype.kp=function(a,b,c,d){var e=a&&d&&d.sheet,f={},g=v(b,c,e,f);return a.oja=f.formatter||aa,g},b.prototype.activateEditor=function(a,b,c,d){var e,g,h,i,k=d&&d.sheet;k&&(e=this,g=a,g&&(h=f.GC$(g),i=pa(g),e._editingElement=g,h.bind("keydown"+J,function(a){var f,h;try{f=a.keyCode,i&&(8===f?Ja(a,!0):46===f?Ma(a,!0):37===f?Ja(a,!1):39===f&&Ma(a,!1)),h=229===f||0===f,h||e.kK||e.lK(g,b,c,a,d,!0),Oa(a,d)}catch(a){}}),h.bind("keyup"+J,function(a){var h=a.keyCode,j=a.ctrlKey,m=a.altKey,n=229===h||0===h;n||e.kK||(46!==h&&8!==h&&(90!==h&&89!==h||!j||m)||(i&&"\n"===g.innerText&&f.GC$(g).empty(),e.lK(g,b,c,a,d)),(13!==h&&9!==h&&27!==h&&16!==h||j||m)&&k.Wq(l,{sheet:k,sheetName:k.name(),row:k.Jl,col:k.Kl,editingText:e.getEditorValue(g,d)}))}),h.bind("mousedown"+J,function(){1===k.Px&&(k.Px=2,k.Cu(1,2))}),h.bind("compositionstart"+J,function(){e.kK=!0,e.nK=qa(g)}),h.bind("compositionupdate"+J,function(a){e.lK(g,b,c,a?a:_,d,!0)}),h.bind("compositionend"+J,function(a){var f,h,i,j;e.lK(g,b,c,a?a:_,d),e.kK=!1,f=a.keyCode,h=a.ctrlKey,i=a.altKey,j=e.getEditorValue(g,d)||"",e.nK!==j&&(f===aa||13!==f&&9!==f||h||i)&&k.Wq(l,{sheet:k,sheetName:k.name(),row:k.Jl,col:k.Kl,editingText:j})}),i&&(h.bind("copy"+J,function(a){var b=X.clipboardData,c=a.clipboardData,d=Ra(a.currentTarget);j(d)||(b&&b.setData?(b.setData("text",d),t(a)):c&&c.setData&&(c.setData("text/plain",d),t(a)))}),h.bind("paste"+J,function(a){var f,h,j,k,l,m,n,o=!1;if(i)try{f=void 0,q&&!r&&X.clipboardData&&X.clipboardData.getData?f=X.clipboardData.getData("text"):a.clipboardData&&a.clipboardData.getData&&(f=a.clipboardData.getData("text/plain")),f=f.replace(/\r\n?/g,"\n"),f=Na(f),h=X.getSelection(),h.rangeCount>0&&(j=h.getRangeAt(0),k=j.startOffset,l=j.endOffset,k!==l&&j.deleteContents(),Wa(g,f,k)||(m=Y.createElement("span"),m.innerText=f,j.insertNode(m),n=document.createRange(),n.setStartAfter(m),n.setEndAfter(m),n.collapse(!1),h.removeAllRanges(),h.addRange(n),o=!0))}catch(a){}e.mK=X.setTimeout(function(){e.lK(g,b,c,a,d),e.mK&&(clearTimeout(e.mK),delete e.mK)},10),o&&t(a)}))))},b.prototype.deactivateEditor=function(a,b){a&&f.GC$(a).unbind(J),this._editingElement=_},b.prototype.getEditingElement=function(){return this._editingElement},b.prototype.lK=function(a,b,c,d,e,g){var h,l,m,n,o,p,r,t,v,w,x,z,A,C,D,H,J,X,Y,Z,$,_,aa,da,ea,fa,ia,ja,ka,la,ma,na,oa,ra,sa=e&&e.sheet,va=this,wa=sa.options.sheetAreaOffset,xa=a;if(xa&&sa&&(h=f.GC$(xa),l=sa.yl,m=qa(xa),sa.isEditing())){if(n=pa(xa),o=void 0,p=E,r=void 0,t=i.Context.u5,v=0,w=0,x=0,z=0,b&&(v=t(b,0),w=t(b,1),x=t(b,2),z=t(b,3),o=u(b.hAlign,a.LF),1===o?p=G:2===o&&(p=F),h.css(M,p),b.foreColor&&h.css("color",b.foreColor),r=b.font||l.Bl(),r&&(sa.zoom()>1&&(r=l.Cl(r)),h.css("font",B(r))),b.textDecoration&&va.lp(h,b.textDecoration)),A=ha(h.css("padding-left"),10)+ha(h.css("padding-right"),10),C=ha(h.css("padding-top"),10)+ha(h.css("padding-bottom"),10),c&&(D=sa.am(),H=c.width,c.x+c.width-wa.left>D.width&&(H=D.width-c.x),h.css(K,H-A).css(L,c.height-C),xa.maxWidth=wa.left+D.width-c.x-A-w,h.css("max-width",xa.maxWidth+"px"),xa.maxHeight=wa.top+D.height-c.y-C-x,xa.minWidth=ha(xa.style.width,10),xa.minHeight=ha(xa.style.height,10)),J=ta(xa),X=ua(xa),g=g&&d&&d.keyCode&&sa.mm.LH(d)&&0===J&&X===m.length,g=g||sa.HF,Y=g?"":m,r=xa.style.font,r||(r=l.Cl(l.Bl())),Z=y(r),!g&&d&&(sa.mm.LH(d)&&8!==d.keyCode&&(Y=Fa(xa,Y,J,X,d)),va.kK&&(Y=q?m:va.nK+d.data)),$=[],$=b&&b.wordWrap?k.Wn(Y,ha(xa.style.width)-A,r):Y.split(/\r\n|\r|\n/),_=void 0,aa=void 0,da=$.length,xa.minWidth=ca(xa.minWidth,xa.maxWidth),xa.minHeight=ca(xa.minHeight,xa.maxHeight),b&&b.wordWrap||da>0){if(ea=void 0,fa=void 0,s?(fa=Ta($,r),ea=Ua(fa)):ea=da*Z,b&&b.wordWrap)h.css(O,S).css(P,N).css("max-width",xa.style.width);else{for(ia=0,ja=[],_=0;_<da;_++)aa=ba(sa.rt($[_],r)),ja.push(aa),ia=ga(ia,aa);ka=h.css(O),la=ha(xa.style.width),b||ka!==S?ia<=xa.minWidth?(h.css(K,xa.minWidth).css(O,R).css(P,N),n&&h.css(V,R)):ia>xa.minWidth&&ia<=xa.maxWidth?(h.css(K,ia).css(O,R).css(P,N),n&&h.css(V,R)):ia>xa.maxWidth&&(h.css(K,xa.maxWidth-2).css(O,S).css(P,N),ea=Va(ja,xa.maxWidth,Z,fa)):ia>la&&(ea=Va(ja,la,Z,fa))}ea<=xa.minHeight?h.css(L,xa.minHeight).css(W,I):ea>xa.minHeight&&ea<=xa.maxHeight?h.css(L,ea).css(W,I):ea>xa.maxHeight&&h.css(L,xa.maxHeight-1).css(T,U).css(W,E)}o=h.css(M),ma=h.width()-xa.minWidth,j(o)||o===E||(o===G?h.css(E,xa.originalLeft-ma/2):o===F&&h.css(E,xa.originalLeft-ma)),b&&n&&(na=b.vAlign,1===na?h.css(Q,"middle"):2===na&&h.css(Q,"bottom")),oa=ha(xa.style.height)+C+v+x,ra=A+z+w,h.css(T)===U?va.updateEditorContainer(xa,{width:xa.offsetWidth+ra,height:g?0:oa},b):va.updateEditorContainer(xa,{width:ha(xa.style.width)+ra,height:oa},b)}},b.prototype.updateEditor=function(a,b,c,d){if(this.lK(a,b,c,_,d),q&&a){var e=f.GC$(a),g=e.width();e.width(g+1).width(g)}},b.prototype.updateImeMode=function(a,b,c){this.isImeAware()&&a&&i.Context.hp(a,b)},b.prototype.isReservedKey=function(a,b){var c=a.srcElement||a.target,d=a.keyCode,e=a.ctrlKey,f=a.altKey,g=a.metaKey;return!!(c&&b&&b.isEditing&&"gcEditingInput"===c.getAttribute(H))&&(13===d&&(e&&!a.shiftKey||f)||90===d&&e&&!f||89===d&&e&&!f||67===d&&(e||g)&&!f||88===d&&(e||g)&&!f)},b.prototype.isImeAware=function(a){return!0},b.prototype.toJSON=function(){var a,b={},c=this;for(a in c)c.hasOwnProperty(a)&&"_editingElement"!==a&&(b[a]=c[a]);return b},b}(i.Base),b.Text=la,h._o[1]=la},"./dist/core/core.entry.js":function(a,b,c){"use strict";var d,e,f,g,h;function i(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),c("./dist/core/core.res.en.js"),i(c("./dist/core/core.ns.js")),i(c("./dist/core/core.enum.js")),i(c("./dist/core/util/common.js")),i(c("./dist/core/util/domUtil.js")),d=c("./dist/core/util/common.js"),Object.defineProperty(b,"getTypeFromString",{set:function(a){d.getTypeFromString=a},get:function(){return d.getTypeFromString}}),e=c("./dist/core/license/releaseLicense.js"),f=e.Soa,g=-1,1===f&&(g=Math.floor(5*Math.random()),b["G".concat("C","$")]["s".concat("d")]=g),i(c("./dist/core/util/theme.js")),i(c("./dist/core/util/basedialog.js")),i(c("./dist/core/util/imageLoader.js")),0===g&&c("./dist/core/license/licenseRegister.js"),i(c("./dist/core/worksheet/stylehelper.js")),1===g&&c("./dist/core/license/licenseRegister.js"),i(c("./dist/core/worksheet/style.js")),2===g&&c("./dist/core/license/licenseRegister.js"),i(c("./dist/core/worksheet/clipboardhelper.js")),3===g&&c("./dist/core/license/licenseRegister.js"),i(c("./dist/core/worksheet/worksheet-model.js")),4===g&&c("./dist/core/license/licenseRegister.js"),i(c("./dist/core/worksheet/worksheet.js")),c("./dist/core/worksheet/worksheet-formatter.js"),i(c("./dist/core/worksheet/worksheet-actions.js")),i(c("./dist/core/worksheet/worksheet-border.js")),c("./dist/core/worksheet/worksheet-edit.js"),i(c("./dist/core/worksheet/worksheet-event.js")),c("./dist/core/worksheet/worksheet-json.js"),i(c("./dist/core/worksheet/worksheet-render.js")),c("./dist/core/worksheet/worksheet-selection.js"),c("./dist/core/worksheet/worksheet-sort.js"),i(c("./dist/core/worksheet/worksheet-ui.js")),i(c("./dist/core/worksheet/worksheet-static.js")),i(c("./dist/core/workbook/workbook.js")),c("./dist/core/workbook/workbook-json.js"),i(c("./dist/core/workbook/sheettabbase.js")),i(c("./dist/core/workbook/sheettab.js")),i(c("./dist/core/workbook/sheettab2007.js")),i(c("./dist/core/workbook/workbookpanelex.js")),h=c("./dist/core/celltype/cellType.entry.js"),b.CellTypes=h,1!==f&&2!==f||e.Gb(b)},"./dist/core/core.enum.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q;Object.defineProperty(b,"__esModule",{value:!0}),function(a){a[a.none=0]="none",a[a.column=1]="column",a[a.row=2]="row",a[a.both=3]="both"}(d=b.ShowResizeTip||(b.ShowResizeTip={})),function(a){a[a.none=0]="none",a[a.horizontal=1]="horizontal",a[a.vertical=2]="vertical",a[a.both=3]="both"}(e=b.ShowScrollTip||(b.ShowScrollTip={})),function(a){a[a.normal=0]="normal",a[a.split=1]="split"}(f=b.ResizeMode||(b.ResizeMode={})),function(a){a[a.noHeaders=0]="noHeaders",a[a.rowHeaders=1]="rowHeaders",a[a.columnHeaders=2]="columnHeaders",a[a.allHeaders=3]="allHeaders"}(g=b.CopyPasteHeaderOptions||(b.CopyPasteHeaderOptions={})),function(a){a[a.default=0]="default",a[a.enhanced=1]="enhanced"}(h=b.ResizeZeroIndicator||(b.ResizeZeroIndicator={})),function(a){a[a.setFormula=0]="setFormula",a[a.copyPaste=1]="copyPaste",a[a.dragFill=2]="dragFill",a[a.dragDrop=3]="dragDrop",a[a.changePartOfArrayFormula=4]="changePartOfArrayFormula",a[a.changeSheetName=5]="changeSheetName"}(i=b.InvalidOperationType||(b.InvalidOperationType={})),function(a){a[a.cell=0]="cell",a[a.cellWithHeader=1]="cellWithHeader"}(j=b.AutoFitType||(b.AutoFitType={})),function(a){a[a.all=0]="all",a[a.values=1]="values",a[a.formatting=2]="formatting",a[a.formulas=3]="formulas",a[a.valuesAndFormatting=4]="valuesAndFormatting",a[a.formulasAndFormatting=5]="formulasAndFormatting"}(k=b.ClipboardPasteOptions||(b.ClipboardPasteOptions={})),function(a){a[a.topLeft=0]="topLeft",a[a.topCenter=1]="topCenter",a[a.topRight=2]="topRight",a[a.bottomLeft=3]="bottomLeft",a[a.bottomCenter=4]="bottomCenter",a[a.bottomRight=5]="bottomRight"}(l=b.LabelAlignment||(b.LabelAlignment={})),function(a){a[a.visible=0]="visible",a[a.hidden=1]="hidden",a[a.auto=2]="auto"}(m=b.LabelVisibility||(b.LabelVisibility={})),function(a){a[a.underline=1]="underline",a[a.lineThrough=2]="lineThrough",a[a.overline=4]="overline",a[a.doubleUnderline=8]="doubleUnderline",a[a.none=0]="none"}(n=b.TextDecorationType||(b.TextDecorationType={})),function(a){a[a.left=0]="left",a[a.center=1]="center",a[a.right=2]="right",a[a.general=3]="general"}(o=b.HorizontalAlign||(b.HorizontalAlign={})),function(a){a[a.top=0]="top",a[a.center=1]="center",a[a.bottom=2]="bottom"}(p=b.VerticalAlign||(b.VerticalAlign={})),function(a){a[a.normal=0]="normal",a[a.superscript=1]="superscript",a[a.subscript=2]="subscript"}(q=b.VertAlign||(b.VertAlign={})),function(a){a[a.smallDecrement=0]="smallDecrement",
a[a.smallIncrement=1]="smallIncrement",a[a.largeDecrement=2]="largeDecrement",a[a.largeIncrement=3]="largeIncrement",a[a.thumbPosition=4]="thumbPosition",a[a.thumbTrack=5]="thumbTrack",a[a.endScroll=6]="endScroll"}(r=b.Nxb||(b.Nxb={})),function(a){a[a.normal=0]="normal",a[a.highlight=1]="highlight",a[a.selected=2]="selected",a[a.active=3]="active",a[a.hover=4]="hover"}(s=b.VisualState||(b.VisualState={})),function(a){a[a.ready=0]="ready",a[a.enter=1]="enter",a[a.edit=2]="edit"}(t=b.EditorStatus||(b.EditorStatus={})),function(a){a[a.auto=1]="auto",a[a.active=2]="active",a[a.inactive=4]="inactive",a[a.disabled=0]="disabled"}(u=b.ImeMode||(b.ImeMode={})),function(a){a[a.single=0]="single",a[a.range=1]="range",a[a.multiRange=2]="multiRange"}(v=b.SelectionPolicy||(b.SelectionPolicy={})),function(a){a[a.cell=0]="cell",a[a.row=1]="row",a[a.column=2]="column"}(w=b.SelectionUnit||(b.SelectionUnit={})),function(a){a[a.data=1]="data",a[a.style=2]="style",a[a.comment=4]="comment",a[a.tag=8]="tag",a[a.sparkline=16]="sparkline",a[a.axis=32]="axis",a[a.bindingPath=64]="bindingPath",a[a.formatString=128]="formatString"}(x=b.StorageType||(b.StorageType={})),function(a){a[a.blank=0]="blank",a[a.numbers=1]="numbers",a[a.letters=2]="letters"}(y=b.HeaderAutoText||(b.HeaderAutoText={})),function(a){a[a.dragDrop=0]="dragDrop",a[a.dragFill=1]="dragFill",a[a.clear=2]="clear",a[a.paste=3]="paste",a[a.sort=4]="sort",a[a.setArrayFormula=5]="setArrayFormula",a[a.evaluateFormula=6]="evaluateFormula"}(z=b.RangeChangedAction||(b.RangeChangedAction={})),function(a){a[a.normal=0]="normal",a[a.richText=1]="richText"}(A=b.ValueType||(b.ValueType={})),function(a){a[a.stretch=0]="stretch",a[a.center=1]="center",a[a.zoom=2]="zoom",a[a.none=3]="none"}(B=b.ImageLayout||(b.ImageLayout={})),function(a){a.ThumbButton="thumbButton",a.TrackButton="trackButton",a.LeftButton="leftButton",a.RightButton="rightButton",a.UpButton="upButton",a.DownButton="downButton"}(C=b.Oxb||(b.Oxb={})),function(a){a[a.left=0]="left",a[a.center=1]="center",a[a.right=2]="right",a[a.nearest=3]="nearest"}(D=b.HorizontalPosition||(b.HorizontalPosition={})),function(a){a[a.top=0]="top",a[a.center=1]="center",a[a.bottom=2]="bottom",a[a.nearest=3]="nearest"}(E=b.VerticalPosition||(b.VerticalPosition={})),function(a){a[a.corner=0]="corner",a[a.colHeader=1]="colHeader",a[a.rowHeader=2]="rowHeader",a[a.viewport=3]="viewport"}(F=b.SheetArea||(b.SheetArea={})),function(a){a[a.none=0]="none",a[a.ascending=1]="ascending",a[a.descending=2]="descending"}(G=b.SortState||(b.SortState={})),function(a){a[a.hover=1]="hover",a[a.invalid=2]="invalid",a[a.readonly=4]="readonly",a[a.edit=8]="edit",a[a.active=16]="active",a[a.selected=32]="selected"}(H=b.CellStatesType||(b.CellStatesType={})),function(a){a[a.always=0]="always",a[a.onSelected=1]="onSelected",a[a.onEditing=2]="onEditing"}(I=b.ButtonVisibility||(b.ButtonVisibility={})),function(a){a[a.none=0]="none",a[a.custom=1]="custom",a[a.clear=2]="clear",a[a.calcel=3]="calcel",a[a.ok=4]="ok",a[a.dropdown=5]="dropdown",a[a.ellipsis=6]="ellipsis",a[a.left=7]="left",a[a.right=8]="right",a[a.plus=9]="plus",a[a.minus=10]="minus",a[a.undo=11]="undo",a[a.redo=12]="redo",a[a.search=13]="search",a[a.separator=14]="separator",a[a.spinLeft=15]="spinLeft",a[a.spinRight=16]="spinRight"}(J=b.ButtonImageType||(b.ButtonImageType={})),function(a){a[a.colorPicker=0]="colorPicker",a[a.dateTimePicker=1]="dateTimePicker",a[a.timePicker=2]="timePicker",a[a.monthPicker=3]="monthPicker",a[a.list=4]="list",a[a.slider=5]="slider",a[a.calculator=6]="calculator",a[a.workflowList=7]="workflowList"}(K=b.DropDownType||(b.DropDownType={})),function(a){a[a.left=0]="left",a[a.right=1]="right"}(L=b.ButtonPosition||(b.ButtonPosition={})),function(a){a[a.left=0]="left",a[a.right=1]="right"}(M=b.CaptionAlignment||(b.CaptionAlignment={})),function(a){a[a.horizontal=0]="horizontal",a[a.vertical=1]="vertical"}(N=b.LayoutDirection||(b.LayoutDirection={})),function(a){a[a.inline=0]="inline",a[a.popup=1]="popup",a[a.tree=2]="tree"}(O=b.LayoutDisplayAs||(b.LayoutDisplayAs={})),function(a){a[a.year=1]="year",a[a.month=2]="month",a[a.day=3]="day"}(P=b.CalendarPage||(b.CalendarPage={})),function(a){a[a.monday=1]="monday",a[a.tuesday=2]="tuesday",a[a.wednesday=3]="wednesday",a[a.thursday=4]="thursday",a[a.friday=5]="friday",a[a.saturday=6]="saturday",a[a.sunday=7]="sunday"}(Q=b.CalendarStartDay||(b.CalendarStartDay={}))},"./dist/core/core.ns.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var d=c("./dist/core/core.res.en.js");b.SR={en:d}},"./dist/core/core.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_NotSupported="NotSupportException",b.Exp_PasteExtentIsNull="pasteExtent is null",b.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",b.Exp_MultipleSelections="This action won't work on multiple selections.",b.Exp_ChangePartOfArray="Cannot change part of an array.",b.Exp_InvalidAndSpace="Invalid {0}: {1} (must be between {2} and {3}).",b.Exp_SrcIsNull="The argument 'src' is null",b.Exp_DestIsNull="The argument 'dest' is null",b.Exp_InvalidCustomFunction="invalid custom function",b.Exp_InvalidCustomName="invalid custom name",b.Exp_IndexOutOfRange="Index is out of range!",b.Exp_InvalidRange="Invalid range",b.Exp_ArgumentOutOfRange="ArgumentOutOfRange",b.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",b.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",b.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",b.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",b.Tip_Row="Row: ",b.Tip_Column="Column: ",b.Tip_Height="Height: {0} pixels",b.Tip_Width="Width: {0} pixels",b.NewTab="New...",b.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",b.Exp_SheetNameInvalid="The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",b.Exp_ArrayFromulaSpan="Array formulas are not valid in merged cells.",b.Exp_DestSheetIsNull="destSheet is null",b.Exp_SheetIsNull="sheet is null.",b.Exp_OverlappingSpans="This operation will cause overlapping spans.",b.NeedCanvasSupport="You need a browser which full supports HTML5 Canvas to run SpreadJS",b.lsru=["","6465706c6f796d656e74"],b.lsde=["","64657369676e6572"],b.ls1=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e0d0a54656d706f72617279207b317d206b6579732061726520617661696c61626c6520666f722074657374696e672e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d2e"],b.ls2=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b6579206578706972657320696e207b307d206461792873292e"],b.ls3=["","4c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561642e5368656574732e0d0a54656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e0d0a496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],b.ls4=["","496e76616c6964206c6963656e7365206b65792e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],b.ls5=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b65792068617320657870697265642e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20666f722068656c702e"],b.ls6=["","506f776572656420627920477261706543697479205370726561644a53204576616c756174696f6e2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"]},"./dist/core/license/common.js":function(a,b,c){"use strict";(function(a){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/core.ns.js"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),h=g.Ul.lZa,i=c("./dist/core/license/licenseValidator.js"),j=i.pHb,k=i.qHb,l="object"==typeof a&&a&&a.Object===Object&&a,m="object"==typeof self&&self&&self.Object===Object&&self,n=l||m||Function("return this")(),o=/^[\w\-]+$/i,p=/^[0-9.]+$/,q="m",r="n",s="b",t="d",u="e",v="adr",w=k("XRsZ"),x=k("HUkJ"),y=k("T&g"),z=k("Q&w"),A=k("GRz1"),B=k("XSzB"),C=k("XRwh"),D=k("WQs5"),E="JYx3Gb#8Pb5R",F=["Ivldlcneky mi pedslsgaeiycmi o edassac.","nai ies e.Ealsra.ae@rpct.o fyune sitne"];function H(){return G}function I(a,b){var c,d,e,f,g="",h=0;for(c=0;c<a.length;c++)h=Math.max(h,a[c].length);for(c=0;c<h;c++){for(b&&(d=""),f=0;f<a.length;f++)b?d+=c>=a[f].length?"00":a[f].charAt(c)+a[f].charAt(c+1):c<a[f].length&&(g+=a[f].charAt(c));b&&(e=parseInt(d,16),g+=String.fromCharCode(e),c++)}return g}function J(a,b,c){var d,e=I(["Lcnee","iesKy"]),f=H()[e],g="63OU";return j(f,{pK:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w==",aC:"B0"},function(e){d=K(e,g),d.hl=!!f,d.m=f?d.m:-1,b.call(a,d),N(d,a,f,c)},function(){d=K(),d.hl=!!f,d.m=f?d.m:-1,b.call(a,d),N(d,a,f,c)}),d}b.pHb=J;function K(a,b){var c,d,e,f,g={isVd:function(a){var b=this;return a=1===H().Workbook.lm||a,b.s&&!b.e&&(!b.adr||!!b.adr.dsr==!!a)}},h=T(),i=function(){var g,i,j,k,l,m,n;if(!a)return!1;if(g=a[x],!g||!g.length)return!1;for(k=0,l=g.length;k<l;k++)if(i=g[k],j=i&&i[z]===b){c=i[y];break}if(!j)return!1;if(a[D]&&(f=a[D]),a[C]){if(m=new Date,n=L(a[C]),e=Math.ceil((n-m)/864e5),d=e<=0)return!1}else e=void 0;return!!(h||!a[A]&&!a[B]||R(a[A],a[B])||S(a[A],a[B]))};return g[s]=h,g.s=i(),g[q]=a?a[w]?-1:1:0,g[r]=c,g[u]=d,d||(g[t]=e),g[v]=f,g}function L(a){return new Date(M(a.substr(0,4))||0,M(a.substr(4,2))-1||0,M(a.substr(6,2))||0)}function M(a){return parseInt(a,10)}function N(a,b,c,d){Z(a)?d||b.repaint&&!b.Js&&b.repaint():_(b,a)}function O(a,b){var c,d,e,f,g;if(!a||0!==a.indexOf("//"))return!1;if(c=a.slice(2).split("/"),c.length<1)return!1;for(d=c[0],e=0,f=b.length;e<f;e++)if(g=b[e],g===d)return!0;return!1}function P(a,b){var c,d,e,f,g;for(c=0,d=b.length;c<d;c++){if(e=b[c],f=!1,e&&0===e.lastIndexOf("*.",0)&&(f=!0),e=f?e.slice(2):e,e===a)return!0;if(f&&(g=a.indexOf("."+e),g>0&&g===a.length-e.length-1))return!0}return!1}function Q(a,b){var c,d,e,f;if(a&&4===a.split(".").length)for(c=0,d=b.length;c<d;c++)if(e=b[c],e&&(f=e.length-2,f>0&&(e===a||".*"===e.substr(f)&&a.substr(0,f)===e.substr(0,f)&&p.test(a))))return!0;return!1}function R(a,b){var c,d,e,f;return!!X()&&(c=k(E),d=k("1agFGc#UHbw5"),e=n[c]&&n[c][d],!!e&&(e=e.toLowerCase(),f=a.split(","),!(!a||!O(e,f))))}function S(a,b){var c,d=k(E),e=k("Zdg3Ga#UHbw5"),f=n[d]&&n[d][e];return!f||(f=f.toLowerCase(),c=a.split(","),!(!a||!P(f,c))||!(!a||!Q(f,c)))}function T(){var a=k(E);return U(n[a])}function U(a){var b=k("VdgJHc#wJb59"),c=k("Zdg3Ga#UHbw5");return a&&(V(a[b])||W(a[b])||Y(a[c]))}function V(a){var b=k("MlSZto#Z");return a&&a===b}function W(a){var b=k("yXbog&w");return a&&a===b}function X(){var a=k(E),b=k("VdgJHc#wJb59"),c=k("Udg36Y#oUddV"),d=n[a];return d&&d[b]===c}function Y(a){var b=k("4LJITMx8UMcA"),c=k("jOxo"),d=k("JYw3Gb4NOb6x"),e=k("g1Jbww#Y"),f=RegExp("^[\\w\\-]+\\."+e+"$","i");return a&&(a===b||a===c||a===d||o.test(a)||f.test(a))}function Z(a){return a&&(a.isVd(!1)||a.b&&!a.hl)}function $(a,b){var c,d,e,f,g,h,i,j;G=b,d=b.Workbook.prototype,e=d.ad,d.ad=function(){var a=this;if(J(a,function(b){a.ls=b,c=b,a.ul=function(){J(a,function(b){a.ls=b,c=b})}}),!c||Z(c))return e.apply(a,arguments)},f=b.Worksheet.prototype,g=f.ad,f.ad=function(){if(c||this.parent||J(this,function(a){c=a}),!c||Z(c))return g.apply(this,arguments)},h=b.oJ.prototype,i=h.Pw,h.Pw=function(b,d){i.apply(this,arguments),c&&(c.m===-1||!c.hl&&c.b)&&a(this.kj,b,d,c)},j=h.RI,h.RI=function(b,d){j.apply(this,arguments),c&&(c.m===-1||!c.hl&&c.b)&&a(this.kj,b,d,c)}}b.Gb=$;function _(a,b){var c,d;function e(){d.width=f.GC$(c).width(),d.height=f.GC$(c).height(),ea(d.getContext("2d"),d.width,d.height,b)}a.rHb||(a.rHb=!0,c=a.qo,a.sheets=[],a.no(),c&&(d=document.createElement("canvas"),c.appendChild(d),e(),f.GC$(window).bind("resize",function(){setTimeout(e,100)})))}b.sHb=_;function aa(a){var b=new d.Common.ResourceManager(e.SR);return b.getResource()[a]}function ba(a,b,c){var d,e,f,g=aa(I([a,"s"])),h=aa(1===H().Workbook.lm?I(["ld","se"]):I(["lr","su"])),i=da(g,b);for(h=da(h,b),i=i.replace("{0}",c.d),i=i.replace("{1}",h).replace("{1}",h),d=[],e=0,f=0;f<i.length;f++)"\r"!==i[f]&&"\n"!==i[f]||(d.push(i.substring(e,f)),"\r"===i[f]&&f<i.length-1&&"\n"===i[f+1]&&f++,e=f+1);return e<i.length&&d.push(i.substring(e,i.length)),d}b.e6=ba;function ca(a){return aa(I([a,"sa"]))}b.tHb=ca;function da(a,b){var c,d,e,f=!0,g="";if(a)if("string"==typeof a)a=a.trim(),a&&(c=[a]);else if(Array.isArray(a)){for(d=!0,c=[],e=0;e<a.length;e++)g=a[e].trim(),c.push(g),d&&g&&(d=!1);d&&(c=null)}return c||(f=!1,c=b),I(c,f)}function ea(a,b,c,d){var e,f,g,i,j,k,l="16pt calibri";if(!d||!d.isVd(!1))for(e=d.hl?d.adr&&d.adr.dsr?"l4":d.e?"l5":"l4":"l3",f=ba(e,F,d),h(a,l),a.fillStyle="black",a.fillRect(0,0,b,c),a.fillStyle="white",g=20,i=30,j=0;j<f.length;j++)k=f[j],a.fillText(k,g,i),i+=25}}).call(this,c("./node_modules/webpack/buildin/global.js"))},"./dist/core/license/licenseRegister.js":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/license/releaseLicense.js"),e=c("./dist/core/util/domUtil.js"),f=e.GC$.sd,g=[],e.GC$[f]=function(a){g.push(a),h||(h=setTimeout(i,5e3*Math.random()+3e3))};function i(){if(h=null,g[0])try{var a=g[0].tc;a&&a.qo&&d.pHb(a,function(b){var c,e=a.getActiveSheet();e&&(c=e.l,c&&(b=c),c||b.b||b.m!==-1||!b.d||(b.s=!1,d.sHb(a,b)))},!0)}finally{g=[]}}},"./dist/core/license/licenseValidator.js":function(a,b){var c=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}return c.m=a,c.c=b,c.p="dist",c(0)}([function(a,b){(function(a){"use strict";var c,d,e,f,g,h,i,j,k,l;Object.defineProperty(b,"__esModule",{value:!0}),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},d="undefined"!=typeof window,e=String.fromCharCode,f=d&&window.Uint8Array||m,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="object"==(void 0===a?"undefined":c(a))&&a&&a.Object===Object&&a,i="object"==("undefined"==typeof self?"undefined":c(self))&&self&&self.Object===Object&&self,j=h||i||Function("return this")();function m(a){var b,d;if("number"==typeof a)for(b=Array(a),d=0;d<a;++d)b[d]=0;else b=a.slice(0);return b.buffer=b,b.byteLength=b.length,"object"===(void 0===a?"undefined":c(a))&&a.buffer&&(b.buffer=a.buffer),b}function n(a,b,c,d){return 1==a.length?a:(a.splice(c,1,d(a.splice(b,1,d(a[c]))[0])),a)}function o(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,c=a.charCodeAt(0);return c>=65&&c<=90?a.toLowerCase():c>=97&&c<=122?a.toUpperCase():c>=48&&c<=57?e(48+(c-48+10+b)%10):a}function p(a){var b,c=a.split(""),d=function a(b){return o(b,-1)};for(b=c.length-5;b>=0;b--)n(c,b+1,b+3,d),n(c,b,b+2,d);return c.join("")}function q(a){return a.split("").reverse().join("")}function r(a){var b,c,d,e,f,h,i,j,k,l=[],m="",n=g,o=a,p=o.length%3;if(p>0)for(;p++<3;)m+="=",o+="\0";for(p=0;p<o.length;p+=3)b=o.charCodeAt(p),c=o.charCodeAt(p+1),d=o.charCodeAt(p+2),e=b<<16|c<<8|d,f=e>>18&63,h=e>>12&63,i=e>>6&63,j=63&e,l[p/3]=n.charAt(f)+n.charAt(h)+n.charAt(i)+n.charAt(j);return k=l.join(""),k=k.slice(0,k.length-m.length)+m}function s(a){var b,c,d,f,h,i,j,k,l,m,n=[],o=g,p=a;for(m=0;m<p.length;m+=4)f=o.indexOf(p.charAt(m)),h=o.indexOf(p.charAt(m+1)),i=o.indexOf(p.charAt(m+2)),j=o.indexOf(p.charAt(m+3)),k=f<<18|h<<12|i<<6|j,b=k>>>16&255,c=k>>>8&255,d=255&k,n[m/4]=e(b,c,d),64==j&&(n[m/4]=e(b,c)),64==i&&(n[m/4]=e(b));return l=n.join("")}function t(a){return(d&&window.atob||s)(a)}function u(a){return(d&&window.btoa||r)(a)}function v(a){return decodeURIComponent(Array.prototype.map.call(t(a),function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function w(a){return u(encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,function(a,b){return e(parseInt(b,16))}))}function x(a){var b,c;return a?(b=p(a),b=q(b),c=Math.ceil(b.length/2),b=b.substr(c)+b.substr(0,c),b=b.replace("#","="),b=b.replace("&","=="),v(b)):""}k=b.iDe=x;function y(a){var b,c=t(a),d=c.length,e=new f(d);for(b=0;b<d;b++)e[b]=c.charCodeAt(b);return e.buffer}function z(a){var b,c,d=new ArrayBuffer(a.length),e=new f(d);for(b=0,c=a.length;b<c;b++)e[b]=a.charCodeAt(b);return d}function A(a){return e.apply(null,new f(a))}function B(a){return a.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")}function C(a){var b,c,d,e=0,f=5381,g=0;for(b=a.length-1;b>=0;b--)c=a.charCodeAt(b),e=c+(e<<6)+(e<<16)-e,f=c+((f<<5)+f),g=c+((g<<5)-g),g&=g;return d=e^f^g,d<0&&(d=~d),d.toString(16).toUpperCase()}function D(a){return a&&JSON.parse(a)||void 0}function E(a,b){try{b="#"+b;var c=a.indexOf(b);if(c>-1)return{prefix:a.substring(0,c),licData:JSON.parse(x(a.substr(c+b.length)))}}catch(a){}return!1}function F(a){return"oncomplete"in a&&(a.then=function(b,c){a.resolve=b,a.reject=c},a.oncomplete=function(b){a.resolve(a.result)},a.onerror=function(){a.reject()}),a}l=b.attorn=function a(b,c,e,f){var g,h,i,k,l,m,n,o=d?window.msCrypto?window.msCrypto:window.crypto:void 0,p=E(b,c.aC);if(!p)return f();g=p.licData,h=p.prefix+"#"+c.aC,i=h+A(y(w(JSON.stringify(g.D))));function q(){return C(h+JSON.stringify(g.D))===g.H?e(g.D):f()}return k=x("JYx3Gb#8Pb5R"),l=x("VdgJHc#wJb59"),j[k]&&j[k][l]&&!location.protocol.match(/^https/i)?q():o&&o.subtle?(m={alg:"RS256",e:"AQAB",kty:"RSA",n:B(c.pK)},m=window.msCrypto?z(JSON.stringify(m)):m,n={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},F(o.subtle.importKey("jwk",m,n,!1,["verify"])).then(function(a){F(o.subtle.verify(n,a,y(g.S),z(i))).then(function(a){return a?e(g.D):f()})},function(){return q()}),void 0):q()}}).call(b,function(){return this}())}]);a.exports={pHb:c.attorn,qHb:c.iDe}},"./dist/core/license/releaseLicense.js":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/license/common.js"),e=c("./dist/core/util/common.js"),f=e.Ul.lZa,g=["LcneNtFud\no edavldlcnekyt u pedSet.\neprr esaeaalbefreauto.\nfyuprhsdalcne orkyi nyu ucaecnimto mi.\nmi sslsgaeiycmi o edassac.","ies o on\rYune  ai ies e ornSra.hes\rTmoayky r vial o vlain\rI o ucae  ies,yu e si orprhs ofraineal\rEalu.ae@rpct.o fyune sitne"],h=Math.max;function i(a,b,c,e){var i,j,k,l,m,n,o,p,q,r,s=a.am(),t=203,u="11pt calibri",v=e.hl&&e.isVd(!1)&&e.d,w="";for(v?i="l2":e.e?i="l5":e.hl&&!e.d?i="l6":(i="l1",j=d.tHb(i)),s=s||a.am(),k=d.e6(i,g,e),l=0,j&&k.forEach(function(b){l=h(l,a.dp(b,u))}),a.l=k[0]?e:void 0,m=0;m<k.length&&(s.width>t||s.height>t);m++)w=k[m],n=l||a.dp(w,u),o=10,p=20,q=s.width-n-o,r=s.height-o-p*(k.length-m),c&&!c.intersect(q,r,n,p)||(b.save(),b.fillStyle="rgba(0, 0, 0, 0.5)",f(b,u),c&&(b.rect(c.x,c.y,c.width,c.height),b.clip(),b.beginPath()),b.fillText(w,q,r+p),w&&(a.l=e),b.restore())}function j(a){d.Gb(i,a)}b.Gb=j,b.Soa=1,b.pHb=d.pHb,b.sHb=d.sHb},"./dist/core/util/basedialog.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/common.js"),e=c("./dist/core/util/domUtil.js"),f=e.GC$,g=d.util.Nl,h=d.util.Ml,i=d.util.nl,j=document,k=window,l=k.Yl,m=function(){function a(a,b,c){this.c4="gc-popup",this.so="gc-overlay",this.AWa=null;var d=this;d.qo=a,d.zWa=c,b=b||0,d.to={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:b,backgroundColor:"rgba(0,0,0,0)"},d.uo={position:"absolute",padding:0,margin:0,height:"auto",zIndex:b+1,outline:"none"},d.ad()}return a.prototype.ad=function(){var a=this;a.vo(a.Cj)?a.xo=f("#"+a.Cj):(a.Cj=a.wo(),a.xo=f(g("div")).addClass(a.c4+" ui-widget").attr({id:a.Cj,tabIndex:-1}).css(a.uo))},a.prototype.wo=function(){for(var a=0,b="gc-dialog";this.vo(b+(""+a));)a++;return b+(""+a)},a.prototype.yo=function(){if(this.xo)return this.xo},a.prototype.zo=function(){return this.qo?this.qo:j.body},a.prototype.Ao=function(a){var b=this,c=b.xo;b.Bo()||b.Co(),l.Gm(),b.vo(b.Cj)||(f(b.zo()).append(c),b.Do(),c.css("display","none")),c.show(a)},a.prototype.close=function(){var a=this;a.vo(a.Cj)&&a.xo.remove(),f("."+a.c4).isVisible()||a.Eo(),l.Hm()},a.prototype.Eo=function(){f("."+this.so).remove(),this.AWa=null},a.prototype.Do=function(){var a,b,c,d,e,g,h,i,k,l,m,n=this.xo,o=this.zo();0!==n.length&&(a=f(o).offset(),b=parseInt(n.css("left"),10)+a.left,c=parseInt(n.css("top"),10)+a.top,d=n.width(),e=n.height(),isNaN(b)||isNaN(c)||isNaN(d)||isNaN(e)||(g=0,h=0,i=j.documentElement,k=i.clientWidth,l=i.clientHeight,m=n[0].getBoundingClientRect(),m.left+d>k&&(h=m.left+d-k),m.top+e>l&&(g=m.top+e-l),(b<0||c<0||g>0||h>0)&&(b-=h,c-=g,b<0&&(b=0),c<0&&(c=0),n.css({left:b-a.left+"px",top:c-a.top+"px"}))))},a.prototype.vo=function(a){return f("#"+a).length>0},a.prototype.Co=function(){var a,b,c=this,d=f(g("div")).addClass(c.so),e=c.xo;this.AWa=d,d.css(c.to),f(c.qo).append(d),a=h&&h.mozilla,a&&(b=(new Date).valueOf()),d.bind("mousedown",function(d){if(!c.zWa){if(a){var e=(new Date).valueOf();if(e-b<100)return}c.close(),a&&c.Fo&&clearTimeout(c.Fo)}i(d)}),d.bind("contextmenu",function(a){c.zWa&&i(a)}),e.bind("contextmenu",function(a){i(a)}),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(b){d.bind(b,function(b){c.zWa||(a?c.Fo=k.setTimeout(function(){c.close()},100):c.close()),i(b)})})},a.prototype.Bo=function(){return f("."+this.so).length>0},a}(),b.Go=m},"./dist/core/util/common.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/core.enum.js"),g=c("CalcEngine"),h=e.GC$,i=h.extend,j=d.Common.o,k=d.Common.k.Uo,l=d.Formatter&&d.Formatter.GeneralFormatter,m=d.Formatter&&d.Formatter.lxb,n=d.Common.j.Fa,o=d.Common.u,b.FallbackFontFamily='"Helvetica Neue", Arial, sans-serif',p=window,q=document,r="boolean",s="date",t="undefined",u="function",v=void 0,w=null,x=Math.floor,y=Math.ceil,z=Math.min,A=Math.max,B=Math.round,C=parseInt,D=parseFloat,E=isNaN,F=.7,G="px",H=" ",I=".",J="string",K="number",L="touch",M="MSPOINTER_TYPE_TOUCH",N=RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),O=RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$");function fa(a){return typeof a!==t}function ga(a){return q.createElement(a)}function ha(a){q.body&&q.body.insertBefore(a,w)}function ia(a,b,c){Object.defineProperty(a,b,{get:function(){return this._ps[b]},set:function(a){var d=this._ps[b];d!==a&&(this._ps[b]=a,c&&c(b,a,d))},enumerable:!0})}b.productInfo={productVersion:"13.0.0"},b.CursorResource={ResizeCol:"col-Resize",ResizeRow:"row-resize",ResizeHiddenCol:"w-resize",ResizeHiddenRow:"n-resize"},b.getTypeFromString=function(a){var b,c,d,e=!1,f=p;if(typeof a===J){for(b=a.split(I),c=0,d=b.length;c<d&&f;c++)f=f[b[c]];f&&c===d&&d>0&&(e=!0)}return e?f:v},b.findControl=function(a){return typeof a===J&&(a=q.getElementById(a)),h(a).data("workbook")};function ja(a){return a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!1,a.returnValue=!1),!1}function ka(a){var b,c,d=!1;if(a)for(b=0;b<a.length;b++)if(c=a.charCodeAt(b),c>=11904&&c<12032||c>=12288&&c<40960||c>=43360&&c<43392||c>=63744&&c<64256){d=!0;break}return d}P=function(){function a(){}return a.xq=function(a){for(var b,c="";a>0;a=parseInt((a-1)/26+"",10))b=(a-1)%26,c=String.fromCharCode(65+b)+c;return c},a.ol=function(b,c,d,e){if(3===b){var f=h.getType(c);b=d&&"@"===d?0:f===r?1:f===K||f===s?2:f===J&&a.YGb(c)?2:0,e&&0!==e&&(e>0?b=0:e<0&&(b=2),e===-90?b=0:90===e&&(b=2))}return b},a.YGb=function(b){return a.ZGb.test(b)},a.bc=function(b){var c,e=h.getType(b);return b===w||b===v?b="":e===r?b=(""+b).toUpperCase():e===s?(c=0===b.getHours()&&0===b.getMinutes()&&0===b.getSeconds()&&0===b.getMilliseconds(),b=d.Common.l.Vb(b,c?"M/d/yyyy":"M/d/yyyy h:mm:ss")):b=b.richText?a.K_a(b):""+b,b},a.ql=function(a,b,c,d,e,f,g){var i,j,k,l,m,n,o=h(a),p=b,q=c,r="background-position",s="background-size",t="auto",u="0%",v="50%",w="100%";switch(f){case 0:g?o.css(r,g.position).css(s,g.size):o.css(r,u+H+u).css(s,w+H+w);break;case 1:i=v,j=v,d>p&&(i=u),e>q&&(j=u),o.css(r,i+H+j).css(s,t+H+t);break;case 2:k=0,l=0,m=p,n=q,q>0&&e>0&&p/q>d/e?(m=d/e*q,k=k+p/2-m/2):p>0&&d>0&&q/p>e/d&&(n=e/d*p,l=l+q/2-n/2),o.css(r,k+G+H+l+G).css(s,m+G+H+n+G);break;case 3:o.css(r,u+H+u).css(s,t+H+t)}},a.device=function(){var a,b,c,d,e=navigator.userAgent,f=e.match(/iPad/i);return f&&(a=f[0],a&&(b="ipad"===a.toLowerCase())),f=e.match(/iPhone/i),f&&(a=f[0],a&&(c="iphone"===a.toLowerCase())),f=e.match(/android/i),f&&(a=f[0],a&&(d="android"===a.toLowerCase())),{ipad:b,iphone:c,android:d}},a.sl=function(){var a=navigator.platform;return a&&a.indexOf("Mac")>-1},a.tl=function(a){if(a===v||a===w)return!1;var b=""+a;return b=j.Oa(b),!E(+(""===b.trim()?NaN:b))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(b)},a.ul=function(b,c,d,e,f){var g,h,i,j,k=w;if(b&&(b.formatter?(k=f?f:b.formatter,typeof k===J&&l&&(k=new l(k))):k=b._autoFormatter),k&&!k.isAuto){g=w;try{if(g=k.parse(c),typeof g===K)return g}catch(a){}return g===v||g===w?c:g}if(d){if(h=void 0,h={},i=void 0,j=w,l)try{j=(new l).getPreferredDisplayFormatter(c,h)}catch(a){}return i=h.value,typeof i===K?c=i:a.tl(c)&&(i=h.value=c),e&&(e.value=j),i!==v&&i!==w?i:c}return c},a.vl=function(a){for(var b,c,d=q.body,e=a;e&&e.parentElement&&e.parentElement!==d;)e=e.parentElement;return b=1e3,e&&e.parentElement===d&&(c=C(h(e).css("z-index")),E(c)||(b+=c)),b},a.wl=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(!a)return[];if(b=a.indexOf("("),c=a.lastIndexOf(")"),d=a.substring(b+1,c),!d)return[];for(e=[],f=0,g="",h=0,i=0;i<d.length;)h=d.indexOf("rgb",f),i=d.indexOf("rgb",f+1),i===-1&&(i=d.length),g=d.substring(h,i),e.push(g),f=i;for(j=[],k=0,l=e.length;k<l;k++)m=e[k],n=m.indexOf(")"),o=m.substring(0,n+1),p=D(m.substring(n+1,m.length)),E(p)&&(k===l-1?p=100:k<=1&&(p=0)),(o||0!==k)&&(p/=100,j.push({color:o,point:p}));return j},a.xl=function(b,c,d,e){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,x,A,B,D=c.yl,E=0,F=[d],G=c.zoom();for(e===f.AutoFitType.cellWithHeader&&(d===f.SheetArea.viewport?F.push(1):d===f.SheetArea.rowHeader&&F.push(0)),g=0;g<F.length;g++)for(h=0,i=F[g],j=c.getRowCount(i);h>=0&&h<j;)k=c.ITa.findSpan(h,b,i),k&&(k.col<b||k.colCount>1||k.row<h)?h=k.row+k.rowCount:(c.getRowHeight(h,i)>0&&(l=c.getActualStyle(h,b,i),m=0,n=l.cellType||c.Al(i),n&&(o=l.font||D.Bl(),l.font=D.Cl(o),p=c.rowFilter&&c.rowFilter(),q=!(!p||!p.Dl(h,b,i)),q||3!==i||(r=c.tables?c.tables.find(h,b):w,r&&r.showHeader()&&r.headerIndex()===h&&r.rowFilter()&&r.filterButtonVisible(b-r.range().col)&&(q=!0)),s=l.formatter?l.formatter:l._autoFormatter,t={sheet:c,row:h,col:b,sheetArea:i,quotePrefix:l.quotePrefix},u={},v=c.getValue(h,b,i,f.ValueType.richText),x="",x=v&&v.richText?c.getText(h,b,i):n.format(v,s,u,t),m=n.X4(v,x,l,G,t),q&&(A=z(G,1),B=C(""+c.defaults.rowHeight*A,10),m+=B)),m>E&&(E=m)),i===f.SheetArea.viewport?h=a.El(h,b,c,i):h++);return 0===E?E=c.defaults.colWidth:E+=y(3),y(E)},a.El=function(a,b,c,d){var e,f,g,h=-1,i=c.getRowCount(d);for(e=a+1;e<i;e++){if(f=c.getText(e,b,d)){h=e;break}if(g=c.getActualStyle(e,b,d),g&&(g.cellType||g.cellButtons&&g.cellButtons.length>0)){h=e;break}}return h},a.Fl=function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=c.yl,r=0,s=[d],t=c.zoom();for(1===e&&(3===d?s.push(2):1===d&&s.push(0)),f=0;f<s.length;f++)for(d=s[f],g=0,h=c.getColumnCount(d);g>=0&&g<h;)i=c.ITa.findSpan(b,g,d),i&&(i.row<b||i.rowCount>1||i.col<g)?g=i.col+i.colCount:(c.getColumnWidth(g,d)>0&&(j=c.getActualStyle(b,g,d),k=j.font||q.Bl(),j.font=q.Cl(k),l=0,m=c.getCellType(b,g,d),m&&(n=c.getText(b,g,d),o=c.getValue(b,g,d,1),p={sheet:c,row:b,col:g,sheetArea:d},l=m.Y4(o,n,j,t,p)),l>r&&(r=l)),3===d?g=a.Gl(b,g,c,d):g++);return 0===r?r=c.defaults.rowHeight:r+=y(3),y(r)},a.Gl=function(a,b,c,d){var e,f,g,h=-1,i=c.getColumnCount(d);for(e=b+1;e<i;e++){if(f=c.getText(a,e,d)){h=e;break}if(g=c.getActualStyle(a,e,d),g&&g.cellType){h=e;break}}return h},a.Il=function(b,c,e,f){var h,i,k,n,o,p,q,r,s;if(e&&(h=e.Jl,i=e.Kl,k=b.formatter?b.formatter:b._autoFormatter,n=f||{},l&&c!==w&&c!==v))if(o=void 0,k&&k.isAuto)o=typeof c===K,p=a.tl(c),!o&&p&&(c=j.Oa(c)),c=k.getPreferredEditingFormatter?k.getPreferredEditingFormatter(c).format(c):c;else if(typeof k===J&&(k=new l(k)),k)try{c instanceof Date?(q=g&&g.Convert.Wh(c),q&&(c=q),r=d.Common.CultureManager.q4().DateTimeFormat,s=d.Common.l.Ra(c),k=new l(!m.Lc(k.formatString(),["d","y"])&&s>=0&&s<1?r.longTimePattern:0===c.getHours()&&0===c.getMinutes()&&0===c.getSeconds()&&0===c.getMilliseconds()?r.shortDatePattern:r.shortDatePattern+H+r.longTimePattern),e.Ll=!0,c=k.format(c),n.formatter=k):typeof c===K&&(c=j.nb(""+c))}catch(a){c=e.getText(h,i)}else c=e.getText(h,i,3);return c!==w&&c!==v&&(c=a.bc(c)),c},a._Va=function(b){var c,d=a.Ml.msie||a.Ml.edge,e=d&&p.MSPointerEvent&&(navigator.msMaxTouchPoints||0)>1;return b?e:(c=d&&p.PointerEvent&&(navigator.maxTouchPoints||0)>1,e||c)},a.K_a=function(b){return b&&b.richText&&b.richText.length>0?(b.text||(b=a.n0a(b)),b.text):b},a.n0a=function(a){var b,c,d;if(!a)return a;if(b=a.richText,b&&b.length>0){for(c=[],d=0;d<b.length;d++)c.push(b[d].text?b[d].text:"");a.text=c.join("")}return a},a.Pl=function(a,b,c,d){var e=a,f=b,g=function(a,b){var g,h,i=this;return i.hasOwnProperty("_ps")||(i._ps={}),g=i._ps,0===arguments.length?g[e]!==v?g[e]:f:(b!==!1&&d&&!d.call(i,a)||(h=g[e]!==v?g[e]:f,h!==a&&(g[e]=a,b!==!1&&c&&c.call(i,a,h))),i)};return g.isDefault=function(a){return a===f},g},a.Ql=function(a,b){var c={_ps:{}};return d.Common.j.H(a,function(a){ia(c,a,b)}),c},a.Rl=function(a,b,c,d,e){var f,g=z(b,c),h=A(b,c),i=0;for(f=g;f<h&&(i+=d?a.Sl(f,3):a.Tl(f,3),!(e&&i>e));f++);return i},a.Z3=function(a,b){var c,d,e=0,f=0;return a!==b&&(c=h(a).offset(),d=h(b).offset(),e=c.left-d.left,f=c.top-d.top),{FB:f,EB:e}},a.bq=function(a,b,c){var d,e,f,g;if(!a||"string"!=typeof a)return!1;for(e=0;e<a.length;e++)if(d=a.charAt(e),"*"===d||":"===d||"["===d||"]"===d||"?"===d||"\\"===d||"/"===d)return!1;if("'"===a.charAt(0)||"'"===a.charAt(a.length-1))return!1;if(!b)return!0;for(f=b.length,e=0;e<f;e++)if(g=b[e],c!==g&&a.toUpperCase()===g.name().toUpperCase())return!1;return!0},a.Ika=function(a,b,c){var d,e,f;if(!a)return a;for(d=0,e=a.length,f=[];d<e;)a[d]===b?f[d]=c:f[d]=a[d],d++;return f.join("")},a.tt=function(){var b,c,d,e=a;return e.ct||(b=ga("span"),c=b.style,d="-10000px",c.visibility="hidden",c.top=d,c.left=d,c.position="absolute",b.setAttribute("gcUIElement","gcStringWidthSpan"),q.body.insertBefore(b,w),e.ct=b),e.ct},a.fp=function(b,c,d){var e,f,g,h=a,i=h.st;if(!c)if(i){if(d&&(i=i.CJKFontCache),e=i[b])return e}else i=h.st={CJKFontCache:{}},d&&(i=i.CJKFontCache);return f=h.tt(),f.style.font=a.hZa(b),f.innerHTML=d?String.fromCharCode(20013):"H",g=f.offsetHeight,c||(i[b]=g),g},a.Pxb=function(b){var c,d,e=a,f=e.Qxb;if(f){if(f[b])return f[b]}else f=e.Qxb={};return d=e.tt(),d.style.font=b,d.innerHTML="H",c={},c.fontFamily=d.style.fontFamily,c.fontSize=d.style.fontSize,c.fontStyle=d.style.fontStyle,c.fontWeight=d.style.fontWeight,f[b]=c,c},a.Voa=function(b,c){var d=a.tt();return d.style.font=a.hZa(c),d.innerHTML=o.Ob(b||"H"),
d.offsetHeight},a.iZa=function(c){var d,e,f=a;return c.indexOf(b.FallbackFontFamily)>=0?c:(c=c.replace("("+String.fromCharCode(27491)+String.fromCharCode(25991)+")","").replace("(Body)","").replace("("+String.fromCharCode(26631)+String.fromCharCode(39064)+")",""),d=f.tt(),e=d.style,e.font=c,e.fontFamily=[].concat(e.fontFamily.split(","),b.FallbackFontFamily.split(",")).join(","),e.font)},a.hZa=function(b){var c,d,e=a;return b&&e.jZa?(c=e.kZa,c||(c=e.kZa={}),d=c[b],d||(d=c[b]=e.iZa(b)),d):b},a.lZa=function(b,c){c&&(c=a.hZa(c),b.font!==c&&(b.font=c))},a.pL=function(b,c,d){return!c||n(d)?0:(a.lZa(b,c),b.measureText(d).width)},a.no=function(){var b=a,c=b.ct;c&&(h(c).remove(),b.ct=v),b.st=v,b.Qxb=v,a._0&&(a._0=v),b.kZa=v},a.Woa=function(b){var c,d=a._0;return d||(d=a._0=ga("div")),c=b.innerHTML,d.innerHTML=c,d.innerText},a.G$a=function(a){return a&&/^[A-Za-z_\\\u0080-\uFFFF][A-Za-z0-9_\.\\\?\u0080-\uFFFF]*$/.test(a)&&!(["C","c","R","r"].indexOf(a)!==-1||/^[A-Za-z]{1,3}(\$)?\d+$/.test(a)||/^[Rr]\d*[Cc]\d*$/.test(a)||a.length>=255)},a.T$a=function(a){a&&(a.j_a(!0),a.initExpression(),a.k_a())},a.l_a=function(a){var b,c,d=0,e=0,f=a.length;for(f>0&&(d=a[0].row,e=a[0].col),b=1;b<f;b++)c=a[b],d>c.row&&(d=c.row),e>c.col&&(e=c.col);return d=d<0?0:d,e=e<0?0:e,{r:d,c:e}},a.w0a=function(a){var b,c;return typeof a===J&&"/"===a.charAt(0)?(c=void 0,O.test(a)?(c=a.match(O),b=d.Common.l.Xb(D(c[1]))):N.test(a)?(c=a.match(N),b=new Date(D(c[1]))):b=a):b=a,b},a.x0a=function(a){var b;return b=!n(a)&&d.Common.l.Ska(a)?d.Common.l.Daa(a):a},a.ZGb=/[\u0600-\u06FF\u0750-\u077F]/,a.nl=ja,a.rl=a.device,a.Ml=function(){var a,b,c,d,e,f,g;function h(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}}a=navigator.userAgent,b=h(a),c={version:v,chrome:v,webkit:v,safari:v,mozilla:v,msie:v,metroMode:v,edge:v},b.browser&&(c[b.browser]=!0,c.version=b.version),c.chrome?c.webkit=!0:c.webkit&&(c.safari=!0),d=a.indexOf("PhantomJS")>=0,d&&(c.safari=!1,c.chrome=!0),e=a.toLowerCase(),f=e.indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(e)!==w,f&&(c.mozilla=v,c.msie=!0),g=/Edge\/\d+/.exec(a),g!==w&&g.length>0&&(c.webkit=v,c.chrome=v,c.msie=!0,c.edge=!0,c.version=g[0].substr(g[0].indexOf("/")+1));function i(){var a=w,b=!1;try{new ActiveXObject("")}catch(b){a=b.name}try{b=!!new ActiveXObject("htmlfile")}catch(a){b=!1}return b="ReferenceError"===a||b!==!1,!b}return c.msie&&i()&&(c.metroMode=!0),c}(),a.browser=a.Ml,a.Nl=ga,a.Ol=fa,a.uWa=ka,a.jZa=a.sl(),a.Fxb=function(a){return!n(a)&&(typeof a===K||typeof a===r||a instanceof Date||g&&a instanceof g.CalcError)},a}(),b.util=P,b.Ul=P,Q=P.pL,R=function(){function a(){}return a.Wl=function(b){return!(a.Xl()!==b||!b.mm||!b.mm.YH)},a.Xl=function(){return p.Yl.activeElement},a.kmb=function(b){var c,d,e,f,g,h,i;function j(a){var f,g;for(f=0;f<=2;f++)g=a.call(c,f),g&&0!==g.width&&0!==g.height&&(b.$l=!0,d._l(e,g))}if(b&&!a.Wl(b)&&b.parent&&b.parent.options.hideSelection){for(c=b.am(),d=b.yl,e=d.bm(),f=b.getSelections(),g=void 0,h=void 0,g=0;g<f.length;g++)i=f[g],h=b.cm(i),h.width>=0&&h.height>=0&&(h.x-=9,h.y-=9,h.width+=18,h.height+=30,d.dm(h));h=c.em(),b.$l=!0,d._l(e,h),j(c.fm),j(c.gm)}},a.Zl=function(b,c){var d=a.Xl();p.Yl.activeElement=b,b===d||c||(d&&(d.endEdit(),a.kmb(d),d.hm&&d.hm()),b&&b.yl.im())},a}(),b.Vl=R;function la(a,b){var c=ga("span");return c.className=a,b&&(c.id=b),c.style.display="none",ha(c),c}function ma(a,b,c,d){a.addEventListener(b,c,d)}function na(a){var b=a.currentStyle,c=q.defaultView;return c&&c.getComputedStyle&&(b=c.getComputedStyle(a,"")),b}function oa(a){var b,c,d,e,f,g,i,j=p.Yl;j.jm>0||(16!==a.keyCode&&(j.XCb=!0),b=R.Xl(),c=b&&b.lm,c&&(d=h(c),d.isVisible())||b&&b.mm&&b.mm.nm&&(b.mm.nm(a),b.isEditing()||(e=a.keyCode,f=a.ctrlKey,g=a.altKey,i=a.shiftKey,90!==e&&89!==e||!f||g?86!==e||!f||g||i||a.stopPropagation&&a.stopPropagation():ja(a))))}function pa(a){var b,c=p.Yl;c.jm>0||(c.XCb=!1,b=R.Xl(),b&&b.mm&&b.mm.om&&b.mm.om(a))}function qa(a){var b,c=p.Yl;c.jm>0||(b=R.Xl(),b&&b.mm&&b.mm.pm&&b.mm.pm(a))}function ra(a){var b,c=p.Yl;c.jm>0||c.XCb!==!0&&(b=R.Xl(),b&&b.mm&&b.mm.pm&&b.mm.pm(a))}function sa(a){return q.all===v&&R.Xl()&&ja(a),!1}S=function(){function a(){this.jm=0,this.km=[],this.XCb=!1,this.ad()}return a.prototype.rm=function(){var a="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",b="span."+a.split(H).join(I);return T.vm?h(q).find(b).length<=0&&ha(T.vm):T.vm=la(a),T.vm},a.prototype.sm=function(){var a="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",b="span."+a.split(H).join(I);return T.wm?h(q).find(b).length<=0&&ha(T.wm):T.wm=la(a),T.wm},a.prototype.tm=function(){var a="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",b="span."+a.split(H).join(I);return T.xm?h(q).find(b).length<=0&&ha(T.xm):T.xm=la(a),T.xm},a.prototype.um=function(){var a="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",b="span."+a.split(H).join(I);return T.ym?h(q).find(b).length<=0&&ha(T.ym):T.ym=la(a),T.ym},a.prototype.zm=function(){var a="gc-theme-version",b="gcDummyElement";return T.Am?h(q).find("#"+b).length<=0&&ha(T.Am):T.Am=la(a,b),T.Am},a.prototype.qm=function(){T.rm(),T.sm(),T.tm(),T.um()},a.prototype.ad=function(){var a,b,c=this;c.jm=0,ma(p,"keydown",oa,!0),ma(p,"keyup",pa,!0),ma(p,"compositionstart",qa,!0),ma(p,"selectstart",sa,!0),a=P.rl(),b=a.ipad||a.iphone,P.browser.safari&&!b&&ma(p,"textInput",ra,!0);function d(a,b){for(var c=!1,d=a;d;){if("gcSpread"===h(d).attr("gcUIElement")){c=b.zo()!==d;break}d=d.parentElement}return c}function e(a){var e,f,g,h=R.Xl();if(h&&(e=T.Bm(a.target),f=h.Cw&&h.Cw.V4,c.km.forEach(function(a){a&&a(h,e)}),!e||d(e,h)))if(h.gv(v,v,f))b&&(g=h.mm,g&&g.Cm&&g.Cm()),R.Zl(w);else if(a.cancelable)return!1}function f(a){var b=a.pointerType;b!==a[M]&&b!==L||e(a)}P._Va()?(h(q).bind("MSPointerDown",f),h(q).bind("pointerdown",f)):h(q).bind("touchstart",e),ma(q,"mousedown",function(a){var b=e(a);b===!1&&ja(a)},!0),h(q).bind("DOMContentLoaded",function(){T.qm()})},a.prototype.Bm=function(a){for(var b,c=a;c&&"BODY"!==c.tagName&&typeof c.getAttribute===u;){if(b=c.getAttribute("gcUIElement"),b||(b=c.gcUIElement),b)return c;c=c.parentNode}return w},a.prototype.Dm=function(a,b){var c,d,e,g,i=T.rm();return a===f.VisualState.highlight||a===f.VisualState.selected?i=T.um():a===f.VisualState.hover&&(i=T.tm()),c=i.className,h(i).removeClass(c).addClass(b),d=na(i),e={backgroundColor:d.backgroundColor,backgroundImage:d.backgroundImage},h(i).addClass(c),d=na(i),g={backgroundColor:d.backgroundColor,backgroundImage:d.backgroundImage,color:d.color,zIndex:d.zIndex},g.borderLeftColor=d.borderLeftColor,g.borderRightColor=d.borderRightColor,g.borderBottomColor=d.borderBottomColor,g.borderBottomWidth=d.borderBottomWidth,g.borderTopColor=d.borderTopColor,g.borderRightWidth=d.borderRightWidth,g.backgroundImage===e.backgroundImage&&g.backgroundColor!==e.backgroundColor&&(g.backgroundImage=v),h(i).removeClass(b),g},a.prototype.Em=function(a){var b,c=T.zm();return h(c).removeClass(c.className).addClass("gc-theme-version "+a),b=na(c),i({},b)},a.prototype.Fm=function(a){var b,c=T.sm();return h(c).removeClass(c.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+a),b=na(c),i({},b)},a.prototype.Gm=function(){var a=p.Yl;a.jm++},a.prototype.Hm=function(){var a=p.Yl;a.jm--,a.jm<0&&(a.jm=0)},a}(),T=S.prototype,p.Yl||(p.Yl=new S),U=function(){function a(){}return a.Jm=function(a){var b={0:"normal",1:"highlight",2:"selected",3:"active",4:"hover"};return b[a]||""},a.Km=function(b,c){var d=a.Jm(b)+c,e=a.styleCache;return e[d]||(e[d]=T.Dm(b,c)),e[d]},a.Lm=function(b){var c=b,d=a.styleCache;return d[c]||(d[c]=T.Em(b)),d[c]},a.Mm=function(b){var c="content"+b,d=a.styleCache;return d[c]||(d[c]=T.Fm(b)),d[c]},a._ob=function(a,b){var c=a.Pm;return c&&c.getColor&&(b=c.getColor(b)),b},a.Nm=function(){a.styleCache={}},a.styleCache={},a}(),b.Im=U,V=function(){function a(a,b){this.x=a,this.y=b}return a.prototype.clone=function(){return new a(this.x,this.y)},a}(),b.Point=V,W=function(){function a(a,b,c,d){var e=this;e.x=a,e.y=b,e.width=c,e.height=d}return a.prototype.intersect=function(a,b,c,d){var e=this;return a<e.x+e.width&&e.x<a+c&&b<e.y+e.height&&e.y<b+d},a.prototype.intersectRect=function(a){return this.intersect(a.x,a.y,a.width,a.height)},a.prototype.contains=function(a,b){var c=this;return c.x<a&&a<c.x+c.width&&c.y<b&&b<c.y+c.height},a.prototype.containsRect=function(a){return this.contains(a.x,a.y)&&this.contains(a.x+a.width,a.y+a.height)},a.prototype.getIntersectRect=function(a){return this.getIntersect(a.x,a.y,a.width,a.height)},a.prototype.getIntersect=function(b,c,d,e){var f=this,g=f.x,h=f.y,i=f.x+f.width,j=f.y+f.height,k=b,l=c,m=b+d,n=c+e,o=A(g,k),p=A(h,l),q=z(i,m),r=z(j,n),s=o,t=p,u=q-o,v=r-p;return u>0&&v>0?new a(s,t,u,v):w},a.prototype.round=function(){var a=this;a.x=x(a.x),a.y=x(a.y),a.width=y(a.width),a.height=y(a.height)},a.prototype.clone=function(){var b=this;return new a(b.x,b.y,b.width,b.height)},a}(),b.Rect=W,X=function(){function a(a,b,c,d){var e=this;e.row=a,e.rowCount=c,e.col=b,e.colCount=d}return a.prototype.intersect=function(a,b,c,d){var e=this;return(a===-1||e.row===-1||e.row<a+c&&a<e.row+e.rowCount)&&(b===-1||e.col===-1||e.col<b+d&&b<e.col+e.colCount)},a.prototype.getIntersect=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o=this;return b&&o.intersect(b.row,b.col,b.rowCount,b.colCount)?(e=o.col===-1?d-1:o.col+o.colCount-1,f=b.col===-1?d-1:b.col+b.colCount-1,g=o.row===-1?c-1:o.row+o.rowCount-1,h=b.row===-1?c-1:b.row+b.rowCount-1,i=A(o.col,b.col),j=z(e,f),k=A(o.row,b.row),l=z(g,h),m=k===-1?-1:l-k+1,n=i===-1?-1:j-i+1,new a(k,i,m,n)):w},a.prototype.contains=function(a,b,c,d){var e=this,f=arguments.length,g=!1;return 2!==f&&4!==f||(2===f&&(c=1,d=1),g=(e.row===-1||e.row<=a&&a+c<=e.row+e.rowCount)&&(e.col===-1||e.col<=b&&b+d<=e.col+e.colCount)),g},a.prototype.containsRange=function(a){return this.contains(a.row,a.col,a.rowCount,a.colCount)},a.prototype.offset=function(b,c){var d=this,e=d.col,f=d.row;return e!==-1&&(e+=b),f!==-1&&(f+=c),new a(f,e,d.rowCount,d.colCount)},a.prototype.union=function(a){return ta(this,a)},a.prototype.equals=function(b){var c=this;return b instanceof a&&c.row===b.row&&c.col===b.col&&c.rowCount===b.rowCount&&c.colCount===b.colCount},a}(),b.Range=X,b.kf=function(a,b,c,d){return new X(a,b,c,d)};function ta(a,b){var c=z(a.row,b.row),d=z(a.col,b.col),e=A(a.row+a.rowCount-1,b.row+b.rowCount-1),f=A(a.col+a.colCount-1,b.col+b.colCount-1);return c>=0&&d>=0?new X(c,d,e-c+1,f-d+1):c>=0?new X(c,(-1),e-c+1,(-1)):d>=0?new X((-1),d,(-1),f-d+1):new X((-1),(-1),(-1),(-1))}b.getUnionRange=ta,Y=function(){function a(){}return a.Om=function(a,b){if(a&&b){var c=a.Pm;if(c)return c.getColor(b)}return b},a.Qm=function(a,b){if(a&&b){var c=a.Pm;return c?c.getFont(b):b}return w},a}(),b.Rm=Y,Z=function(){function a(){}return a.ValidationError="ValidationError",a.CellClick="CellClick",a.CellDoubleClick="CellDoubleClick",a.ColumnChanging="ColumnChanging",a.RowChanging="RowChanging",a.EnterCell="EnterCell",a.LeaveCell="LeaveCell",a.ValueChanged="ValueChanged",a.TopRowChanged="TopRowChanged",a.LeftColumnChanged="LeftColumnChanged",a.InvalidOperation="InvalidOperation",a.RangeFiltering="RangeFiltering",a.RangeFiltered="RangeFiltered",a.RangeFilterClearing="RangeFilterClearing",a.TableFilterClearing="TableFilterClearing",a.RangeFilterCleared="RangeFilterCleared",a.TableFilterCleared="TableFilterCleared",a.TableFiltering="TableFiltering",a.TableFiltered="TableFiltered",a.RangeSorting="RangeSorting",a.RangeSorted="RangeSorted",a.ClipboardChanging="ClipboardChanging",a.ClipboardChanged="ClipboardChanged",a.ClipboardPasting="ClipboardPasting",a.ClipboardPasted="ClipboardPasted",a.ColumnWidthChanging="ColumnWidthChanging",a.ColumnWidthChanged="ColumnWidthChanged",a.RowHeightChanging="RowHeightChanging",a.RowHeightChanged="RowHeightChanged",a.DragDropBlock="DragDropBlock",a.DragDropBlockCompleted="DragDropBlockCompleted",a.DragFillBlock="DragFillBlock",a.DragFillBlockCompleted="DragFillBlockCompleted",a.EditStarting="EditStarting",a.EditStarted="EditStarted",a.EditChange="EditChange",a.EditEnding="EditEnding",a.EditEnd="EditEnd",a.EditEnded="EditEnded",a.RangeGroupStateChanging="RangeGroupStateChanging",a.RangeGroupStateChanged="RangeGroupStateChanged",a.SelectionChanging="SelectionChanging",a.SelectionChanged="SelectionChanged",a.SheetTabClick="SheetTabClick",a.SheetTabDoubleClick="SheetTabDoubleClick",a.SheetNameChanging="SheetNameChanging",a.SheetNameChanged="SheetNameChanged",a.UserZooming="UserZooming",a.UserFormulaEntered="UserFormulaEntered",a.CellChanged="CellChanged",a.ColumnChanged="ColumnChanged",a.RowChanged="RowChanged",a.ActiveSheetChanging="ActiveSheetChanging",a.ActiveSheetChanged="ActiveSheetChanged",a.SparklineChanged="SparklineChanged",a.OutlineColumnCheckStatusChanged="OutlineColumnCheckStatusChanged",a.RangeChanged="RangeChanged",a.ButtonClicked="ButtonClicked",a.EditorStatusChanged="EditorStatusChanged",a.FloatingObjectChanged="FloatingObjectChanged",a.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",a.ShapeChanged="ShapeChanged",a.ShapeSelectionChanged="ShapeSelectionChanged",a.PictureChanged="PictureChanged",a.FloatingObjectRemoving="FloatingObjectRemoving",a.ShapeRemoving="ShapeRemoving",a.FloatingObjectRemoved="FloatingObjectRemoved",a.ShapeRemoved="ShapeRemoved",a.PictureSelectionChanged="PictureSelectionChanged",a.FloatingObjectLoaded="FloatingObjectLoaded",a.TouchToolStripOpening="TouchToolStripOpening",a.CommentChanged="CommentChanged",a.CommentRemoving="CommentRemoving",a.CommentRemoved="CommentRemoved",a.SlicerChanged="SlicerChanged",a.ResetBinding="ResetBinding",a.InitBinding="InitBinding",a.BeforeDragDrop="BeforeDragDrop",a.FormulatextboxActiveSheetChanging="FormulatextboxActiveSheetChanging",a.FormulatextboxActiveSheetChanged="FormulatextboxActiveSheetChanged",a.FormulatextboxEditStarted="FormulatextboxEditStarted",a.FormulatextboxEnterCell="FormulatextboxEnterCell",a.FormulatextboxEditEnded="FormulatextboxEditEnded",a.FormulatextboxRangeChanged="FormulatextboxRangeChanged",a.SheetMoving="SheetMoving",a.SheetMoved="SheetMoved",a.DragMerging="DragMerging",a.DragMerged="DragMerged",a.ChartClicked="ChartClicked",a.FloatingElementSelected="FloatingElementSelected",a.BeforePrint="BeforePrint",a.TableResizing="TableResizing",a.TableResized="TableResized",a.TableRowsChanged="TableRowsChanged",a.TableColumnsChanged="TableColumnsChanged",a}(),b.Events=Z,$=function(){function a(a){this.kj=a}return a.prototype.Sm=function(a,b,c){var d,e=this.Tm,f=a<<4+b;return e?(d=e[f],d||(d=c(),e[f]=d),d):c()},a.prototype.Um=function(a,b){var c,d=this.Vm;return d&&(c=d[a])?c[b]:w},a.prototype.Wm=function(a,b,c,d){var e,f=this.Vm;f&&(f[a]||(f[a]={}),e=f[a],e[b]={d:c,i:d})},a.prototype.ge=function(a,b,c,d){var e,f,g,h=this,i=h.kj,j=h.Xm;return c===v&&(c=3),j?(e=j[c],e||(e={},j[c]=e),f=e[a],f||(f={},e[a]=f),g=f[b],g===v&&(g=i.getValue(a,b,c,d),f[b]=g),g):i.getValue(a,b,c,d)},a.prototype.Ym=function(a,b,c){var d,e,f,g=this,h=g.kj,i=g.Zm;return c===v&&(c=3),i?(d=i[c],d||(d={},i[c]=d),e=d[a],e||(e={},d[a]=e),f=e[b],f||(f=h.getActualStyle(a,b,c,!1,!0),e[b]=f),f.clone(!0)):h.getActualStyle(a,b,c,!1,!1)},a.prototype.Sl=function(a){var b,c=this,d=c.kj,e=c.$m;return e?(b=e[a],b===v&&(b=e[a]=d.Sl(a)),b):d.Sl(a)},a.prototype._m=function(a){var b,c=this,d=c.kj,e=c.an;return e?(b=e[a],b===v&&(b=e[a]=d.Tl(a)),b):d.Tl(a)},a.prototype.bn=function(a){var b=this;return b.Xm?(b.cn||(b.cn=a()),b.cn):a()},a.prototype.dn=function(a){var b=this;return b.Xm?(b.gn||(b.gn=a()),b.gn):a()},a.prototype.hn=function(){var a=this;a.in=!0,a.Tm={},a.Vm={},a.Xm={},a.Zm={},a.$m={},a.an={}},a.prototype.jn=function(){this.in=!1},a.prototype.kn=function(){var a=this;a.in=!1,a.Tm=w,a.Vm=w,a.Xm=w,a.Zm=w,a.an=w,a.$m=w,a.cn=w,a.gn=w},a}(),b.ln=$,_=function(){function a(){}return a.qn=function(b,c,d,e,f){var g,h,i,j;if(a.nn=!0,g=b.tables,g&&g.rn(c,d,e-c+1,f-d+1))for(h=-1,i=a.sn=[],j=0;j<=e;j++)b.getRowVisible(j)?(h++,i[j]=h):i[j]=-1},a.Nm=function(){a.sn=w,a.nn=!1},a.tn=function(b){var c=a.on;return c[b]||(c[b]=l?new l(b):w),c[b]},a.un=function(b,c,d){var e,f,g,h,i,j,m,n=a.pn,o=b+"_"+typeof b;return l?(n[c]||(n[c]={}),e=n[c],(f=e[o])?(d&&(d.conditionalForeColor=d.value=f.color,d.content=k(f.content)),f.text):(g=a.on,g[c]||(g[c]=new l(c)),h=g[c],i={},j=h.format(b,i),m=e[o]={},m.text=j,m.color=i.conditionalForeColor,m.content=i.content,d&&(d.conditionalForeColor=d.value=i.conditionalForeColor,d.content=k(i.content)),j)):""+b},a.vn=function(a,b,c,d){var e,f;return c&&"SparklineExValue"===c.typeName?"":(e=b.cellType||a.Al(),f=b.formatter||b._autoFormatter,e.format(c,f,d,w))},a.wn=function(){a.on={},a.pn={}},a.nn=!1,a.on={},a.pn={},a.sn=[],a}(),b.mn=_;function ua(a){var b=a.An||{scaleX:1,scaleY:1,translateX:0,translateY:0,skewX:0,skewY:0,orgTranslateX:0,orgTranslateY:0};return a.An=b,b}aa=function(){function a(){}return a.Cn=function(a,b,c){var d=ua(a);d.scaleX=b,d.scaleY=c,d.translateX=d.orgTranslateX*b,d.translateY=d.orgTranslateY*c,a.setTransform(d.scaleX,d.skewX,d.skewY,d.scaleY,d.translateX,d.translateY)},a.Dn=function(a,b,c){var d=ua(a);d.orgTranslateX+=b,d.orgTranslateY+=c,d.translateX=d.orgTranslateX*d.scaleX,d.translateY=d.orgTranslateY*d.scaleY,a.setTransform(d.scaleX,d.skewX,d.skewY,d.scaleY,d.translateX,d.translateY)},a}(),b.Bn=aa,ba=aa;function va(a,b){a&&(a.Gn=b)}function wa(a,b){a&&(a.Hn=b)}function xa(a,b){a.In=b}function ya(a,b){a.Jn=b}ca=function(){function a(){}return a.npb=function(){var a=p.screen,b=a.deviceXDPI,c=p.devicePixelRatio||(b?b/a.logicalXDPI:1),d=20*c,e=B(d);return e-d>.82?e/20:B(100*c)/100},a.Kn=function(b,c,d){var e,f,g,h,i,j,k,l,m=a;if(va(b,1),wa(b,1),e=a.npb(),(1!==e||1!==m.dpr)&&(m.dpr=e,f=c?c:d&&d.parent)){for(g=m.Fn,h=void 0,i=0;i<g.length;i++)if(f===g[i].workbook){h=g[i];break}if(h||(h={workbook:f,sheets:[],canvases:[]},g.push(h)),c)h.canvases.push(b);else{for(j=void 0,k=h.sheets,l=0;l<k.length;l++)if(k[l].sheet===d){j=k[l];break}j||(j={sheet:d,canvases:[]},k.push(j)),j.canvases.push(b)}}},a.Ln=function(a){return a&&a.Gn||1},a.Mn=function(a){return a&&a.Hn||1},a.Nn=function(a){return a.In},a.On=function(a){return a.Jn},a.Pn=function(b,c,d){var e,f,g,h=a,i=h.dpr,j=h.Ln(b),k=h.Mn(b);xa(b,c),ya(b,d),1===i&&1===j&&1===k?(b.width=c,b.height=d):(e=b.getContext("2d"),ba.Cn(e,1,1),P.Ml.mozilla?(b.width=y(c*i),b.height=y(d*i)):(b.width=B(c*i),b.height=B(d*i)),b.style.width=c+G,b.style.height=d+G,f=b.width/c,g=b.height/d,f===j&&g===k||(va(b,f),wa(b,g)),ba.Cn(e,f,g))},a.Qn=function(b,c){var d,e,f,g,h,i=a.Fn,j=b.parent;for(f=0;f<i.length;f++)if(!j||i[f].workbook===j)for(d=i[f].sheets,g=0;g<d.length;g++)if(d[g].sheet===b){for(e=d[g].canvases,h=0;h<e.length;h++)if(e[h]===c){e.splice(h,1);break}break}},a.Rn=function(b,c){var d,e,f,g=a.Fn;for(e=0;e<g.length;e++)if(g[e].workbook===b)for(d=g[e].canvases,f=0;f<d.length;f++)if(d[f]===c){d.splice(f,1);break}},a.Sn=function(b){var c,d,e,f=a.Fn,g=b.parent;for(d=0;d<f.length;d++)if(!g||f[d].workbook===g){for(c=f[d].sheets,e=0;e<c.length;e++)c[e].sheet===b&&c.splice(e,1);return}},a.Tn=function(b){var c,d=a.Fn;for(c=0;c<d.length;c++)if(d[c].workbook===b)return void d.splice(c,1)},a.Un=function(){var b,c,d,e,f,g,h,i,j=a,k=j.npb();if(j.dpr!==k)for(b=j.Fn,c=void 0,d=void 0,e=void 0,f=void 0,j.dpr=k,g=0;g<b.length;g++){for(d=b[g],e=d.canvases,c=d.sheets,h=0;h<c.length;h++)e=e.concat(c[h].canvases);for(i=0;i<e.length;i++)f=e[i],j.Pn(f,j.Nn(f),j.On(f))}},a.dpr=1,a.Fn=[],a}(),b.En=ca;function za(){return da.Yn||(da.Yn=ga("canvas").getContext("2d")),da.Yn}function Aa(a){var b,c,d,e=[],f=0,g=H;for(b=0;b<a.length;b++)e[f]===v&&(e[f]=""),c=a.charAt(b),d="",b+1<a.length&&(d=a.charAt(b+1)),c===g&&d!==g||"-"===c&&"-"!==d?(e[f]+=c,f++):e[f]+=c;return e}function Ba(a){for(var b=a.length-1;" "===a.charAt(b);)b--;return b!==a.length-1&&(a=a.substring(0,b+1)),a}function Ca(a){var b,c=a instanceof Array?[]:{};for(b in a)a.hasOwnProperty(b)&&(c[b]="object"==typeof a[b]&&a[b]!==w?Ca(a[b]):a[b]);return c}function Da(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o=[],p=e?e:za();if(!p)return o;for(c?(h=a.length*d,g=y(b/d)):(h=Q(p,p.font,a),f=h/a.length,g=y(b/f));h>b&&a;)for(i=!1,j=g;;){if(a.length<j){o.push(a),a="";break}if(k=a.substring(0,j),l=c?j*d:Q(p,p.font,k),"-"===k.charAt(k.length-1)&&(l=c?j*d:Q(p,p.font,k)-Q(p,p.font,"-")),l===b||i&&l<b){o.push(k),a=a.substring(j),h-=l;break}if(l>b){if(1===k.length){m=a.substring(k.length),m.trim()?(o.push(k),a=a.substring(j),h-=l):(o.push(a),a="");break}j-=1,i=!0}else n=c?(b-l)/d:(b-l)/f,n=n>=1?n:1,j+=n}return a&&a.search(/^[ ]*$/)===-1&&o.push(a),o}function Ea(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p=f?f:za();if(!p)return[a];for(g=[],h=0,i=0,j=b,k=[],l=0;l<a.length;l++)if(m=a[l].style&&a[l].style.font||e,n=P.fp(m),a[l].text&&a[l].text.length>0?i+=d?n*a[l].text.length:Q(p,m,a[l].text):i=0,i<j)k.push(a[l]);else for(i-=d?n*a[l].text.length:Q(p,m,a[l].text),o=0;o<a[l].text.length;o++)if(i+=d?n:Q(p,m,a[l].text.charAt(o)),i>j){k.push({style:a[l].style,text:a[l].text.substring(0,o)}),g.push(k),k=[],a.splice(l+1,0,{style:a[l].style,text:a[l].text.substring(o,a[l].text.length)}),i=0,j=c;break}return k.length>0&&g.push(k),g}function Fa(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=[],u=Aa(a),v=e?e:za();if(!v)return t;for(f=Q(v,v.font,a),g=c?d:f/a.length,h=C(b/g+"",10),i=0,j=0,k=0,l=0,m=[],n=!1;l<u.length;){if(n===!1){if(o=u[l],m.push(o),j+=o.length,j<h&&l<u.length-1){l++;continue}k=j,j=0}if(p=c?m.join("").length*d:da.Xn(m.join(""),v.font,!0,v),"-"===m.join("").charAt(m.join("").length-1)&&(p=c?m.join("").length*d:Q(v,v.font,m.join(""))-Q(v,v.font,"-")),p>b)if(q=m.pop(),0===m.length){for(r=Da(q,b,c,d,v),s=0;s<r.length-1;s++)t[i]=r[s],i++;1===r.length&&(t[i]=r[0],i++),r.length>=2?u[l]=r[r.length-1]:l++,n=!1}else n=!0,l--;else p<b&&n===!0||p===b?(n=!1,t[i]=Ba(m.join("")),i++,m=[],l++):p<b&&(l++,j=k)}return 0!==m.length&&(t[i]=Ba(m.join(""))),t}function Ga(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=[],s=e?e:za();if(!s)return r;if(0===a.length)return r.push({textLength:0,text:"",textInfos:[{style:{font:c},text:""}]}),r;for(f=0,g=[],h=0;h<a.length;h++){for(i=a[h],j=0,k=0,l=0;l<i.length;l++)m=void 0,m=i[l].style&&i[l].style.font?i[l].style.font:c,d?(k=P.fp(m),j+=k*i[l].text.length):n(i[l].text)||(j+=Q(s,m,i[l].text));if(j>b){for(g.length>0&&(r.push({textLength:f,text:Ba(Ia(g)),textInfos:Ca(g)}),g=[],f=0),o=Ea(i,b-f,b,d,c,s),g=g.concat(o[0]),n(o[0])||r.push({textLength:f+Ha(o[0],c,d,s),text:Ba(Ia(g)),textInfos:Ca(g)}),g=[],f=0,p=1;p<o.length-1;p++)n(o[p])||r.push({textLength:Ha(o[p],c,d,s),text:Ba(Ia(o[p])),textInfos:Ca(o[p])});o.length>1&&(q=o[o.length-1],g=g.concat(q),n(q)||(f+=Ha(q,c,d,s)))}else f+j>b?(r.push({textLength:f,text:Ba(Ia(g)),textInfos:Ca(g)}),g=[],g=g.concat(i),f=j):(g=g.concat(i),f+=j)}return g.length>0&&r.push({textLength:f,text:Ba(Ia(g)),textInfos:Ca(g)}),r}function Ha(a,b,c,d){var e,f,g=0,h=d?d:za();for(e=0;e<a.length;e++)f=a[e].style&&a[e].style.font||b,g+=c?P.fp(f):Q(h,f,a[e].text);return g}function Ia(a){var b,c="";for(b=0;b<a.length;b++)c+=a[b].text;return c}function Ja(a,b,c,d){var e,f,g,h,i,j=-1,k=!0;for(e=0;e<b.length;e++)if(!n(b[e].text))for(f=0;f<b[e].text.length;f++)g=b[e].text.charAt(f),h=b[e].style?b[e].style.font:c,P.lZa(a,h),i=P.fp(h),g===H||k?g!==H&&k&&(j=d?i:Q(a,c,g),k=!1):j=z(j,d?i:Q(a,c,g));return j}da=function(){function a(){}return a.Wn=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=[];if(0===a.length)return p;if(f=e?e:za(),!f)return p;if(P.lZa(f,c),g=P.fp(c),b<=0){for(h=-1,i=!0,j=0;j<a.length;j++)k=a.charAt(j),k===H||i?k!==H&&i&&(h=d?g:Q(f,f.font,k),i=!1):h=z(h,d?g:Q(f,f.font,k));if(b=h,b<=0)return[a]}for(l=a.split(/\r\n|\r|\n/),m=0;m<l.length;m++)if(n=Fa(l[m],b,d,g,f))if(0===n.length)p.push("");else for(o=0;o<n.length;o++)p.push(n[o]);return p},a.oV=function(b,c,d,e,f){var g,h,i,j,k=[];if(0===c.length)return k;if(e)k=a.Wn(c,f,d,!0);else for(g=c.split(/\r\n|\r|\n/),h=0;h<g.length;h++){for(i=[],j=0;j<g[h].length;j++)i.push(g[h][j]);k.push(i)}return k},a.M_a=function(b,c,d,e,f,g){var h,i,j,k,l,m,o,p=[];if(0===b.length)return p;if(h=g?g:za(),!h)return p;if(c<=0&&(c=Ja(h,e,d,f),c<=0)){for(j=[],i=0;i<e.length;i++)n(e[i].text)||j.push({textLength:a.R_a([e[i]],d,1,f,!1,h),text:e[i].text,textInfos:[e[i]]});return j}for(k=a.N_a(b),l=a.O_a(k,a.P_a(e)),i=0;i<l.length;i++)if(m=Ga(l[i],c,d,f,h))if(0===m.length)p.push("");else for(o=0;o<m.length;o++)p.push(m[o]);return p},a.N_a=function(a){var b,c=[],d=a.split(/\r\n|\r|\n/);for(b=0;b<d.length;b++)c.push(Aa(d[b]));return c},a.O_a=function(a,b){var c,d,e,f,g,h,i=[],j=0,k=0;for(c=0;c<a.length;c++){for(d=[],e=0;e<a[c].length&&j<b.length;e++)if(f=a[c][e],f.length<=b[j].text.length-k)d.push([{style:b[j].style,text:f}]),k+=f.length;else{for(g=[],g.push({style:b[j].style,text:b[j].text.substring(k)}),h=f.length-(b[j].text.length-k),j++;j<b.length;j++){if(h<b[j].text.length){g.push({style:b[j].style,text:f.substring(f.length-h)}),k=h;break}if(h===b[j].text.length){g.push({style:b[j].style,text:f.substring(f.length-h)}),j++,k=0;break}g.push({style:b[j].style,text:b[j].text}),h-=b[j].text.length}d.push(g)}i.push(d)}return i},a.Xn=function(a,b,c,d){var e,f=d?d:za();return f?(b&&P.lZa(f,b),e=c?Ba(a):a,Q(f,f.font,e)):0},a.P_a=function(a){var b,c=[];for(b=0;b<a.length;b++)c.push({style:a[b].style,text:a[b].text?a[b].text.replace(/\r\n|\r|\n/g,""):a[b].text});return c},a.R_a=function(a,b,c,d,e,f){var g,h,i,j,k,l=f?f:za();if(!l)return 0;for(g=0,h=0;h<a.length;h++)i=void 0,i=a[h].style&&a[h].style.font?a[h].style.font:b,P.lZa(l,i),j="",j=h===a.length-1&&e?Ba(a[h].text):a[h].text,k=0,d?k=P.fp(i)*j.length/c:n(a[h].text)||(k=Q(l,l.font,a[h].text)/c),a[h].style&&a[h].style.vertAlign&&(k*=F),g+=k;return g},a.lHb=function(b,c,d,e,f,g,h,i){var j=0,k=P.fp(g),l=(h-4-k*e)/d,m=a.Wn(f,l,g),n=m.length,o=k/d,p=k*d;return j=(n-1)*o,j+=a.Xn(m[0],g)/2*e+p,j+=a.Xn(m[n-1],g)/2*e+p},a.Rvb=function(a){return Ba(a)},a.bm=function(){return za()},a}(),b.Vn=da,b.Zn=function(a){a.$n=function(b,c){var d,e;for(a._n||(a._n=[]),d=a._n,c.name=b,c.priority=c.priority||5e3,e=0;;e++)if(e>=d.length||c.priority>d[e].priority){d.splice(e,0,c);break}},a.ao=function(b,c,d,e){var f,g,h=a._n;if(h)for(f=0;f<h.length&&(g=h[f][c],g&&g.call(b,d),!e||!e());f++);}},ea=function(){function a(){this.JTa={}}return a.prototype.get=function(a,b){var c=this.JTa[a];return c?c[b]:v},a.prototype.set=function(a,b,c){var d=this.JTa[a];d||(d=this.JTa[a]={}),d[b]=c},a}(),b.KTa=ea,b.Rxb={touch:!1}},"./dist/core/util/domUtil.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=d.Common.j,f=d.Common.D,g=void 0,h=null,i=parseFloat,j=document,k="_nonamespace",l="events",m="get",n="set",o="width",p="height",q="left",r="right",s="top",t="bottom",u="hidden",v="block",w="none",x="position",y="visibility",z="display",A={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},B={tabIndex:{get:function(a){var b=a.getAttributeNode("tabindex"),c=/^(?:input|select|textarea|button|object)$/i,d=/^(?:a|area)$/i,e=a.nodeName;return b&&b.specified?parseInt(b.value,10):c.test(e)||d.test(e)&&a.href?0:g}}},C={option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||e<0,g=f?h:[],i=f?e+1:d.length,j=f?e:0;for(e<0&&(j=i);j<i;j++)if(c=d[j],(c.selected||j===e)&&!c.disabled&&(!c.parentNode.disabled||!M(c.parentNode,"optgroup"))){if(b=H(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c=H.makeArray(b),d=H(a).find("option").getAll();return d.forEach(function(a){a.selected=H.inArray(H(a).val(),c)>=0}),c.length||(a.selectedIndex=-1),c}}},D={},E="$"+(""+Math.random()).replace(/\D/g,""),F=1,G={},[p,o].forEach(function(a){G[a]={get:function(b){var c,d,e,f=getComputedStyle(b),g=b.style,h=g[x],i=g[y],k=g[z],l=0===b.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(f[z]);if(l&&(g[x]="absolute",g[y]=u,g[z]=v),c=f&&f[a],l&&(g[x]=h,g[y]=i,g[z]=k),""===c){for(d=b.parentElement,e=j.body;d&&d!==e;)d=d.parentElement;d!==e&&(c=g[a])}return c}}});function K(a,b){var c,d;for(Array.call(this),"string"==typeof a?c=(b||j).querySelectorAll(a):a&&(c=e.Ca(a)||a instanceof HTMLCollection?a:[a]),d=0;c&&d<c.length;d++)this.push(c[d])}H=function(a,b){return a instanceof K?a:new K(a,b)},b.GC$=H,I={get:function(a){return this[a]},getAll:function(){return this},bind:function(a,b,c){var d=this;return X(c)&&(c=b,b=g),d.forEach(function(d){var e,f,h,i,j,m,n=R(d,l,g,!0);n||(n={},R(d,l,n,!0)),e=a.split("."),f=e[0],h=e[1]||k,i=n[h],i||(i=n[h]={}),j=function(a){X(b)||(a.data=b);var e=c.apply(d,arguments);a.result=e,e===!1&&(a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.cancelBubble=!1,a.returnValue=!1))},j.original=c,m=i[f],m||(m=i[f]=[]),m.push(j),d.addEventListener(f,j)}),d},unbind:function(a,b){var c=this;return c.forEach(function(c){var d,e,h,i,j=a.split("."),m=j[0],n=j[1]||k,o=R(c,l,g,!0),p=o&&o[n];if(b){if(p&&m&&(d=p[m]))for(h=d.length,e=0;e<h;e++)if(d[e].original===b){ba(c,m,d[e]),d.splice(e,1);break}}else if(p)if(m){if(d=p[m])for(h=d.length,e=0;e<h;e++)ba(c,m,d[e]);p[m]=g}else{for(i in p)if(f(p,i)&&(d=p[i]))for(h=d.length,e=0;e<h;e++)ba(c,i,d[e]);o[n]=g}}),c},trigger:function(a,b){var c,d,e,h,i,j,k,m,n,o,p,q=this;for(c=0,d=q.length;c<d;c++)if(e=q[c],h=R(e,l,g,!0)){i=a.split("."),j=i[0];for(k in h)if(f(h,k)&&(m=h[k],n=m&&m[j]))for(o=0,p=n.length;o<p;o++)n[o].apply(e,[{type:j},b])}return q},css:function(a,b){var c,d,e,g=this,h=g,i=arguments.length;function j(a,b){h.forEach(function(c){c.style[a]=N(a,b)})}if(1===i){if(!W(a))return c=g[0],d=G[a],d&&m in d?d.get(c):(e=getComputedStyle(c),e&&e[a]);h.forEach(function(b){for(var c in a)f(a,c)&&(b.style[c]=N(c,a[c]))})}else 2===i&&(Array.isArray(a)&&Array.isArray(b)&&a.length===b.length?a.forEach(function(a,c){j(a,b[c])}):j(a,b));return g},width:Y(!0),height:Y(),innerWidth:Z(!0),innerHeight:Z(),outerWidth:$(!0),outerHeight:$(),append:function(a){var b,c,d=[a];return a instanceof H&&(d=a.getAll()),b=this,c=b[0],d.forEach(function(a){a&&c.appendChild(a)}),b},appendTo:function(a){var b,c=a;return a instanceof H&&(c=a[0]),b=this,b.forEach(function(a){c.appendChild(a)}),b},prepend:function(a){var b=this,c=b[0];return c.insertBefore(a,c.firstChild),b},insertBefore:function(a){var b=this,c=a.parentElement;return b.forEach(function(b){c.insertBefore(b,a)}),b},addClass:function(a){var b,c,d,e,f,g=0,h=this,i=h.length,j=/\S+/g,k=/[\t\r\n]/g;for(b=(a||"").match(j)||[];g<i;g++)if(c=h[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(k," "):" ")){for(f=0,e=b[f];e;)d.indexOf(" "+e+" ")<0&&(d+=e+" "),f++,e=b[f];c.className=H.trim(d)}return this},removeClass:function(a){var b,c,d,e,f,g=0,h=this,i=h.length,j=/\S+/g,k=/[\t\r\n]/g;for(b=(a||"").match(j)||[];g<i;g++)if(c=h[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(k," "):"")){for(f=0,e=b[f];e;){for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");f++,e=b[f]}c.className=a?H.trim(d):""}return this},hasClass:function(a){var b,c=0,d=this,e=d.length,f=/[\t\r\n]/g;for(a=" "+a+" ";c<e;c++)if(b=d[c],1===b.nodeType&&(" "+b.className+" ").replace(f," ").indexOf(a)>=0)return!0;return!1},toggle:function(){var a=this,b=a[0];return b.style[z]===w?a.show():a.hide(),a},show:_(!0),hide:_(),attr:function(a,b){var c=this,d=c,e=arguments.length;if(1===e){if(!W(a))return c[0].getAttribute(a);d.forEach(function(b){for(var c in a)f(a,c)&&b.setAttribute(c,a[c])})}else 2===e&&d.forEach(function(c){c.setAttribute(a,b)});return c},removeAttr:function(a){return this.forEach(function(b){
b.removeAttribute(a)}),this},prop:function(a,b){var c=this,d=c,e=arguments.length;if(1===e){if(!W(a))return O(c[0],a);d.forEach(function(b){for(var c in a)f(a,c)&&O(b,c,a[c])})}else 2===e&&d.forEach(function(c){O(c,a,b)});return c},removeProp:function(a){a=A[a]||a;var b=this,c=b;return c.forEach(function(b){try{b[a]=g,delete b[a]}catch(a){}}),b},text:function(a){var b=this,c=b;return 0===arguments.length?b[0].textContent:(c.forEach(function(b){b.textContent=a}),b)},val:function(a){var b,c,d,e,f=this;{if(arguments.length)return e=H.isFunction(a),f.forEach(function(c,d){var f;1===c.nodeType&&(f=e?a.call(c,d,H(c).val()):a,f===h||f===g?f="":"number"==typeof f?f+="":H.isArray(f)&&(f=H.map(f,function(a){return a===h||a===g?"":a+""})),b=C[c.type]||C[c.nodeName.toLowerCase()],b&&n in b&&!X(b.set(c,f,"value"))||(c.value=f))}),f;if(c=f[0],d=void 0,c)return b=C[c.type]||C[c.nodeName.toLowerCase()],b&&m in b&&(d=b.get(c,"value"),!X(d))?d:(d=c.value,V(d)?d.replace(/\r/g,""):d===h||d===g?"":d)}},position:function(){var a,b,c,d,e=this[0];if(e)return b={top:0,left:0},"fixed"===H(e).css(x)?a=e.getBoundingClientRect():(c=this.offsetParent(),a=this.offset(),d=c[0],M(d,"html")||(b=c.offset(),b.left-=d.scrollLeft,b.top-=d.scrollTop),b.top+=i(H(d).css("borderTopWidth")),b.left+=i(H(d).css("borderLeftWidth"))),{top:a.top-b.top-i(H(e).css("marginTop")),left:a.left-b.left-i(H(e).css("marginLeft"))}},offsetParent:function(){var a=H.map(this,function(a){for(var b=j.documentElement,c=a.offsetParent||b;c&&!M(c,"html")&&"static"===H(c).css(x);)c=c.offsetParent;return c||b});return H(a)},offset:function(){var a,b,c={top:0,left:0},d=this[0],e=d&&d.ownerDocument;if(e)return a=e.documentElement,X(d.getBoundingClientRect)||(c=d.getBoundingClientRect()),b=L(e),{top:c.top+(b.pageYOffset||a.scrollTop)-(a.clientTop||0),left:c.left+(b.pageXOffset||a.scrollLeft)-(a.clientLeft||0)}},scrollLeft:aa(!0),scrollTop:aa(),html:function(a){var b=this,c=b;return 0===arguments.length?b[0].innerHTML:(c.forEach(function(b){b.innerHTML=a}),b)},remove:function(){var a=this;a.forEach(function(a){var b=a.parentElement;b&&(b.removeChild(a),U([a]))})},empty:function(){return this.forEach(function(a){H(a.children).remove()}),this},find:function(a){var b=[];return V(a)&&this.forEach(function(c){var d=c.querySelectorAll(a);H.merge(b,d)}),H(b)},parent:function(){var a=[];return this.forEach(function(b){var c=b.parentElement;c&&a.push(c)}),H(a)},index:function(a){var b=this[0];return a?V(a)?H.inArray(b,H(a).getAll()):H.inArray(a,this):b&&b.parentElement?H.inArray(b,b.parentElement.children):-1},focus:function(){var a=this,b=a[0];return b!==j.activeElement&&b.focus&&b.focus(),a},isVisible:function(){var a=0;return this.forEach(function(b){var c=getComputedStyle(b);c[y]!==u&&c[z]!==w&&a++}),a>0},data:function(a,b){var c=this,d=X(b);return d&&(c=void 0),H.each(this,function(e,f){var g=R(f,a,b);if(d)return c=g,!1}),c},removeData:function(a){return H.each(this,function(b,c){T(c,a)}),this}},J=K.prototype=[],e.Ia(J,I),H.prototype=J,H.each=e.H,H.isEmptyObject=e.za,H.isFunction=e.Aa,H.isArray=e.Ca,H.isNumeric=e.Da,H.getType=e.Ba,H.inArray=e.Ea,H.merge=e.Ga,H.map=e.Ha,H.extend=e.Ia,H.inherit=e.G,H.isPlainObject=e.Ja,H.isArraylike=e.ya,H.isWindow=e.Ka,H.makeArray=e.La,H.trim=function(a){if(a.trim)return a.trim();var b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;return a===h||a===g?"":(a+"").replace(b,"")},H.Nl=function(a,b,c,d,e){var f=H(j.createElement(a));return b&&c&&f.css(b,c),d&&f.addClass(d),e&&(e instanceof H?e.append(f):H(e).append(f)),f};function L(a){return H.isWindow(a)?a:9===a.nodeType&&(a.defaultView||a.parentWindow)}function M(a,b){var c=a.nodeName;return c&&c.toLowerCase()===b.toLowerCase()}function N(a,b){return"top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(a)>=0&&isFinite(b)?("width height".split(" ").indexOf(a)>=0&&b<0&&(b=0),b+"px"):b}function O(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g,f&&(b=A[b]||b,e=B[b]),X(c)?e&&m in e&&(d=e.get(a,b),d!==h)?d:a[b]:e&&n in e&&(d=e.set(a,c,b),!X(d))?d:(a[b]=c,c)}function P(a){var b,c,d,e=a.nodeType;return(!e||1===e||9===e)&&(b={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},c=a.nodeName,d=c&&b[c.toLowerCase()],!d||d!==!0&&a.getAttribute("classid")===d)}function Q(a){return a.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(a,b){return b.toUpperCase()})}function R(a,b,c,d){if(P(a)){var e,f,i=E,j=V(b),k=a.nodeType,l=k?D:a,m=k?a[i]:a[i]&&i;if(m&&l[m]&&(d||l[m].data)||!j||!X(c))return m||(k?(a[i]=m=F,F++):m=i),l[m]||(l[m]={},k||(l[m].toJSON=function(){})),(W(b)||"function"==typeof b)&&(d?l[m]=H.extend(l[m],b):l[m].data=H.extend(l[m].data,b)),e=l[m],d||(e.data||(e.data={}),e=e.data),X(c)||(e[Q(b)]=c),j?(f=e[b],f!==h&&f!==g||(f=e[Q(b)])):f=e,f}}function S(a){var b;for(b in a)if(("data"!==b||!H.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function T(a,b,c){if(P(a)){var d,e,f,g=a.nodeType,i=g?D:a,j=g?a[E]:E;if(i[j]){if(b&&(f=c?i[j]:i[j].data)){H.isArray(b)?b=b.concat(H.map(b,Q)):b in f?b=[b]:(b=Q(b),b=b in f?[b]:b.split(" ")),e=b.length;for(d=0;d<e;d++)delete f[b[d]];if(!(c?S:H.isEmptyObject)(f))return}(c||(delete i[j].data,S(i[j])))&&(g?U([a],!0):i!==i.window?delete i[j]:i[j]=h)}}}function U(a,b){for(var c,d,e,g,i,j,k,l,m,n=0,o=E,p=D,q=a[n];q!==h&&void 0!==q;){if((b||P(q))&&(c=q[o],d=c&&p[c])){if(e=d.events)for(g in e)if(f(e,g)&&(i=e[g]))for(j in i)if(f(i,j)&&(k=i[j]))for(l=0,m=k.length;l<m;l++)ba(q,g,k[l]);p[c]&&(delete p[c],delete q[o])}n++,q=a[n]}}function V(a){return"string"==typeof a}function W(a){return"object"==typeof a}function X(a){return typeof a==typeof g}function Y(a){var b=a;return function(a){var c,d=this,e="border-box"===d.css("box-sizing"),f=b?o:p,g=b?q:s,h=b?r:t;return 0===arguments.length?(c=Math.round(i(d.css(f)))||0,e&&(c-=i(d.css("padding-"+g))+i(d.css("padding-"+h))+i(d.css("border-"+g+"-"+o))+i(d.css("border-"+h+"-"+o))),c):(d.css(f,a),d)}}function Z(a){var b=a;return function(){var a=this,c=b?q:s,d=b?r:t;return b?a.width():a.height()+i(a.css("padding-"+c))+i(a.css("padding-"+d))}}function $(a){var b=a;return function(a){var c=b?q:s,d=b?r:t,e=this,f=b?e.innerWidth():e.innerHeight();return f+=i(e.css("border-"+c+"-"+o))+i(e.css("border-"+d+"-"+o)),a&&(f+=i(e.css("margin-"+c))+i(e.css("margin-"+d))),f}}function _(a){var b=a;return function(a){return this.forEach(function(c){c.style[z]=b?v:w,a&&a.apply(c)}),this}}function aa(a){var b=a;return function(a){var c="scrollLeft",d="scrollTop",e=b?c:d,f=b?"pageXOffset":"pageYOffset",g=this,h=g[0],i=L(h);return X(a)?i?f in i?i[f]:j.documentElement[e]:h[e]:(i?i.scrollTo(b?a:H(i)[c](),b?H(i)[d]():a):h[e]=a,g)}}function ba(a,b,c){a.removeEventListener(b,c)}},"./dist/core/util/imageLoader.js":function(a,b,c){"use strict";var d,e,f,g;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/domUtil.js"),e=d.GC$,f=".gcSheet",g=function(){function a(a){this.bo=0,this.co=0,this.eo={};var b=this;b.do=a}return a.prototype.fo=function(a){var b,c,d,g=this;function h(){g.ho(a)}b=g.eo,c=b[a],c||(d=e(document.createElement("img")),d.bind("load"+f,h),d.bind("error"+f,h),d.bind("abort"+f,h),g.bo++,b[a]={io:!1,jo:d[0]},d[0].src=a)},a.prototype.ko=function(a){var b=this.eo[a];return!!b&&b.io},a.prototype.lo=function(a){var b=this.eo[a];return b?b.jo:null},a.prototype.ho=function(a){var b=this;b.co++,b.eo[a].io=!0,b.mo()&&b.do&&b.do()},a.prototype.mo=function(){return this.co>=this.bo},a.prototype.no=function(){var a,b,c=this.eo;if(c)for(a in c)c[a]&&(b=e(c[a].jo),b.unbind(f));this.do=null},a}(),b.oo=g},"./dist/core/util/theme.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/common.js"),f=d.Common.j.Fa,g=d.Common.pc,h=g.ec,i=parseInt,j=e.util.Pl,k="Gill Sans MT",l="Franklin Gothic Book",m="Trebuchet MS";function F(a){var b=a;return function(c){return 0===arguments.length?this.po[b]:(this.po[a]=h(c),this)}}n=0,o=1,p=2,q=3,r=4,s=5,t=6,u=7,v=8,w=9,x=10,y=11,z=function(){function a(a,b,c,d,e,f,g,i,j,k,l,m,z){this.background1=F(n),this.background2=F(o),this.textColor1=F(p),this.textColor2=F(q),this.accent1=F(r),this.accent2=F(s),this.accent3=F(t),this.accent4=F(u),this.accent5=F(v),this.accent6=F(w),this.hyperlink=F(x),this.followedHyperlink=F(y),this.Cj=a,this.po=[];for(var A=1;A<13;A++)this.po.push(h(arguments[A]))}return a.prototype.name=function(a){return 0===arguments.length?this.Cj:(this.Cj=a,this)},a.prototype.getColor=function(a){var b,c,d,e,f;if(a&&(b=a.split(" "),c=void 0,b)){if(d=-1,e=b.length,e>1){if(!b[0])return a;c=b[0].toLowerCase(),"background"===c?d=i(b[1],10)-1:"text"===c?d=i(b[1],10)+1:"accent"===c&&(d=i(b[1],10)+3)}else 1===e&&(c=b[0].toLowerCase(),"hyperlink"===c?d=x:"followedhyperlink"===c&&(d=y));if(d>=0&&d<=11)return e>2?(f=i(b[2],10)/100,g.bc(g.jc(this.po[d],f))):g.bc(this.po[d])}return a},a.prototype.toJSON=function(){var a=this,b=a.po;return{name:a.Cj,background1:b[n],background2:b[o],text1:b[p],text2:b[q],accent1:b[r],accent2:b[s],accent3:b[t],accent4:b[u],accent5:b[v],accent6:b[w],hyperlink:b[x],followedHyperlink:b[y]}},a.prototype.fromJSON=function(a,b){var c,d,e,g,h,i,j,k,l,m,z,A,B,C,D,E,F;function G(a,b){f(b)||(c.po[a]={a:b.a,r:b.r,g:b.g,b:b.b})}a&&(c=this,d="_colorList",e="_name",b?(E=a.name?a.name:a[e],f(E)||(c.Cj=E),F=a.colorList?a.colorList:a[d],g=F[n],h=F[o],i=F[p],j=F[q],k=F[r],l=F[s],m=F[t],z=F[u],A=F[v],B=F[w],C=F[x],D=F[y]):(f(a.name)||(c.Cj=a.name),g=a.background1,h=a.background2,i=a.text1,j=a.text2,k=a.accent1,l=a.accent2,m=a.accent3,z=a.accent4,A=a.accent5,B=a.accent6,C=a.hyperlink,D=a.followedHyperlink),G(n,g),G(o,h),G(p,i),G(q,j),G(r,k),G(s,l),G(t,m),G(u,z),G(v,A),G(w,B),G(x,C),G(y,D))},a.prototype.e4=function(a){var b,c,d,e;if(this.name()!==a.name())return!1;for(b=["textColor1","textColor2","background1","background2","accent1","accent2","accent3","accent4","accent5","accent6","hyperlink","followedHyperlink"],c=0,d=b.length;c<d;c++)if(e=b[c],!g.Pka(this[e](),a[e]()))return!1;return!0},a}(),b.ColorScheme=z,A=function(){function a(a,b,c,d){this.name=j("name"),this.colors=j("colors"),this.headerFont=j("headerFont"),this.bodyFont=j("bodyFont");var e=this;e.name(a),e.colors(b?b:new z(a)),e.headerFont(c),e.bodyFont(d)}return a.prototype.getColor=function(a){return this.colors().getColor(a)},a.prototype.getFont=function(a){return"Body"===a?this.bodyFont():"Headings"===a?this.headerFont():a},a.prototype.toJSON=function(){var b=this,c=b.name();return a.f4(b)?c:{name:c,themeColor:b.colors()?b.colors().toJSON():void 0,headingFont:b.headerFont(),bodyFont:b.bodyFont()}},a.f4=function(a){var b,c=a.name();return!!E[c]&&(b=E[c],a.bodyFont()===b.bodyFont()&&a.headerFont()===b.headerFont()&&a.colors().e4(b.colors()))},a}(),b.Theme=A,B="#000000",C="#FFFFFF",D=function(){function a(){}return a.Default=new z("Default",C,"#EEECE1",B,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),a.Office2007=new z("Office2007",C,"#EEECE1",B,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),a.Office=new z("Office",C,"#E7E6E6",B,"#44546A","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),a.Apex=new z("Apex",C,"#C9C2D1",B,"#69676D","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),a.Aspect=new z("Aspect",C,"#E3DED1",B,"#323232","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),a.Concourse=new z("Concourse",C,"#DEF5FA",B,"#464646","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),a.Civic=new z("Civic",C,"#C5D1D7",B,"#646B86","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),a.Oriel=new z("Oriel",C,"#FFF39D",B,"#575F6D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),a.Origin=new z("Origin",C,"#DDE9EC",B,"#464653","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),a.Paper=new z("Paper",C,"#FEFAC9",B,"#444D26","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),a.Solstice=new z("Solstice",C,"#E7DEC9",B,"#4F271C","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),a.Technic=new z("Technic",C,"#D4D2D0",B,"#3B3B3B","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),a.Trek=new z("Trek",C,"#FBEEC9",B,"#4E3B30","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),a.Urban=new z("Urban",C,"#DEDEDE",B,"#424456","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),a.Verve=new z("Verve",C,"#D2D2D2",B,"#666666","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),a.Equity=new z("Equity",C,"#E9E5DC",B,"#696464","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),a.Flow=new z("Flow",C,"#DBF5F9",B,"#04617B","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),a.Foundry=new z("Foundry",C,"#EAEBDE",B,"#676A55","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),a.Median=new z("Median",C,"#EBDDC3",B,"#775F55","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),a.Metro=new z("Metro",C,"#D6ECFF",B,"#4E5B6F","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),a.Module=new z("Module",C,"#D4D4D6",B,"#5A6378","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),a.Opulent=new z("Opulent",C,"#F4E7ED",B,"#B13F9A","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),a}(),b.ThemeColors=D,E=function(){function a(){}return a.Default=new A("Default",D.Default,"Cambria","Calibri"),a.Office=new A("Office",D.Office,"Calibri Light","Calibri"),a.Office2007=new A("Office2007",D.Office2007,"Cambria","Calibri"),a.Apex=new A("Apex",D.Apex,"Lucida Sans","Book Antiqua"),a.Aspect=new A("Aspect",D.Aspect,"Verdana","Verdana"),a.Concourse=new A("Concourse",D.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),a.Civic=new A("Civic",D.Civic,"Georgia","Georgia"),a.Oriel=new A("Oriel",D.Oriel,"Century Schoolbook","Century Schoolbook"),a.Origin=new A("Origin",D.Origin,"Bookman Old Style",k),a.Paper=new A("Paper",D.Paper,"Constantia","Constantia"),a.Solstice=new A("Solstice",D.Solstice,k,k),a.Technic=new A("Technic",D.Technic,l,"Arial"),a.Trek=new A("Trek",D.Trek,"Franklin Gothic Medium",l),a.Urban=new A("Urban",D.Urban,m,"Georgia"),a.Verve=new A("Verve",D.Verve,"Century Gothic","Century Gothic"),a.Equity=new A("Equity",D.Equity,l,"Perpetua"),a.Flow=new A("Flow",D.Flow,"Calibri","Constantia"),a.Foundry=new A("Foundry",D.Foundry,"Rockwell","Rockwell"),a.Median=new A("Median",D.Median,"Tw Cen MT","Tw Cen MT"),a.Metro=new A("Metro",D.Metro,"Consolas","Corbel"),a.Module=new A("Module",D.Module,"Corbel","Corbel"),a.Opulent=new A("Opulent",D.Opulent,m,m),a}(),b.Themes=E},"./dist/core/workbook/sheettab.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/common.js"),f=c("./dist/core/worksheet/stylehelper.js"),g=c("./dist/core/workbook/sheettabbase.js"),h=c("./dist/core/core.enum.js"),i=d.Common.pc,j=i.ic,k=i.ec,l=null,m="blank",n="nextButton",o=function(a){p(b,a);function b(b){var c=a.call(this,b)||this,d=c;return d.EC=13,d.GC=12,d.HC=0,d.kw=30,d.IC=28,d.JC=28,d.KC=28,d.LC=0,d._font="10pt Segoe UI",c}return b.prototype.NC=function(){var a=this.OC;return a&&a.options.tabNavigationVisible?this.IC:0},b.prototype.PC=function(){var a=this.OC;return a&&a.options.tabNavigationVisible?a.Jv():0},b.prototype.QC=function(){return this.JC},b.prototype.RC=function(){return this.SC?0:this.JC},b.prototype.TC=function(){return this.SC?0:this.KC},b.prototype.UC=function(){var a,b,c=this,d=c.OC.sheets,e=c.VC(),f=c.WC,g=c.Dr(),h=g.x+g.width-c.kw-c.TC()-c.RC();for(a=c.gq,b=d.length;a<b;a++)if(d[a].visible()&&(e+=f[a]),e>h){e=h;break}return e},b.prototype.VC=function(){var a=this;return 2*a.NC()+a.QC()+a.XC()},b.prototype.XC=function(){var a=this,b=a.OC;return b&&b.options.tabNavigationVisible?a.kw/2:0},b.prototype.getResizeBarBounds=function(){var a=this,b=a.Dr();return{x:b.x+b.width-a.kw,y:l,width:a.kw,height:l}},b.prototype.getNavButtonBounds=function(){var a=this;return{x:a.kw/2,y:l,width:a.NC(),height:l,endIndex:3,startIndex:1}},b.prototype.getSheetTabBounds=function(){var a=this,b=a.Dr(),c=a.RC();return{x:a.VC(),y:l,height:l,secondMoreTabWidth:a.RC(),moreTabPos:b.x+b.width-a.kw-a.TC()-c}},b.prototype.getPreMoreTabBounds=function(){var a=this;return{x:a.VC()-a.QC(),width:a.QC()}},b.prototype.YC=function(){var a=this;return a.ZC+a.WC[a.$C]>a._C()},b.prototype._C=function(){var a=this;return a.Dr().width-a.kw-a.TC()-a.RC()},b.prototype.aD=function(){return 6},b.prototype.Via=function(){return[m,n]},b.prototype.cD=function(){return this.VC()},b.prototype.dD=function(a,b){a.save(),a.beginPath();var c=e.Im.Km(0,"gc-tabStripBackground");this.eD=k(c.backgroundColor),a.fillStyle=c.backgroundColor,a.fillRect(b.x,b.y,b.width,b.height),a.beginPath(),a.strokeStyle=c.borderTopColor,a.moveTo(b.x,b.y+.5),a.lineTo(b.x+b.width,b.y+.5),a.stroke(),a.restore()},b.prototype.fD=function(a,b,c,d){var e,f,g=this,h=g.OC.options.newTabVisible,i=g.IC,j=g.RC();c+=j,h?g.KC=i:g.KC=0,e=b.x+b.width-g.kw-g.TC(),c>e&&(c=e,f=e-j,f<d&&(f=d,c=f+i),g.gD(a,f,0,j,b.height)),h&&g.hD(a,c,0,i,b.height,g.iD===-2)},b.prototype.jD=function(a,b,c,d){var e=this.QC();this.gD(a,d-e,0,e,b.height)},b.prototype.kD=function(a,b,c){var d=this,e=5,f=d.NC(),g=d.PC(),h=d.kw/2+f/2,i=g/2,j=d.lD;d.mD(a,h,i,h+e,i+e,h+e,i-e,!0,l,1===j),h+=f,d.mD(a,h,i,h-e,i+e,h-e,i-e,!1,l,2===j)},b.prototype.nD=function(a,b){var c,d,f=this,g=f.kw,h=e.Im.Km(0,"gc-tabStripResizeBarInner");f.OC.options.showHorizontalScrollbar&&(a.beginPath(),a.rect(b.x+b.width-g,0,g,b.height),a.clip(),c=b.x+b.width-g/2,d=b.y+b.height/2,a.fillStyle=h.color,a.fillRect(c,d,2,2),a.fillRect(c,d-4,2,2),a.fillRect(c,d+4,2,2))},b.prototype.oD=function(a,b,c,d,g,i,j,k,l){var m,n,o,p,q,r,s,t=this,u=h.VisualState.normal;k&&(u=h.VisualState.hover),j&&(u=h.VisualState.active),m=e.Im.Km(u,"gc-tab-"+e.Im.Jm(u)),n=e.Im.Km(0,"gc-tab-"+e.Im.Jm(0)),a.save(),o=4,p=3,j&&(a.fillStyle="white",a.fillRect(b,c,d,g-o)),q=t.pD(a,j,l,m),a.fillStyle=q,a.fillRect(b+p,c+p,d-2*p+1,g-2*p),a.beginPath(),a.lineWidth=1,a.strokeStyle=n&&n.borderLeftColor,j?(a.moveTo(b+.5,c),a.lineTo(b+.5,c+g-o),a.moveTo(b+d+.5,c),a.lineTo(b+d+.5,c+g-o)):(a.moveTo(b+.5,c+o),a.lineTo(b+.5,c+g-o),a.moveTo(b+d+.5,c+o),a.lineTo(b+d+.5,c+g-o)),a.stroke(),j&&(a.beginPath(),a.strokeStyle=m&&m.borderBottomColor,a.lineWidth=2,a.moveTo(b,c+g-o),a.lineTo(b+d+1,c+g-o),a.stroke()),a.textBaseline="top","string"==typeof q&&(r=q),a.fillStyle=t.qD(m,r),(k||j)&&(a.font=f.To.Ro(a.font,"bold")),s=t.EC,a.textBaseline="middle",a.fillText(l,b+s,c+g/2-1),a.restore()},b.prototype.mD=function(a,b,c,d,f,g,i,j,k,l){var m,n,o,p,q,r;a.save(),m=this,n=h.VisualState.highlight,l&&(n=h.VisualState.hover),j?(b-=2,d-=2,o=m.rw(m.gq),o===-1&&(n=h.VisualState.normal)):(b+=2,d+=2,p=m.rD(m.sD()),p===-1&&(n=h.VisualState.normal)),q=e.Im.Km(n,"gc-navButton-"+e.Im.Jm(n)),a.strokeStyle=this.tD(q.borderTopColor),a.beginPath(),r=1,b>d&&(r=-1),a.moveTo(b-.5,c),a.lineTo(b-.5,c+1),a.moveTo(b+r-.5,c-1),a.lineTo(b+r-.5,c+2),a.moveTo(b+2*r-.5,c-2),a.lineTo(b+2*r-.5,c+3),a.moveTo(b+3*r-.5,c-3),a.lineTo(b+3*r-.5,c+4),a.stroke(),a.restore()},b.prototype.hD=function(a,b,c,d,f,g){var i,j,k;a.save(),a.beginPath(),i=(f-14)/2,j=h.VisualState.highlight,g&&(j=h.VisualState.hover),k=e.Im.Km(j,"gc-tabStripNewTab-"+e.Im.Jm(j)),a.lineWidth=1.5,a.strokeStyle=this.tD(k.borderTopColor),a.arc(b+d/2,c+f/2,i,0,2*Math.PI),a.stroke(),a.beginPath(),a.lineWidth=2,a.moveTo(b+d/2-4,c+f/2),a.lineTo(b+d/2+4,c+f/2),a.moveTo(b+d/2,c+f/2-4),a.lineTo(b+d/2,c+f/2+4),a.stroke(),a.restore()},b.prototype.gD=function(a,b,c,d,f){var g,i,j;a.save(),a.beginPath(),g=h.VisualState.highlight,i=this.lD,5!==i&&6!==i||(g=h.VisualState.hover),j=e.Im.Km(g,"gc-navMoreButton-"+e.Im.Jm(g)),a.fillStyle=this.tD(j.borderTopColor),a.fillRect(b+d/2,c+f/2,2,2),a.fillRect(b+d/2-4,c+f/2,2,2),a.fillRect(b+d/2+4,c+f/2,2,2),a.restore()},b.prototype.tD=function(a){var b=k(a),c=this.eD;return b.a<=.01?j(c):i.hc(c,b)?j(b):a},b}(g.DC),b.iv=o},"./dist/core/workbook/sheettab2007.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("Common"),f=c("./dist/core/util/common.js"),g=c("./dist/core/workbook/sheettabbase.js"),h=f.Ul.wl,i=null,j=Math.min,k="#92A5C7",l="newSheet",m=new e.Common.ResourceManager(d.SR),n=m.getResource.bind(m),o=function(a){p(b,a);function b(b){var c=a.call(this,b)||this,d=c;return d.EC=12,d.GC=8,d.HC=3,d.kw=12,d.KC=48,d.LC=5,d._font="10pt Arial",c}return b.prototype.NC=function(){var a=this.OC,b=a&&a.options,c=0;return c=b&&b.tabNavigationVisible?a.Wv()*(b.useTouchLayout?2:1):0},b.prototype.PC=function(){var a=this.OC;return a&&a.options.tabNavigationVisible?a.Wv():0},b.prototype.VC=function(){return 4*this.NC()+this.lE()},b.prototype.lE=function(){var a=this,b=a.OC;return b&&b.options.tabNavigationVisible?2:0},b.prototype.getResizeBarBounds=function(){var a=this,b=a.Dr();return{x:b.x+b.width-a.kw,y:i,width:a.kw,height:i}},b.prototype.getNavButtonBounds=function(){var a=this;return{x:0,y:i,width:a.NC(),height:i,endIndex:4,startIndex:0}},b.prototype.getSheetTabBounds=function(){var a=this;return{x:a.VC(),y:i,height:i,secondMoreTabWidth:0,moreTabPos:0}},b.prototype.getPreMoreTabBounds=function(){var a=this;return{x:a.VC(),width:a.HC+a.LC}},b.prototype.YC=function(){var a=this;return a.ZC+a.WC[a.$C]+a.TC()>a._C()},b.prototype._C=function(){return this.Dr().width-this.kw},b.prototype.aD=function(){return 1},b.prototype.Via=function(){return[l]},b.prototype.cD=function(){var a=this,b=a.VC()+a.Dr().height;return a.OC.options.newTabVisible&&(b+=a.TC(),b+=a.HC),b},b.prototype.dD=function(a,b){var c,d,e,g,i,j,k,l;if(a.save(),a.beginPath(),c=a.createLinearGradient(b.x,b.y,b.width,b.height),d=f.Im.Km(0,"gc-tabStripBackground"),e=d&&d.backgroundImage,g=d&&d.backgroundColor,e&&e.indexOf("linear-gradient")!==-1)for(i=h(e),j=0,k=i.length;j<k;j++)l=i[j],c.addColorStop(l.point,l.color);else g&&(c.addColorStop(0,"#DDDDDD"),c.addColorStop(1,g));a.fillStyle=c,a.fillRect(b.x,b.y,b.width,b.height),a.restore()},b.prototype.fD=function(a,b,c,d){var e=this,f=e.OC,g=n().NewTab;f.options.newTabVisible&&(e.KC=a.measureText(g).width+e.EC,e.oD(a,c,0,e.TC(),b.height,5,!1,e.iD===-2,g))},b.prototype.jD=function(a,b,c,d){var e=this,f=c-1,g=e.WC[f];e.oD(a,d+e.LC-g-e.HC,0,g,b.height,5,e.$C===f,e.iD===f,"")},b.prototype.kD=function(a,b,c){var d,e,f,g,h,j,l=this;a.fillStyle=k,a.fillRect(b.x,b.y,c-1,b.height),d=5,e=l.NC(),f=l.PC(),g=e/2,h=f/2,j=l.lD,l.mD(a,g,h,g+d,h+d,g+d,h-d,!0,g-d,0===j),g+=e,l.mD(a,g,h,g+d,h+d,g+d,h-d,!0,i,1===j),g+=e,l.mD(a,g,h,g-d,h+d,g-d,h-d,!1,i,2===j),g+=e,l.mD(a,g,h,g-d,h+d,g-d,h-d,!1,g+4,3===j)},b.prototype.nD=function(a,b){var c,d=this,e=d.OC,g=d.kw,h=f.Im.Km,i=h(4,"gc-tabStripResizeBarInner"),j=h(0,"gc-tabStripResizeBarOuter");e.options.showHorizontalScrollbar&&(c=b.x+b.width-g,a.fillStyle=j.backgroundColor,a.fillRect(c,b.y,g,b.height),a.fillStyle=i.backgroundColor,a.fillRect(c+1,b.y+1,g-2,b.height-2),a.fillStyle=i.color,a.fillRect(c+g/2-1,b.y+4,2,b.height-8))},b.prototype.oD=function(a,b,c,d,e,g,h,i,j){var l,m,n,o,p,q;a.save(),a.beginPath(),a.moveTo(b,c),a.lineTo(b,c+e-g),a.arcTo(b,c+e,b+d,c+e,g),a.lineTo(b+d,c+e),a.lineTo(b+d+e,c),h||a.lineTo(b,c),l=this,m=0,(h||i)&&(m=4),n=f.Im.Km(m,"gc-tab-"+f.Im.Jm(m)),o=l.pD(a,h||i,j,n),a.fillStyle=o,a.fill(),a.strokeStyle=k,a.stroke(),a.textBaseline="top","string"==typeof o&&(p=o),a.fillStyle=l.qD(n,p),q=l.EC,a.textBaseline="middle",a.fillText(j,b+q,c+e/2),a.restore()},b.prototype.mD=function(a,b,c,d,e,g,k,l,m,n){var o,p,q,r,s,t,u,v,w,x,y,z,A;if(a.save(),o=this,p=o.Dr(),q=o.NC(),r=f.Im.Km,s=r(4,"gc-navButton-hover"),t=r(0,"gc-navButton-normal"),u=t&&t.backgroundColor,n)a.fillStyle=s.backgroundColor,a.fillRect(b-q/2+2,p.y+2,q-4,p.height-4);else{if(v=t&&t.backgroundImage,v&&v.indexOf("linear-gradient")!==-1){for(w=a.createLinearGradient(p.x+.7*p.height,p.y+0,.7*p.height,p.height),x=h(v),y=0,z=x.length;y<z;y++)A=x[y],w.addColorStop(A.point,A.color);a.fillStyle=w}else u&&(a.fillStyle=u);a.fillRect(b-q/2,p.y+1,q,p.height-2)}n?a.fillStyle=s.color:a.fillStyle=t.color,void 0!==m&&m!==i&&a.fillRect(m,j(e,k),1,Math.max(e,k)-j(e,k)),l?(b-=2,d-=2,g-=2):(b+=2,d+=2,g+=2),a.beginPath(),a.moveTo(b,c),a.lineTo(d,e),a.lineTo(g,k),a.lineTo(b,c),a.fill(),a.restore()},b}(g.DC),b.jv=o},"./dist/core/workbook/sheettabbase.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("Common"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),h=c("./dist/core/worksheet/stylehelper.js"),i=c("./dist/core/core.enum.js"),j=e.Common.pc,k=g.Ul.wl,l=g.Ul.bq,m=e.Common.j.Fa,n=g.Ul.Nl,o=g.Ul.lZa,p=window,q=document,r=null,s=Math.max,t=Math.min,u=Math.pow,v="px",w="none",x=".gcTab",y="mousedown"+x,z="mousemove"+x,A="mouseup"+x,B="mouseout"+x,C="dblclick"+x,D=".spliter",E="mousemove"+D,F="mouseup"+D,G=".tabNameEditor",H="keydown"+G,I="focus"+G,J="blur"+G,K="canvas",L="2d",M="resize",N="navButton",O="tab",P="newSheet",Q="blank",R="black",S="white",T=4,U=10,V="navButton",W="sheetTab",X=new e.Common.ResourceManager(d.SR),Y=X.getResource.bind(X);function $(a,b,c){a.Wq(g.Events.SheetTabClick,{sheet:b,sheetName:b?b.name():r,sheetTabIndex:m(c)?-1:c})}function _(a,b){a.Wq(g.Events.SheetMoving,b)}function aa(a,b,c,d){a.Wq(g.Events.SheetMoved,{sheet:b,sheetName:b?b.name():r,oldIndex:c,newIndex:d})}Z=function(){function a(a){this.Cj=a,this.SC=!1,this.LC=0,this.HC=0,this.buffer=null;var b=this;b.OC=r,b.$C=0,b.gq=0,b.ZC=70,b.lD=-1,b.iD=-1,b._font="",b.WC=[],b.uD=-1,b.vD=-1,b.wD=r,b.xD=0,b.Us(new g.Rect(0,0,200,28))}return a.prototype.ws=function(b){var c,d=this,e=d.Xs;e&&d.no(!0),c=n(K),g.En.Kn(c,d.OC),c.setAttribute("id",d.Cj),d.yD=d.zD(),b.appendChild(d.yD[0]),b.appendChild(c),d.Xs=c,f.GC$(c).bind(y,function(a){return d.AD(a)}).bind(z,function(a){return d.BD(a)}).bind(A,function(a){return d.CD(a)}).bind(B,function(a){return d.DD(a)}).bind(C,function(a){return d.ED(a)}),d.fq(),a.ao(d,"setHost")},a.prototype.Yv=function(a){var b=this,c=a.options.font;b.OC=a,a&&c&&c.length>0&&(b._font=c)},a.prototype.Dr=function(){var a=this.Zs;return new g.Rect(a.x,a.y,a.width,a.height)},a.prototype.Us=function(a){var b=this.Zs=new g.Rect(0,0,0,0);b.x=a.x,b.y=a.y,b.width=a.width,b.height=a.height},a.prototype.TC=function(){return this.KC},a.prototype.UC=function(){var a=this.Dr();return a.x+a.width-this.kw},a.prototype.VC=function(){return 0},a.prototype.fq=function(){var a,b,c,d,e=this,h=e.Ws();h&&h.parentNode&&(a=f.GC$(h.parentNode),0!==a.width()&&0!==a.height()&&(b=s(a.width(),0),c=s(a.height(),0),h.style.display=w,h.width=b,h.height=c,h.style.display="",h.style.width=b+v,h.style.height=c+v,b=h.clientWidth||h.width,c=h.clientHeight||h.height,d=e.Dr(),e.Us(new g.Rect(d.x,d.y,b,c)),g.En.Pn(h,b,c),e.repaint()))},a.prototype.YC=function(){return!1},a.prototype._C=function(){return 0},a.prototype.aD=function(){return 0},a.prototype.Via=function(){return[]},a.prototype.cD=function(){return 0},a.prototype.zD=function(){var a="transparent";return f.GC$(n("div")).css({position:"absolute","border-style":"solid","border-color":R,"border-width":T+v,display:"none",width:0,"border-bottom":0,"border-left-color":a,"border-right-color":a})},a.prototype.no=function(b){var c,d=this,e=d.Xs;e&&(c=e.parentNode,f.GC$(e).unbind(y).unbind(z).unbind(A).unbind(C).unbind(B),c&&c.removeChild(e)),f.GC$(d.yD).remove(),a.ao(d,"dispose"),b||(d.OC=r)},a.prototype.hitTest=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r.OC,t=r.Dr(),u=r.getResizeBarBounds();if(s.options.showHorizontalScrollbar&&a>u.x&&a<t.x+t.width)return{type:"resize",element:M};for(c=r.getNavButtonBounds(),d=-1,e=c.startIndex,f=c.x,g=c.endIndex,h=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],i=e;i<g;i++){if(f<a&&a<f+c.width){d=i,N=h[i];break}f+=c.width}if(d!==-1)return{type:V,element:N,index:i};if(j=r.getPreMoreTabBounds(),f=j.x,k=0,l=r.rw(r.gq),l!==-1){if(f<=a&&a<f+j.width)return N=h[5],{type:V,element:N,index:5,position:f};k=r.LC}if(m=r.getSheetTabBounds(),n=s.sheets,o=r.WC,p=r.HC,q=0,f=m.x+k,r.gq>-1)for(i=r.gq;i<n.length&&i<o.length;i++)if(n[i].visible()){if(q=o[i],f<a&&a<f+q+p){if(m.moreTabPos>0&&a<m.moreTabPos)return{type:W,element:O,index:i,position:f};if(0===m.moreTabPos)return{type:W,element:O,index:i,position:f}}f+=q+p}if(f>m.moreTabPos&&m.moreTabPos>0&&(f=m.moreTabPos),r.rD(r.sD())!==-1){if(f<a&&a<f+m.secondMoreTabWidth)return N=h[6],{type:V,element:h[6],index:6,position:f}}else if(f<a&&a<f+m.secondMoreTabWidth)return{element:Q,position:f};return f+=m.secondMoreTabWidth,s.options.newTabVisible&&f<a&&a<f+r.TC()?{type:W,element:P,position:f,index:-1}:{element:Q}},a.prototype.AD=function(b){var c,d,e,g,h,i,j,k,l=this,n={e:b,r:r};return a.ao(l,"preProcessMouseDown",n),c=n.r,m(c)?(d=f.GC$(l.Ws()).offset(),e=b.pageX-d.left,g=b.pageY-d.top,h=l.OC.getActiveSheet(),l.FD&&l.GD(h,!1),i=l.hitTest(e,g),j=i.element,0===b.button&&(j===M?(l.HD=!0,l.ID=b.pageX,l.tC()):j===N?l.JD(i.index):j===O?(l.KD(i.index,i.position),l.LD(b,i)):j===P&&l.MD(i.position),h=l.OC.getActiveSheet(),k=h&&h.mm,k&&!h.isEditing()&&h.zt()),l.ND=!0,!1):c},a.prototype.BD=function(b){var c,d,e,g,h,i,j,k,l,n,o,p,q,s,t,v=this,w={e:b,r:r};if(a.ao(v,"preProcessMouseMove",w),c=w.r,!m(c))return c;if(d=v.Xs.style,e="default",g="w-resize",v.OD&&!v.PD&&(h=Math.sqrt(u(v.OD.x-b.pageX,2)+u(v.OD.y-b.pageY,2)),h>U&&(v.PD=!0)),v.HD)d.cursor=g,i=b.pageX-v.ID,j=v.OC.xs.clientWidth,k=v.OC,k.options.tabStripRatio=k.Iv()+i/j,l=v.kw/j,n=1,k.Iv()<l?(k.options.tabStripRatio=l,v.ID=v.kw):k.Iv()>=n?(k.options.tabStripRatio=n,v.ID=j):v.ID=b.pageX,k.aq();else if(v.PD)v.QD(b.pageX,b.pageY),v.RD(b);else{if(v.lD=-1,v.iD=-1,o=f.GC$(v.Ws()).offset(),p=b.pageX-o.left,q=b.pageY-o.top,s=v.hitTest(p,q),t=s.element,""===t)return d.cursor=e,v.repaint(),!1;t===M?d.cursor=g:(d.cursor=e,t===N?v.lD=s.index:t===O?v.iD=s.index:t===P&&(v.iD=-2)),v.repaint()}return!1},a.prototype.CD=function(b){var c,d=this,e={e:b,r:r};return a.ao(d,"preProcessMouseUp",e),c=e.r,m(c)?(d.HD&&(d.HD=!1,d.OC.aq()),d.SD(),d.PD&&(d.PD=!1,d.TD.remove(),d.UD(),d.yD.hide()),d.OD=r,d.VD(),d.uC(),!d.ND||(d.ND=!1,!1)):c},a.prototype.DD=function(b){var c,d,e,f=this,g={e:b,r:r};return a.ao(f,"preProcessMouseOut",g),c=g.r,m(c)?(f.VD(),d=f.lD,f.lD=-1,e=f.iD,f.iD=-1,f.lD===d&&f.iD===e||f.repaint(),!1):c},a.prototype.tC=function(){var a,b=this;b.WD||(f.GC$(q).bind(E,function(a){b.BD(a)}).bind(F,function(a){b.CD(a)}),a=b.OC.getActiveSheet(),a&&(a.XD=!0),b.WD=!0)},a.prototype.uC=function(){if(this.WD){this.WD=!1,f.GC$(q).unbind(E).unbind(F);
var a=this.OC.getActiveSheet();a&&delete a.XD}},a.prototype.JD=function(a,b){var c,d,e=this;e.VD(),c=e.sD(),c.length<=0||(d=200,a%=4,0===a?e.YD(c):1===a?(b||(e.ZD=p.setTimeout(function(){e.JD(1)},d)),e.$D(c)):2===a?(b||(e.ZD=p.setTimeout(function(){e.JD(2)},d)),e._D(c)):3===a&&e.aE(c))},a.prototype.KD=function(a,b){var c,d,e,f=this,g=f.OC;f.$C=a,f.ZC=b,g.suspendPaint(),c=g.getActiveSheet(),d=g.getSheet(a),d&&d.isEditing()&&d!==c&&(e=c&&c.Cw&&c.Cw.V4,!d.gv(void 0,void 0,e))||($(g,d,a),f.iw(a),g.resumePaint(),f.repaint())},a.prototype.MD=function(a){var b,c,d=this,e=d.OC,f=e.getActiveSheet();if(!d.bE||d.bE(f)){for($(e,r,r),b=e.sheets.length,c=e.vv(e.wv(b)),e.ow(b,1,c),d.$C=b,d.ZC=a,e.dq(b,1,!1,!0);d.$C>d.gq&&(d.YC()||d.gq<d.jw(-1));)d.hE(d.gq)&&(d.ZC-=d.WC[d.gq]),d.gq++;d.repaint()}},a.prototype.iw=function(a){var b,c=this,d=c.OC,e=d.getActiveSheet(),f=!1;e&&e.Cw&&e.Cw.V4&&(f=!0),a!==d.eq&&(d.dq(a,1,f,!0),b=c.jw(c.gq),c.$C>c.gq&&c.ZC+c.WC[c.$C]>c._C()&&b!==-1&&(c.gq=b)),c.$C<c.gq&&(c.gq=c.rw(c.gq))},a.prototype.cE=function(a,b){var c,d,e,h,i,j,k,l,m,o=this,p=o.OC,q=o.hitTest(a,b);if(q.element===O){if(c=o.$C,d=p.sheets[c],q.index!==c)return;if(p.Wq(g.Events.SheetTabDoubleClick,{sheet:d,sheetName:d.name(),sheetTabIndex:c}),!p.options.tabEditable)return!1;if(e=g.Vl.Xl(),e&&e.endEdit&&!e.endEdit())return;g.Vl.Zl(r),h=o.WC[c],i=f.GC$(o.Ws()).offset(),j=p.xv(),k=f.GC$(j).offset(),l=n("input"),m=l.style,l.type="text",l.value=d.name(),l.setAttribute("contentEditable","true"),l.setAttribute("autocomplete","off"),m.position="absolute",m.margin="0px",m.padding="0px",m.left=i.left-k.left+o.ZC+o.EC+v,m.top=i.top-k.top+o.aD()+v,m.width=h-o.EC-o.GC+2+v,m.backgroundColor=S,m.borderWidth="0px",m.outline=w,f.GC$(l).appendTo(j),o.FD=l,f.GC$(l).addClass("gc-sheetTabEditor").bind(H,function(a){return 13===a.keyCode?(o.GD(d,!1),!1):27===a.keyCode?(o.GD(d,!0),!1):void 0}).bind(I,function(){l.selectionStart=0,l.selectionEnd=l.value.length}).bind(J,function(){o.GD(d,!1)}),l.focus()}return!1},a.prototype.ED=function(b){var c,d,e,g,h=this,i={e:b,r:r};return a.ao(h,"preProcessMouseDbClick",i),c=i.r,m(c)?(d=f.GC$(h.Ws()).offset(),e=b.pageX-d.left,g=b.pageY-d.top,h.cE(e,g)):c},a.prototype.GD=function(a,b){var c,d,e,h,i=this,j=i.FD;j&&(f.GC$(j).unbind(H).unbind(I).unbind(J),c=j.value,b===!1&&(d=a.name(),c!==d&&(!m(c)&&""!==c&&l(c,i.OC.sheets,a)?(e={sheet:a,oldValue:d,newValue:c,cancel:!1},a.Wq(g.Events.SheetNameChanging,e),e.cancel===!1&&(a.wu().execute({cmd:"renameSheet",sheetName:d,name:c}),h={sheet:a,oldValue:d,newValue:c},a.Wq(g.Events.SheetNameChanged,h))):a.Wq(g.Events.InvalidOperation,{sheet:a,sheetName:a.name(),invalidType:5,message:Y().Exp_SheetNameInvalid}))),j.parentNode.removeChild(j),delete i.FD)},a.prototype.dE=function(){return this.OC.options.allowSheetReorder},a.prototype.LD=function(a,b){var c=this;c.dE()?(c.vD=b.index,c.TD=c.eE(c.vD),c.OD=new g.Point(a.pageX,a.pageY),c.tC()):c.PD=!1},a.prototype.eE=function(a){var b,c,d=this.OC.sheets,e=d.length;if(!(a>=e||a<0))return b=d[a].name(),b||(b="sheet"),c=f.GC$(n("span")).text(b).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"}),c.addClass("ui-widget-header gc-tab-tip-span btn-primary"),c},a.prototype.VD=function(){var a=this.ZD;a&&(clearTimeout(a),this.ZD=r)},a.prototype.QD=function(a,b){var c,d,e=this,g=e.TD;g&&0===f.GC$(".gc-tab-tip-span").length&&(g.appendTo(q.body),g.hide()),c=g.width(),d=g.height(),g.css({left:a-c/2,top:b-d/2}),g.show()},a.prototype.RD=function(a){var b=this,c=f.GC$(b.Ws()),d=c.position(),e=c.offset(),g=a.pageX-e.left,h=a.pageY-e.top,i=b.hitTest(g,h),j=i.element,k=b.Dr(),l=b.VC(),n=b.OC.sheets.length,o=100,q=k.x+b._C(),s=b.yD;g>q?b.wD===r&&b.uD<n&&(b.wD=p.setInterval(function(){b._D(b.sD()),b.uD===n?(b.SD(),s.css({left:d.left+b.fE()-T,top:d.top-T}),s.show()):(b.uD++,s.hide())},o)):g<l?b.wD===r&&b.uD>0&&(b.wD=p.setInterval(function(){b.$D(b.sD()),0===b.uD?(b.SD(),s.css({left:d.left+l-T,top:d.top-T}),s.show()):(b.uD--,s.hide())},o)):(b.SD(),j!==O&&b.Via().indexOf(j)===-1||(j!==O||m(i.index)?b.uD=b.OC.sheets.length:b.uD=i.index,s.css({left:d.left+i.position-T,top:d.top-T}),s.show()))},a.prototype.fE=function(){var a,b=this,c=b.WC,d=b.sD(),e=b.gE(b.gq,d),f=0,g=b.VC()+b.LC;for(a=e;a<d.length;a++)f=d[a],g+=c[f],g+=b.HC;return g},a.prototype.SD=function(){var a=this.wD;a&&(clearInterval(a),this.wD=r)},a.prototype.UD=function(){var a,b,c,d,e=this,f=e.OC,g=e.uD,h=e.vD,i=-1,j=f.getActiveSheet(),k=h,l=g;if(h<g-1&&(l=g-1),g!==-1&&h!==-1&&h!==g&&h!==g-1&&e.yD.isVisible()){if(a={sheet:j,sheetName:j.name(),oldIndex:k,newIndex:l,cancel:!1},_(f,a),a.cancel)return;if(b=f.sheets,c=void 0,d=b[h],h>g){for(c=h;c>g;c--)b[c]=b[c-1];b[g]=d,i=g}else if(h<g-1){for(c=h;c<g-1;c++)b[c]=b[c+1];b[g-1]=d,i=g-1}f.eq=i,e.fq(),aa(f,j,k,l)}},a.prototype.sD=function(){var a=[],b;for(b=0;b<this.OC.sheets.length;b++)this.hE(b)&&a.push(b);return a},a.prototype.YD=function(a){a.length>0&&this.gq!==a[0]&&this.OC.startSheetIndex(a[0])},a.prototype.$D=function(a){var b,c;a.length>0&&(b=this,b.gq>a[0]&&(c=b.rw(b.gq),c!==-1&&b.OC.startSheetIndex(c)))},a.prototype._D=function(a){var b,c;a.length>0&&(b=this,b.gq<a[a.length-1]&&(c=b.rD(a),c!==-1&&b.OC.startSheetIndex(b.jw(b.gq))))},a.prototype.aE=function(a){if(a.length>0&&this.gq<a[a.length-1]){var b=this.rD(a);b!==-1&&this.OC.startSheetIndex(b)}},a.prototype.rD=function(a){var b,c,d,e,f,g,h,i,j,k,l;if(a.length>0)for(b=this,c=b._C(),d=0,e=b.WC,f=void 0,g=void 0,h=b.cD(),i=b.gE(b.gq,a),i===-1&&(i=0),f=a.length-1;f>=i;f--)if(g=a[f],j=e[g],d+=j,f!==a.length-1&&(d+=b.HC),k=h+d,0!==f&&(k+=b.LC),k>c)return l=void 0,l=f+1<a.length?a[f+1]:a[a.length-1],b.gq<l?l:-1;return-1},a.prototype.rw=function(a){var b;for(b=a-1;b>=0;b--)if(this.hE(b))return b;return-1},a.prototype.jw=function(a){var b,c=this.OC.sheets.length;for(b=a+1;b<c;b++)if(this.hE(b))return b;return-1},a.prototype.gE=function(a,b){var c;for(c=0;c<=b.length-1;c++)if(a===b[c])return c;return-1},a.prototype.hE=function(a){var b=this.OC.sheets[a];return b&&b.visible()},a.prototype.fw=function(){this.xD++},a.prototype.gw=function(){var a=this;a.xD--,a.xD<=0&&(a.xD=0,a.repaint())},a.prototype.repaint=function(a){var b=this.Ws();b&&b.getContext&&this.jp(b.getContext(L),a)},a.prototype.jp=function(a,b){var c,d,e,f,h,i,j,k,l,m,o,p,q,u=this;if(!(u.xD>0)){if(c=u.Dr(),d=u.Xs,b){if(b.x>=c.x+c.width)return;if(b.y>=c.y+c.height)return;if(b.x+b.width>c.width&&(b.width=c.width-b.x,b.width<=0))return;if(b.y+b.height>c.height&&(b.height=c.height-b.y,b.height<=0))return;if(b.width<=0||b.height<=0)return}if(f=u.buffer,f&&(!f||f.width===d.width&&f.height===d.height)&&(f||f.width===c.width&&f.height===c.height)||(f&&g.En.Rn(u.OC,f),u.buffer=f=n(K),g.En.Kn(f,u.OC),g.En.Pn(f,c.width,c.height)),!(c.width<=0||c.height<=0||b&&(b.width<=0||b.height<=0))){e=u.buffer.getContext(L),e.clearRect(0,0,c.width,c.height),g.Bn.Dn(e,-c.x,-c.y),u.iE(e,b),g.Bn.Dn(e,c.x,c.y),h=c.x>=0?0:-c.x,i=c.y>=0?0:-c.y,j=h,k=i,b&&(j=c.x+b.x,k=c.y+b.y,c=new g.Rect(j,k,b.width,b.height)),h=c.x>=0?c.x:0,i=c.y>=0?c.y:0,o=r,p=g.En.Ln(d),q=g.En.Mn(d),d&&1!==p&&(j*=p,k*=q,c.x*=p,c.y*=q,c.width*=p,c.height*=q);try{d?b?(l=s(c.width-j,0),m=s(c.height-k,0)):(l=t(c.width-j,s(d.width-c.x,3)),m=t(c.height-k,s(d.height-c.y,3))):(j=b.x,k=b.y,l=b.width,m=b.height),d?(g.Bn.Cn(a,1,1),a.clearRect(h,i,l,m),a.drawImage(u.buffer,j,k,l,m,h,i,l,m),g.Bn.Cn(a,p,q)):(e=u.buffer.getContext(L),o=e.getImageData(j,k,l,m))}catch(a){return}!d&&o&&c.width>0&&c.height>0&&a.putImageData(o,h,i)}}},a.prototype.iE=function(a,b){var c,d,e,f,g,i,j,k,l,m=this,n=m.OC;if(a&&n){for(c=m.Dr(),a.save(),o(a,m._font),b?a.rect(b.x,b.y,b.width,b.height):a.rect(c.x,c.y,c.width,c.height),a.clip(),a.beginPath(),e=m.VC(),f=e,a.save(),a.font=h.To.Ro(a.font,"bold"),m.WC=[],i=n.sheets,g=0;g<i.length;g++)d=Math.round(a.measureText(i[g].name()).width)+m.GC+m.EC,m.WC.push(d);for(a.restore(),j=[],k=m.gq,k>0&&m.rw(k)>=0&&(f+=m.LC),k<0&&(k=0),g=k;g<i.length&&(l=i[g].visible(),d=m.WC[g],!(f>c.x+c.width));g++)j.push({i:g,x:f,w:d,t:i[g].name(),visible:l}),l&&(f+=d+m.HC);m.dD(a,c),m.fD(a,c,f,e),m.jE(a,c,j,k,e),m.OC&&m.OC.options.tabNavigationVisible&&m.kD(a,c,e),m.nD(a,c),a.beginPath(),a.restore()}},a.prototype.dD=function(a,b){},a.prototype.fD=function(a,b,c,d){},a.prototype.jE=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=k.OC,m=l.sheets,n=k.iD;if(k.$C=l.getActiveSheetIndex(),f=k.$C,m.length>0){for(a.save(),a.beginPath(),g=b.x+k._C(),a.rect(e,0,g-e,b.height),a.clip(),h=c.length-1;h>=0;h--)i=c[h],i.i!==f&&i.visible&&k.oD(a,i.x,0,i.w,b.height,5,!1,i.i===n,i.t);j=c[f-d],f>=d&&f<m.length&&j&&j.visible&&k.oD(a,j.x,0,j.w,b.height,5,!0,!1,j.t),a.restore(),a.save(),a.beginPath(),d>0&&k.rw(d)>=0&&k.jD(a,b,d,e),a.restore()}},a.prototype.jD=function(a,b,c,d){},a.prototype.kD=function(a,b,c){},a.prototype.nD=function(a,b){},a.prototype.mD=function(a,b,c,d,e,f,g,h,i,j){},a.prototype.oD=function(a,b,c,d,e,f,g,h,i){},a.prototype.Ws=function(){return this.Xs},a.prototype.kE=function(a,b){var c,d,e,f,h=a.createLinearGradient(b.x,b.y,b.width,b.height),j=g.Im.Km(i.VisualState.normal,"gc-tabStripBackground"),l=j&&j.backgroundImage,m=j&&j.backgroundColor;if(l&&l.indexOf("linear-gradient")!==-1)for(c=k(l),d=0,e=c.length;d<e;d++)f=c[d],h.addColorStop(f.point,f.color);else m&&(h.addColorStop(0,"#DDDDDD"),h.addColorStop(1,m));return h},a.prototype.pD=function(a,b,c,d){var e,f,h,i,j,l,m,n,o,p,q=this,r=q.Dr(),s=a.createLinearGradient(r.x+.7*r.height,r.y+0,.7*r.height,r.height),t=q.OC.getSheetFromName(c);if(""===c&&q.gq>0&&(t=q.OC.getSheet(q.gq-1)),e=t&&t.options.sheetTabColor)f="rgba(0, 0, 0, 0)",a.fillStyle=f,h=a.fillStyle,a.fillStyle=g.Rm.Om(t,e),i=a.fillStyle,i!==h&&(b?(s.addColorStop(0,S),s.addColorStop(.45,"#F1F6FD"),s.addColorStop(.9,i),s.addColorStop(1,S)):s=i);else if(d)if(j=d.backgroundImage,l=d.backgroundColor,j&&j.indexOf("linear-gradient")!==-1)for(m=k(j),n=0,o=m.length;n<o;n++)p=m[n],s.addColorStop(p.point,p.color);else l&&s.addColorStop(0,l);return s},a.prototype.qD=function(a,b){var c=R;return a&&(c=a.color),b&&j.dc(j.ec(b))<127.5&&(c=S),c},a}(),b.DC=Z,g.Zn(Z)},"./dist/core/workbook/workbook-json.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/workbook/workbook.js"),e=c("./dist/core/worksheet/style.js"),f=c("./dist/core/util/domUtil.js"),g=c("Common"),h=c("./dist/core/util/common.js"),i=c("CalcEngine"),j=!!i,k=e.Style.kxb,l=g.Commands.UndoManager,m=g.Common.CultureManager,n=f.GC$.each,o=h.Ul.Ol,p=parseFloat;function q(a,b){return a.hasOwnProperty(b)}function r(a){var b,c,d,e;if(!a||"string"!=typeof a)return 1;if(b=a.split("."),c=b.length,c>3)return 3;if(d=p(b[0]),c<=2)return isNaN(d)?1:d;if(e=p(b[1]),d>=10)return d;if(d>=3){if(e>=20143)return 3;if(e>=20142)return 2}return 1}function s(a,b){var c,d,e,f,g=this,h=b&&b.frozenColumnsAsRowHeaders,i=b&&b.frozenRowsAsColumnHeaders,j=0,k=a.sheets;if(i||h)for(d in k)"string"==typeof d&&(e=k[d],f=o(e.index)?e.index:e.mi,c=g.sheets[o(f)?f:j],i&&o(e.frozenRowCount)&&(c.$Bb=!0,c.deleteRows(0,e.frozenRowCount)),h&&o(e.frozenColCount)&&c.deleteColumns(0,e.frozenColCount),j++)}d.Workbook.prototype.toJSON=function(a){var b,c,e,g,k,l,m,o,p,r,s,t,u,v=this,w={version:h.productInfo.productVersion},x=a&&a.rowHeadersAsFrozenColumns,y=a&&a.columnHeadersAsFrozenRows,z=x||y;for(j&&(b=i.Functions.setLanguagepackage,b&&(c=b(),b("en"))),z&&(e=new d.Workbook,e.fromJSON(v.toJSON({includeBindingSource:!0})),v=e),v.mv=!0,v.suspendPaint(),v.suspendEvent(),j&&(g=v.Wu,g.calcOnDemand&&(g.calcOnDemand=!1,g.suspend(!0),g.resume(!0),g.calcOnDemand=!0),g.suspend(!0)),k=v.startSheetIndex(),k&&(w.startSheetIndex=k),n(v.options,function(a,b){"_ps"!==a&&d.Workbook.Qp[a]!==b&&(w[a]=b)}),l=v.getSheetCount(),l!==d.Workbook.nv&&(w.sheetCount=l),m=v.getActiveSheetIndex(),m!==d.Workbook.ov&&(w.activeSheetIndex=m),o={},p=0;p<l;p++)r=v.getSheet(p),o[r.name()]=r.toJSON(a),o[r.name()].index=p;if(f.GC$.isEmptyObject(o)||(w.sheets=o),s=[],t=v.Lq,t){for(u in t)q(t,u)&&s.push(t[u]);s.length>0&&(w.namedStyles=s)}return d.Workbook._n&&n(d.Workbook._n,function(b,c){c.toJson&&c.toJson.call(v,w,a)}),j&&b&&b(c),v.mv=!1,j&&v.Wu.resume(!1),v.resumeEvent(),v.resumePaint(),w},d.Workbook.prototype.fromJSON=function(a,b){var c,f,g,i,p,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S;if(a){c=this,f=r(a.version),g=f<3,i={noSchema:g,version:f},p=h.Vl.Xl(),c.mv=!0,c.suspendPaint(),c.suspendEvent(),t=m.culture(),m.culture("");try{c.T3(),c.pv=new l(c,(-1),c.options.allowUndo),j&&c.qv(!0),j&&c.Wu.suspendAdjust(),c.lv=-1,c.clearSheets(),u=c.options,v=a.canUserEditFormula,o(v)&&(u.allowUserEditFormula=v),w=a.allowDragDrop,o(w)&&(u.allowUserDragDrop=w),x=a.allowDragFill,o(x)&&(u.allowUserDragFill=x);for(y in u)q(u,y)&&(z=a[y],o(z)&&(u[y]=z));if(A=a.sheetCount,o(A)||(A=d.Workbook.nv),c.sw(A,0),c.Lq={},B=a.namedStyles)for(C=0,D=B;C<D.length;C++)E=D[C],F=new e.Style,k(E,c),F.fromJSON(E,g,c),c.Kq(F);if(G=0,H=void 0,I=a.sheets,J=void 0,K=void 0,L=!1,M=!0,I)for(N in I)"string"==typeof N&&(O=I[N],P=o(O.index)?O.index:O.mi,H=c.sheets[o(P)?P:G],H.fromJSON(O,!1,i,b,!0),G++,K=O.allowUndo,L?M=M&&K===J:(J=K,L=!0));o(J)&&M&&(u.allowUndo=J),Q=a.activeSheetIndex,o(Q)||(Q=d.Workbook.ov),c.dq(Q,0),R=a.startSheetIndex,o(R)&&c.startSheetIndex(R),d.Workbook._n&&n(d.Workbook._n,function(d,e){var f=e.fromJson;f&&f.call(c,a,g,b)}),j&&c.Wu.resumeAdjust(),s.call(c,a,b)}finally{j&&c.Wu.resumeAdjust(),m.culture(t),c.mv=!1,S=c.getActiveSheet(),p&&S&&S.zt(),c.resumeEvent(),c.fq(),c.resumePaint(),S&&c.Wq(h.Events.FormulatextboxActiveSheetChanged,{oldSheet:void 0,newSheet:S})}}}},"./dist/core/workbook/workbook.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("Common"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),h=c("./dist/core/util/imageLoader.js"),i=c("./dist/core/worksheet/worksheet-actions.js"),j=c("./dist/core/workbook/workbookpanelex.js"),k=c("./dist/core/workbook/sheettab.js"),l=c("./dist/core/workbook/sheettab2007.js"),m=c("./dist/core/worksheet/stylehelper.js"),n=c("./dist/core/worksheet/clipboardhelper.js"),o=c("./dist/core/worksheet/worksheet.js"),p=c("CalcEngine"),q=!!p,r=c("./dist/core/core.enum.js"),s=e.Common.u,t=e.Commands.UndoManager,u=e.Commands.CommandManager,v=f.GC$.each,w=f.GC$.extend,x=q,y=e.Common.j.Fa,z=g.Ul.Nl,A=g.Ul.Pl,B=g.Ul.Ql,C=g.Ul.hZa,D=e.Common.CultureManager,E=parseInt,F=window,G=document,H=null,I=Math.round,J=Math.min,K=Math.abs,L="number",M="mousedown",N="mouseup",O="scroll",P="resize",Q="focus",R=".gcSpread",S=".gcSpreadInternal",T=".gcScrollbar",U="div",V="table",W="px",X="gc-scroll-handle",Y="gc-scroll-bar",Z="none",$="absolute",_="content-box",aa="solid",ba=" ui-widget-header ui-state-default btn btn-default",ca=F.jQuery,da="cultureChanged",ea="workbook",fa="gcUIElement",ga="gc-no-user-select",ha="visible",ia="overflow",ja="en-US",ka=new e.Common.ResourceManager(d.SR),la=ka.getResource.bind(ka);function sa(a){return a.getActiveSheet()}function ta(a,b){return F.setTimeout(function(){a.invalidateLayout(),a.repaint(),b.uHb=H},200)}function ua(a,b,c){a.Wq(g.Events.ActiveSheetChanged,{oldSheet:b,newSheet:c})}function va(a,b){a.Wq(g.Events.ActiveSheetChanging,b)}function wa(a,b){a.Wq(g.Events.FormulatextboxActiveSheetChanging,b)}function xa(a,b,c){a.Wq(g.Events.FormulatextboxActiveSheetChanged,{oldSheet:b,newSheet:c})}ma=100,na=30,oa=40,pa=function(){function a(a){this.yw=a}return a.Lv=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,s,t=b.data,u=sa(t);u&&c&&(d=c.newValue,e=c.oldValue,f=c.scrollEventType,g=E(d+"",10),h=void 0,g=u.du(g),e=c.oldValue=y(e)?0:E(e+"",10),u.oq=!1,i=u.$t(),j=u.ps(),k=t.options.scrollbarShowMax,l=0,m=t.options.scrollByPixel,m&&5!==f?(n=g-e,0===n&&(0===f||2===f?n=-1:1!==f&&3!==f||(n=1)),o=a._Bb(u,n),g=o.dj,l=o.UP,k||(u.oq=!0,c.ignoreUpdatePosition=!0)):(f===r.Nxb.largeDecrement||f===r.Nxb.smallDecrement?(f===r.Nxb.largeDecrement&&(g=u.zw()),h=u.Ot(g,!0),h!==-1&&h!==g&&(g=h),k||(u.oq=!0,c.ignoreUpdatePosition=!0)):f!==r.Nxb.largeIncrement&&f!==r.Nxb.smallIncrement||(f===r.Nxb.largeIncrement&&(g=u.Aw(),g===u.qq&&g++),k||(u.oq=!0,f===r.Nxb.smallIncrement&&d===e&&g++),h=u.Ot(g),h!==-1&&h!==g&&(g=h)),g<i&&(g=i),g>j&&(g=j)),p=u.Qt(g),d!==p&&(c.newValue=p),q=p,s=u.ss._m(g),0!==s&&(q+=K(l)/s),c.newValueWithOffset=q,(e!==p||m)&&t.ku.Bw(g,l,!0))},a.Mv=function(a){var b,c,d,e,f,g=a.data,h=sa(g);h&&(b=g.Pt,c=h.du(b.value()),d=h.$t(),e=h.ps(),f=h.Cw,c<d?b.value(h.Qt(d)):c>e&&b.value(h.Qt(e)),g.xw(),g.options.scrollbarShowMax||(g.ku.scrolling?h.oq=!0:g.Ut()),f&&f.focus())},a.Nv=function(a){var b,c,d,e,g,h=a.data;h&&(b=sa(h),b&&(c=h.Pt.xR,c&&c.mR&&(b.CH=!0),b.zt(),d=h.options.showScrollTip,1!==d&&3!==d||(e=f.GC$(a.srcElement||a.target),g=e.parent(),(e&&(e.hasClass(X)||e.hasClass(Y))||g&&(g.hasClass(X)||g.hasClass(Y)))&&h.ku.Dw(!1,a))))},a.Dv=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,s,t=b.data,u=sa(t);u&&c&&(d=c.newValue,e=c.oldValue,f=c.scrollEventType,g=E(d+"",10),h=void 0,g=u.cu(g),e=c.oldValue=y(e)?0:E(e+"",10),u.jq=!1,i=u._t(),j=u.ns(),k=t.options.scrollbarShowMax,l=0,m=t.options.scrollByPixel,m&&5!==f?(n=g-e,0===n&&(0===f||2===f?n=-1:1!==f&&3!==f||(n=1)),o=a.aCb(u,n),g=o.cj,l=o.UP,k||(u.jq=!0,c.ignoreUpdatePosition=!0)):(f===r.Nxb.largeDecrement||f===r.Nxb.smallDecrement?(f===r.Nxb.largeDecrement&&(g=u.Ew()),h=u.Rt(g,!0),h!==-1&&h!==g&&(g=h),k||(u.jq=!0,c.ignoreUpdatePosition=!0)):f!==r.Nxb.largeIncrement&&f!==r.Nxb.smallIncrement||(f===r.Nxb.largeIncrement&&(g=u.Fw(),g===u.lq&&g++),k||(u.jq=!0,f===r.Nxb.smallIncrement&&d===e&&g++),h=u.Rt(g),h!==-1&&h!==g&&(g=h)),g<i&&(g=i),g>j&&(g=j)),p=u.Tt(g),d!==p&&(c.newValue=p),q=p,s=u.ss.Sl(g),0!==s&&(q+=K(l)/s),c.newValueWithOffset=q,(e!==p||m)&&t.ku.Bw(g,l))},a.Ev=function(a){var b,c,d,e,f,g=a.data,h=sa(g);h&&(b=g.St,c=h.cu(b.value()),d=h._t(),e=h.ns(),f=h.Cw,c<d?b.value(h.Tt(d)):c>e&&b.value(h.Tt(e)),g.xw(),g.options.scrollbarShowMax||(g.ku.scrolling?h.jq=!0:g.Xt()),f&&f.focus())},a.Fv=function(a){var b,c,d,e,g,h=a.data;h&&(b=sa(h),b&&(c=h.St.xR,c&&c.mR&&(b.CH=!0),b.zt(),d=h.options.showScrollTip,2!==d&&3!==d||(e=f.GC$(a.srcElement||a.target),e&&(g=e.parent(),(e.hasClass(X)||g&&g.hasClass(X)||e.hasClass(Y)||g&&g.hasClass(Y))&&h.ku.Dw(!0,a)))))},a.Gv=function(a){var b=a.data;b&&b.xw()},a.prototype.no=function(){this.yw=H},a.prototype.Bw=function(a,b,c){var d=this,e=sa(d.yw);e&&(d.Gw=!0,d.Hw=c?e.lq:a,d.bCb=c?e.cCb:b,d.Iw=c?a:e.qq,d.dCb=c?b:e.eCb,F.setTimeout(function(){d.Kw()},0))},a.prototype.Kw=function(){var a=this,b=sa(a.yw);b&&a.Gw&&(a.Gw=!1,a.Lw())},a.prototype.Lw=function(){var a,b,c,d,e,f,g,h=this;h.Mw||(h.Mw=!0,a=h.yw,b=sa(a),b&&(c=a.options.showScrollTip,d=h.Hw,e=h.bCb,f=h.Iw,g=h.dCb,d!==b.lq||e!==b.cCb?(h.ju(d,e),2!==c&&3!==c||a.ww(h.Nw(!0))):f===b.qq&&g===b.eCb||(h.lu(f,g),1!==c&&3!==c||a.ww(h.Nw(!1)))),h.Mw=!1)},a.prototype.ju=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this;if(E.uHb&&(F.clearTimeout(E.uHb),E.uHb=H),d=sa(E.yw)){if(e=d.lq,f=d.cCb,!c&&a===e&&b===f)return;if(d.lq=a,d.cCb=b,d.Xq>0)return void d.Wq(g.Events.TopRowChanged,{sheet:d,sheetName:d.name(),oldTopRow:e,newTopRow:a});if(h=!1,i=d.options,j=i.sheetAreaOffset.top,k=j+2,l=d.Zs,m=d.am(),n=m.qt,o=m.jr,p=void 0,q=void 0,r=m.width+i.sheetAreaOffset.left,s=void 0,t=d.yl,u=t.bm(),d.tables&&(v=d.tables.vHb(),v&&(v.x=v.x-2,v.width=v.width+4,v.y=j,v.height=n,t.AI(u,v))),a>e||a===e&&K(b)>K(f)){if(w=void 0,x=void 0,y=d.Gr(1),y&&y.length>0&&(w=y.findRow(a)),w){for(z=y.length-1,x=y[z];x&&x.y+x.height>n+o;)z-=1,x=y[z];x&&x.row>a&&(h=!0,p=l?l.x:m.x,q=w.y+K(b),s=x.y+x.height-q-k,t.Ow(p,q,r,s,p,n),i.colHeaderVisible||(d.invalidateLayout(),t._l(u,new g.Rect(p,0,r,j))),d.invalidateLayout(),t._l(u,new g.Rect(p,n+s,r,o-s)),t.Pw(u,new g.Rect(p,n-2,r,o+2)))}}else{for(A=0,B=a;B<e&&A<o;B++)A+=d.Sl(B);A+=K(f)-K(b),A<o&&(h=!0,p=l?l.x:m.x,q=n,s=o-A,d.frozenTrailingRowCount()>0&&(s-=1),t.Ow(p,q,r,s,p,q+A),d.invalidateLayout(),C=d.rowOutlines&&!d.rowOutlines.iT()?d.rowOutlines.s0a()+j+1:0,t._l(u,new g.Rect(p,q-j,r,A+j+C+5)),t.Pw(u,new g.Rect(p,n-2,r,o+2)))}h||(d.invalidateLayout(),d.repaint()),d.Wq(g.Events.TopRowChanged,{sheet:d,sheetName:d.name(),oldTopRow:e,newTopRow:a}),D=d.mm,D&&D.Qw(),h&&g.En.npb()%1!==0&&(E.uHb=ta(d,E))}},a.prototype.lu=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this;if(D.uHb&&(F.clearTimeout(D.uHb),D.uHb=H),d=sa(D.yw)){if(e=d.qq,f=d.eCb,!c&&a===e&&b===f)return;if(d.qq=a,d.eCb=b,d.Xq>0)return void d.Wq(g.Events.LeftColumnChanged,{sheet:d,sheetName:d.name(),oldLeftCol:e,newLeftCol:a});if(h=!1,i=d.options,j=i.sheetAreaOffset.left,k=j+2,l=d.Zs,m=d.am(),n=m.pt,o=m.er,p=void 0,q=void 0,r=void 0,s=m.height+i.sheetAreaOffset.top,t=d.yl,u=t.bm(),a>e||a===e&&K(b)>K(f)){if(v=void 0,w=void 0,x=d.Hr(1),x&&x.length>0&&(v=x.findCol(a)),v){for(y=x.length-1,w=x[y];w&&w.x+w.width>n+o;)y-=1,w=x[y];w&&w.col>a&&(h=!0,p=v.x+K(b),q=l?l.y:m.y,r=w.x+w.width-p-k,t.Ow(p,q,r,s,n,q),i.rowHeaderVisible||(d.invalidateLayout(),t._l(u,new g.Rect(0,q,j,s))),d.invalidateLayout(),t._l(u,new g.Rect(n+r,q,o-r,s)),t.Pw(u,new g.Rect(n-2,q,o+2,s)))}}else{for(z=0,A=a;A<e&&z<o;A++)z+=d.Tl(A);z+=K(f)-K(b),z<o&&(h=!0,p=n,q=l?l.y:m.y,r=o-z,d.frozenTrailingColumnCount()>0&&(r-=1),t.Ow(p,q,r,s,p+z,q),d.invalidateLayout(),B=d.columnOutlines&&!d.columnOutlines.iT()?d.columnOutlines.s0a()+j+1:0,t._l(u,new g.Rect(p-j,q,z+j+B+5,s)),t.Pw(u,new g.Rect(n-2,q,o+2,s)))}h||(d.invalidateLayout(),d.repaint()),d.Wq(g.Events.LeftColumnChanged,{sheet:d,sheetName:d.name(),oldLeftCol:e,newLeftCol:a}),C=d.mm,C&&C.Qw(),h&&g.En.npb()%1!==0&&(D.uHb=ta(d,this))}},a.prototype.Rw=function(a,b,c){var d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this,w=v.yw,x=sa(w),y=!1,z=!1,A=w.options.scrollbarShowMax;if(x){if(a.ctrlKey){if(!w.options.allowUserZoom)return!0;if(d=x.zoom(),e=d-.05*b,x.isEditing()&&!x.endEdit())return;x.wu().execute({cmd:"zoom",sheetName:x.name(),oldZoomFactor:d,zoomFactor:e}),e=x.zoom(),d!==e&&x.Wq(g.Events.UserZooming,{sheet:x,sheetName:x.name(),oldZoomFactor:d,newZoomFactor:e})}else c=c||0,f=x.lq,h=x.cCb,i=v.ms(x,b),j=i.cj,k=i.UP,f!==j||h!==k?(v.ju(j,k),x.os(),A||x.es()):y=!0,l=x.qq,m=x.eCb,n=v.Sw(x,c),o=n.dj,p=n.UP,l!==o||m!==p?(v.lu(o,p),x.qs(),A||x.ds()):z=!0;q=x.Vs(),r=x.hitTest(a.pageX-q.left,a.pageY-q.top),s=x.yt,t=s&&s.cellTypeHitInfo,t&&(t.cellRect=x.getCellRect(s.row,s.col)),u=x.mm,u.Tw(r),u.Uw(r)}return y&&z},a.aCb=function(a,b){var c,d,e,f,g,h,i,j,k=a.lq,l=a.cCb,m=a.parent,n=b*m.options.scrollPixel*a.zoom(),o=0,p=a.ss,q=a.am().qt,r=a.jt(1).findRow(k);if(r)if(n<0){for(c=a.Rt(-1),o=-(q-r.y);k>c&&o>n;)k--,o-=p.Sl(k);l=o-n,k===c&&l>0&&(l=0)}else if(n>0){for(d=a.ns(),o=r.y+r.height-q;k<d&&o<n;)k++,o+=p.Sl(k);e=p.Sl(k),l=o-n-e,m.options.scrollbarMaxAlign?(f=a.am(),g=a.frozenRowCount(),h=a.getRowCount()-a.frozenTrailingRowCount()-1,i=a.wHb(f.jr,g,h),d=i.cj,j=i.UP,k>d?(k=d,l=j):k===d&&K(l)>K(j)&&(l=j)):k<d&&o-n===0?(k++,l=0):k===d&&o-n<0&&(l=-e)}return{cj:k,UP:l}},a.prototype.ms=function(b,c){var d,e,f,g,h=b.lq,i=b.cCb,j=b.parent;return j&&j.options.scrollByPixel?a.aCb(b,c):(d=b.frozenRowCount(),d>0&&(0===h&&c>0?h=d:c<0&&h===d-c&&(h=0)),e=b.Rt(h+c,c<0),e!==-1?h=e:h+=c,f=b._t(),g=b.ns(),b.getRowCount()-d-b.frozenTrailingRowCount()<=0||f===H?h=b.lq:(h<f?h=f:h>g&&(h=g),h===H&&(h=-1)),{cj:h,UP:i})},a._Bb=function(a,b){var c,d,e,f,g,h,i,j,k=a.qq,l=a.eCb,m=a.parent,n=b*m.options.scrollPixel*a.zoom(),o=0,p=a.ss,q=a.am().pt,r=a.it(1).findCol(k);if(r)if(n<0){for(c=a.Ot(-1),o=-(q-r.x);k>c&&o>n;)k--,o-=p._m(k);l=o-n,k===c&&l>0&&(l=0)}else if(n>0){for(d=a.ps(),o=r.x+r.width-q;k<d&&o<n;)k++,o+=p._m(k);e=p._m(k),l=o-n-e,m.options.scrollbarMaxAlign?(f=a.am(),g=a.frozenColumnCount(),h=a.getColumnCount()-a.frozenTrailingColumnCount()-1,i=a.xHb(f.er,g,h),d=i.dj,j=i.UP,k>d?(k=d,l=j):k===d&&K(l)>K(j)&&(l=j)):k<d&&o-n===0?(k++,l=0):k===d&&o-n<0&&(l=-e)}return{dj:k,UP:l}},a.prototype.Sw=function(b,c){var d,e,f,g,h=b.qq,i=b.eCb,j=b.parent;return j&&j.options.scrollByPixel?a._Bb(b,c):(d=b.frozenColumnCount(),d>0&&(0===h&&c>0?h=d:c<0&&h===d-c&&(h=0)),e=b.Ot(h+c,c<0),e!==-1?h=e:h+=c,f=b.$t(),g=b.ps(),b.getColumnCount()-d-b.frozenTrailingColumnCount()<=0||f===H?h=b.qq:(h<f?h=f:h>g&&(h=g),h===H&&(h=-1)),{dj:h,UP:i})},a.prototype.Dw=function(a,b){var c,d,e=this,f=e.yw,g=sa(f);g&&(a?(c=b.pageY,d=b.pageX-ma):(c=b.pageY-oa,d=b.pageX-na),f.uw(e.Nw(a),d,c,!0))},a.prototype.Nw=function(a){var b,c=sa(this.yw),d=c.qq+1;return c&&(a?b=la().Tip_Row+(c.lq+1):(1!==c.options.colHeaderAutoText&&(d=g.Ul.xq(d)),b=la().Tip_Column+d)),b},a}(),qa={allowUserDragDrop:!0,allowUserDragFill:!0,allowUserZoom:!0,allowUserResize:!0,allowUndo:!0,allowSheetReorder:!0,allowContextMenu:!0,allowUserDeselect:!0,defaultDragFillType:5,showDragFillSmartTag:!0,showHorizontalScrollbar:!0,showVerticalScrollbar:!0,scrollbarShowMax:!0,scrollbarMaxAlign:!1,tabStripVisible:!0,tabStripRatio:.5,tabEditable:!0,newTabVisible:!0,cutCopyIndicatorVisible:!0,cutCopyIndicatorBorderColor:"#217346",tabNavigationVisible:!0,backColor:"white",backgroundImage:H,backgroundImageLayout:0,showResizeTip:r.ShowResizeTip.none,showDragDropTip:!0,showDragFillTip:!0,scrollIgnoreHidden:!1,highlightInvalidData:!1,showScrollTip:r.ShowScrollTip.none,grayAreaBackColor:H,useTouchLayout:!1,hideSelection:!1,resizeZeroIndicator:r.ResizeZeroIndicator.enhanced,allowUserEditFormula:!0,enableFormulaTextbox:!0,referenceStyle:0,allowDynamicArray:!1,calcOnDemand:!1,autoFitType:r.AutoFitType.cell,allowCopyPasteExcelStyle:!0,allowExtendPasteRange:!1,copyPasteHeaderOptions:r.CopyPasteHeaderOptions.allHeaders,allowUserDragMerge:!1,rowResizeMode:r.ResizeMode.normal,columnResizeMode:r.ResizeMode.normal,scrollByPixel:!1,scrollPixel:5,font:H,customList:[]};function ya(a,b,c){var d,e,h=g.Im.Lm("gc-vertical-scrollbar"+ba),i=E(h.zIndex)>2007?1:0,j=b-c;j%2===0?(d=j/2,e=d-i):(d=(j-i)/2,e=d),f.GC$(a).css({"box-sizing":_,border:Z,"border-color":Z,"border-left-style":aa,"border-left-width":i+W,"border-left-color":h.borderLeftColor,"background-color":h.backgroundColor,width:c,padding:"0px "+d+"px 0px "+e+W,margin:0})}function za(a,b,c){var d,e,h=g.Im.Lm("gc-horizontal-scrollbar"+ba),i=E(h.zIndex)>2007?1:0,j=b-c;j%2===0?(d=j/2,e=d-i):(d=(j-i)/2,e=d),f.GC$(a).css({"box-sizing":_,border:Z,"border-color":Z,"border-top-style":aa,"border-top-width":i+W,"border-top-color":h.borderTopColor,"background-color":h.backgroundColor,height:c,padding:e+"px 0px "+d+"px 0px",margin:0})}function Aa(a,b,c){var d=g.Im.Lm("gc-footer-corner"+ba);f.GC$(a).css({border:Z,padding:0,margin:0,width:b+W,height:c+W,"background-color":d.backgroundColor})}ra=function(){function a(a,b){var c,d,e=this;e.name="",e.kv=!1,e.lv=-1,e.eq=0,e.mv=!1,e.options=B(qa,function(a,b,c){e.Op(a,b,c)}),e.T3(b),b&&"white"===b.backColor?e.Sxb=!0:e.Sxb=!1,c=1,b&&(d=b.sheetCount,typeof d===L&&(c=d)),e.qo=a,e.ad(c,a)}return a.prototype.commandManager=function(){return this.wu},a.prototype.undoManager=function(){return this.pv},a.prototype.Txb=function(){var a=this.Uxb(),b=this.Vxb;return b instanceof Array?b.concat(a):a},a.prototype.Uxb=function(){var a=D.culture(),b=[],c=[],d=D.q4(ja).DateTimeFormat,e=D.q4(a).DateTimeFormat;return b=this.Wxb(d),a!==ja&&(c=this.Wxb(e)),b.concat(c)},a.prototype.Wxb=function(a){var b=[],c,d;return this.Xxb=["abbreviatedDayNames","dayNames","abbreviatedMonthNames","monthNames"],this.Xxb.forEach(function(e){c=a[e],c instanceof Array&&c.length>0&&(d=e.indexOf("month")>-1||e.indexOf("Month")>-1,c=d?c.slice(0,12):c,b.push(c))}),b},a.prototype.Op=function(a,b,c){var d,e=this,f=sa(e),g=x&&e.Cf();switch(a){case"allowUndo":e.pv&&(e.pv.zc=b);break;case"backColor":e.Sxb=!0,f&&f.$p();break;case"cutCopyIndicatorBorderColor":case"cutCopyIndicatorVisible":case"grayAreaBackColor":case"hideSelection":case"highlightInvalidData":case"resizeZeroIndicator":case"allowUserDragFill":case"allowUserDragMerge":f&&f.$p();break;case"backgroundImage":case"backgroundImageLayout":e.Ys(),f&&f.$p();break;case"newTabVisible":case"tabNavigationVisible":d=e.hq,d&&d.repaint();break;case"showHorizontalScrollbar":case"showVerticalScrollbar":case"useTouchLayout":case"tabStripVisible":e.fq();break;case"tabStripRatio":e.aq();break;case"scrollIgnoreHidden":case"scrollbarMaxAlign":case"scrollbarShowMax":f&&(f.oq=!0,f.jq=!0,f.$p());break;case"scrollByPixel":f&&(f.cCb=0,f.eCb=0,f.$p());break;case"calcOnDemand":g&&(g.calcOnDemand=b);break;case"customList":e.Vxb=b;break;case"referenceStyle":case"allowDynamicArray":e.yHb(a,b)}},a.prototype.yHb=function(a,b){var c=this,d=x&&c.Cf();if(d)switch(a){case"referenceStyle":d.useR1C1=1===b;break;case"allowDynamicArray":d.allowDynamicArray=b}},a.prototype.ad=function(b,c){var d,e,f,g=this;for(x&&g.qv(),g.rv=[],g.sv=z("input"),g.jm=0,g.xD=0,g.tv={fromSheet:H,isCutting:!1},g.mmb={fromSheet:H,isCutting:!1},g.Ks=H,g.sheets=[],g.Lq={},g.Vxb=g.options.customList,g.pv=new t(g,(-1),g.options.allowUndo),d=g.wu=new u(g),d.addListener("workbookUndo",function(a){var b=a.command,c=i.Commands.aWa(b),d=g.wu[b.cmd];d&&d.canUndo()&&!c&&!b.yTa&&g.undoManager().Cc(b,a.s4)}),i.Commands.uv(d),a.ao(g,"init"),e=0;e<b;e++)f=g.vv(g.wv(e)),g.sheets.push(f),f.Ls(g);g.suspendPaint(),c&&g.ws(c),g.uu=new n.S4(g),g.resumePaint()},a.prototype.hitTest=function(a,b,c){var d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=this,G=F.getActiveSheet(),I=F.hq,J=F.Pt,K=F.St,L=f.GC$(F.getHost()).width(),M=f.GC$(F.getHost()).height();if(a<0||a>L||b<0||b>M)return H;if(d=F.oia(),G&&(e=G.Vs(),g=G.Dr(),h=e.left-d.left,i=e.top-d.top,a>h&&a<g.width+h&&b>i&&b<g.height+i))return{worksheetHitInfo:G.hitTest(a-h,b-i,!1,c),x:a,y:b};if(j=f.GC$(I.Ws()).offset(),k=I.Dr(),l=j.left-d.left,m=j.top-d.top,a>l&&a<k.width+l&&b>m&&b<k.height+m){switch(n=I.hitTest(a-l,b-m),o={},p=n.index,q=F.sheets[p],r=q&&q.name(),n.type){case"navButton":o={navButton:n.element};break;case"sheetTab":o={sheetTab:{sheetName:r||n.element,sheetIndex:p}};break;case"resize":o={resize:!0};break;default:o={blank:!0}}return{tabStripHitInfo:o,x:a,y:b}}return s=f.GC$(J.Bv()).offset(),t=J.pia(),u=s.left-d.left,v=s.top-d.top,a>u&&a<t.width+u&&b>v&&b<t.height+v?{horizontalScrollBarHitInfo:{element:J.hitTest(a-u,b-v).element},x:a,y:b}:(w=f.GC$(K.Bv()).offset(),x=K.pia(),y=w.left-d.left,z=w.top-d.top,a>y&&a<x.width+y&&b>z&&b<x.height+z?{verticalScrollBarHitInfo:{element:K.hitTest(a-y,b-z).element},x:a,y:b}:(A=f.GC$(F.Ov).offset(),B=parseInt(F.Ov.style.width.substr(0,F.Ov.style.width.indexOf("px")),10),C=parseInt(F.Ov.style.height.substr(0,F.Ov.style.height.indexOf("px")),10),D=A.left-d.left,E=A.top-d.top,a>D&&a<B+D&&b>E&&b<C+E?{footerCornerHitInfo:{element:"footerCorner"},x:a,y:b}:void 0))},a.prototype.oia=function(){var a=this,b;return b=ca?ca(a.qo).offset():f.GC$(a.qo).offset(),b?(b.top+=G.body.clientTop||0,b.left+=G.body.clientLeft||0):b={top:0,left:0},b},a.prototype.T3=function(a){var b=this.options,c=a||{};c=w(!0,{},qa,c),v(c,function(a,c){b.hasOwnProperty(a)&&(b[a]=c)})},a.prototype.xv=function(){var a=this;return!a.Ks&&a.qo&&(a.Ks=z(U),f.GC$(a.Ks).css({position:"relative",left:0,top:0,height:0}),f.GC$(a.qo).prepend(a.Ks)),a.Ks},a.prototype.wv=function(a){var b,c,d,e,f,g,h=this,i=h.getSheetCount();h.lv<i?h.lv=i:h.lv++,(y(a)||a<h.lv)&&(a=h.lv),b=!1,d=h.sheets;do for(c="Sheet"+(a+1),e=d.length,f=0;f<e;f++)if(g=d[f]){if(g.name().toUpperCase()===c.toUpperCase()){a++,b=!0;break}b&&(b=!1)}while(b);return c},a.prototype.vv=function(a){return new o.Worksheet(a)},a.prototype.ws=function(b){var c,d,e,g,h,i,k,l,m,n,o,p,q,r,s,t,u,v,w=this;if(b){for(w.qo=b,ca&&ca(b).data(ea,w),f.GC$(b).data(ea,w).attr(fa,"gcSpread").addClass(ga).css(ia,ha),F.Yl.qm(),w.cultureChangedHandler=function(){w.Av()},G.addEventListener(da,w.cultureChangedHandler),c=z(V),d=c.style,e=void 0,g=void 0,h=void 0,i=void 0,k=void 0,l="100%",c.cellSpacing="0px",c.cellPadding="0px",c.border="0",d.width=l,d.height=l,d.border="0",d.margin="0",d.borderCollapse="collapse",e=0;e<2;e++){for(h=z("tr"),g=0;g<2;g++)i=z("td"),k=i.style,k.padding=0,k.border=0,
h.appendChild(i);c.appendChild(h)}for(b.appendChild(c),w.xs=z(U),w.xs.id=b.id+"vp",f.GC$(c.rows[0].cells[0]).append(w.xs),w.St=new j.hv((!1)),m=w.St.Bv(),n=w.Cv=z(U),f.GC$(n).append(m),f.GC$(c.rows[0].cells[1]).append(n),f.GC$(m).bind(O+T,function(a,b){var c=b.scrollEventType;a.data=w,1===b.scrollOrientation&&(0===c||1===c||2===c||3===c||5===c?pa.Dv(a,b):4===c&&pa.Ev(a))}).bind(M+T,function(a){a.data=w,pa.Fv(a)}).bind(N+T,function(a){a.data=w,pa.Gv(a)}),o=z(V),p=o.style,o.cellSpacing="0",o.cellPadding="0",o.border="0",p.border="0",p.margin="0",f.GC$(o).css("user-select",Z),h=z("tr"),g=0;g<2;g++)i=z("td"),k=i.style,k.padding=0,k.border=0,h.appendChild(i);o.appendChild(h),f.GC$(c.rows[1].cells[0]).append(o),q=void 0,r=void 0,q=w.Hv=z(U),r=q.style,r.width=""+w.Iv()*f.GC$(b).width()+W,r.height=""+w.Jv()+W,r.fontSize="10pt",r.fontFamily="Arial",f.GC$(o.rows[0].cells[0]).append(q),w.Pt=new j.hv((!0)),s=w.Pt.Bv(),t=w.Kv=z(U),f.GC$(t).append(s),f.GC$(o.rows[0].cells[1]).append(t),f.GC$(s).bind(O+T,function(a,b){var c=b.scrollEventType;a.data=w,0===b.scrollOrientation&&(0===c||1===c||2===c||3===c||5===c?pa.Lv(a,b):4===c&&pa.Mv(a))}).bind(M+T,function(a){a.data=w,pa.Nv(a)}).bind(N+T,function(a){a.data=w,pa.Gv(a)}),w.Ov=z(U),f.GC$(c.rows[1].cells[1]).append(w.Ov),w.ku=new pa(this),u=w.oTa=function(){w.Pv()},f.GC$(F).bind(P+R,u),v=sa(w),v&&v.ws(w.xs),w.Qv(),w.fq(),w.Rv(b),a.ao(w,"setHost",b)}},a.prototype.Rv=function(a){var b=this,c="tabindex",d=E(f.GC$(a).attr(c),10)||0,e=z(U);f.GC$(e).css({position:$,overflow:"hidden"}).attr(fa,"gcSheetFocusElementForTab").attr(c,d).bind(Q,function(){b.Sv||sa(b).zt(),b.Sv=!1}),a.insertBefore(e,H),b.Tv=e},a.prototype.Uv=function(){var a=this,b=a.Tv;b&&(a.Sv=!0,b.focus())},a.prototype.no=function(){var b,c,d,e,h,i,j=this,k=j.Pt,l=j.St,n=j.sheets;for(g.En.Tn(j),g.Ul.no(),j.oTa&&f.GC$(F).unbind(P+R,j.oTa),j.Zv&&clearTimeout(j.Zv),k&&k.dispose(),l&&l.dispose(),j.mu(),g.Vl.Xl()===j.getActiveSheet()&&g.Vl.Zl(H),b=0;b<n.length;b++)n[b].no(!0);n.splice(0,n.length),c=j.uu,c&&(c.no(),j.uu=H),d=j.qo,h="class",i="unselectable",d&&(e=f.GC$(d),G.removeEventListener(da,j.cultureChangedHandler),e.html("").removeAttr(fa).removeClass(ga),e.attr(h)||e.removeAttr(h),e.attr(i)||e.removeAttr(i),e.data(ea)&&e.data(ea,H),ca&&ca(d).data(ea)&&ca(d).data(ea,H)),j.Kv=H,j.Cv=H,j.pv&&(j.pv.no(),j.pv=H),j.hq&&(j.hq.no(),j.hq=H),a.ao(j,"dispose"),j.Tv&&(f.GC$(j.Tv).unbind(Q),j.Tv=H),j.Wu&&(j.Wu.dispose(),j.Wu=H,j.yv=H,j.zv=H),j.bt&&(j.bt.no(),j.bt=H),m.To.no(),j.wu&&(j.wu.no(),j.wu=H),j.ku&&(j.ku.no(),j.ku=H)},a.prototype.mu=function(){var a=this,b=a.sheets,c,d;for(f.GC$(a.sv).unbind(R),c=0;c<b.length;c++)d=b[c],d.mu()},a.prototype.Qv=function(){var a,b,c,d=this,e=E(g.Im.Lm("").zIndex),f=e!==d.Vv,h=d.qo,i=h.getAttribute("id")+"_tabStrip",j=d.hq;f&&(d.Vv=e),a=d.Jv(),b=d.Wv(),c=d.Xv(),j&&!f?j.repaint():(j&&j.no(),j=d.hq=e>2007?new k.iv(i):new l.jv(i),j.Yv(d),j.ws(d.Hv)),ya(d.Cv,c,b),za(d.Kv,a,b),Aa(d.Ov,c,a)},a.prototype.Pv=function(){var a=this,b=a.Zv;b&&clearTimeout(b),a.Zv=F.setTimeout(function(){g.En.Un(),a.fq(),a.Zv=H},100)},a.prototype.fq=function(){var a=this;a.kv||(a.kv=!0,a.$v(),a.kv=!1)},a.prototype.$v=function(){var a,b,c,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=this,w="display",x="block",y=v.Jv(),z=v.Wv(),A=v.Xv(),B=v.qo;B&&(a=v.options,b=a.showVerticalScrollbar,c=a.showHorizontalScrollbar,d=a.tabStripVisible,e=c||d,g=f.GC$(B),h=g.width(),i=g.height(),j=v.Ov,k=v.Pt,l=v.St,m=v.xs.style,n=v.Hv.style,m.width=""+(h-(b?A:0))+W,f.GC$(v.Cv).css(w,b?x:Z),f.GC$(j).css("width",(b?A:0)+W),o=i-(e?y:0),m.height=""+(o>=2?o:2)+W,f.GC$(v.Kv).css(w,e?x:Z),f.GC$(j).css("height",e?y:0+W),c?f.GC$(k.Bv()).show():f.GC$(k.Bv()).hide(),p=f.GC$(v.xs).width(),q=I(v.Iv()*p),q===p&&(q=p-1),n.width=""+q+W,n.height=""+y+W,l.Vo(z),l._v(f.GC$(v.xs).height()),r=h-(d?q:0)-(b?A:0),k.Vo(r>0?r:1),k._v(z),s=sa(v),s&&(0===s.lq&&(s.lq=s._t()),0===s.qq&&(s.qq=s.$t()),s.fq()),v.Ut(),v.Xt(),s&&(s.invalidateLayout(),s.repaint()),d?f.GC$(v.Hv).show():f.GC$(v.Hv).hide(),v.hq&&v.hq.fq(),t=g.width(),u=h!==t&&K(h-t)>2,u&&!v.aw&&(v.aw=!0,setTimeout(function(){delete v.aw,v.$v()},1)))},a.prototype.Ut=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n=this,o=sa(n),p=n.options;o&&(a=o.frozenColumnCount(),b=o.getColumnCount()-o.frozenTrailingColumnCount()-a,c=a,d=o.am(),e=0===b?c:c+b-1,f=o.qq,g=void 0,h=o.fu(d.er,c,e),p.scrollbarMaxAlign&&(e=h),p.scrollbarShowMax||(i=o.iu(),j=i.lastNonNullCol,k=o.fu(d.er,c,j),k===c&&(k++,k>e&&(k=e)),e=f>k?f<e?f:e:k),f>e&&(o.qq=e),l=o.Ot(o.qq),l!==-1&&l!==o.qq&&(o.qq=l),g=o.gu(),g<1&&(g=1),m=n.Pt,m&&(m.bw(o.Qt(c)),m.cw(o.Qt(e)),m.dw(g),m.ew(),m.value(o.Qt(o.qq))))},a.prototype.Xt=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n=this,o=sa(n),p=n.options;o&&(a=o.frozenRowCount(),b=o.getRowCount()-o.frozenTrailingRowCount()-a,c=a,d=o.am(),e=0===b?c:c+b-1,f=o.lq,g=void 0,h=o.eu(d.jr,c,e),p.scrollbarMaxAlign&&(e=h),p.scrollbarShowMax||(i=o.iu(),j=i.lastNonNullRow,k=o.eu(d.jr,c,j),k===c&&(k++,k>e&&(k=e)),e=f>k?f<e?f:e:k),f>e&&(o.lq=e),l=o.Rt(o.lq),l!==-1&&l!==o.lq&&(o.lq=l),g=o.hu(),g<1&&(g=1),m=n.St,m&&(m.bw(o.Tt(c)),m.cw(o.Tt(e)),m.dw(g),m.ew(),m.value(o.Tt(o.lq))))},a.prototype.aq=function(){var a,b,c,d,e,g,h,i,j,k,l=this,m=l.Jv(),n=l.Wv(),o=l.Xv(),p=l.qo;p&&(a=l.options,b=a.tabStripVisible,c=f.GC$(p),d=c.width(),e=l.Pt,g=l.Hv.style,h=f.GC$(l.xs).width(),i=I(l.Iv()*h),i===h&&(i=h-1),g.width=""+i+W,g.height=""+m+W,j=d-(b?i:0)-(a.showVerticalScrollbar?o:0),e.Vo(j>0?j:1),e._v(n),k=sa(l),k&&0===k.qq&&(k.qq=k.$t()),l.Ut(),b?f.GC$(l.Hv).show():f.GC$(l.Hv).hide(),l.hq&&l.hq.fq())},a.prototype.suspendPaint=function(){var a,b,c,d=this,e=d.hq,f=d.sheets;for(d.xD++,a=0,b=f;a<b.length;a++)c=b[a],c.suspendPaint();e&&e.fw()},a.prototype.resumePaint=function(){var a,b,c,d=this,e=d.hq,f=d.sheets;for(d.xD-=d.xD>0?1:0,a=0,b=f;a<b.length;a++)c=b[a],c.resumePaint();e&&e.gw()},a.prototype.isPaintSuspended=function(){return this.xD>0},a.prototype.Ys=function(){var a,b,c,d,e,i,j=this,k=j.options.backgroundImage,l=j.options.backgroundImageLayout,m=sa(j);if(m&&k&&(a=f.GC$(m.Ws()),b=void 0,a.css({"background-image":"url('"+k+"')","background-repeat":"no-repeat"}),!y(l))){b=j.bt,b||(b=j.bt=new h.oo(function(){j.bt&&j.Ys()}));try{b.ko(k)?(c=b.lo(k),d=m.Dr(),e=d.width,i=d.height,g.Ul.ql(m.Ws(),e,i,c.width,c.height,l)):b.fo(k)}catch(a){}}},a.prototype.hw=function(a){var b=this;b.hq.iw(b.getSheetIndex(a.name()))},a.prototype.startSheetIndex=function(a){var b=this,c=b.hq;return 0===arguments.length?c?c.gq:0:(c&&(c.hE(a)||(a=c.jw(a),a===-1&&(a=c.rw(a))),c.gq=a),b.aq(),b)},a.prototype.Iv=function(){var a,b,c,d,e,g=this,h=g.options;return h.showHorizontalScrollbar?(a=h.tabStripRatio,isNaN(a)?.5:(b=0,c=g.xs,d=g.hq,c&&d&&(e=f.GC$(c).width(),b=d.kw/e),a<b?a=b:a>1&&(a=1),a)):1},a.prototype.destroy=function(){this.oTa&&f.GC$(F).unbind(P+R,this.oTa),this.no()},a.prototype.repaint=function(){var a,b=this,c=b.hq;c&&c.repaint(),a=sa(b),a&&a.repaint()},a.prototype.refresh=function(){var a=this;a.qo&&(g.Im.Nm(),a.Qv(),a.fq(),a.repaint())},a.prototype.getHost=function(){return this.qo},a.prototype.invalidateLayout=function(){var a=sa(this);a&&a.invalidateLayout()},a.prototype.addNamedStyle=function(a){this.Kq(a);var b=sa(this);b&&b.$p()},a.prototype.Kq=function(a){if(a){if(!a.name)throw Error(la().Exp_EmptyNamedStyle);var b=a.name.toUpperCase();this.Lq[b]=a}},a.prototype.getNamedStyle=function(a){return this.Mq(a,!0)},a.prototype.Mq=function(a,b){var c,d=this.Lq;return d&&a?(a=a.toUpperCase(),c=d[a],c&&b&&this.Jq(),c):H},a.prototype.Jq=function(){var a,b,c,d=this.sheets;for(a=0,b=d;a<b.length;a++)c=b[a],c.Jq()},a.prototype.removeNamedStyle=function(a){var b,c=this.Lq;c&&a&&(a=a.toUpperCase(),c.hasOwnProperty(a)&&(delete c[a],this.Jq(),b=sa(this),b&&b.$p()))},a.prototype.getNamedStyles=function(){var a=[],b=this.Lq;return b&&v(b,function(b,c){a.push(c)}),this.Jq(),a},a.prototype.getActiveSheet=function(){return this.sheets&&this.sheets.length>0?this.sheets[this.eq]:H},a.prototype.setActiveSheet=function(a){this.lw(a,2)},a.prototype.lw=function(a,b){var c,d=this.sheets;for(c=0;c<d.length;c++)d[c].name()===a&&this.dq(c,b)},a.prototype.getActiveSheetIndex=function(){return this.eq},a.prototype.setActiveSheetIndex=function(a){this.dq(a,2)},a.prototype.dq=function(a,b,c,d){var e,f,h,i,j,k,l,m;typeof a===L&&(e=this,a!==e.eq&&(f=e.sheets[a],f&&f.visible()&&(h=g.Ul.rl(),(h.ipad||h.iphone)&&(i=e.mw,i&&(new Date).valueOf()-i<300)||(j=sa(e),k={oldSheet:j,newSheet:f,needTriggerSheetChange:!0},wa(e,k),l={oldSheet:j,newSheet:f,cancel:!1},m=k.needTriggerSheetChange&&d,m&&va(e,l),l.cancel===!1&&(e.eq=a,f!==j&&(j&&(j.no(!1),j.charts&&j.charts.all().forEach(function(a){a.clearflexDVs()})),e.nw(f,b,!1,c)),e.fq(),xa(e,j,f),m&&ua(e,j,f)),(h.ipad||h.iphone)&&(e.mw=(new Date).valueOf())))))},a.prototype.nw=function(a,b,c,d){var e,f,h;c||a.ws(this.xs),e=g.Vl.Xl(),f=e&&e.parent===this,h=2===b?f:1===b,g.Vl.Zl(H),!this.mv&&h&&a.zt(d),a.qs(),a.os()},a.prototype.addSheet=function(a,b){this.ow(a,2,b)},a.prototype.ow=function(a,b,c){var d,e,f,g,h,i,j,k,l=this;if(c||(c=l.vv(l.wv(a))),e=l.sheets,f=e.length,c.name()){for(d=0;d<f;d++)if(e[d].name()===c.name())throw la().Exp_NotSupported}else c.cq(l.wv(a));for(l.pw(c),g=sa(l),h=l.eq,i=f-a,j=[],d=0;d<i&&f>0;d++)j.push(e.pop());for(e.push(c),c.Ls(l);j.length>0;)e.push(j.pop());f=e.length,1===f?(l.xs&&c.ws(l.xs),l.eq=0):(h<0&&l.hq&&(h=l.hq.jw(h)),l.eq=h),k=sa(l),k!==g&&(g&&g.no(!1),k&&l.nw(k,b,1===f),l.fq()),l.hq&&(l.hq.gq<0&&(l.hq.gq=l.eq),l.hq.repaint())},a.prototype.removeSheet=function(a){this.qw(a,2)},a.prototype.qw=function(a,b){var c,d,e,f,g,h,i=this,j=i.sheets,k=i.Wu,l=i.hq,m=j.length;if(isNaN(a)||a<0||a>=m)throw Error(la().Exp_IndexOutOfRange);if(c=a<=i.eq||a===m-1,d=sa(i),a<i.eq&&i.eq--,e=j[a],e.mu(),j.splice(a,1),m=j.length,0===m)i.eq=-1;else if(i.eq>=m)i.eq=l.rw(m);else{for(f=void 0,f=i.eq;f<m;f++)if(j[f].visible()){i.eq=f;break}f>=m&&(i.eq=l.rw(m))}c&&(g=j[i.eq],d!==g&&(d&&d.no(!1),g&&i.nw(g,b,!1))),k&&k.removeSource(e.yj()),e.no(!0),x&&!k.Dh&&i.sheets&&i.sheets.length>0&&(h=i.sheets[0],k.initParserContext(h.yj())),l&&(l.gq>=m?i.startSheetIndex(l.rw(m)):l.gq<0?i.startSheetIndex(l.jw(-1)):i.fq())},a.prototype.clearSheets=function(){var a,b,c,d=this,e=d.sheets,f=d.Wu,g=d.hq;for(a=0,b=e;a<b.length;a++)c=b[a],c.mu(),c.no(!0);e.splice(0,e.length),f&&f.clearSource(),d.eq=-1,g&&(g.gq=-1,g.repaint())},a.prototype.getSheet=function(a){var b=this.sheets;return a>=0&&a<b.length?b[a]:H},a.prototype.getSheetFromName=function(a){var b,c,d,e=this.sheets;for(b=0,c=e;b<c.length;b++)if(d=c[b],d.name()===a)return d;return H},a.prototype.getSheetIndex=function(a){var b,c=this.sheets;for(b=0;b<c.length;b++)if(c[b].name()===a)return b;return H},a.prototype.getSheetCount=function(){return this.sheets.length},a.prototype.setSheetCount=function(a){this.sw(a,2)},a.prototype.sw=function(a,b){var c,d,e=this;if(a<0)throw la().Exp_ArgumentOutOfRange;if(0===a&&e.clearSheets(),c=e.sheets.length,a<c)for(d=c-1;d>=a;d--)e.qw(d,b);else if(a>c)for(d=c;d<a;d++)e.ow(d,b)},a.prototype.bind=function(a,b,c){var d,e,g,h=this,i=h.sheets;for(h.rv.push({type:a,data:b,fn:c}),f.GC$(h.sv).bind(a+R,b,c),d=0,e=i;d<e.length;d++)g=e[d],g.bind(a,b,c)},a.prototype.unbind=function(a,b){var c,d,e,g,h,i=this,j=i.sheets,k=i.rv;for(c=0;c<k.length;c++)d=k[c],d.type===a&&k.splice(c,1);for(f.GC$(i.sv).unbind(a+R,b),e=0,g=j;e<g.length;e++)h=g[e],h.unbind(a,b)},a.prototype.unbindAll=function(){var a,b,c,d=this,e=d.sheets;for(d.rv.length=0,f.GC$(d.sv).unbind(R),a=0,b=e;a<b.length;a++)c=b[a],c.unbindAll()},a.prototype.Fu=function(a,b,c){var d,e,g,h=this,i=h.sheets;for(h.rv.push({type:a,data:b,fn:c}),f.GC$(h.sv).bind(a+S,b,c),d=0,e=i;d<e.length;d++)g=e[d],g.Fu(a,b,c)},a.prototype.Gu=function(a,b){var c,d,e,g,h,i=this,j=i.sheets,k=i.rv;for(c=0;c<k.length;c++)d=k[c],d.type===a&&k.splice(c,1);for(f.GC$(i.sv).unbind(a+S,b),e=0,g=j;e<g.length;e++)h=g[e],h.Gu(a,b)},a.prototype.nu=function(){var a,b,c,d=this,e=d.sheets;for(d.rv.length=0,f.GC$(d.sv).unbind(S),a=0,b=e;a<b.length;a++)c=b[a],c.nu()},a.prototype.Wq=function(a,b){0===this.jm&&f.GC$(this.sv).trigger(a,b)},a.prototype.tw=function(a,b,c,d){this.Wq(g.Events.ButtonClicked,{sheet:a,sheetName:a.name(),row:b,col:c,sheetArea:d})},a.prototype.pw=function(a){var b,c,d,e=this.rv;for(b=0,c=e;b<c.length;b++)d=c[b],a.bind(d.type,d.data,d.fn)},a.prototype.suspendEvent=function(){var a,b,c,d=this,e=d.sheets;for(d.jm++,a=0,b=e;a<b.length;a++)c=b[a],c.suspendEvent()},a.prototype.resumeEvent=function(){var a,b,c,d=this,e=d.sheets;for(d.jm--,d.jm<0&&(d.jm=0),a=0,b=e;a<b.length;a++)c=b[a],c.resumeEvent()},a.prototype.focus=function(a){if(a===!1)g.Vl.Zl(H);else{var b=sa(this);b&&b.zt()}},a.prototype.Wv=function(){return this.Vv>2007?15:18},a.prototype.Xv=function(){return this.Vv>2007?22:this.Wv()},a.prototype.Jv=function(){return this.Vv>2007?28:this.Wv()},a.prototype.uw=function(a,b,c,d){var e,g="auto",h=this;h.vw||(e=z(U),f.GC$(e).addClass("gc-spread-toolTip ui-state-default ui-widget-content btn-default").css({position:$,padding:"0px 3px 0px 3px",font:C("normal normal normal 11pt calibri"),"box-shadow":"1px 2px 5px rgba(0,0,0,0.4)"}).width(g).height(g).appendTo(G.body),h.vw=e),h.ww(a,b,c,d)},a.prototype.ww=function(a,b,c,d){var e,g,h,i,j=this,k=sa(j);k&&(e=j.vw,e&&(g=f.GC$(e),a?(g.html(s.Ob(a)),g.show()):g.hide(),h=k.Vs(),d&&(c-=h.top,b-=h.left),i=k.Dr(),c=J(c,i.y+i.height-g.outerHeight()),b=J(b,i.x+i.width-g.outerWidth()),y(c)||g.css("top",c+h.top),y(b)||g.css("left",b+h.left)))},a.prototype.xw=function(){var a=this,b=a.vw;b&&(f.GC$(b).remove(),a.vw=H)},a.prototype.Av=function(){var b,c,d,e,f,h,i,j,k,l=this,m=l.sheets;for(g.mn.wn(),l.invalidateLayout(),b=0,c=m.length;b<c;b++)for(d=m[b],e=d.getRowCount(),f=d.getColumnCount(),h=0;h<e;h++)for(i=0;i<f;i++)j=d.getValue(h,i),j instanceof Date&&(k=d.getStyle(h,i),k&&k.$o(j),d.Nq(h,i,k));l.repaint(),a.ao(l,"onCultureChanged")},a.prototype.getTab=function(){return this.hq},a.Qp=qa,a.nv=1,a.ov=0,a}(),b.Workbook=ra,g.Zn(ra),ra.prototype.nextControl=A("nextControl",H),ra.prototype.previousControl=A("previousControl",H)},"./dist/core/workbook/workbookpanelex.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/domUtil.js"),e=c("./dist/core/util/common.js"),f=c("Common"),g=c("./dist/core/core.enum.js"),h=f.Common.j.Fa,i=null,j=e.Ul.Ml,k=e.Ul.nl,l=e.Ul.Nl,m=e.Ul.Pl,n=document,o=window,p=Math.round,q=Math.ceil,r="gc-scroll-container",s="gc-scroll-corner-all",t="gc-scroll-arrow",u="gc-scrollbar-wrapper",v="gc-scroll-bar",w="gc-scroll-arrowUp",x="gc-scroll-arrowDown",y="gc-scroll-arrowLeft",z="gc-scroll-arrowRight",A="gc-scrollbar-vertical",B="gc-scrollbar-horizontal",C="gc-no-user-select",D="width",E="height",F="gc-scrollbar-stateActive ui-state-active",G="left",H="right",I="top",J="bottom",K="margin-left",L="position",M="border",N="padding",O="margin",P="overflow",Q="display",R="outline",S="borderWidth",T="boxSizing",U="margin-top",V=".gcScrollbar",W="mousedown"+V,X="mouseup"+V,Y="mousemove"+V,Z="mouseover"+V,$="mouseout"+V,_="mousewheel",aa="inline-block",ba="content-box",ca="DOMMouseScroll",da="scroll"+V;function ka(a){a.preventDefault?a.preventDefault():a.returnValue=!1}!function(a){a[a.continuous=1]="continuous"}(ea||(ea={})),function(a){a[a.horizontalScroll=0]="horizontalScroll",a[a.verticalScroll=1]="verticalScroll"}(fa||(fa={})),ga=function(){function a(a,b,c,d,e,f,g){var h=this;h.JB=!1,h.KB=!1,h.LB=i,h.MB=i,h.NB=300,h.OB=70,h.PB=a,h.Vo("number"==typeof b?b:0),h._v("number"==typeof c?c:0),h.dw("number"==typeof d?d:0),h.cw("number"==typeof e?e:0),h.bw("number"==typeof f?f:0),h.QB="number"==typeof g?g:1,h.RB=!1,h.SB=0,h.Qb=h.bw(),h.ew()}return a.prototype.Bv=function(){return this.TB},a.prototype.value=function(a){var b,c=this;return 0===arguments.length?c.Qb:("number"==typeof a&&a<=c.cw()&&a>=c.bw()&&(c.Qb=a,b=(a-c.bw())*c.UB,c.scrollTo(b,!0)),c)},a.prototype.ew=function(){var a,b,c,e=this,f=e._v(),g=e.Vo(),h=0,i=0,j=!1,k=2,m="ui-widget ui-corner-all",n=f,o=g-2*f,q=n,F=G,V=H,W=y,X=z,Y=B,Z=K,$="ui-button ui-state-default ui-corner-bl btn btn-default",_="ui-icon ui-icon-triangle-1-w",ca="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",da="ui-icon ui-icon-grip-solid-vertical",ea="ui-button ui-state-default ui-corner-br btn btn-default",fa="ui-icon ui-icon-triangle-1-e";e.VB=o,e.PB||(n=g,o=n,q=f-2*g,F=I,V=J,W=w,X=x,Y=A,Z=U,$="ui-button ui-state-default ui-corner-tr btn btn-default",_="ui-icon ui-icon-triangle-1-n",ca="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",da="ui-icon ui-icon-grip-solid-horizontal",ea="ui-button ui-state-default ui-corner-br btn btn-default",fa="ui-icon ui-icon-triangle-1-s",e.VB=q);function ga(){e.TB=l("div"),e.WB=d.GC$(e.TB),e.WB.css([L,G,I,P,R,M,N,O],["relative",0,0,"hidden","none","none",0,0]).addClass(r+" "+s+" "+m)}function ha(a){e.XB=d.GC$.Nl("div",[L,Q,S,N,O,T],["absolute",aa,"1px",0,0,ba],t+" "+$,a),e.YB=d.GC$.Nl("span",[Q,M,N,O],["block","none",0,0],W+" "+_,e.XB)}function ia(a){e.ZB=d.GC$.Nl("div",[L,Q,T,M,N,O],["absolute",aa,ba,"none",0,0],u+" "+u,a)}function ja(a){e.$B=d.GC$.Nl("div",[L,S,N,O,T],["absolute","1px",0,0,ba],v+" "+C+" "+ca,a),e._B=d.GC$.Nl("span",[Q,M,N,O],["block","none",0,0],Y+" "+da,e.$B)}function ka(a){e.aC=d.GC$.Nl("div",[L,Q,S,N,O,T],["absolute",aa,"1px",0,0,ba],t+" "+ea,a),e.bC=d.GC$.Nl("span",[Q,M,N,O],["block","none",0,0],X+" "+fa,e.aC)}a=e.VB,b=e.cw()-e.bw(),e.dC=e.dw()*a/(b+e.dw()),e.dC>a&&(e.dC=a),e.dC<10&&(e.dC=10),c=e.dC,e.UB=0===b?1:(a-c)/b,e.PB?(h=c,i=n):(h=n,i=c),e.WB||(j=!0,ga()),e.XB||ha(e.WB),e.ZB||ia(e.WB),e.$B||ja(e.ZB),e.aC||ka(e.WB),e.WB.css([D,E],[g,f]),e.XB.css([F,D,E],[0,n-k,n-k]),e.YB.css([D,E],["100%","100%"]),e.ZB.css([F,D,E],[n,o,q]),e.$B.css([F,D,E],[e.SB,p(h-k),p(i-k)]),e._B.css([D,E,Z],[n-k,n-k,Math.floor((e.dC-n)/2)]),e.aC.css([V,D,E],[0,n-k,n-k]),e.bC.css([D,E],["100%","100%"]),j&&e.eC()},a.prototype.eC=function(){var b=this;function c(a,c){a.bind(W,function(a){b.fC(a,c)}).bind(X,function(a){b.gC(a,c)}).bind(Z,function(a){b.hC(a,c)}).bind($,function(a){b.iC(a,c)})}c(b.XB,!0),c(b.aC,!1),b.$B.bind(W,function(a){b.jC(a)}).bind(Y,function(a){b.kC(a)}).bind(X,function(a){b.lC(a)}).bind(Z,function(a){b.mC(a)}).bind($,function(a){b.nC(a)}),b.ZB.bind(W,function(a){var c,d,e=j&&j.mozilla;e&&(c=(new Date).valueOf(),d=b.oC,b.oC=c,d&&c-d<100)||b.pC(a)}).bind(X,function(a){b.qC(a)}),b.GB=function(a){b.sC(a)},b.WB.bind(_,b.GB),b.WB.bind(ca,b.GB),a.ao(b,"initEvents",b.TB)},a.prototype.dispose=function(){var b=this;function c(a){a&&a.unbind(V)}c(b.aC),c(b.$B),c(b.XB),c(b.ZB),b.WB&&(b.GB&&(b.WB.unbind(_,b.GB),b.WB.unbind(ca,b.GB)),a.ao(b,"dispose",b.TB),b.WB.unbind(V).remove())},a.prototype.tC=function(){var a=this;a.RB||(d.GC$(n).bind(Y,function(b){a.kC(b)}).bind(X,function(b){a.lC(b)}),a.RB=!0)},a.prototype.uC=function(){this.RB&&(this.RB=!1,d.GC$(n).unbind(Y).unbind(X))},a.prototype.fC=function(a,b){var c,d=0,e=this,f=!0;e.KB=!0,null===e.LB&&(b?(e.XB.addClass(F),d=0-e.qB(),e.vC=g.Nxb.smallDecrement):(e.aC.addClass(F),d=e.qB(),e.vC=1),c=function(){e.scrollTo(e.SB+d*e.UB,!1),e.QB===ea.continuous&&(e.LB=o.setTimeout(c,f?e.NB:e.OB)),f=!1},c(),ka(a))},a.prototype.gC=function(a,b){var c=this,d=b?c.XB:c.aC;d.removeClass(F),c.wC(),ka(a)},a.prototype.hC=function(a,b){var c=this,d=b?c.XB:c.aC;d.addClass("gc-scroll-arrow-hover ui-state-hover"),ka(a)},a.prototype.iC=function(a,b){var c=this,d=b?c.XB:c.aC;d.removeClass("gc-scroll-arrow-hover gc-scrollbar-stateActive ui-state-hover ui-state-active"),c.wC(),ka(a)},a.prototype.jC=function(a){var b,c,d,e,f,g,h=this;0===a.button&&(h.JB=!0,h.xC={x:a.pageX,y:a.pageY},h.tC(),h.$B.addClass(F),b=h.$B.offset(),c=h.$B.outerWidth(!0),d=h.$B.outerHeight(!0),e=h.ZB.offset(),f=h.ZB.outerWidth(!0),g=h.ZB.outerHeight(!0),h.yC={isBeyondEdge:!1,startEdgePosition:{x:e.left+a.pageX-b.left,y:e.top+a.pageY-b.top},endEdgePosition:{x:e.left+f-(c-a.pageX+b.left),y:e.top+g-(d-a.pageY+b.top)}}),ka(a)},a.prototype.kC=function(a){var b=this;b.JB&&(b.zC={x:a.pageX,y:a.pageY},b.AC(),b.xC=b.zC,d.GC$(n.body).attr("unselectable","on").addClass(C)),ka(a)},a.prototype.lC=function(a){var b,c,e,f=this;f.JB=!1,f.vC=g.Nxb.thumbPosition,f.yC=null,f.WB.trigger(da,{newValue:f.Qb,oldValue:f.Qb,scrollOrientation:f.PB?fa.horizontalScroll:fa.verticalScroll,scrollEventType:f.vC}),b=f.Qb,c=(b-f.bw())*f.UB,e="left",f.PB||(e="top"),f.SB=c,f.$B.css(e,c),f.uC(),d.GC$(n.body).removeClass(C),d.GC$(n.body).attr("unselectable")&&d.GC$(n.body).removeAttr("unselectable"),f.$B.removeClass(F),f.vC=6,f.WB.trigger(da,{newValue:f.Qb,oldValue:f.Qb,scrollOrientation:f.PB?fa.horizontalScroll:fa.verticalScroll,scrollEventType:f.vC}),ka(a)},a.prototype.mC=function(a){this.$B.addClass("gc-scrollbar-stateHover ui-state-hover"),ka(a)},a.prototype.nC=function(a){this.$B.removeClass("gc-scrollbar-stateHover ui-state-hover"),ka(a)},a.prototype.sC=function(a){var b,c,d,e=this;h(a.wheelDelta)&&h(a.detail)&&(a.wheelDelta=a.originalEvent.wheelDelta,a.detail=a.originalEvent.detail),b=a.detail?a.detail:a.wheelDelta/-40,c=b/3*e.qB()*e.UB,e.vC=c>=0?1:0,e.scrollTo(e.SB+c,!1),e.vC=6,d={newValue:e.Qb,oldValue:e.Qb,scrollOrientation:e.PB?fa.horizontalScroll:fa.verticalScroll,scrollEventType:e.vC},e.WB.trigger(da,d),ka(a)},a.prototype.pC=function(a){var b,c=this,d=!0,e=a.pageX,f=a.pageY,h=0,i=c.ZB.offset(),j=c.rB();null===c.MB&&(h=c.PB?e-i.left-c.SB:f-i.top-c.SB,b=function(){var a=0,k=c.SB;if(a=c.PB?e-i.left-k:f-i.top-k,a*h<0||a>=0&&a<c.dC)return void c.CC();if(h<0)c.vC=g.Nxb.largeDecrement,c.scrollTo(k-j*c.UB,!1);else{if(!(h>0))return void c.CC();c.vC=g.Nxb.largeIncrement,c.scrollTo(k+j*c.UB,!1)}1===c.QB&&(c.MB=o.setTimeout(b,d?c.NB:c.OB)),d=!1},b(),ka(a))},a.prototype.qC=function(a){this.CC(),ka(a)},a.prototype.CC=function(){var a,b=this;b.MB&&clearTimeout(b.MB),b.MB=i,b.vC=g.Nxb.endScroll,a={newValue:b.Qb,oldValue:b.Qb,scrollOrientation:b.PB?fa.horizontalScroll:fa.verticalScroll,scrollEventType:b.vC},b.WB.trigger(da,a)},a.prototype.wC=function(){var a,b=this;b.KB&&(b.KB=!1,b.LB&&clearTimeout(b.LB),b.LB=i,b.vC=6,a={newValue:b.Qb,oldValue:b.Qb,scrollOrientation:b.PB?fa.horizontalScroll:fa.verticalScroll,scrollEventType:b.vC},b.WB.trigger(da,a))},a.prototype.AC=function(){var a,b,c,d,e,f,g,h,i=this,j=i.SB,k=i.zC,l=i.yC;function m(a){return i.PB?a.x:a.y}function n(a,b){i.PB?a.x=b:a.y=b}if(c=m(k),d=m(i.xC),l&&l.isBeyondEdge){if(e=m(l.startEdgePosition),f=m(l.endEdgePosition),a=c<e,b=c>f,a||b)return;d<e&&n(i.xC,e),d>f&&n(i.xC,f)}g=c-d,h=j+g,h!==j&&(i.vC=5,i.scrollTo(h,!1))},a.prototype.scrollTo=function(a,b){var c,d,e,f,g,i,j=this,k=I,l=j.VB-j.dC;j.PB&&(k=G),c=!1,a>l&&(a=l,c=!0),a<0&&(a=0,c=!0),j.yC&&(j.yC.isBeyondEdge=c),d=p(a/j.UB)+j.bw(),e=j.Qb,f=!1,b||(i={newValue:d,oldValue:e,scrollOrientation:j.PB?fa.horizontalScroll:fa.verticalScroll,scrollEventType:j.vC},j.WB.trigger(da,i),f=i.ignoreUpdatePosition,i.newValue>j.cw()&&(i.newValue=j.cw()),d=i.newValue,g=i.newValueWithOffset),h(g)&&(g=d),j.Qb=d,5!==j.vC&&(a=(g-j.bw())*j.UB),j.SB=a,f||j.$B.css(k,a)},a.prototype.hitTest=function(a,b){var c,e,f,h,i=this,j=0,k=0,l=i.$B.outerWidth(),m=i.XB.outerWidth(),n=i.ZB.outerWidth(),o=i.$B.offset(),p=d.GC$(i.Bv()).offset(),q=o.left-p.left-18;return i.PB?a<j+n+m&&a>j+m?a<j+q+l+m&&a>q?{element:g.Oxb.ThumbButton,x:a,y:b}:{element:g.Oxb.TrackButton}:a<=j+m&&a>j?{element:g.Oxb.LeftButton,x:a,y:b}:{element:g.Oxb.RightButton,x:a,y:b}:(c=i.$B.outerHeight(),e=i.XB.outerHeight(),f=i.ZB.outerHeight(),h=o.top-p.top-18,b<k+f+e&&b>k+e?b<k+h+c+e&&b>h?{element:g.Oxb.ThumbButton,x:a,y:b}:{element:g.Oxb.TrackButton}:b<=k+e&&b>k?{element:g.Oxb.UpButton,x:a,y:b}:{element:g.Oxb.DownButton,x:a,y:b})},a.prototype.pia=function(){var a=this;return{x:0,y:0,width:a.Vo(),height:a._v()}},a}(),b.hv=ga,e.Zn(ga),ha=ga.prototype,ha.qB=m("smallChange",1),ha.rB=m("largeChange",10),ha.dw=m("pageValue",10,function(a){a<=0&&this.dw(1)}),ha.cw=m("maximum",100,function(a){a<=0&&this.cw(0)}),ha.bw=m("minimum",0,function(a){a<=0&&this.bw(0)}),ha.Vo=m("width",0),ha._v=m("height",0),ia=function(){function a(a,b){var c=this;c.fB=!0,c.gB=!0,c.hB=18,c.iB=a&&d.GC$(a),c.jB=b&&d.GC$(b),c.ew(!0)}return a.prototype.ew=function(a){var b,c,e,f,g,h,k,l,m,n,o,r,s,t=this;function u(){return d.GC$.Nl("div",[L,G,I,M,N,O],["absolute",0,0,"none",0,0])}function v(a,b){var c,e,f,g=b?t.mB:t.nB;return g?g:(c=new ga(b),e=d.GC$.Nl("div"),b?(t.oB=e,t.mB=c,e.css([L,G,J,M,N,O],["absolute",0,0,"none",0,0])):(t.pB=e,t.nB=c,e.css([L,H,I,M,N,O],["absolute",0,0,"none",0,0])),f=(b?t.mB:t.nB).Bv(),e.append(f),a.append(e),c)}function w(a,b,c,e,f,g){g?(t.oB.css([D,E],[b,e]),a.Vo(b),a._v(e)):(t.pB.css([D,E],[e,b]),a.Vo(e),a._v(b)),a.bw(0),a.cw(f-b),a.dw(b),a.qB(g?t.kB():t.lB()),a.rB(b),a.ew(),d.GC$(a.Bv()).bind(da,function(a,b){c.css(g?G:I,0-b.newValue)}),g?t.oB.show():t.pB.show()}function x(a){t.sB||(t.sB=u(),t.sB.css([P,Q],["hidden",aa]),a.append(t.sB))}function y(a){t.tB||(t.tB=d.GC$.Nl("div",L,"relative",i,a))}t.iB&&t.jB&&(b=t.hB,c=t.jB.width(),e=t.jB.height(),f=t.iB.width(),g=t.iB.height(),h=f-b,k=g-b,l=!1,t.uB||(t.uB=u(),t.uB.css([L,P],["relative","hidden"]),l=!0),t.uB.css([D,E],[f,g]),x(t.uB),y(t.sB),a&&t.tB.append(t.jB).css([I,G],[0,0]),j.chrome&&(c=p(c),e=p(e),f=q(f),g=q(g)),m=t.vB(c,e,f,g),n=m.wB,o=m.xB,o?(n||(h+=b),r=v(t.uB,!0),w(r,h,t.tB,b,c,!0)):t.oB&&t.oB.hide(),n?(o||(k+=b),s=v(t.uB,!1),w(s,k,t.tB,b,e,!1)):t.pB&&t.pB.hide(),o||n||(h+=b,k+=b),t.fB=o,t.gB=n,t.yB=h,t.zB=k,t.sB.css([D,E],[h,k]),l&&(t.iB.append(t.uB),t.AB()))},a.prototype.BB=function(a){var b=this,c=b.CB(a),d=c.EB,e=c.FB;!h(d)&&b.mB&&b.lu(d),!h(e)&&b.nB&&b.ju(e)},a.prototype.lu=function(a){var b,c,d=this;d.mB.value(a),b=d.yB,c=d.jB.width(),a>=0&&a<=c-b&&d.tB.css(G,0-a)},a.prototype.ju=function(a){var b,c,d=this;d.nB.value(a),b=d.zB,c=d.jB.height(),a>=0&&a<=c-b&&d.tB.css(I,0-a)},a.prototype.vB=function(a,b,c,d){var e=this.hB,f=c-e,g=d-e,h={xB:!1,wB:!1};return a>c&&(h.xB=!0,h.wB=b>g),b>d&&(h.wB=!0,h.xB=a>f),h},a.prototype.CB=function(a){var b=d.GC$(a),c=this.sB,e=this.tB,f,g,h,j,k,l,m,n={EB:i,FB:i};return a?(f=b.offset(),g=e.offset(),h=c.offset(),f.leftWidth=f.left+b.outerWidth(),f.topHeight=f.top+b.outerHeight(),h.leftWidth=h.left+c.outerWidth(),h.topHeight=h.top+c.outerHeight(),j=f.left-g.left,f.left<h.left?n.EB=j:f.leftWidth>h.leftWidth&&(k=f.leftWidth-g.left-c.innerWidth(),j<k?n.EB=j:n.EB=k),l=f.top-g.top,f.top<h.top?n.FB=l:f.topHeight>h.topHeight&&(m=f.topHeight-g.top-c.innerHeight(),l<m?n.FB=l:n.FB=m),n):n},a.prototype.AB=function(){var a=this;this.tB&&(a.GB=function(b){a.HB(b)},a.tB.bind(_,a.GB),a.tB.bind(ca,a.GB))},a.prototype.HB=function(a){var b,c,d,e,f,g,i,j=this;h(a.wheelDelta)&&h(a.detail)&&(a.wheelDelta=a.originalEvent.wheelDelta,a.detail=a.originalEvent.detail),b=a.detail?a.detail:a.wheelDelta/-40,c=b,d=j.nB,e=parseInt(j.tB.css(I),10),f=j.zB,g=j.jB.height(),g<f&&(g=f),isNaN(e)&&(e=0),i=e-c*j.lB(),i>=0&&(i=0),i<0&&0-i>g-f&&(i=0-(g-f)),i!==e&&(j.tB.css(I,i),j.gB&&d.value(0-i)),k(a)},a.prototype.dispose=function(){var a=this;a.uB&&(a.mB&&a.mB.dispose(),a.nB&&a.nB.dispose(),a.tB&&a.GB&&(a.tB.unbind(_,a.GB),a.tB.unbind(ca,a.GB)),d.GC$(a.uB).remove())},a}(),b.IB=ia,ja=ia.prototype,ja.kB=m("horizontalSmallChange",10),ja.lB=m("verticalSmallChange",10)},"./dist/core/worksheet/clipboardhelper.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/common.js"),e=c("Common"),f=c("./dist/core/worksheet/stylehelper.js"),g=c("./dist/core/worksheet/style.js"),h=e.Common.u,i=d.Ul.Ml,j=e.Common.j.Fa,k=e.Common.k.Bb,l=null;function n(a){return a&&a.options.allowCopyPasteExcelStyle}function o(a,b){var c,d;if(i.msie){for(c=[],d=0;d<a.length;d++)b&&""===a[d].trim()||c.push(a[d]);return c.join("")}return a.join("")}m=function(){function a(a){var b=this;b.PA=l,b.n5=l,b.G4=!1,b.tc=a,b.Nl()}return a.prototype.Nl=function(){var b,c,d,e=this,f=document.createElement("div");f.style.position="fixed",f.style.top="0px",f.style.left="0px",f.style.width="0px",f.style.height="0px",f.style.overflow="hidden",b=document.createElement("div"),b.setAttribute("contenteditable","true"),b.setAttribute("gcUIElement","gcSheetClipboard"),b.setAttribute("tabindex","-1"),b.style.position="absolute",b.style.overflow="hidden",b.style.background="white",b.style.webkitUserSelect="text",f.appendChild(b),e.KM=b,c=document.createElement("textarea"),c.setAttribute("gcUIElement","gcSheetClipboard"),c.setAttribute("tabindex","-1"),c.style.position="absolute",c.style.overflow="hidden",c.style.background="white",c.style.webkitUserSelect="text",f.appendChild(c),e.qka=c,d=e.tc.getHost(),d&&d.appendChild(f),i.msie||i.edge||(e.H4=function(b){var c,d,f,g=e.tc.getActiveSheet(),h=b.clipboardData;h&&(c=h.getData("text/html"),d=e.I4(),d.innerHTML=c,f=void 0,f=c?e.EZa(d,!0):a.formatClipboardData(h.getData("text/plain")),d.innerHTML="",g.J4(f,c))},b.addEventListener("paste",e.H4),e.rka=function(b){var c,d,f,g=e.tc.getActiveSheet(),h=b.clipboardData;h&&(c=a.formatClipboardData(h.getData("text/plain")),c||(d=h.getData("text/html"),d&&(f=e.I4(),f.innerHTML=d,c=e.EZa(f,!1),f.innerHTML="")),g.J4(c,""))},c.addEventListener("paste",e.rka))},a.prototype.no=function(){var a,b,c,d,e,f,g=this,h=g.KM;h&&(i.msie||i.edge||(h.removeEventListener("paste",g.H4),g.qka.removeEventListener("paste",g.rka)),a=h.parentElement,a&&(b=a.parentElement,b&&b.removeChild(a)),g.KM=l,g.qka=l),c=g.K4,c&&(d=c.parentElement,d&&d.removeChild(c),g.K4=l),e=g.FZa,e&&(f=e.parentElement,f&&f.removeChild(e),g.FZa=l),g.tc=l},a.prototype.ska=function(a){n(this.tc)?this.KM.innerHTML=a:this.qka.value=a},a.prototype.M4=function(){n(this.tc)?this.KM.focus():this.qka.focus()},a.prototype.N4=function(){n(this.tc)?document.execCommand("selectAll"):this.qka.select()},a.prototype.wx=function(){var b,c,d="",e="";return n(this.tc)?(b=this.KM,b&&(c=b.getElementsByTagName("table"),c.length>0&&(d=c[0].outerHTML)),e=this.EZa(this.KM,!0)):e=a.formatClipboardData(this.qka.value),{html:d,text:e}},a.prototype.Q4=function(a,b,c,e,f,g,h,i){var j,k,l,m,n,o=this,p=a.Tq(d.kf(b,e,c,f)),q=RegExp(String.fromCharCode(32),"g"),r="&nbsp;",s=!1,t=!1,u=a.parent.options.copyPasteHeaderOptions;return b<0&&2===(2&u)&&(s=!0),e<0&&1===(1&u)&&(t=!0),b=p.row,e=p.col,c=p.rowCount,f=p.colCount,j=null,k=null,l=o.Ema(a,b,c,e,f,3,h,i,g,p,q,r),t&&(m=a.getColumnCount(2),j=o.Ema(a,b,c,0,m,2,h,i,g,p,q,r)),s&&(n=a.getRowCount(1),k=o.Ema(a,0,n,e,f,1,h,i,g,p,q,r)),o.yb(l,j,k)},a.prototype.yb=function(a,b,c){var d,e,f=this,g=a,h=0,i=function(a,b){var c,d=[],e=a.length;for(c=0;c<e;c++)d.push(a[c].concat(b[c]));return d};return b&&(h=b[0].length,g=i(b,a)),c&&(d=c.length,e=null,h&&(e=f.Ema(null,0,d,0,h,null,[],[],!1,null,null,null),c=i(e,c)),g=c.concat(g)),f.Fma(g)},a.prototype.Fma=function(a){var b,c,d="",e=a.length;for(d+="<table>",b=0;b<e;b++){for(d+="<tr>",c=0;c<a[b].length;c++)d+=a[b][c];d+="</tr>"}return d+="</table>"},a.prototype.Ema=function(b,c,d,e,f,g,m,n,o,p,q,r){var s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R=[];for(s=0;s<d;s++)if(t=c+s,!k(m,t)){for(u=[],v=0;v<f;v++)w=e+v,k(n,w)||(x="",y=void 0,z=void 0,o&&b&&(y=b.getSpan(t,w,g),y&&a.isPartSpan(y,p,m,n)&&(y=l),y&&(y.row!==t||y.col!==w))||(x+="<td",o&&b&&(y&&(y.rowCount>1&&(x+=" rowSpan="+y.rowCount),y.colCount>1&&(x+=" colSpan="+y.colCount)),z=b.getActualStyle(t,w,g),A=a.convertVAlign,B=a.convertHAlign,C=a.convertLineBorder,x+=' style="',D=z.backColor,D&&(x+="background-color: "+D+";"),E=z.foreColor,E&&(x+="color: "+E+";"),F=z.font,F&&(x+="font: "+F.replace(/"/g,"'")+";"),G=z.vAlign,j(G)||(x+="vertical-align: "+A(G)+";"),H=z.hAlign,j(H)||(I=B(H),I&&(x+="text-align: "+I+";")),J=z.borderLeft,J&&(x+="border-left: "+C(J)+";"),K=z.borderRight,K&&(x+="border-right: "+C(K)+";"),L=z.borderTop,L&&(x+="border-top: "+C(L)+";"),M=z.borderBottom,M&&(x+="border-bottom: "+C(M)+";"),x+='"'),x+=">",N=void 0,O=void 0,o&&b&&(P=z.textDecoration,N=2===(2&P),O=1===(1&P),N&&(x+="<s>"),O&&(x+="<u>")),Q=b?b.getText(t,w,g):"",
Q?(" "!==Q[0]&&" "!==Q[Q.length-1]||"number"!=typeof b.getValue(t,w,g)||(Q=Q.trim()),Q=h.Ob(Q).replace(q,r)):i.chrome?Q=" ":i.safari&&(Q="&nbsp;"),x+=Q,o&&(O&&(x+="</u>"),N&&(x+="</s>")),x+="</td>",u.push(x)));R.push(u)}return R},a.prototype.I4=function(){var a,b,c=this;return c.K4||(a=document.createElement("div"),a.style.display="none",b=c.tc.getHost(),b&&b.appendChild(a),c.K4=a),c.K4},a.prototype.GZa=function(){var a,b,c=this;return c.FZa||(a=document.createElement("div"),a.style.display="none",b=c.tc.getHost(),b&&b.appendChild(a),c.FZa=a),c.FZa},a.prototype.R4=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p=this.I4();if(p.innerHTML=a,e=p.getElementsByTagName("table"),e.length>0)for(f=this.HZa(e[0],!0),g=0;g<f.length;g++)for(h=f[g],i=c+g,j=0;j<h.length;j++)k=h[j],k&&(l=d+j,b.Pq(i,l,k.style),m=k.rowSpan,n=k.colSpan,(m>1||n>1)&&(o=b.getSpan(i,l),o?(o.row=i,o.col=l,o.rowCount=m,o.colCount=n):b.addSpan(i,l,m,n)));p.innerHTML=""},a.prototype.HZa=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=this.GZa(),q=[],r=/\s+/g;for(d=0;d<b.rows.length;d++)for(e=b.rows[d],q[d]||(q[d]=[]),f=q[d],g=0,h=0;g<e.cells.length;g++){for(i=e.cells[g];f[h];)h++;for(j=f[h]={},k=void 0,c&&(k=a.getStyleFromDOM(i),j.style=k),p.innerHTML=i.innerHTML.replace(r," "),j.text=p.innerText,j.rowSpan=i.rowSpan,l=i.getAttribute("style"),l&&l.indexOf("mso-ignore:colspan;")>=0?j.colSpan=1:j.colSpan=i.colSpan,m=0;m<i.rowSpan;m++)for(n=0;n<i.colSpan;n++)0===m&&0===n||(q[d+m]||(q[d+m]=[]),o=q[d+m],o[h+n]={style:k,text:"",rowSpan:1,colSpan:1});h+=i.colSpan}return p.innerHTML="",q},a.prototype.EZa=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=[];if(a)if(c=a.getElementsByTagName("table"),c.length>0)for(d=this.HZa(c[0],!1),e=RegExp(String.fromCharCode(160),"g"),f=String.fromCharCode(32),g=0,h=d.length;g<h;g++){for(i=d[g],j=0,k=i.length;j<k;j++)l=i[j]?i[j].text:"",l.indexOf("\n")>=0&&(b?(l.indexOf("\r\n")>=0&&(l=o(l.split("\r\n"),!0)),l=o(l.split("\n"),!0)):l='"'+l+'"'),m.push(l.replace(e,f)),j<k-1&&m.push("\t");g<h-1&&m.push("\r\n")}else m.push(a.innerText.trim());return m.join("")},a.prototype.hZ=function(){var a=this;a.PA=l,a.n5=l,a.G4=!1},a.isPartSpan=function(a,b,c,d){var e,f,g,h,i,j;if(!b.containsRange(a))return!0;for(e=0,f=c;e<f.length;e++)if(g=f[e],a.row<=g&&g<a.row+a.rowCount)return!0;for(h=0,i=d;h<i.length;h++)if(j=i[h],a.col<=j&&j<a.col+a.colCount)return!0;return!1},a.formatClipboardData=function(a){var b,c,d,e,f,g=[];if(a){for(b='"',c=!1,d=0;d<a.length;d++)e=d>0?a[d-1]:"",f=a[d],f===b?(c=!c,g.push(b)):c||"\n"!==f||"\r"===e?g.push(f):g.push("\r\n");return g.join("")}return""},a.convertHAlign=function(a){var b={0:"left",1:"center",2:"right"};return b[a]},a.convertVAlign=function(a){var b={0:"top",1:"middle",2:"bottom"};return b[a]},a.convertLineBorder=function(a){var b={0:"none",1:"solid",2:"solid",3:"dashed",4:"dotted",5:"solid",6:"double",7:"dotted",8:"dashed",9:"dashed",10:"dashed",11:"dashed",12:"dashed",13:"dashed"},c={9:.5,1:.5,3:.5,4:.5,7:.5,11:.5,2:1,10:1,12:1,8:1,13:1,5:1.5,6:1.5};return c[a.style]+"pt "+b[a.style]+" "+a.color},a.convertToHAlign=function(a){var b={left:0,center:1,right:2};return b[a]},a.convertToVAlign=function(a){var b={top:0,middle:1,bottom:2};return b[a]},a.convertToLineBorder=function(a,b,c){var d={none:0,solid:1,dashed:3,dotted:4,double:6};return(i.msie||i.edge)&&"2px"===c?d.solid=5:(c=Math.round(10*parseFloat(c)*3/4)/10,c<=.5?d.solid=1:c<=1?(d.solid=2,d.dashed=8):c<=1.5&&(d.solid=5)),new g.LineBorder(a,d[b])},a.convertToTextDecoration=function(a){var b={underline:1,"line-through":2,none:0};return b[a]},a.isTransparent=function(a){return 0===e.Common.pc.ec(a).a},a.isBlack=function(a){var b=e.Common.pc.ec(a);return 0!==b.a&&0===b.r&&0===b.g&&0===b.b},a.getStyleFromDOM=function(b){var c,d,e,h,j,k,l,m,n,o,p,q,r,s,t=b.getElementsByTagName("font")[0],u=getComputedStyle(b),v=b.style,w=new g.Style,x=u.backgroundColor;return x&&!a.isTransparent(x)&&(w.backColor=x),c=u.color,t&&(c=t.color),c&&!a.isBlack(c)&&(w.foreColor=c),t?w.font=f.To.F4(getComputedStyle(t)):(d=f.To.F4(u),d&&(w.font=d)),e=u.verticalAlign,h=a.convertToVAlign,j=a.convertToHAlign,k=a.convertToLineBorder,l=a.convertToTextDecoration,e&&(w.vAlign=h(e)),m=v.textAlign,n=u.textAlign,i.msie||i.edge?""!==m?w.hAlign=j(m):w.hAlign=j("general"):n&&(w.hAlign=j(n)),o=u.borderLeftStyle,"none"!==o&&(w.borderLeft=k(u.borderLeftColor,o,u.borderLeftWidth)),p=u.borderRightStyle,"none"!==p&&(w.borderRight=k(u.borderRightColor,p,u.borderRightWidth)),q=u.borderTopStyle,"none"!==q&&(w.borderTop=k(u.borderTopColor,q,u.borderTopWidth)),r=u.borderBottomStyle,"none"!==r&&(w.borderBottom=k(u.borderBottomColor,r,u.borderBottomWidth)),s=l(i.chrome?u.textDecorationLine:u.textDecoration),b.getElementsByTagName("u").length>0&&(s|=l("underline")),b.getElementsByTagName("s").length>0&&(s|=l("line-through")),0!==s&&(w.textDecoration=s),w},a}(),b.S4=m},"./dist/core/worksheet/style.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/stylehelper.js"),h=c("./dist/core/celltype/celltype.ns.js"),i=e.GC$.each,j=f.Ul,k=j.Ol,l=d.Common.j.C4,m=void 0,n=null,o="autoFormatter",p="formatter",q="cellType",r="hAlign",s="vAlign",t="imeMode",u="labelOptions",v="cellButtons",w="dropDowns",x={borderLeft:!0,borderRight:!0,borderTop:!0,borderBottom:!0,diagonalDown:!0,diagonalUp:!0},function(a){a[a.empty=0]="empty",a[a.thin=1]="thin",a[a.medium=2]="medium",a[a.dashed=3]="dashed",a[a.dotted=4]="dotted",a[a.thick=5]="thick",a[a.double=6]="double",a[a.hair=7]="hair",a[a.mediumDashed=8]="mediumDashed",a[a.dashDot=9]="dashDot",a[a.mediumDashDot=10]="mediumDashDot",a[a.dashDotDot=11]="dashDotDot",a[a.mediumDashDotDot=12]="mediumDashDotDot",a[a.slantedDashDot=13]="slantedDashDot"}(y=b.LineStyle||(b.LineStyle={})),function(a){a[a.conditionalFormat=1]="conditionalFormat",a[a.cell=10]="cell",a[a.table=20]="table",a[a.row=30]="row",a[a.column=40]="column",a[a.sheet=50]="sheet"}(z=b.LineBorderComposeLevel||(b.LineBorderComposeLevel={})),A=function(){function a(a,b,c){this.color=a||"black",this.style=b||0,this.level=c}return a.prototype.Uo=function(){return new a(this.color,this.style,this.level)},a.prototype.toJSON=function(){var a={},b=this,c=b.color,d=b.style;return"black"!==c&&(a.color=c),0!==d&&(a.style=d),a},a.prototype.fromJSON=function(a,b){if(a){var c=this,d=a.color,e=a.style;k(d)&&(c.color=d),k(e)&&(c.style=e)}},a.Vo=function(a){var b=a&&a.style,c={9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3};return c[b]||0},a}(),b.LineBorder=A,B=["backColor","foreColor",r,s,"font","themeFont",p,"borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","shrinkToFit","backgroundImage",q,"backgroundImageLayout","tabStop","textDecoration",t,"name","parentName","watermark","cellPadding",u,"quotePrefix","diagonalDown","diagonalUp","isVerticalText",v,w,"textOrientation"],C=function(){function a(){var b,c,d=this;if(d.yn=a.Wo,a.Wo++,b=arguments,0!==b.length)for(c=0;c<B.length;c++)d[B[c]]=b[c]}return a.kxb=function(a,b){var c=a.parentName;c&&!b.getNamedStyle(c)&&delete a.parentName},a.prototype.Yo=function(a,b,c,d){var e,f,g,h,i,j,k,n,o=this,p=a.labelOptions,q=a.cellButtons,r=a.dropDowns;if(b?(o._autoFormatter=a._autoFormatter,o.backgroundImage=a.backgroundImage,o.backgroundImageLayout=a.backgroundImageLayout,o.backColor=a.backColor,o.foreColor=a.foreColor,o.hAlign=a.hAlign,o.vAlign=a.vAlign,o.font=a.font,o.themeFont=a.themeFont,o.formatter=a.formatter,e=a.borderLeft,o.borderLeft=e&&e.Uo()||e,o.borderLeft&&c&&(o.borderLeft.level=c),f=a.borderTop,o.borderTop=f&&f.Uo()||f,o.borderTop&&c&&(o.borderTop.level=c),g=a.borderRight,o.borderRight=g&&g.Uo()||g,o.borderRight&&c&&(o.borderRight.level=c),h=a.borderBottom,o.borderBottom=h&&h.Uo()||h,o.borderBottom&&c&&(o.borderBottom.level=c),i=a.diagonalDown,o.diagonalDown=i&&i.Uo()||i,o.diagonalDown&&c&&(o.diagonalDown.level=c),j=a.diagonalUp,o.diagonalUp=j&&j.Uo()||j,o.diagonalUp&&c&&(o.diagonalUp.level=c),o.locked=a.locked,o.textIndent=a.textIndent,o.wordWrap=a.wordWrap,o.shrinkToFit=a.shrinkToFit,o.cellType=a.cellType,o.name=a.name,o.parentName=a.parentName,o.tabStop=a.tabStop,o.textDecoration=a.textDecoration,o.imeMode=a.imeMode,o.watermark=a.watermark,o.cellPadding=a.cellPadding,o.isVerticalText=a.isVerticalText,o.textOrientation=a.textOrientation,p&&(o.labelOptions={alignment:p.alignment,font:p.font,foreColor:p.foreColor,visibility:p.visibility,margin:p.margin}),o.quotePrefix=a.quotePrefix):(o.backgroundImage===m&&(o.backgroundImage=a.backgroundImage),o.backgroundImageLayout===m&&(o.backgroundImageLayout=a.backgroundImageLayout),o.backColor===m&&(o.backColor=a.backColor),o.foreColor===m&&(o.foreColor=a.foreColor),o.hAlign===m&&(o.hAlign=a.hAlign),o.vAlign===m&&(o.vAlign=a.vAlign),o.themeFont===m&&o.font===m?(o.themeFont=a.themeFont,o.font=a.font):o.themeFont!==m&&o.font===m&&(o.font=a.font),o.formatter===m&&(o.formatter=a.formatter),o._autoFormatter===m&&(o._autoFormatter=a._autoFormatter),o.borderLeft===m&&(e=a.borderLeft,o.borderLeft=e&&e.Uo()||e,o.borderLeft&&c&&(o.borderLeft.level=c)),o.borderTop===m&&(f=a.borderTop,o.borderTop=f&&f.Uo()||f,o.borderTop&&c&&(o.borderTop.level=c)),o.borderRight===m&&(g=a.borderRight,o.borderRight=g&&g.Uo()||g,o.borderRight&&c&&(o.borderRight.level=c)),o.borderBottom===m&&(h=a.borderBottom,o.borderBottom=h&&h.Uo()||h,o.borderBottom&&c&&(o.borderBottom.level=c)),o.diagonalDown===m&&(i=a.diagonalDown,o.diagonalDown=i&&i.Uo()||i,o.diagonalDown&&c&&(o.diagonalDown.level=c)),o.diagonalUp===m&&(j=a.diagonalUp,o.diagonalUp=j&&j.Uo()||j,o.diagonalUp&&c&&(o.diagonalUp.level=c)),o.locked===m&&(o.locked=a.locked),o.textIndent===m&&(o.textIndent=a.textIndent),o.wordWrap===m&&(o.wordWrap=a.wordWrap),o.shrinkToFit===m&&(o.shrinkToFit=a.shrinkToFit),o.cellType===m&&(o.cellType=a.cellType),o.tabStop===m&&(o.tabStop=a.tabStop),o.textDecoration===m&&(o.textDecoration=a.textDecoration),o.imeMode===m&&(o.imeMode=a.imeMode),o.name===m&&(o.name=a.name),o.parentName===m&&(o.parentName=a.parentName),o.watermark===m&&(o.watermark=a.watermark),o.cellPadding===m&&(o.cellPadding=a.cellPadding),!o.labelOptions&&p&&(o.labelOptions={}),k=o.labelOptions,k&&p&&(k.alignment===m&&(k.alignment=p.alignment),k.font===m&&(k.font=p.font),k.foreColor===m&&(k.foreColor=p.foreColor),k.visibility===m&&(k.visibility=p.visibility),k.margin===m&&(k.margin=p.margin)),d||o.quotePrefix!==m||(o.quotePrefix=a.quotePrefix),o.isVerticalText===m&&(o.isVerticalText=a.isVerticalText),o.textOrientation===m&&(o.textOrientation=a.textOrientation)),q)for(o.cellButtons||(o.cellButtons=[]),n=0;n<q.length;n++)o.cellButtons.push(l(q[n]));if(r)for(o.dropDowns||(o.dropDowns=[]),n=0;n<r.length;n++)o.dropDowns.push(l(r[n]))},a.prototype.$b=function(a){var b=this;0===arguments.length?i(B,function(a,c){b[c]=m}):b[a]=m},a.prototype.clone=function(b){var c=this,d=c.borderLeft,e=c.borderTop,f=c.borderRight,g=c.borderBottom,h=c.diagonalDown,i=c.diagonalUp,j=new a;return j.backColor=c.backColor,j.foreColor=c.foreColor,j.hAlign=c.hAlign,j.vAlign=c.vAlign,j.font=c.font,j.themeFont=c.themeFont,j.formatter=m,j.borderLeft=d&&!b&&d.Uo()||d,j.borderTop=e&&!b&&e.Uo()||e,j.borderRight=f&&!b&&f.Uo()||f,j.borderBottom=g&&!b&&g.Uo()||g,j.locked=c.locked,j.textIndent=c.textIndent,j.wordWrap=c.wordWrap,j.shrinkToFit=c.shrinkToFit,j.backgroundImage=c.backgroundImage,j.cellType=m,j.backgroundImageLayout=c.backgroundImageLayout,j.tabStop=c.tabStop,j.textDecoration=c.textDecoration,j.imeMode=c.imeMode,j.name=c.name,j.parentName=c.parentName,j.watermark=c.watermark,j.cellPadding=c.cellPadding,j.labelOptions=c.labelOptions,j.quotePrefix=c.quotePrefix,j.diagonalDown=h&&!b&&h.Uo()||h,j.diagonalUp=i&&!b&&i.Uo()||i,j.isVerticalText=c.isVerticalText,j.textOrientation=c.textOrientation,G(j,c.formatter,!b),H(j,c._autoFormatter,!b),D(j,c.cellType,!b,!0),E(j,c.cellButtons,!b,!0),F(j,c.dropDowns,!b,!0),j},a.prototype.Zo=function(a){var b,c,d,e,f,h,i=this;if(a&&a.getColor)for(I(a,i.foreColor,function(a){i.foreColor=a}),I(a,i.backColor,function(a){i.backColor=a}),b=[i.borderLeft,i.borderTop,i.borderRight,i.borderBottom,i.diagonalDown,i.diagonalUp],c=function(c,d){var e=b[c];e&&e.color&&I(a,e.color,function(a){e.color=a})},d=0,e=b.length;d<e;d++)c(d,e);return f=i.themeFont,h=i.font,a&&a.getFont&&(f?i.font=g.To.Io(h,a.getFont(f)):h||(i.font=g.To.Io(h,a.bodyFont()))),i},a.prototype.$o=function(a){var b,c=this,d=c._autoFormatter;d&&a!==n&&(b=d.getPreferredEditingFormatter(a),b.isAuto=!0,c._autoFormatter=b)},a.prototype.toJSON=function(a,b){var c,d,f=this,g={},h=f._autoFormatter;for(!k(h)||b&&J(o,h,a)||(h.toJSON&&(h=h.toJSON()),e.GC$.isEmptyObject(h)||(g[o]=h)),c=0;c<B.length;c++)d=B[c],h=f[d],d!==u||e.GC$.isEmptyObject(h)?d!==w&&d!==v||e.GC$.isEmptyObject(h)?!k(h)||b&&J(d,h,a)||(g[d]=h&&h.toJSON?h.toJSON():h):g[d]=h:g[u]=h;return e.GC$.isEmptyObject(g)?m:g},a.prototype.fromJSON=function(b,c,d){var e,f,g,h,i;if(b){e=this;for(f in b)if(b.hasOwnProperty(f)){if(g=b[f],!k(g))continue;h={p:f,v:g,r:!1},h.noSchema=c,h.context=d,a.ao(e,"fromJson",h),h.r||("formatter"===f?G(e,g,!0):"autoFormatter"===f?H(e,g,!0):f===q?D(e,g,!0,c):x[f]?g===n?e[f]=null:(i=new A,i.fromJSON(g,c),e[f]=i):e[f]=g)}}},a}(),b.Style=C;function D(a,b,c,d){var e,g,i,j,k=b;if(c&&b){if(e=b.gQa&&b.gQa())return void(a.cellType=k);b.toJSON&&(b=b.toJSON()),g=h._o,i=b.typeName,j=g[b.type]||g[i]||f.getTypeFromString(i),j?(k=new j,k.fromJSON(b,d)):k=m}a.cellType=k}function E(a,b,c,d){var e,f;if(b){if(e=b,c)for(e=[],f=0;f<b.length;f++)e.push(l(b[f]));a.cellButtons=e}}function F(a,b,c,d){var e,f;if(b&&(a.dropDowns=b.slice()),b){if(e=b.slice(),c)for(e=[],f=0;f<b.length;f++)e.push(l(b[f]));a.dropDowns=e}}function G(a,b,c){var e,g,h,i,j=b;c&&b&&"object"==typeof b&&(b.toJSON&&(b=b.toJSON()),e=d.Formatter,g=e&&e.GeneralFormatter,g&&(h=b.typeName,h?(i=f.getTypeFromString(h),i&&(j=new i,j.fromJSON(b))):j=new g(b.formatCached,b.customerCultureName))),a.formatter=j}function H(a,b,c){var e,f,g=b;c&&b&&(b.toJSON&&(b=b.toJSON()),e=d.Formatter,f=e&&e.GeneralFormatter,f&&(g=new f(b.formatCached,b.customerCultureName),g.isAuto=!0)),a._autoFormatter=g}function I(a,b,c){b&&(b=a.getColor(b),b&&c(b))}function J(a,b,c){return a===r?2===c?1===b:1===c?1===b:3===b:a===s?2===c?1===b:1===c?1===b:0===b:a===t?1===b:a===o?b===m:void 0}f.Zn(C),C.Wo=0},"./dist/core/worksheet/stylehelper.js":function(a,b,c){"use strict";var d,e,f,g,h,i;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/domUtil.js"),e=c("./dist/core/util/common.js"),f=document,g=Math.max,h=void 0,b.Ho="11pt",i=function(){function a(){}return a.Io=function(b,c){return c?a.Jo(b,c):b},a.Ko=function(b){var c,d;return b?(c=a.Lo(),c.style.font=b,d=c.style,{fontFamily:d.fontFamily,fontSize:d.fontSize,fontStyle:d.fontStyle,fontWeight:d.fontWeight}):{}},a.F4=function(a){var b,c,d,f,g,h,i,j,k,l,m;return e.Ul.Ml.safari?a.font:(b="",c="normal",d="400",f="11pt",g="Calibri",h=a.fontStyle,i=a.fontVariant,j=a.fontWeight,k=a.lineHeight,l=a.fontSize,m=a.fontFamily,h&&h!==c&&(b=h),i&&i!==c&&(b+=(b?" ":"")+i),j&&j!==c&&j!==d&&(b+=(b?" ":"")+j),l=l?l:f,b+=(b?" ":"")+l,k&&k!==c&&(b+="/"+k),m=m?m:g,b+=" "+m)},a.Jo=function(c,e){var g,h,i,j,k;if(!c&&!e)return c;if(c){if(h=e?c+"+"+e:c,i=a.Mo[h])return i;g=a.Lo(),d.GC$(g).css("font",c)}else{if(h=e,i=a.Mo[h])return i;g=a.Lo(),d.GC$(g).css("fontSize",b.Ho)}return e&&d.GC$(g).css("fontFamily",e),j=g.currentStyle,k=f.defaultView,k&&k.getComputedStyle&&(j=k.getComputedStyle(g,"")),i=a.F4(j),a.Mo[h]=i,a.Mo[i]=i,i},a.No=function(b,c,d,e){var h,i,j,k,l,m,n,o,p,q=a.Oo[c];if(!e)if(q){if(h=q[b])return h}else q=a.Oo[c]={};return i=a.Lo(),i.style.font=b,j=i.currentStyle,k=f.defaultView,k&&k.getComputedStyle&&(j=k.getComputedStyle(i,"")),l=j.fontSize,m="px",l.indexOf(m)!==-1&&(n=g(1,parseFloat(l.replace(m,""))*c),d&&1===n&&(d.value=!0),l=n+m),o=j.lineHeight,o.indexOf(m)!==-1&&(p=g(1,parseFloat(o.replace(m,""))*c),o=p+m),1===c?h={font:b,fontFamily:i.style.fontFamily,fontSize:n}:(i.style.fontSize=l,i.style.lineHeight=o,h={font:i.style.font,fontFamily:i.style.fontFamily,fontSize:n}),e||(q[b]=h),h},a.Lo=function(){var b,c,d;return a.Po?a.Po.style.cssText=a.Qo:(b="-10000px",c=e.Ul.Nl("span"),d=c.style,d.visibility="hidden",d.top=b,d.left=b,d.lineHeight="normal",d.position="absolute",d.fontWeight="normal",d.fontStretch="normal",d.fontVariant="normal",d.fontStyle="normal",f.body.insertBefore(c,null),a.Po=c,a.Qo=d.cssText),a.Po},a.no=function(){var b=a.Po;b&&(d.GC$(b).remove(),a.Po=h,a.Qo=h)},a.stringFontCatch={},a.Ro=function(b,c){var d,e=b+","+c,f=a.stringFontCatch,g=f[e];return g||(d=a.Lo(),d.style.font=b,c&&(d.style.fontWeight=c),g=f[e]=d.style.font),g},a.Mo={},a.Oo={},a.So=function(a){if(a<=0)return"none";var b="";return(1|a)===a&&(b+="underline "),(2|a)===a&&(b+="line-through "),(4|a)===a&&(b+="overline "),b.trim()},a}(),b.To=i},"./dist/core/worksheet/worksheet-actions.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,_a,ab,bb,cb,db,eb,fb=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("Common"),f=c("Common"),g=c("./dist/core/worksheet/style.js"),h=c("./dist/core/worksheet/worksheet.js"),i=c("./dist/core/util/common.js"),j=c("./dist/core/util/domUtil.js"),k=j.GC$,l=c("./dist/core/worksheet/worksheet-static.js"),m=c("CalcEngine"),n=!!m,o=e.Common.j.Fa,p=e.Common.k.Bb,q=e.Common.u,r=q.jb,s=i.Events.CellChanged,t=i.Events.ColumnWidthChanging,u=i.Events.ColumnWidthChanged,v=i.Events.RowHeightChanging,w=i.Events.RowHeightChanged,x=i.Ul.Ml,y=i.Ul.Ol,z=k.extend,A=k.inherit,B=null,C=void 0,D=Math.max,E=Math.min,F=Math.floor,G=Math.ceil,H=Number.MAX_VALUE,I=isNaN,function(a){a[a.value=1]="value",a[a.formula=2]="formula",a[a.comment=4]="comment",a[a.outline=8]="outline",a[a.sparkline=16]="sparkline",a[a.span=32]="span",a[a.style=64]="style",a[a.tag=128]="tag",a[a.bindingPath=256]="bindingPath",a[a.conditionalFormat=512]="conditionalFormat",a[a.formatString=768]="formatString",a[a.all=1791]="all"}(J=b.CopyToOptions||(b.CopyToOptions={}));function gb(a,b){return a.getRowCount(b)}function hb(a,b){return a.getColumnCount(b)}function ib(a){return a.rowCount}function jb(a){return a.colCount}function kb(a){var b=a.parent;return b&&b.options.allowExtendPasteRange}function lb(a){var b=a.parent;return b&&b.options.allowCopyPasteExcelStyle}function mb(a){var b=a.parent;return b&&b.options.copyPasteHeaderOptions}K=new e.Common.ResourceManager(d.SR),L=K.getResource.bind(K);function nb(a,b,c,d){throw Error(q.Kb(L().Exp_InvalidAndSpace,[a,b,c,d]))}function ob(a){a.suspendPaint()}function pb(a){a.resumePaint()}function qb(a){a.suspendEvent()}function rb(a){a.resumeEvent()}function sb(a,b){a&&n&&a.suspendCalcService(b)}function tb(a,b){a&&n&&a.resumeCalcService(b)}function ub(a,b,c,d,e){var f=a.getSpan(b,c,d);if(f&&e&&(f.row!==b||f.col!==c))return!0}function vb(a){var b=this;b.Vw=1===(1&a),b.Ww=2===(2&a),b.Xw=8===(8&a),b.Yw=n&&16===(16&a),b.Zw=!0,b.$w=!0}function wb(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,p,q,s,t,u,v;if(o(a)||""===a)return B;for((o(b)||""===b)&&(b="\r\n"),e="\n",(o(c)||""===c)&&(c="\t"),(o(d)||""===d)&&(d='"'),r(a,b)||(a+=b),f=[],g=[],h="",j=!1,k=d.length,l=b.length,m=e.length,n=c.length,p=a.length,q=0;q<p;q++)h+=a[q],i=h.length,i>=k&&d===h.substr(i-k,k)?j&&p>=q+1+k&&d===a.substr(q+1,k)?q+=k:j?(h=h.substr(0,i-k),j=!1):(s=h,0===s.indexOf(d)&&(h=h.substr(0,i-k),j=!0)):!j&&i>=n&&c===h.substr(i-n,n)?(h=h.substr(0,i-n),g.push(""+h),h=""):!j&&i>=l&&b===h.substr(i-l,l)?(h=h.substr(0,i-l),g.push(""+h),f.push(g),g=[],h=""):!j&&i>=m&&e===h.substr(i-m,m)?(h=h.substr(0,i-m),g.push(""+h),f.push(g),g=[],h=""):j&&p>=q+1+n&&c===a.substr(q+1,n)&&","!==c&&(q+=k);if(j){if(g.length>0){for(t=void 0,t=0;t<f.length&&f[t]!==g;t++);t>=f.length&&f.push(g)}u=""+h,u&&(u=u.replace(RegExp(c,"g"),""),r(u,b)&&(u=u.substr(0,u.length-l)),0===f.length&&f.push([u]))}return 0===f.length&&(v=a,r(a,b)&&(v=v.substr(0,v.length-l)),f.push([v])),f}function xb(a,b,c,d,e){var f,g,h,i,j,k,l,m=d.length,n=Ab(d);if(0!==m&&0!==n)for(f=new vb(e),a&&(hb(a,2)<=0&&(f.Vw=!1),gb(a,1)<=0&&(f.Ww=!1)),g=f.Vw?hb(a,2):0,h=f.Ww?gb(a,1):0,i=0,n-=g,n<=0&&(n=0),m-=h,m<=0&&(i=0),m-=i,m<=0&&(m=0),f.Zw&&b+m>gb(a)&&a.setRowCount(b+m),f.$w&&c+n>hb(a)&&a.setColumnCount(c+n),j=0,k=0;j<d.length;j++,k++)l=d[j],l.length<=0||(h>0&&j<h?yb(a,l,k,c,n,1,f):m>0&&k<gb(a)&&(j===h&&(k=b),yb(a,l,k,0,g,2,f),l.splice(0,g),yb(a,l,k,c,n,3,f)))}function yb(a,b,c,d,e,f,g){for(var h=0,i=d;h<b.length;h++,i++)e>0&&i<hb(a,f)&&zb(a,f,c,i,b[h],g)}function zb(a,b,c,d,e,g){var h,j,k,l,m,n,p,q=e,r=B;if(g.Xw===!1&&(h={value:B},q=i.Ul.ul(B,e,!g.Xw,h),r=h.value),o(q))a.setValue(c,d,q,b);else if(""!==e)if(g.Yw&&"="===e[0]&&e.length>1)try{a.setFormula(c,d,e.substr(1))}catch(f){a.setText(c,d,e,b)}else j=a.tq(c,d,"formatter",b),g.Xw===!1&&r?j?j&&("string"==typeof j&&f.Formatter&&(j=new f.Formatter.GeneralFormatter(j)),p=j.parse&&j.parse(e),q=o(p)?q:p):(r.isAuto=!0,a.getCell(c,d,b)._w("_autoFormatter",r),k=e,l=a.getCellType(c,d,b),m=r.formatString(),l&&"7"===l.typeName&&(n={sheet:a,row:c,col:d,sheetArea:b},k=l.parse(e,m,n),q=o(k)?e:k)):j&&a.getCell(c,d,b).formatter(B),a.setValue(c,d,q,b);else a.setValue(c,d,B,b)}function Ab(a){var b,c,d=0;for(b=0;b<(a&&a.length);b++)c=a[b],d=D(c.length,d);return d}function Bb(a,b,c,d,e,f,g,h){if(!a)throw Error(L().Exp_SheetIsNull);if((b<-1||b>=gb(a))&&nb("row",b,"-1",gb(a)-1),(c<-1||c>=hb(a))&&nb("column",c,"-1",hb(a)-1),!o(d)&&""!==d){b===-1&&(b=0),c===-1&&(c=0);var i=wb(d,e,f,g);i&&i.length>0&&xb(a,b,c,i,h)}}function Cb(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var p,q,r,s,t,u,v,w,x,y,z,A;if(!a)throw Error(L().Exp_SheetIsNull);return p=gb(a),q=hb(a),(b<-1||b>=p)&&nb("row",b,"-1",p-1),(c<-1||b+c>p)&&nb("rowCount",c,"-1",p-b),(d<-1||d>=q)&&nb("column",d,"-1",q-1),(e<-1||d+e>q)&&nb("columnCount",e,"-1",q-d),r=-1,s=-1,t=!1,u=!1,b===-1&&d===-1&&c===-1&&e===-1?(b=0,d=0,r=gb(a)-1,s=hb(a)-1):(b===-1&&(b=0,2===(2&a.parent.options.copyPasteHeaderOptions)&&(t=!0)),d===-1&&(d=0,1===(1&a.parent.options.copyPasteHeaderOptions)&&(u=!0)),c===-1&&(c=gb(a)-b),e===-1&&(e=hb(a)-d),r=b+c-1,s=d+e-1),(o(f)||""===f)&&(f="\r\n"),(o(g)||""===g)&&(g="\t"),(o(h)||""===h)&&(h='"'),v=RegExp(h,"g"),w=null,x=null,y=Fb(a,b,r,d,s,3,j,k,f,g,h,v,i,l,m,n),u&&(z=a.getColumnCount(2),w=Fb(a,b,r,0,z-1,2,j,k,f,g,h,v,i,l,m,n)),t&&(A=a.getRowCount(1),x=Fb(a,0,A-1,d,s,1,j,k,f,g,h,v,i,l,m,n)),Db(y,w,x,f,g)}function Db(a,b,c,d,e){var f,g,h=a,i=0,j=function(a,b){var c,d=[],e=a.length;for(c=0;c<e;c++)d.push(a[c].concat(b[c]));return d};return b&&(i=b[0].length,h=j(b,a)),c&&(f=c.length,g=null,i&&(g=Fb(null,0,f-1,0,i-1,null,[],[],d,e,null,null,null,!1,!1),c=j(g,c)),h=c.concat(h)),Eb(h,d,e)}function Eb(a,b,c){var d,e,f="",g=a.length;for(d=0;d<g;d++){for(e=0;e<a[d].length;e++)0!==e&&(f+=c),f+=a[d][e];f+=b}return f}function Fb(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,q){var r,s,t,u,v=[],w=a&&lb(a);for(r=b;r<=c;r++)if(!g||!p(g,r)){for(t=[],s=d;s<=e;s++)h&&p(h,s)||(u="",a&&!ub(a,r,s,f,n)&&(u=a.getText(r,s,f),q&&w&&u&&(" "===u[0]||" "===u[u.length-1])&&"number"==typeof a.getValue(r,s,f)&&(u=u.trim())),u=Gb(u,n,w,l,k,o,m,j,i),t.push(u));v.push(t)}return v}function Gb(a,b,c,d,e,f,g,h,i){var j="";return o(a)||(j=a,b||(j=j.replace(d,e+e))),f&&!j&&(j=" "),b&&c?j=j.replace(/\n/g," "):(g||j.indexOf(e)!==-1||j.indexOf(h)!==-1||j.indexOf(i)!==-1||j.indexOf("\n")!==-1)&&(j=e+j+e),j}function Hb(a,b,c,d){var e,f,g,h,i,j=B,k=wb(a,b,c,d);if(k){for(e=k.length,f=Ab(k),g=[],h=0;h<e;h++)for(g[h]=[],i=0;i<f;i++)i<k[h].length?g[h][i]=k[h][i]:g[h][i]=B;j=g}return j}z(h.Worksheet.prototype,{autoFitColumn:function(a){0<=a&&a<hb(this)&&this.wu().execute({cmd:"autoFitColumn",sheetName:this.name(),columns:[{col:a}],rowHeader:!1})},autoFitRow:function(a){0<=a&&a<gb(this)&&this.wu().execute({cmd:"autoFitRow",sheetName:this.name(),rows:[{row:a}],columnHeader:!1})},setCsv:function(a,b,c,d,e,f){var g=this;ob(g),qb(g),Bb(g,a,b,c,d,e,'"',f),rb(g),pb(g)},getCsv:function(a,b,c,d,e,f){return Cb(this,a,c,b,d,e,f,'"',!0)},copyTo:function(a,b,c,d,e,f,g){this.ax(a,b,c,d,e,f,g)},ax:function(a,b,c,d,e,f,g,h){var i=this;ob(i),qb(i),l.staticMembers.copyTo(i,a,b,i,c,d,e,f,g,h,0),rb(i),pb(i)},moveTo:function(a,b,c,d,e,f,g){var h=this;if(!(n&&g&J.formula)||h.Vq(a,b,e,f,!0)&&h.Vq(c,d,e,f,!0))try{ob(h),qb(h),l.staticMembers.moveTo(h,a,b,h,c,d,e,f,g)}finally{rb(h),pb(h)}},bx:function(a,b,c){var d,e,f,g,h,j,k,l,m,n=this,o=n.o5(a);if(o){d=n.J5(a),e="\t",f="\r\n",g='"',h=n.mm,j=Cb(n,o.row,ib(o),o.col,jb(o),f,e,g,!1,d.rows,d.cols,!0),k=n.tu(),k.PA=n,k.n5=a,k.G4=b,l=k.Q4(n,o.row,ib(o),o.col,jb(o),lb(n),d.rows,d.cols),n.ex&&n.ex(),n.Sob&&n.Sob();try{if(m={sheet:n,sheetName:n.name(),copyData:{text:j,html:l},cancel:!1},n.Wq(i.Events.ClipboardChanging,m),m&&m.cancel===!1)return h&&!c&&h.gx(lb(n)?l:j),n.Wq(i.Events.ClipboardChanged,{sheet:n,sheetName:n.name(),copyData:{text:j,html:l}}),setTimeout(function(){!h||c||n.Js||h.hx()},100),{copyText:j,copyHtml:l};k.hZ()}catch(a){}}},ix:function(a,b,c,d,e,f){var g,h,i,j=L().Exp_PasteSourceCellsLocked;if(f.pastedInternal=!1,f.pastedRange=B,!a&&!e)return!1;if(g=this,h=g,i=g.J5(b),g.jx(a,g.o5(b),h,e,i.rows,i.cols)||!e){if(f.pastedInternal=!0,d&&a.options.isProtected&&a.p5(b))return g.Os(1,j),!1;f.pastedRange=g.kx(a,b,h,c,d)}else f.pastedRange=g.lx(c,e);return g.mx(a,b,c,d,f)},mx:function(a,b,c,d,e){var f,g,h,j,k,l,m,n,o,p,q,r,s,t,u=L().Exp_InvalidCopyPasteSize,v=L().Exp_PasteDestinationCellsLocked,w=L().Exp_PasteChangeMergeCell,x=L().Exp_ChangePartOfArray,y=this,z=y,A=e.pastedRange;if(!A)return y.Os(1,u),!1;if(!z.Y3(A.row,A.col,ib(A),jb(A),v,x))return!1;if(e.pastedInternal){if(f=b.length,1===f){if(g=b[0],d&&!a.Y3(g.row,g.col,ib(g),jb(g),v,x))return!1;if(a.qu(g.row,g.col,ib(g),jb(g)))return y.Os(1,w),!1;if(h=A.row<0?gb(z):ib(A),j=A.col<0?hb(z):jb(A),k=g.row<0?gb(a):ib(g),l=g.col<0?hb(a):jb(g),h>k||j>l){for(m=c.row,n=c.col,c.row<0&&k<gb(z)&&(m=0),c.col<0&&l<hb(z)&&(n=0),h%k===0&&1===j?(j=l,A=e.pastedRange=new i.Range(m,n,h,j)):1===h&&j%l===0?(h=k,A=e.pastedRange=new i.Range(m,n,h,j)):h%k===0&&j%l===0||(h=k,j=l,A=e.pastedRange=new i.Range(m,n,h,j)),o=F(h/k),p=F(j/l),q=0;q<o;q++)for(r=0;r<p;r++)if(!y.nx(g,A)&&z.qu(m<0?-1:m+q*k,n<0?-1:n+r*l,m<0?-1:k,n<0?-1:l))return y.Os(1,w),!1}else if(!y.nx(g,A)&&z.qu(A.row,A.col,ib(A),jb(A)))return y.Os(1,w),!1}else if(f>1){for(s=0;s<f;s++)if(t=b[s],a.qu(t.row,t.col,ib(t),jb(t)))return y.Os(1,w),!1;if(z.qu(A.row,A.col,ib(A),jb(A)))return y.Os(1,w),!1}}else{if(z.qu(A.row,A.col,ib(A),jb(A)))return y.Os(1,w),!1;if(!z.l5(A.row,A.col,ib(A),jb(A)))return y.Os(1,u),!1}return!0},nx:function(a,b){if(a&&1===ib(a)&&1===jb(a)){var c=this.getSpan(b.row,b.col);if(c&&c.equals(b))return!0}return!1},jx:function(a,b,c,d,e,f){var g,h;if(a&&b&&c)try{return g=Cb(a,b.row,ib(b),b.col,jb(b),"\r\n","\t",'"',!1,e,f,!0,x.safari,!0),h=g===d,h||(h=g===d+"\r\n",!h&&x.chrome&&(h=g===d+"\t\r\n"),h||!x.safari&&lb(c)||(h=g.replace(/\s/g,"")===d.replace(/\s/g,"")),h||(h=g.replace(/\s+$/,"")===d.replace(/\s+$/,""))),h}catch(a){return!1}return!1},kx:function(a,b,c,d,e){var f,g,h,j,k,l,m,n,o,p,q=this,r=b.length;if(1===r){if(f=b[0],g=f.row<0?0:f.row,h=f.col<0?0:f.col,j=f.row<0?gb(a):ib(f),k=f.col<0?hb(a):jb(f),l=d.row<0?0:d.row,m=d.col<0?0:d.col,n=d.row<0?gb(c):ib(d),o=d.col<0?hb(c):jb(d),e?(n=j,o=k):n%j===0&&1===o?o=k:1===n&&o%k===0?n=j:n%j===0&&o%k===0||(n=j,o=k),!q.pu(g,h,j,k,gb(a),hb(a)))return B;if(!c.l5(l,m,n,o))return B;if(p=new i.Range(l,m,n,o),!e&&a.name()===c.name())if(p.contains(g,h,j,k)){if((g-l)%j!==0||(h-m)%k!==0)return B}else if(p.intersect(g,h,j,k)&&(n>j||o>k))return B;return d.row===-1&&(l=-1,n=-1),d.col===-1&&(m=-1,o=-1),new i.Range(l,m,n,o)}return r>1?q.q5(b,d):B},q5:function(a,b){var c,d,e,f,g,h;if(a.length>1){if(c=a[0],d=a[1],e=c.rowCount,f=c.colCount,c.row===d.row&&e===d.rowCount)return g=0,a.forEach(function(a){g+=a.colCount}),i.kf(b.row,b.col,e,g);if(c.col===d.col&&f===d.colCount)return h=0,a.forEach(function(a){h+=a.rowCount}),i.kf(b.row,b.col,h,f)}return B},lx:function(a,b){var c,d,e,f,g=B,h=Hb(b,"\r\n","\t",'"');return h&&(c=a.row<0?0:a.row,d=a.col<0?0:a.col,e=h.length,f=Ab(h),e>0&&f>0&&(g=new i.Range(c,d,e,f))),g},ox:function(){var a=this.tu();a&&a.hZ()},px:function(a,b,c,d,e,f,g,h,j){var k,m,o,q,r,s,t,u,v,w,x,y,z,A,C,D;if(a&&c.name()===a.name()&&c.parent&&!p(c.parent.sheets,a))return void a.ox();t=db.qx(h),sb(a),sb(c);try{if(a&&b){if(0!==(2&t)&&e&&n&&(a.Ns(b.row,b.col,ib(b),jb(b))||c.Ns(d.row,d.col,ib(d),jb(d))))throw L().Exp_ChangePartOfArray;if(e)l.staticMembers.moveTo(a,b.row,b.col,c,d.row,d.col,ib(b),jb(b),t),a.ox();else if(u=d.row<0?gb(c):ib(d),v=d.col<0?hb(c):jb(d),o=b.row<0?gb(a):ib(b),q=b.col<0?hb(a):jb(b),u>o||v>q)for(k=d.row,m=d.col,d.row<0&&o<gb(c)&&(k=0),d.col<0&&q<hb(c)&&(m=0),u%o===0&&1===v?v=q:1===u&&v%q===0?u=o:u%o===0&&v%q===0||(u=o,v=q),w=F(u/o),x=F(v/q),r=0;r<w;r++)for(s=0;s<x;s++)l.staticMembers.copyTo(a,b.row,b.col,c,k<0?-1:k+r*o,m<0?-1:m+s*q,k<0?-1:o,m<0?-1:q,t,j,mb(a));else l.staticMembers.copyTo(a,b.row,b.col,c,d.row,d.col,ib(b),jb(b),t,j,mb(a))}else{for(k=d.row,m=d.col,o=ib(d),q=jb(d),y=c.ITa,z=y.getSpans(i.kf(k,m,o,q)),A=z.length-1;A>=0;A--)y.do("removeSpan",z[A]);if(n&&(1&t)>0&&c.clearFormula(k,m,o,q,function(a,b){return!a.Ps||!a.Ps(b)}),f&&""!==f)C=0===h||2===h,C&&g&&(D=c.tu(),D&&D.R4(g,c,k,m)),c.setCsv(k,m,f,"\r\n","\t",16);else for(r=0;r<o;r++)for(s=0;s<q;s++)c.setValue(k+r,m+s,B)}}finally{tb(a,!1),tb(c,!1)}},sx:function(a){if(!this.isEditing()){var b=this.getSelections();if(b&&1===b.length)return this.bx(b,!0,a)}return B},r5:function(a,b){var c,d,e,f,g,h,i;if(a&&(c=a.length,c>1)){for(d=void 0,d=0;d<c;d++)for(e=a[d],f=d+1;f<c;f++)if(g=a[f],e.intersect(g.row,g.col,g.rowCount,g.colCount))return!1;for(h=a[0],i=void 0,d=1;d<c&&(i=a[d],h.row===i.row&&h.rowCount===i.rowCount);d++);if(d>=c)return b&&(b.inSameRow=!0),!0;for(d=1;d<c&&(i=a[d],h.col===i.col&&h.colCount===i.colCount);d++);if(d>=c)return b&&(b.inSameCol=!0),!0}return!1},o5:function(a){var b,c,d,e,f;if(a){if(b=a.length,1===b)return a[0];if(b>1){if(c=a[0],d=a[b-1],e=void 0,f=void 0,c.row===d.row&&c.rowCount===d.rowCount){for(e=0;e<b;e++)f=a[e],f.col<c.col&&(c=f),f.col>d.col&&(d=f);return i.kf(c.row,c.col,c.rowCount,d.col+d.colCount-c.col)}if(c.col===d.col&&c.colCount===d.colCount){for(e=0;e<b;e++)f=a[e],f.row<c.row&&(c=f),f.row>d.row&&(d=f);return i.kf(c.row,c.col,d.row+d.rowCount-c.row,c.colCount)}}}return B},J5:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=[],o=[];if(a&&(b=a.length,b>1&&(c=a[0],d=a[b-1],e=c.row===d.row&&c.rowCount===d.rowCount,f=c.col===d.col&&c.colCount===d.colCount,e||f)))for(a.sort(e?function(a,b){return a.col-b.col}:function(a,b){return a.row-b.row}),g=1;g<b;g++)for(h=a[g-1],i=a[g],j=e?h.col+h.colCount:h.row+h.rowCount,k=e?i.col:i.row,l=e?o:n,m=j;m<k;m++)l.push(m);return{rows:n,cols:o}},ux:function(a){var b,c,d,e,f,g,h=this;if(!h.isEditing()){if(b=h.getSelections(),b&&1===b.length){if(c=b[0],c.row!==-1&&h.Nu&&h.Nu()){for(d=[],e=-1,f=0;f<c.rowCount;f++)g=c.row+f,h.Ps(g)?e!==-1&&(d.push(i.kf(e,c.col,g-e,c.colCount)),e=-1):e===-1&&(e=g);e!==-1&&d.push(i.kf(e,c.col,c.row+c.rowCount-e,c.colCount)),b=d}return h.bx(b,!1,a)}if(h.r5(b))return h.bx(b,!1,a)}return B},vx:function(a){var b=this,c=b.mm,d,e,f;b.isEditing()||(a&&(d=a.pasteText,e=a.pasteHtml,f=a.callback),c&&!d&&c.gx(""),setTimeout(function(){var a,g,h,i;b.Js||(a=d||"",g=e||"",c&&!d&&(h=b.tu(),h&&(i=h.wx(),a=i.text,g=i.html),c.hx()),(x.msie||x.edge||d||!a&&!g)&&(b.J4(a,g),f&&f()),b.mm.Qq())},100))},J4:function(a,b){
var c=this,d=c.xx(a);d&&(d.cmd="clipboardPaste",d.sheetName=c.name(),lb(c)&&(d.clipboardHtml=b),c.wu().execute(d))},xx:function(a){var b,c,d,e,f,g,h,i,j,k=this,l=L().Exp_InvalidPastedArea,m=k.tu(),n=m.PA,o=m.n5,p=m.G4;if(p&&n&&o&&n.options.isProtected&&n.p5(o)&&(p=!1),b={pastedRange:B,pastedInternal:!1},c=[],d=k.getSelections(),d.length>1)for(f=0;f<d.length;f++){if(e=d[f],!k.ix(n,o,e,p,a,b))return;if(e.containsRange(b.pastedRange)&&!e.equals(b.pastedRange))return void k.Os(1,l);c.push(b.pastedRange)}else{if(e=d.length>0?d[0]:k.ITa.getSpan(k.Jl,k.Kl),!k.ix(n,o,e,p,a,b))return;c.push(b.pastedRange)}if(g=k.at,g&&g.jx(b.pastedInternal),b.pastedInternal||(n=B,o=B,p=!1),h=k.options.clipBoardOptions,p&&(h=0),o&&1===o.length)for(i=0;i<c.length;i++)j=c[i],k.nx(o[0],j)&&(j.rowCount=1,j.colCount=1);return(!o||o.length>1)&&c.length>1?void k.Os(1,L().Exp_MultipleSelections):{fromSheet:n,fromRanges:o,isCutting:p,pasteOption:h,pastedRanges:c,clipboardText:a}},l5:function(a,b,c,d,e){var f=this,g=gb(f),h=hb(f);return kb(f)?-1<=a&&(e||a<g)&&-1<=b&&(e||b<h):f.pu(a,b,c,d,g,h)},p5:function(a){for(var b=0;b<a.length;b++)if(this.ou(a[b]))return!0;return!1},yx:function(a,b,c,d){var e,f,g,h=this;h.endEdit&&!h.endEdit()||(e={sheet:h,sheetName:h.name(),row:h.Jl,col:h.Kl,cancel:!1},h.Wq(i.Events.LeaveCell,e),e.cancel!==!0&&(f=h.Jl,g=h.Kl,o(c)&&(c=h.Jl),o(d)&&(d=h.Kl),h.suspendPaint(),3===a?h.zx(c,d,b):4===a?h.Rs(c,d,b):1===a?h.Ax(c,d,b):2===a?h.Bx(c,d,b):5===a?h.Cx():6===a&&h.Dx(),h.Ss(a,f,g),h.resumePaint()))},Ex:function(a){var b,c,d,e=this;e.endEdit()&&(b={sheet:e,sheetName:e.name(),row:e.Jl,col:e.Kl,cancel:!1},e.Wq(i.Events.LeaveCell,b),b.cancel!==!0&&(c=e.Jl,d=e.Kl,3===a?e.Fx(e.Jl,e.Kl):4===a&&e.Gx(e.Jl,e.Kl),e.Ss(a,c,d)))},Ss:function(a,b,c){var d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this,y=x.mm,z=x.ITa.getSelections(),A=!1;x.Hx||(d=x.Tq(x.Ix()),(z.length>1||ib(d)>1||jb(d)>1)&&(A=!0),x.Tr()),e=x.Jl,f=x.Kl,g=x.ITa.getSpan(e,f),x.Lr=ib(g),x.Mr=jb(g),x.Hx||(h=x.Jx(e,f),j=x.selectionPolicy(),k=x.selectionUnit(),0===j?x.ITa.do("clearSelection"):1===j&&x.ITa.do("clearSelection"),1===k?(h.col=-1,h.colCount=-1):2===k&&(h.row=-1,h.rowCount=-1),x.Kx(h.row,h.col,ib(h),jb(h),!1),l=x.ITa.getSelections(),y.zu(z,l)&&(x.yu(z,l),x.Au(z))),x.Yq(e,f),b!==e&&(m=x.wq,m&&m.Lx()),n=x.yl,A?(o=x.am(),p=o.zr,q=o.Ar,r=o.width-p,s=o.height-q,n.Mx(p,q,r,s),n.repaint(new i.Rect(p,q,r,o.Cr)),n.repaint(new i.Rect(p,q,o.Br,s)),n.Pw(n.bm())):(t=x.ITa.getSpan(b,c),u=ib(t),v=jb(t),n.im(new i.Range(e,f,x.Lr,x.Mr).union(new i.Range(b,c,u,v)))),w={sheet:x,sheetName:x.name(),row:e,col:f},x.Wq(i.Events.EnterCell,w),x.Wq(i.Events.FormulatextboxEnterCell,w),y.cs&&y.cs(e,f)},Nx:function(a,b){var c=this,d=c.getDataValidator&&c.getDataValidator(a,b),e={sheet:c,sheetName:c.name(),row:a,col:b,validator:d,validationResult:0};return c.Wq(i.Events.ValidationError,e),e.validationResult}});function Ib(a,b){return a.sheets?a.getSheetFromName(b.sheetName):a}function Jb(a,b,c,d){var e=Ib(a,c),f=new b(e,c,d);return d?f.undo(e):f.execute(e)}M={},b.Commands=M,M.Ox=function(a,b){return!!a&&(2!==a.Px&&(a.yx(b,!1),!0))},M.Qx=function(a,b,c,d){return!!a&&(2!==a.Px&&(a.yx(b,!1,c,d),!0))},M.Rx=function(a,b,c){return!!a&&(2!==a.Px&&(!(a.endEdit&&!a.endEdit())&&(a.Sx(b,c),!0)))};function Kb(a){var b=a;return function(a,c){var d=Ib(a,c);return M.Ox(d,b)}}function Lb(a,b){var c=a,d=b;return function(a,b){var e=Ib(a,b);return M.Rx(e,c,d)}}function Mb(a,b){var c,d,e,f=a.parent;f&&(c=f.getSheetCount(),d=void 0,e=void 0,d=e=f.getActiveSheetIndex(),b?e<c-1&&e++:e>0&&e--,d!==e&&(f.dq(e,1),f.repaint()))}function Nb(a,b){a.Tx=!0,a.Hx?a.Ex(b):a.yx(b,!0),a.Tx=!1}function Ob(a,b){var c,d,e,f;return!!a.endEdit()&&(c=a.mm,c.Ux(),c.Vx(),i.Vl.Zl(B),d=!1,e=a.parent,e&&(f=b.call(e),f&&f.focus?(f.focus(),d=!0):e.Uv()),{ignoreCancelDefault:!d})}N="navigationLeft",O="navigationRight",P="navigationUp",Q="navigationDown",R="navigationHome2",S="navigationEnd2",T="navigationTop",U="navigationBottom",V="navigationHome",W="navigationFirst",X="navigationEnd",Y="navigationLast",Z="moveToNextCell",$="moveToPreviousCell",_="navigationPageUp",aa="navigationPageDown",ba="navigationPreviousSheet",ca="navigationNextSheet",da="clear",ea="clearAndEditing",fa="commitInputNavigationDown",ga="commitInputNavigationUp",ha="cancelInput",ia="commitArrayFormula",ja="selectionLeft",ka="selectionRight",la="selectionUp",ma="selectionDown",na="selectionHome",oa="selectionEnd",pa="selectionPageUp",qa="selectionPageDown",ra="selectionTop",sa="selectionBottom",ta="selectionFirst",ua="selectionLast",va="copy",wa="cut",xa="paste",ya="undo",za="redo",Aa="resizeColumn",Ba="resizeRow",Ca="splitResizeRow",Da="splitResizeColumn",Ea="autoFitColumn",Fa="autoFitRow",Ga="editCell",Ha="renameSheet",Ia="zoom",Ja="clearValues",Ka="clipboardPaste",La="selectNextControl",Ma="selectPreviousControl",Na="moveToNextCellThenControl",Oa="moveToPreviousCellThenControl",Pa="changeFormulaReference",M.bT=Ib,M.h4=Jb,M.uv=function(a){var b=i.Ul.sl(),c=!b,d=b;a.register(N,M[N],37,!1,!1,!1,!1),a.register(O,M[O],39,!1,!1,!1,!1),a.register(P,M[P],38,!1,!1,!1,!1),a.register(Q,M[Q],40,!1,!1,!1,!1),a.register(R,M[R],37,c,!1,!1,d),a.register(S,M[S],39,c,!1,!1,d),a.register(T,M[T],38,c,!1,!1,d),a.register(U,M[U],40,c,!1,!1,d),a.register(V,M[V],36,!1,!1,!1,!1),a.register(W,M[W],36,!0,!1,!1,!1),a.register(X,M[X],35,!1,!1,!1,!1),a.register(Y,M[Y],35,!0,!1,!1,!1),a.register(Z,M[Z],9,!1,!1,!1,!1),a.register($,M[$],9,!1,!0,!1,!1),a.register(_,M[_],33,!1,!1,!1,!1),a.register(aa,M[aa],34,!1,!1,!1,!1),a.register(ba,M[ba],33,c,!1,!1,d),a.register(ca,M[ca],34,c,!1,!1,d),a.register(da,M[da],46,!1,!1,!1,!1),a.register(ea,M[ea],8,!1,!1,!1,!1),a.register(fa,M[fa],13,!1,!1,!1,!1),a.register(ga,M[ga],13,!1,!0,!1,!1),a.register(ha,M[ha],27,!1,!1,!1,!1),a.register(ia,M[ia],13,!0,!0,!1,!1),a.register(ja,M[ja],37,!1,!0,!1,!1),a.register(ka,M[ka],39,!1,!0,!1,!1),a.register(la,M[la],38,!1,!0,!1,!1),a.register(ma,M[ma],40,!1,!0,!1,!1),a.register(na,M[na],36,!1,!0,!1,!1),a.register(oa,M[oa],35,!1,!0,!1,!1),a.register(pa,M[pa],33,!1,!0,!1,!1),a.register(qa,M[qa],34,!1,!0,!1,!1),a.register(na,M[na],37,c,!0,!1,d),a.register(oa,M[oa],39,c,!0,!1,d),a.register(ra,M[ra],38,c,!0,!1,d),a.register(sa,M[sa],40,c,!0,!1,d),a.register(ta,M[ta],36,!0,!0,!1,!1),a.register(ua,M[ua],35,!0,!0,!1,!1),a.register(va,M[va],67,c,!1,!1,d),a.register(wa,M[wa],88,c,!1,!1,d),a.register(xa,M[xa],86,c,!1,!1,d),a.register(ya,M[ya],90,c,!1,!1,d),a.register(za,M[za],89,c,!1,!1,d),b&&a.register(za,M[za],90,c,!0,!1,d),a.register(La,M[La]),a.register(Ma,M[Ma]),a.register(Na,M[Na]),a.register(Oa,M[Oa]),a.register(Pa,M[Pa]),a.register(Aa,M[Aa]),a.register(Ba,M[Ba]),a.register(Da,M[Da]),a.register(Ca,M[Ca]),a.register(Ea,M[Ea]),a.register(Fa,M[Fa]),a.register(Ga,M[Ga]),a.register(Ha,M[Ha]),a.register(Ia,M[Ia]),a.register(Ja,M[Ja]),a.register(Ka,M[Ka])},Qa={256:"bindingPath",4:"comment",2:"formula",16:"sparkline",64:"style",128:"tag",768:"formatString",1:"value"},Ra=".cellEditAction",M[N]={canUndo:!1,execute:Kb(3)},M[O]={canUndo:!1,execute:Kb(4)},M[P]={canUndo:!1,execute:Kb(1)},M[Q]={canUndo:!1,execute:Kb(2)},M[ia]={canUndo:!1,execute:function(a,b){var c=Ib(a,b),d=M.Wx;return d&&(c=d.fv(c)),c.fv&&c.fv(),!0}},M[fa]={canUndo:!1,execute:function(a,b){var c=Ib(a,b),d=M.Wx;return d&&(c=d.Xx(c)),c.yx(2,!1),!0}},M[ga]={canUndo:!1,execute:function(a,b){var c=Ib(a,b),d=M.Wx;return d&&(c=d.Yx(c)),c.yx(1,!1),!0}},M[V]={canUndo:!1,execute:function(a,b){var c=Ib(a,b);return M.Qx(c,4,B,c.frozenColumnCount()-1)}},M[R]={canUndo:!1,execute:function(a,b){var c=Ib(a,b);return M.Qx(c,4,B,-1)}},M[X]={canUndo:!1,execute:function(a,b){var c=Ib(a,b);return M.Qx(c,3,B,hb(c)-c.frozenTrailingColumnCount())}},M[S]={canUndo:!1,execute:function(a,b){var c=Ib(a,b);return M.Qx(c,3,B,hb(c))}},M[T]={canUndo:!1,execute:function(a,b){var c=Ib(a,b);return M.Qx(c,2,-1,B)}},M[U]={canUndo:!1,execute:function(a,b){var c=Ib(a,b);return M.Qx(c,1,gb(c),B)}},M[_]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h=Ib(a,b);if(!h||2===h.Px)return!1;if(c=h.Ew(),c===B||c===h.lq)return!0;if(d=h.Gr(1,3),e=h._q(h.Jl-d.length),e<c&&(e=c),f=M.Wx){if(g=f.Zx(h,e,c),g.r)return!0;h=g.sheet}return!!h.endEdit()&&(h.Qs(e,h.getActiveColumnIndex())&&(h.Jr(e,B),h.Qr=e,h.yx()),h.mq(c,0),!0)}},M[aa]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h=Ib(a,b);if(!h||2===h.Px)return!1;if(c=h.$x(),c===B||c===h.lq)return!0;if(d=h.Gr(1,3),e=h.gr(h.Jl+d.length),e<c&&(e=c),f=M.Wx){if(g=f._x(h,e,c),g.r)return!0;h=g.sheet}return!!h.endEdit()&&(h.Qs(e,h.getActiveColumnIndex())&&(h.Jr(e,B),h.Qr=e,h.yx()),h.mq(c,0),!0)}},M[ca]={canUndo:!1,execute:function(a,b){var c=Ib(a,b);Mb(c,!0)}},M[ba]={canUndo:!1,execute:function(a,b){var c=Ib(a,b);Mb(c,!1)}},M[W]={canUndo:!1,execute:function(a,b){var c,d,e=Ib(a,b);if(!e||2===e.Px)return!1;if(c=M.Wx){if(d=c.ay(e),d.r)return!0;e=d.sheet}return e.yx(5,!1,e.Jl,e.Kl),!0}},M[Y]={canUndo:!1,execute:function(a,b){var c,d,e=Ib(a,b);if(!e||2===e.Px)return!1;if(c=M.Wx){if(d=c.by(e),d.r)return!0;e=d.sheet}return e.yx(6,!1,e.Jl,e.Kl),!0}},M[La]={canUndo:!1,execute:function(a,b){var c=Ib(a,b);return!!c.parent&&Ob(c,c.parent.nextControl)}},M[Ma]={canUndo:!1,execute:function(a,b){var c=Ib(a,b);return!!c.parent&&Ob(c,c.parent.previousControl)}},M[Z]={canUndo:!1,execute:function(a,b){var c=Ib(a,b),d=M.Wx;return d&&(c=d.ey(c)),Nb(c,4),!0}},M[$]={canUndo:!1,execute:function(a,b){var c=Ib(a,b),d=M.Wx;return d&&(c=d.gy(c)),Nb(c,3),!0}},M[Na]={canUndo:!1,execute:function(a,b){var c,d,e=Ib(a,b),f=e.Qr,g=e.getActiveColumnIndex();return e.Tx=!0,c=e.hy(e.getActiveRowIndex(),g,!0,f),e.Tx=!1,d=!c||(c.leadingCellRow<f||c.leadingCellRow===f&&g>c.col),d?M[La].execute(a,b):M[Z].execute(a,b)}},M[Oa]={canUndo:!1,execute:function(a,b){var c,d,e=Ib(a,b),f=e.Qr,g=e.getActiveColumnIndex();return e.Tx=!0,c=e.iy(e.getActiveRowIndex(),g,!0,f),e.Tx=!1,d=!c||(c.leadingCellRow>f||c.leadingCellRow===f&&g<c.col),d?M[Ma].execute(a,b):M[$].execute(a,b)}},M[ha]={canUndo:!1,execute:function(a,b){var c,d,e,f,g,h,i=Ib(a,b),j=M.Wx;return j&&(c=j.jy(i)),i.isEditing()?(d=i.Jl,e=i.Kl,f=i.getValue(d,e,3,1),!!i.endEdit(!0)&&(g=i.ITa,h=g&&g.zHb,h&&h.getAnchorCell(d,e)||i.setValue(d,e,f,3,!0),!0)):o(c)?void M.Yxb(i.parent):c}},M.Yxb=function(a){var b,c,d,e=a&&a.sheets;if(e)for(b=0,c=e.length;b<c;b++)d=e[b],d&&d.at&&d.at.ky()},M[da]={canUndo:!1,execute:function(a,b){var c,d=Ib(a,b);return!d.isEditing()&&(c=d.getSelections(),d.wu().execute({cmd:Ja,sheetName:d.name(),ranges:c}),!0)}},M[ea]={canUndo:!1,execute:function(a,b){var c=Ib(a,b);return!c.isEditing()&&(i.Ul.sl()?(M[da].execute(a,b),!0):(c.startEdit(!0,""),!0))}},M[va]={canUndo:!1,execute:function(a,b){var c=Ib(a,b),d=b.copyData=c.ux(b.ignoreClipboard);return b.callback&&b.callback(),!d||C}},M[wa]={canUndo:!1,execute:function(a,b){var c=Ib(a,b),d=b.cutData=c.sx(b.ignoreClipboard);return b.callback&&b.callback(),!d||C}},M[xa]={canUndo:!1,execute:function(a,b){var c=Ib(a,b);c.vx(b)}},M[ja]={canUndo:!1,execute:Lb(37)},M[ka]={canUndo:!1,execute:Lb(39)},M[la]={canUndo:!1,execute:Lb(38)},M[ma]={canUndo:!1,execute:Lb(40)},M[na]={canUndo:!1,execute:Lb(37,!0)},M[oa]={canUndo:!1,execute:Lb(39,!0)},M[pa]={canUndo:!1,execute:Lb(33)},M[qa]={canUndo:!1,execute:Lb(34)},M[ra]={canUndo:!1,execute:Lb(38,!0)},M[sa]={canUndo:!1,execute:Lb(40,!0)},M[ta]={canUndo:!1,execute:Lb(36,!0)},M[ua]={canUndo:!1,execute:Lb(35,!0)},M[Pa]={canUndo:!1,execute:function(a,b){var c=Ib(a,b),d=c&&c.mm;if(d){ob(c);try{d.ly&&d.ly()}finally{pb(c)}}}},M[ya]={canUndo:!1,execute:function(a){var b,c=a;c&&(b=c.undoManager(),b&&b.canUndo()&&b.undo())}},M[za]={canUndo:!1,execute:function(a){var b,c=a;c&&(b=c.undoManager(),b&&b.canRedo()&&b.redo())}},M[Aa]={canUndo:!0,execute:function(a,b,c){return Jb(a,Ua,b,c)}},M[Ba]={canUndo:!0,execute:function(a,b,c){return Jb(a,Va,b,c)}},M[Da]={canUndo:!0,execute:function(a,b,c){return Jb(a,Wa,b,c)}},M[Ca]={canUndo:!0,execute:function(a,b,c){return Jb(a,Xa,b,c)}},M[Ea]={canUndo:!0,execute:function(a,b,c){return Jb(a,Ya,b,c)}},M[Fa]={canUndo:!0,execute:function(a,b,c){return Jb(a,Za,b,c)}},M[Ga]={canUndo:!0,execute:function(a,b,c){return Jb(a,$a,b,c)}},M[Ha]={canUndo:!0,execute:function(a,b,c){return Jb(a,_a,b,c)}},M[Ia]={canUndo:!0,execute:function(a,b,c){return Jb(a,ab,b,c)}},M[Ja]={canUndo:!0,execute:function(a,b,c){return Jb(a,cb,b,c)}},M[Ka]={canUndo:!0,execute:function(a,b,c){return Jb(a,eb,b,c)}},Sa=function(){function a(a,b,c){var d=this;d.kj=a,d.my=b,d.ny=c,d.oy=[],d.Iu=[],d.py()}return a.prototype.py=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,D=this,E=D.my,F=D.kj;if(F&&E){if(a=D.ny,b=E.row,c=E.col,d=ib(E),e=jb(E),f=D.oy,g=!1,b===-1&&(g=!0,b=0,d=gb(F)),c===-1&&(g=!0,c=0,e=hb(F)),i=[],(64&a)>0)for(k=0;k<e;k++)i[k]=F.Aj(-1,k)||B;for(l=0;l<d;l++)for(m=b+l,(64&a)>0&&(h=F.Aj(m,-1)||B),o=0;o<e;o++){if(p=void 0,q=c+o,n&&(2&a)>0&&F.getFormulaInformation&&(p=F.getFormulaInformation(m,q),p.hasFormula))if(p.isArrayFormula){if(r=p.baseRange,r.row===m&&r.col===q)for(s=r.row,t=r.row+ib(r);s<t;s++)for(u=r.col,v=r.col+jb(r);u<v;u++)D.qy(f,s-b,u-c,p,2)}else D.qy(f,l,o,p.formula,2);!((1&a)>0)||p&&p.hasFormula||D.qy(f,l,o,F.getValue(m,q,3),1),(16&a)>0&&F.getSparkline&&(w=F.getSparkline(m,q),x=B,w&&(x=w.data()),w&&x&&D.qy(f,l,o,w,16)),(64&a)>0&&(y=void 0,g?y=F.getActualStyle(m,q,3):(j=F.Aj(m,q)||B,y=F.Dq(m,q,3,j,h,i[o])),z=C,y&&y.toJSON&&(z=JSON.stringify(y.toJSON(3,!0))),D.qy(f,l,o,z,64)),A=F.ITa.Ky,(4&a)>0&&A&&D.qy(f,l,o,A.get(m,q),4),(128&a)>0&&D.qy(f,l,o,F.getTag(m,q,3),128),(256&a)>0&&D.qy(f,l,o,F.getBindingPath&&F.getBindingPath(m,q,3),256)}}},a.prototype.sy=function(){return this.oy},a.prototype.qy=function(a,b,c,d,e){!o(d)&&a&&(a[b]===C&&(a[b]=[]),a[b][c]===C&&(a[b][c]={}),a[b][c][Qa[e]]=d)},a.prototype.uy=function(a){var b,c,d,e,f,g,h,i,j;if(a)for(b=this,c=b.oy,d=0,e=a.length;d<e;d++)if(f=a[d])for(g=0,h=f.length;g<h;g++)i=f[g],i&&(c[d]||(c[d]=[]),j=c[d][g],j?b.vy(i,j)&&(c[d][g]=C):c[d][g]=i)},a.prototype.vy=function(a,b){var c,d,e,f=this.ny,g=[];for(256&f&&g.push(Qa[256]),4&f&&g.push(Qa[4]),2&f&&g.push(Qa[2]),16&f&&g.push(Qa[16]),64&f&&g.push(Qa[64]),128&f&&g.push(Qa[128]),768&f&&g.push(Qa[768]),1&f&&g.push(Qa[1]),c=0,d=g.length;c<d;c++)if(e=g[c],a[e]!==b[e])return!1;return!0},a.prototype.wy=function(){var a,b,c,d,e,f=this,g=f.my.row,h=f.my.col,i=f.oy,j=f.Iu;if(j&&j.length>0)return j;for(j=[],g=g===-1?0:g,h=h===-1?0:h,a=0,b=i.length;a<b;a++)if(c=i[a])for(d=0,e=c.length;d<e;d++)c[d]&&j.push({row:a+g,col:d+h});return f.Iu=j,j},a}(),M.xy=Sa,M.Bu=function(a,b,c,d,e,f,g){a&&(b<0&&(b=0,d=gb(a)),c<0&&(c=0,e=hb(a)),a.Bu(b,c,d,e,f,g))};function Pb(a,b){var c=[];return"string"==typeof b?c.push(a.getSheetFromName(b)):Array.isArray(b)&&b.forEach(function(b){c.push(a.getSheetFromName(b))}),c}M.bWa=function(a){return"changes"+a},M.cWa=function(a){return a&&(0!==a.length||!k.isEmptyObject(a))},M.aWa=function(a){var b,c=a.sheetName;return"string"==typeof c?b=[c]:Array.isArray(c)&&(b=c),!!b&&b.every(function(b){var c=M.bWa(b),d=a[c];return d&&0===d.length&&k.isEmptyObject(d)})},M.startTransaction=function(a,b){Pb(a,b.sheetName).forEach(function(a){a.ITa.startTransaction()})},M.endTransaction=function(a,b){Pb(a,b.sheetName).forEach(function(a){var c=M.bWa(a.name());b[c]=a.ITa.endTransaction()})},M.undoTransaction=function(a,b){Pb(a,b.sheetName).forEach(function(a){var c=M.bWa(a.name());a.ITa.undo(b[c]),a.$p()})},M.Zxb=function(a){a.forEach(function(a){a.ITa.startTransaction()})},M.$xb=function(a,b){a.forEach(function(a){var c=M.bWa(a.name());b[c]=a.ITa.endTransaction()})},M._xb=function(a,b){a.forEach(function(a){var c=M.bWa(a.name());a.ITa.undo(b[c])})};function Qb(a,b){ob(a),b||qb(a)}function Rb(a,b){b||rb(a),pb(a)}Ta=function(){function a(a,b){this.Lz=Qb,this.Mz=Rb;var c=this;c.kj=a,c.VQ=b}return a.prototype.execute=function(){},a.prototype.canExecute=function(){return!0},a.prototype.canUndo=function(){return!0},a.prototype.undo=function(){return!0},a}(),M.ActionBase=Ta;function Sb(a,b){o(a.lq)&&(a.lq=b.lq,a.qq=b.qq)}Ua=function(a){fb(b,a);function b(b,c){var d=a.call(this,b,c)||this;return Sb(c,b),d}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i,j,l,m,n,o,p,q,r,s=this,v=!1;if(s.canExecute()&&(a=s.VQ,b=s.kj,c=a.columns,d=a.rowHeader,e=c&&c.length,b&&e>0)){if(f=s.Sz(c),g={sheet:b,sheetName:b.name(),colList:f,header:d,cancel:!1},b.Wq(t,g),g&&g.cancel===!0)return v;a.Tz=!0,b.ITa.startTransaction(),Qb(b);try{for(h=2,i=3,j=d?hb(b,h):hb(b,i),b.qq=a.qq,l=a.size,m=0;m<e;m++)for(n=c[m],o=n.firstCol,p=n.lastCol,q=o;q<=p;q++)0<=q&&q<j&&(d&&b.getColumnResizable(q,h)&&l!==b.$r(q,h)?(b.setColumnWidth(q,l,h),v=!0):!d&&b.getColumnResizable(q,i)&&l!==b.$r(q,i)&&(b.setColumnWidth(q,l,i),v=!0))}finally{rb(b),k[k.sd]({tc:b.parent}),b.Wq(u,{sheet:b,sheetName:b.name(),colList:f,header:a.rowHeader}),pb(b),r=M.bWa(b.name()),a[r]=b.ITa.endTransaction()}b.qs()}return v},b.prototype.undo=function(){var a,b,c,d,e,f,g,h,i=this,j=!1;if(i.canUndo()&&(a=i.VQ,b=i.kj,c=a.columns,d=a.rowHeader,e=c&&c.length,b&&e>0)){if(f=i.Sz(c),g={sheet:b,sheetName:b.name(),colList:f,header:d,cancel:!1},b.Wq(t,g),g&&g.cancel===!0)return j;Qb(b);try{h=M.bWa(b.name()),b.ITa.undo(a[h]),b.oq=!0,b.showCell(b.getActiveRowIndex(),b.getActiveColumnIndex(),1,1),j=!0}finally{rb(b),k[k.sd]({tc:b.parent}),b.Wq(u,{sheet:b,sheetName:b.name(),colList:f,header:a.rowHeader}),pb(b)}}return j},b.prototype.Sz=function(a){var b,c,d,e,f,g,h=[];for(b=0,c=a.length;b<c;b++)for(d=a[b],e=d.firstCol,f=d.lastCol,g=e;g<=f;g++)h.push(g);return h},b.prototype.canUndo=function(){return this.VQ.Tz},b}(Ta),Va=function(a){fb(b,a);function b(b,c){var d=a.call(this,b,c)||this;return Sb(c,b),d}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i,j,l,m,n,o,p,q,r,s=this,t=!1;if(s.canExecute()&&(a=s.kj,b=s.VQ,c=b.rows,d=c&&c.length,a&&d>0)){if(e=s.Vz(c),f={sheet:a,sheetName:a.name(),rowList:e,header:b.columnHeader,cancel:!1},a.Wq(v,f),f&&f.cancel===!0)return t;b.Tz=!0,a.ITa.startTransaction(),Qb(a);try{for(g=3,h=1,i=b.columnHeader,j=i?gb(a,h):gb(a,g),a.lq=b.lq,l=b.size,m=0;m<d;m++)for(n=c[m],o=n.firstRow,p=n.lastRow,q=o;q<=p;q++)0<=q&&q<j&&(i&&a.getRowResizable(q,h)&&l!==a.Yr(q,h)?(a.setRowHeight(q,l,h),t=!0):!i&&a.getRowResizable(q,g)&&l!==a.Yr(q,g)&&(a.setRowHeight(q,l,g),t=!0))}finally{rb(a),k[k.sd]({tc:a.parent}),a.Wq(w,{sheet:a,sheetName:a.name(),rowList:e,header:b.columnHeader}),pb(a),r=M.bWa(a.name()),b[r]=a.ITa.endTransaction()}a.os()}return t},b.prototype.undo=function(){var a,b,c,d,e,f,g,h=this,i=!1;if(h.canUndo()&&(a=h.kj,b=h.VQ,c=b.rows,d=c&&c.length,a&&d>0)){if(e=h.Vz(c),f={sheet:a,sheetName:a.name(),rowList:e,header:b.columnHeader,cancel:!1},a.Wq(v,f),f&&f.cancel===!0)return i;Qb(a);try{g=M.bWa(a.name()),a.ITa.undo(b[g]),a.jq=!0,a.showCell(a.getActiveRowIndex(),a.getActiveColumnIndex(),1,1),i=!0}finally{rb(a),k[k.sd]({tc:a.parent}),a.Wq(w,{sheet:a,sheetName:a.name(),rowList:e,header:b.columnHeader}),pb(a)}}return i},b.prototype.Vz=function(a){var b,c,d,e,f,g,h=[];for(b=0,c=a.length;b<c;b++)for(d=a[b],e=d.firstRow,f=d.lastRow,g=e;g<=f;g++)h.push(g);return h},b.prototype.canUndo=function(){return this.VQ.Tz},b}(Ta),Wa=function(a){fb(b,a);function b(b,c){var d=a.call(this)||this,e=d;return e.kj=b,e.VQ=c,d}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i=this,j=!1,l=i.VQ,m=i.kj,n=l.columns,o=l.rowHeader,p=i.Sz(n);if(m&&n&&n.length>0){if(a={sheet:m,sheetName:m.Cj,colList:p,header:o,cancel:!1},m.Wq(t,a),a&&a.cancel===!0)return j;m.ITa.startTransaction(),i.Lz(m);try{b=G(l.size),c=o?2:3,d=n[0].firstCol,e=void 0,f=void 0,g=void 0,e=m.$r(d,c),b!==e&&(f=b-e,g=m.Zq(d,c),m.setColumnWidth(d,b,c),m.setColumnWidth(g,m.$r(g,c)-f,c)),j=!0}finally{rb(m),k[k.sd]({tc:m.parent}),m.Wq(u,{sheet:m,sheetName:m.Cj,colList:p,header:l.rowHeader}),pb(m),h=M.bWa(m.name()),l[h]=m.ITa.endTransaction()}}return j},b.prototype.undo=function(){var a,b=this.kj,c=this.VQ.columns,d=!1,e=this.VQ,f=this.VQ.rowHeader,g=this.Sz(c),h={sheet:b,sheetName:b.Cj,colList:g,header:f,cancel:!1};if(b.Wq(t,h),h&&h.cancel===!0)return d;Qb(b);try{a=M.bWa(b.name()),b.ITa.undo(e[a]),d=!0}finally{rb(b),k[k.sd]({tc:b.parent}),b.Wq(u,{sheet:b,sheetName:b.Cj,colList:g,header:e.rowHeader}),pb(b)}return d},b.prototype.Sz=function(a){var b,c,d,e,f,g,h=[];for(b=0,c=a.length;b<c;b++)for(d=a[b],e=d.firstCol,f=d.lastCol,g=e;g<=f;g++)h.push(g);return h},b}(Ta),Xa=function(a){fb(b,a);function b(b,c){var d=a.call(this)||this,e=d;return e.kj=b,e.VQ=c,d}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i=this,j=!1,l=i.VQ,m=i.kj,n=l.rows,o=l.columnHeader,p=i.Vz(n);if(m&&n&&n.length>0){if(a={sheet:m,sheetName:m.Cj,rowList:p,header:o,cancel:!1},m.Wq(v,a),a&&a.cancel===!0)return j;m.ITa.startTransaction(),i.Lz(m);try{b=G(l.size),c=o?1:3,d=n[0].firstRow,e=void 0,f=void 0,g=void 0,e=m.Yr(d,c),b!==e&&(f=b-e,g=m._q(d,c),m.setRowHeight(d,b,c),m.setRowHeight(g,m.Yr(g,c)-f,c)),j=!0}finally{rb(m),k[k.sd]({tc:m.parent}),m.Wq(w,{sheet:m,sheetName:m.Cj,rowList:p,header:l.columnHeader}),pb(m),h=M.bWa(m.name()),l[h]=m.ITa.endTransaction()}}return j},b.prototype.undo=function(){var a,b=this.kj,c=this.VQ.rows,d=!1,e=this.VQ,f=this.VQ.columnHeader,g=this.Vz(c),h={sheet:b,sheetName:b.Cj,rowList:g,header:f,cancel:!1};if(b.Wq(v,h),h&&h.cancel===!0)return d;Qb(b);try{a=M.bWa(b.name()),b.ITa.undo(e[a]),d=!0}finally{rb(b),k[k.sd]({tc:b.parent}),b.Wq(w,{sheet:b,sheetName:b.Cj,rowList:g,header:e.columnHeader}),pb(b)}return d},b.prototype.Vz=function(a){var b,c,d,e,f,g,h=[];for(b=0,c=a.length;b<c;b++)for(d=a[b],e=d.firstRow,f=d.lastRow,g=e;g<=f;g++)h.push(g);return h},b}(Ta),Ya=function(a){fb(b,a);function b(b,c){var d=a.call(this,b,c)||this,e=d,f=b.parent;return e.Wz=c.rowHeader?2:3,y(c.autoFitType)||(c.autoFitType=f?f.options.autoFitType:0),d}return b.prototype.canExecute=function(){var a=this.VQ;return this.kj&&a.columns&&a.columns.length>0},b.prototype.execute=function(){var a,b,c,d,e,f,g,h,j,l,m,n,p,q,r,s=this,v=!1;if(s.canExecute()){if(a=s.VQ,b=s.kj,c=s.Wz,d=s.Sz(a.columns),e=2===c,f={sheet:b,sheetName:b.name(),colList:d,header:e,cancel:!1},b.Wq(t,f),f&&f.cancel===!0)return v;for(a.Tz=!0,g=hb(b,c),h=g-1,j=0,l=void 0,m=0,n=a.columns.length;m<n;m++)l=a.columns[m].col,h=h>l?l:h,j=j<l?l:j;i.mn.qn(b,0,h,gb(b)-1,j),b.ITa.startTransaction(),Qb(b);try{for(p=void 0,m=0,n=a.columns.length;m<n;m++)q=a.columns[m].col,0<=q&&q<g&&b.getColumnResizable(q,c)&&(p=s.xl(q),p===b.getColumnWidth(q,c)&&o(b.getColumnWidth(q,c,!0))||(b.setColumnWidth(q,p,c),v=!0))}finally{i.mn.Nm(),rb(b),k[k.sd]({tc:b.parent}),b.Wq(u,{sheet:b,sheetName:b.name(),colList:d,header:e}),pb(b),r=M.bWa(b.name()),a[r]=b.ITa.endTransaction()}}return v},b.prototype.undo=function(){var a,b,c,d,e,f,g,h=this,i=!1;if(h.canUndo()){if(a=h.VQ,b=h.kj,c=h.Wz,d=h.Sz(a.columns),e=2===c,f={sheet:b,sheetName:b.name(),colList:d,header:e,cancel:!1},b.Wq(t,f),f&&f.cancel===!0)return i;Qb(b);try{g=M.bWa(b.name()),b.ITa.undo(a[g]),i=!0}finally{rb(b),k[k.sd]({tc:b.parent}),b.Wq(u,{sheet:b,sheetName:b.name(),colList:d,header:e}),pb(b)}}return i},b.prototype.Sz=function(a){var b,c,d=[];for(b=0;b<a.length;b++)c=a[b],d.push(c.col);return d},b.prototype.xl=function(a){return i.Ul.xl(a,this.kj,this.Wz,this.VQ.autoFitType)},b.prototype.canUndo=function(){return this.VQ.Tz},b}(Ta),Za=function(a){fb(b,a);function b(b,c){var d=a.call(this,b,c)||this,e=d,f=b.parent;return e.Wz=c.columnHeader?1:3,y(c.autoFitType)||(c.autoFitType=f?f.options.autoFitType:0),d}return b.prototype.canExecute=function(){var a=this.VQ;return this.kj&&a.rows&&a.rows.length>0},b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i,j,l,m,n=this,p=!1;if(n.canExecute()){if(a=n.VQ,b=n.kj,c=n.Vz(a.rows),d=n.Wz,e=1===n.Wz,f={sheet:b,sheetName:b.name(),rowList:c,header:e,cancel:!1},b.Wq(v,f),f&&f.cancel===!0)return p;a.Tz=!0,b.ITa.startTransaction(),Qb(b);try{for(g=gb(b,d),h=void 0,i=0,j=a.rows.length;i<j;i++)l=a.rows[i].row,0<=l&&l<g&&b.getRowResizable(l,d)&&(h=n.Fl(l),h===b.getRowHeight(l,d)&&o(b.getRowHeight(l,d,!0))||(b.setRowHeight(l,h,d),p=!0))}finally{rb(b),k[k.sd]({tc:b.parent}),b.Wq(w,{sheet:b,sheetName:b.name(),rowList:c,header:e}),pb(b),m=M.bWa(b.name()),a[m]=b.ITa.endTransaction()}}return p},b.prototype.undo=function(){var a,b,c,d,e,f,g=this,h=!1;if(g.canUndo()){if(a=g.VQ,b=g.kj,c=g.Vz(a.rows),d=1===g.Wz,e={sheet:b,sheetName:b.name(),rowList:c,header:d,cancel:!1},b.Wq(v,e),e&&e.cancel===!0)return h;Qb(b);try{f=M.bWa(b.name()),b.ITa.undo(a[f]),h=!0}finally{rb(b),k[k.sd]({tc:b.parent}),b.Wq(w,{sheet:b,sheetName:b.name(),rowList:c,header:d}),pb(b)}}return h},b.prototype.Vz=function(a){var b,c,d,e=[];for(b=0,c=a.length;b<c;b++)d=a[b],e.push(d.row);return e},b.prototype.Fl=function(a){return i.Ul.Fl(a,this.kj,this.Wz,this.VQ.autoFitType)},b.prototype.canUndo=function(){return this.VQ.Tz},b}(Ta);function Tb(a,b){"value"===b.propertyName&&a.xu(b.row,b.col,b.oldValue,b.newValue)}$a=function(a){fb(b,a);function b(b,c){var d,e,f=a.call(this,b,c)||this;return n&&c.ranges&&1===c.endEditType&&(d=b.Tq(c.ranges[0]),c.ranges[0]=d,1===ib(d)&&1===jb(d)&&(e=b.Ms(d.row,d.col,1,1),e&&e.ranges&&e.ranges.length>0&&(c.ranges=[e.ranges[0]]))),f}return b.prototype.canExecute=function(){var a,b,c=this,d=c.kj,e=c.VQ,f=e.ranges,g=e.row,h=e.col;if(f){for(a=0;a<f.length;a++)if(b=f[a],!d.Y3(b.row,b.col,ib(b),jb(b)))return!1}else if(!d.Y3(g,h,1,1))return!1;return!0},b.prototype.yA=function(a){var b,c,d,e,f=this,g=f.VQ,h=g.ranges;if(h)for(b=0;b<h.length;b++)for(c=h[b],d=c.row;d<c.row+ib(c);d++)for(e=c.col;e<c.col+jb(c);e++)a(d,e);else a(g.row,g.col)},b.prototype.undo=function(){var a,b,c,d=this;if(d.canUndo()){a=d.kj,b=d.VQ,Qb(a,!0);try{a.Fu(s+Ra,function(b,c){Tb(a,c)}),c=M.bWa(a.name()),a.ITa.undo(b[c])}catch(a){return!1}finally{a.Gu(s+Ra),Rb(a,!0)}return!0}return!1},b.prototype.execute=function(){var a,b,c,d,e=this,f=!1;if(e.canExecute()){a=e.kj,a.ITa.startTransaction(),Qb(a,!0);try{a.Fu(s+Ra,function(b,c){Tb(a,c)}),e.VQ.applyResult=e.AA(),f=!0}catch(a){f=!1}finally{a.Gu(s+Ra),Rb(a,!0),b=M.bWa(a.name()),e.VQ[b]=a.ITa.endTransaction()}c=a.am(),d=new i.Rect(c.kt,c.nt,c.width-c.kt,c.height-c.nt),a.repaint(d)}return f},b.prototype.zA=function(a,b){return a+"_"+b},b.prototype.BA=function(a){var b,c,d,e,f,g,h=this,i=0,j=h.kj,k=h.VQ,l=k.row,m=k.col,o=k.newValue,p=!k.hasOwnProperty("autoFormat")||k.autoFormat;return n&&o&&o.length>0&&"="===o[0]?j.getDataValidator&&j.getDataValidator(l,m)&&(b=o.substring(1),""!==b&&b!==j.getFormula(l,m)&&(c=j.Cf(),c&&(d=c.parse(j.yj(),b,l>=0?l:0,m>=0?m:0,!0),d&&(e=c.Hg(j.yj(),d,{row:l,col:m}),j.isValid&&!j.isValid(l,m,e)&&(i=j.Nx(l,m)))))):(f=h.CA(l,m,o,p,a),g=!j.isValid||j.isValid(l,m,f),g||(i=j.Nx(l,m),j.mm.DA=!0)),i},b.prototype.AA=function(){var a,b,c,d,e,f,h,j,k,l,o,p,q,r,s,t=this,u=t.kj,v=t.VQ,w=v.newValue,x={tka:!1,uka:!1,_autoFormatter:C,quotePrefix:C},y=t.BA(x);if(1===y||2===y)return y;if(b=!v.hasOwnProperty("autoFormat")||v.autoFormat,c=v.row,c=c>=0?c:0,d=v.col,d=d>=0?d:0,e=n&&m&&m.Parser)if(j=u.Cf(),k=u.parent,l=k&&k.options.allowUserEditFormula,l&&j&&w&&w.length>0&&"="===w[0])try{if(v.ranges&&1===v.endEditType)return h=v.ranges[0],u.setArrayFormula(h.row,h.col,ib(h),jb(h),w.substring(1)),y;f=j.parse(u.yj(),w.substring(1),c,d,!0)}catch(a){throw u.Os(0,"string"==typeof a?a:a.message),a}else v.ranges&&1===v.endEditType&&(h=v.ranges[0],u.getRange(h.row,h.col,ib(h),jb(h),3).clear(1));return f||(w&&"'"===w[0]?t.Uia(c,d,!0,x):t.Uia(c,d,C,x),a=t.CA(c,d,w,b,x)),t.yA(function(b,c){if(f)try{u._u(b,c,j.unparse(u.yj(),f,b,c),f),u.Wq(i.Events.UserFormulaEntered,{sheet:u,sheetName:u.name(),row:b,col:c,formula:w.substring(1).toUpperCase()})}catch(a){throw u.Os(0,"string"==typeof a?a:a.message),a}else{try{u.hasFormula&&u.hasFormula(b,c)&&u.setFormula(b,c,B)}catch(a){throw u.Os(0,"string"==typeof a?a:a.message),a}try{u.uq(b,c,a,v.sheetArea)}catch(a){u.setValue(b,c,w)}}}),o=x.tka,p=x.uka,(o||p)&&(q=u.Aj(c,d),r="string"==typeof q,q&&!r||(s=new g.Style,r&&(s.parentName=q),q=s),o&&(q._autoFormatter=x._autoFormatter),p&&(q.quotePrefix=x.quotePrefix),u.setStyle(c,d,q)),y},b.prototype.canUndo=function(){return 0===this.VQ.applyResult},b.prototype.CA=function(a,b,c,d,e){var f,g,h,j=this,k=j.kj,l=j.VQ,m=k.getActualStyle(a,b),n={};return f="string"==typeof c?c&&"'"===c[0]?c.substring(1):i.Ul.ul(m,c,d,n,l.editingFormatter):c,e.quotePrefix?(e._autoFormatter=C,e.tka=!0):(g=n.value,d&&g&&(h=B,(f!==B&&"General"!==g.formatString()||!m._autoFormatter)&&(g.isAuto=!0,h=g),h&&(e.tka=!0,e._autoFormatter=h))),f},b.prototype.Uia=function(a,b,c,d){var e,f=this,h=f.kj,i=h.Aj(a,b),j="string"==typeof i;i&&!j||(e=new g.Style,j&&(e.parentName=i),i=e),i.quotePrefix!==c&&(d.uka=!0,d.quotePrefix=c)},b}(Ta);function Ub(a){var b=a.parent,c=b&&b.hq;c&&c.repaint()}_a=function(a){fb(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canUndo=function(){return!!this.VQ.FA},b.prototype.canExecute=function(){var a=this,b=a.VQ;return a.kj&&b.name&&b.name!==b.FA},b.prototype.execute=function(){var a,b=this,c=b.kj,d=b.VQ,e=d.name,f=!1;return b.canExecute()&&(d.FA=c.name(),c.ITa.startTransaction(),Qb(c,!0),sb(c),c.cq(e),Ub(c),a=M.bWa(c.name()),d[a]=c.ITa.endTransaction(),f=!0,d.sheetName=e,tb(c),Rb(c,!0)),f},b.prototype.undo=function(){var a,b,c,d=this;return!(!d.canUndo()||(a=d.kj,b=d.VQ,!a))&&(Qb(a,!0),sb(a),c=M.bWa(a.name()),a.ITa.undo(b[c]),Ub(a),b.sheetName=b.FA,tb(a),Rb(a,!0),!0)},b}(Ta),ab=function(a){fb(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.canExecute=function(){var a=this;return a.kj&&a.kj.parent.options.allowUserZoom&&a.kj.zoom()!==a.VQ.zoomFactor},b.prototype.execute=function(){var a,b,c,d,e=this,f=e.VQ,g=!1;return e.canExecute()&&(a=e.kj,b=a.ITa,c=f.zoomFactor,b.startTransaction(),g=Vb(a,c),b.ZVa(["zoomChanged",c,f.oldZoomFactor]),d=M.bWa(a.name()),f[d]=a.ITa.endTransaction()),g},b.prototype.undo=function(){var a,b=this.kj;if(this.canUndo())return!(b.isEditing()===!0&&!b.endEdit())&&(b.suspendPaint(),a=M.bWa(b.name()),b.ITa.undo(this.VQ[a]),b.resumePaint(),!0)},b}(Ta);function Vb(a,b){return!(a.isEditing()===!0&&!a.endEdit())&&(a.suspendPaint(),a.zoom(b),a.resumePaint(),!0)}bb=function(a){fb(b,a);function b(b,c){return a.call(this,b,c)||this}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h,i,j=this;j.canExecute()&&(a=j.kj,b=j.VQ.clearRange,a.isDirtySuspended()||(j.VQ.Iu=new Sa(a,a.Tq(b),3)),c=a.Tq(b),d=c.row,e=c.col,f=ib(c),g=jb(c),g>0&&f>0&&(a.ITa.startTransaction(),Qb(a),a.vxb=!0,a.getRange(d,e,f,g,3).clear(1),k[k.sd]({tc:a.parent}),Rb(a),a.vxb=!1,h=M.bWa(a.name()),j.VQ[h]=a.ITa.endTransaction(),i=j.VQ.Iu,M.Bu(a,d,e,f,g,i?i.wy():[],2)))},b.prototype.canExecute=function(){var a=this.VQ.clearRange;return this.kj.Y3(a.row,a.col,ib(a),jb(a))},b.prototype.canUndo=function(){var a=M.bWa(this.kj.name()),b=this.VQ[a];return M.cWa(b)},b.prototype.undo=function(){var a,b,c,d=this,e=d.kj;if(d.canUndo()&&e&&(a=e.Tq(d.VQ.clearRange),jb(a)>0&&ib(a)>0)){Qb(e);try{b=M.bWa(e.name()),e.ITa.undo(d.VQ[b])}finally{Rb(e)}return c=d.VQ.Iu,M.Bu(e,a.row,a.col,ib(a),jb(a),c?c.wy():[],2),!0}return!1},b}(Ta),cb=function(a){fb(b,a);function b(b,c,d){var e,f,g=a.call(this,b,c)||this;if(!d&&(c.MA=[],e=c.ranges,e&&e.length>0))for(f=0;f<e.length;f++)c.MA[f]=new bb(b,{clearRange:e[f]});return g}return b.prototype.canExecute=function(){var a,b,c=this.VQ.MA;if(c){for(a=0;a<c.length;a++)if(b=c[a],!b.canExecute())return!1;return!0}return!1},b.prototype.execute=function(){var a,b,c,d,e=this;if(e.canExecute()&&(a=e.VQ.MA,b=e.kj,a)){for(Qb(b,!0),c=0;c<a.length;c++)d=a[c],d.execute();return Rb(b,!0),!0}return!1},b.prototype.canUndo=function(){var a,b,c=this.VQ.MA;if(c){for(a=0;a<c.length;a++)if(b=c[a],!b.canUndo())return!1;return!0}return!1},b.prototype.undo=function(){var a,b,c,d,e=this,f=e.VQ.MA;if(e.canUndo()){for(a=e.kj,b=f.length-1;b>=0;b--)if(c=f[b],Qb(a,!0),d=c.undo(),Rb(a,!0),!d)return!1;return!0}return!1},b}(Ta),M.OA=cb,db=function(a){fb(b,a);function b(b,c){return a.call(this,b,c)||this}return b.qx=function(a){var b=0;return 0!==a&&1!==a||(b|=1),0!==a&&2!==a||(b|=64,b|=32),0!==a&&3!==a||(b|=2),0!==a&&4!==a||(b|=1,b|=64,b|=32),0!==a&&5!==a||(b|=64,b|=32,b|=2),0===a&&(b|=32,b|=16,b|=256,b|=4,b|=512,b|=128,b|=768),b},b.prototype.canExecute=function(){
var a=this,b=a.VQ,c=b.pasteExtent,d=c.targetRange,e=c.sourceRange;return b.toSheet.Y3(d.row,d.col,ib(d),jb(d))&&(!c.isCutting||b.fromSheet.Y3(e.row,e.col,ib(e),jb(e)))},b.prototype.oUa=function(){var a=this,c=a.VQ.pasteExtent,d=a.VQ.io={},e=c.isCutting,f=b.qx(a.VQ.pasteOption),g=c.sourceRange,h=c.targetRange,i=a.VQ.fromSheet,j=a.VQ.toSheet;i&&g&&e&&!i.isDirtySuspended()&&(d.cA=new Sa(i,g,f)),j.isDirtySuspended()||(d.fA=new Sa(j,h,f))},b.prototype.VA=function(){return this.VQ.pasteExtent.targetRange},b.prototype.execute=function(){var a,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t=this;if(t.canExecute()){if(a=t.VQ.fromSheet,c=t.VQ.toSheet,d=t.VQ.pasteExtent,e=t.VQ.pasteOption,f=d.sourceRange,g=d.targetRange,h=d.isCutting,a&&f&&!a.pu(f.row,f.col,ib(f),jb(f),gb(a),hb(a)))return;if(!(c&&g&&c.l5(g.row,g.col,ib(g),jb(g),!0)))return;if(c.tables&&c.tables.zxb(a,f,c,g,h))return;t.oUa(),j=c.parent.sheets,M.Zxb(j),ob(c),qb(c),c.vxb=!0,a&&(qb(a),a.vxb=!0);try{kb(c)&&(k=-1,l=-1,g.row!==-1?k=g.row+ib(g):f.row===-1&&(k=gb(a)),m=gb(c),k>m&&t.vTa(f,g)&&c.addRows(m,k-m),g.col!==-1?l=g.col+jb(g):f.col===-1&&(l=hb(a)),l>hb(c)&&t.vTa(f,g)&&c.setColumnCount(l)),f&&i.mn.qn(a,f.row,f.col,f.row+ib(f)-1,f.col+jb(f)-1);try{c.tables&&d.clipboardText.replace(/[\r\n\t]/gi,"")&&c.tables.AHb(g,f)}catch(a){return c.Os(6,a.message),void c.resumePaint()}c.px(a,f,c,g,d.isCutting,d.clipboardText,d.clipboardHtml,e,!d.includeFilteredOutRow)}finally{f&&i.mn.Nm(),rb(c),c.vxb=!1,a&&(rb(a),a.vxb=!1),pb(c),M.$xb(j,t.VQ),n=t.VQ.io,o=b.qx(e),d.isCutting&&a&&(p=[],a.isDirtySuspended()||(q=new Sa(a,f,o),q.uy(n.cA.sy()),n._z=q,p=q.wy()),M.Bu(a,f.row,f.col,ib(f),jb(f),p,3)),c&&(r=[],c.isDirtySuspended()||(s=new Sa(c,g,o),s.uy(n.fA.sy()),n.dA=s,r=s.wy()),M.Bu(c,g.row,g.col,ib(g),jb(g),r,3))}}},b.prototype.vTa=function(a,b){var c,d,e,f,g,h,i;return!a||(c=a.row,d=a.col,e=b.row,f=b.col,g=c===-1&&d!==-1,h=d===-1&&c!==-1,i=c===-1&&d===-1,c!==-1&&d!==-1||g&&e<=0||h&&f<=0||i&&e<=0&&f<=0)},b.prototype.undo=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,q,r,s=this;if(s.canUndo()){if(a=s.VQ.fromSheet,b=s.VQ.toSheet,c=s.VQ.pasteExtent,d=c.sourceRange,e=c.targetRange,!b||!e)return!1;if(!b.pu(e.row,e.col,ib(e),jb(e),gb(b),hb(b)))return!1;if(a&&d){if(!a.pu(d.row,d.col,ib(d),jb(d),gb(a),hb(a)))return!1;if(a&&a.name()===b.name()&&b.parent&&!p(b.parent.sheets,a))return!1}f=s.VQ.io,ob(b);try{g=e.row<0?0:e.row,h=e.col<0?0:e.col,i=e.row<0?gb(b):ib(e),j=e.col<0?hb(b):jb(e),k=b.parent.sheets,M._xb(k,s.VQ),l=0,m=0,n=0,o=0,a&&d&&(l=d.row<0?0:d.row,m=d.col<0?0:d.col,n=d.row<0?gb(a):ib(d),o=d.col<0?hb(a):jb(d)),b&&(q=f.dA,M.Bu(b,g,h,i,j,q?q.wy():[],3)),a&&(r=f._z,M.Bu(a,l,m,n,o,r?r.wy():[],3))}finally{pb(b)}}return!0},b}(Ta),eb=function(a){fb(b,a);function b(b,c,d){var e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=a.call(this,b,c)||this;if(!d){if(e=b,f=c.fromSheet,!e)throw Error(L().Exp_DestSheetIsNull);if(g=c,h=g.pastedRanges,h&&h.length>0)if(c.MA=[],j=g.fromRanges||[g.fromRange],k=j.length,l=g.isCutting,m=g.clipboardText,n=g.clipboardHtml,o=g.pasteOption,p={},q=h[0],!l&&f&&f.r5(j,p)&&q.equals(f.q5(j,q))){for(r=p.inSameRow,s=p.inSameCol,r?j.sort(function(a,b){return a.col-b.col}):s&&j.sort(function(a,b){return a.row-b.row}),t=q.row,u=q.col,v=0;v<k;v++)w=j[v],x=w.rowCount,y=w.colCount,z={sourceRange:w,targetRange:i.kf(t,u,x,y),isCutting:l,clipboardText:m,clipboardHtml:n,includeFilteredOutRow:!0},c.MA[v]=new db(b,{fromSheet:f,toSheet:e,pasteExtent:z,pasteOption:o}),r?u+=y:s&&(t+=x);c.s5=!0}else for(A=0;A<h.length;A++)B={sourceRange:j[0],targetRange:h[A],isCutting:l,clipboardText:m,clipboardHtml:n},c.MA[A]=new db(b,{fromSheet:f,toSheet:e,pasteExtent:B,pasteOption:o})}return C}return b.prototype.execute=function(){var a,b,c,d,e,f,g,h=this,j=h.VQ,k=j.MA,l=!1;if(h.canExecute()&&k){a=h.kj,b=a.parent.getActiveSheet(),Qb(b,!0);try{for(c=!1,d=0;d<k.length;d++)e=k[d],a?(f=e.VQ.pasteExtent,g={sheet:a,sheetName:a.name(),cellRange:e.VA(),pasteOption:e.VQ.pasteOption,pasteData:{text:f.clipboardText,html:f.clipboardHtml},cancel:!1},a.Wq(i.Events.ClipboardPasting,g),g.cancel||(l=e.execute(),delete g.cancel,c=!0,a.Wq(i.Events.ClipboardPasted,g))):l=e.execute();c&&h.WA()}finally{Rb(b,!0)}}return l},b.prototype.WA=function(){var a,b,c,d,e,f,g=this,h=g.VQ,i=h.MA,j=g.kj;if(j&&i){if(a=j.getSelections(),j.Tr(),h.s5)b=h.pastedRanges[0],j.addSelection(b.row,b.col,ib(b),jb(b));else if(i.length>1)for(c=0;c<i.length;c++)d=i[c],e=d.VA(),j.addSelection(e.row,e.col,ib(e),jb(e));else i.length>0&&(f=i[0].VA(),j.addSelection(f.row,f.col,ib(f),jb(f)),f.contains(j.Jl,j.Kl)||j.Jr(f.row,f.col));j.yu(a,j.getSelections())&&j.Au(a)}},b.prototype.canExecute=function(){var a,b,c=this.VQ.MA;if(c){for(a=0;a<c.length;a++)if(b=c[a],!b.canExecute())return!1;return!0}return!1},b.prototype.canUndo=function(){var a,b,c=this.VQ.MA;if(c){for(a=0;a<c.length;a++)if(b=c[a],!b.canUndo())return!1;return!0}return!1},b.prototype.undo=function(){var a,b,c,d,e=this,f=e.VQ.MA;if(e.canUndo()&&f){a=!0,b=e.kj.parent.getActiveSheet(),Qb(b,!0);try{for(c=f.length-1;c>=0;c--)d=f[c],a=a&&d.undo()}finally{Rb(b,!0)}return a}return!1},b}(Ta)},"./dist/core/worksheet/worksheet-border.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/worksheet/style.js"),e=c("./dist/core/util/domUtil.js"),f=void 0,g=null,h=Math.sqrt,i=Math.pow,j=Math.min,k=Math.abs,l=Math.tan,m=Math.floor,n=Math.PI,o=e.GC$.inherit,p=e.GC$.isEmptyObject,q={LEFT_TOP:0,RIGHT_TOP:1,RIGHT_BOTTOM:2,LEFT_BOTTOM:3},r={H_TOP_LEFT:0,H_TOP_Right:1,V_RIGHT_TOP:2,V_RIGHT_BOTTOM:3,H_BOTTOM_RIGHT:4,H_BOTTOM_LEFT:5,V_LEFT_BOTTOM:6,V_LEFT_TOP:7},s=function(){function a(){}return a.prototype.mE=function(a){var b=this;0===a._orientation?(a.nE&&(b.oE+=a.nE),a.pE&&(b.qE+=a.pE)):(a.nE&&(b.rE+=a.nE),a.pE&&(b.sE+=a.pE))},a.prototype.jp=function(a){var b=this.tE||"#9eb6ce",c=this.uE,d=a.lineWidth,e=a.strokeStyle;d===c&&e===b||(d!==c&&(a.lineWidth=c),e!==b&&(a.strokeStyle=b)),this.hWa(a)},a.prototype.hWa=function(a){var b,c,d=this;d.qE===d.oE||d.sE===d.rE?(a.beginPath(),d.vE(a),a.stroke()):(a.save(),b=Math.min(d.qE,d.oE),c=Math.min(d.sE,d.rE),a.rect(b,c,Math.abs(d.oE-d.qE),Math.abs(d.rE-d.sE)),a.clip(),a.beginPath(),d.vE(a),a.stroke(),a.beginPath(),a.restore())},a.prototype.vE=function(a){var b=this;a.moveTo(b.qE,b.sE),a.lineTo(b.oE,b.rE)},a}(),t=function(a){A(b,a);function b(b,c,d,e,f,g,h){var i,j=a.call(this)||this,k=g%2;return k||(b!==d?(c-=.5,e-=.5):(b-=.5,d-=.5)),i=j,i.qE=b,i.sE=c,i.oE=d,i.rE=e,i.tE=f,i.uE=g,i.BHb=h,j}return b}(s),u=function(a){A(b,a);function b(b,c,d,e,f,g,h,i){var j,k=a.call(this)||this,l=g%2;return l||(b!==d?(c-=.5,e-=.5):(b-=.5,d-=.5)),j=k,j.qE=b,j.sE=c,j.oE=d,j.rE=e,j.tE=f,j.uE=g,j.wE=h,j.BHb=i,k}return b.prototype.vE=function(a){var c=this;b.yl(a,c.qE,c.sE,c.oE,c.rE,c.wE)},b.yl=function(a,b,c,d,e,f){var g,k,l=h(i(d-b,2)+i(e-c,2)),m={x:(d-b)/l,y:(e-c)/l},n=0,o=0;for(f=f&&f.length?f:[4,4];n<l;)g=j(f[o%f.length],l-n),o++,k=o%2,n+=g,k&&a.moveTo(b,c),b+=g*m.x,c+=g*m.y,k&&a.lineTo(b,c)},b}(s),v=function(a){A(b,a);function b(b,c,d,e,f,g,h,i,j){var k,l=a.call(this)||this;return g?(b-=1,d-=1):(c-=1,e-=1),k=l,k.qE=b,k.sE=c,k.oE=d,k.rE=e,k.tE=f,k.xE=g,k.uE=1,k.yE=h,k.zE=i,k.BHb=j,l}return b.prototype.vE=function(a){var b=this,c=b.xE?0:1,d=b.xE?1:0;u.yl(a,b.qE-c,b.sE-d,b.oE-c,b.rE-d,b.yE),u.yl(a,b.qE,b.sE,b.oE,b.rE,b.zE)},b}(s),w=function(a){A(b,a);function b(b,c,d,e,f,g,h){var i=a.call(this)||this,j=i;return j.qE=b,j.sE=c,j.oE=d,j.rE=e,j.tE=f,j.iWa=g,j.BHb=h,j.AE=new t(j.qE,j.sE,j.oE,j.rE,f,1,h),j.BE=null,i}return b.prototype.hWa=function(a){this.AE&&this.AE.hWa(a),this.BE&&this.BE.hWa(a)},b.prototype.mE=function(a){var b=this;b.BE?(a.pE&&b.AE&&b.AE.mE(a),a.nE&&b.BE.mE(a)):b.AE&&b.AE.mE(a)},b.prototype.jWa=function(a){var b,c,d,e,f,g,h,i,j=this;a&&a.severX&&a.severY?(b=a.severX||0,c=a.severY||0,b=j.iWa?b:-b,d=parseInt(j.qE+(j.oE-j.qE)/2,10),e=parseInt(j.sE+(j.rE-j.sE)/2,10),f=d-b,g=e-c,h=d+b,i=e+c,j.AE=new t(j.qE,j.sE,f,g,j.tE,1,j.BHb),j.BE=new t(h,i,j.oE,j.rE,j.tE,1,j.BHb)):(j.AE=new t(j.qE,j.sE,j.oE,j.rE,j.tE,1,j.BHb),j.BE=null)},b}(s),x=function(a){A(b,a);function b(b,c,d,e,f,g){var h=a.call(this)||this,i=h,j=0,k=0;return b===d&&(j=1),c===e&&(k=1),b!==d&&c!==e?g?(j=2,i.AE=new t(b-j,c,d-j,e,f,1,g),i.BE=new t(b+j,c,d+j,e,f,1,g)):(j=2,k=2,b>d?(i.AE=new w(b-j,c,d,e-k,f,(!1),g),i.BE=new w(b,c+k,d+j,e,f,(!1),g)):(i.AE=new w(b,c+k,d-j,e,f,(!0),g),i.BE=new w(b+j,c,d,e-k,f,(!0),g))):(i.AE=new t(b-j,c-k,d-j,e-k,f,1,g),i.BE=new t(b+j,c+k,d+j,e+k,f,1,g)),i.BHb=g,i.tE=f,i.uE=1,h}return b.prototype.hWa=function(a){this.AE.hWa(a),this.BE.hWa(a)},b.prototype.mE=function(a){var b=this;a.CE?1===a.CE?b.AE.mE(a):2===a.CE&&b.BE.mE(a):(b.AE.mE(a),b.BE.mE(a))},b.prototype.jWa=function(){var a=this,b={severX:1,severY:1},c=a.AE,d=a.BE;c.jWa(b),d.jWa(b)},b}(s);function B(a,b,c,d,e,h,i){switch(h!==f&&h!==g||(h=1),h){case 1:return new t(a,b,c,d,e,1,i);case 2:return new t(a,b,c,d,e,2,i);case 5:return new t(a,b,c,d,e,3,i);case 3:return new u(a,b,c,d,e,1,[3,1],i);case 9:return new u(a,b,c,d,e,1,[8,2,2,2],i);case 4:return new u(a,b,c,d,e,1,[2,2],i);case 11:return new u(a,b,c,d,e,1,[9,3,3,3,3,3],i);case 13:return new v(a,b,c,d,e,a!==c,[11,1,5,1],[10,2,4,2],i);case 10:return new u(a,b,c,d,e,2,[9,3,3,3],i);case 12:return new u(a,b,c,d,e,2,[9,3,3,3,3,3],i);case 8:return new u(a,b,c,d,e,2,[9,3],i);case 7:return new u(a,b,c,d,e,1,[1],i);case 6:return new x(a,b,c,d,e,i)}return g}b.zF=B,y=function(){function a(){}return a.DE=function(b,c,d){var e,f;return b?c?(e=a.EE,f=e[b.style]-e[c.style],0!==f||d?f:c.level-b.level):1:c?-1:0},a.FE=function(a){if(a){if(a.isGridLine)return 1;if(a.style)return d.LineBorder.Vo(a.style)}return 0},a.GE=function(a){return a&&6===a.style},a.HE=function(a){return a&&13===a.style},a.IE=function(b,c){return b?c?a.DE(b.style,c.style)>=0?b:c:b:c},a.JE=function(a,b){a&&a.line&&a.line.mE(b)},a.KE=function(b,c,d){return b===c?0:b?c?b.isGridLine?c.isGridLine?0:-1:c.isGridLine?1:a.DE(b.style,c.style,d):1:-1},a.LE=function(a){return a&&a.style&&6===a.style.style},a.ME=function(a,b,c,d){if(a.style&&6===a.style.style)return!0;var e=0;return e+=b&&b.style&&6===b.style.style?1:0,e+=c&&c.style&&6===c.style.style?1:0,e+=d&&d.style&&6===d.style.style?1:0,e<2},a.NE=function(a,b,c,d,e,f){var g={_orientation:f?1:0,pE:0,nE:0},h=this.KE(a,c),i=this.KE(a,d);h>=0&&i>=0?0===h&&0===i?e!==-1&&1===e&&(g.nE-=e):e===-1?g.pE-=e:1===e&&(g.nE-=2*e):i>=0?(g.CE=2,g.pE+=e):h>=0&&(g.CE=1,g.pE+=e),this.JE(a,g)},a.OE=function(b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t={_orientation:i?1:0,CE:j?2:1,pE:0,nE:0},u={_orientation:i?1:0,CE:j?1:2,pE:0,nE:0},v=1===g?e:f,w=1===h?d:c,x=this.LE(w);x?(k=this.KE(b,v),0===k?(l=this.KE(b,w),0===l?1===h&&(u.nE-=h):l>0&&(h===-1?u.pE-=2*h:1===h&&(u.nE-=2*h))):k>0?(m=this.KE(b,w),0===m?1===h&&(u.nE-=h):m>0&&(h===-1?u.pE-=2*h:1===h&&(u.nE-=2*h))):(n=this.KE(b,w),0===n?h===-1?t.pE+=2*h:1===h&&(t.nE+=2*h):n>0&&(h===-1?t.pE-=3*h:1===h&&(t.nE-=3*h)))):this.KE(b,v)>=0?h===-1?u.pE-=2*h:1===h&&(u.nE-=2*h):h===-1?t.pE+=2*h:1===h&&(t.nE+=2*h),o=1===g?2:1,p=1===o?e:f,q=!1,r=0,this.LE(p)&&this.KE(p,b)>0&&(q=!0,s=a.FE(p),this.KE(p,v)>0?s>0&&(r=1===h&&this.LE(d)?s>=2?2:1:h===-1&&this.LE(c)?s>=3?2:1:3===s?3:2):r=3===s?3:2),q||this.LE(w)||!(w&&!w.isGridLine||p&&!p.isGridLine)||(q=!0,r=h===-1?2:1),q&&(h===-1?(t.pE+=h*r,u.pE+=h*r):1===h&&(t.nE+=h*r,u.nE+=h*r)),(t.pE||t.nE)&&this.JE(b,t),(u.pE||u.nE)&&this.JE(b,u)},a.PE=function(a,b,c,d,e,f){if(this.KE(a,c)>=0&&this.KE(a,d)>=0){var g={_orientation:f?1:0,pE:0,nE:0};e===-1?(g.pE-=2*e,this.LE(a)&&this.KE(b,a)>0&&(g.pE-=1)):1===e&&(g.nE-=2*e,this.LE(a)&&this.KE(b,a)>0&&(g.nE+=1)),this.JE(a,g)}},a.QE=function(b,c,d,e,f,g){var h,i,j;this.LE(b)&&(h=this.IE(d,e),h&&!h.isGridLine&&(i=a.FE(h),i>0&&(j={_orientation:g?1:0,pE:0,nE:0},f===-1?j.pE+=i*f:j.nE+=i*f,(j.pE||j.nE)&&this.JE(b,j))))},a.RE=function(b,c,d,e,f,g,h){var i,j,k,l,m=a;(c||d||e)&&(k=m.IE(d,e),m.ME(b,c,d,e)?(j=m.KE(k,b,!0))>0?(i=m.FE(k),m.LE(b)&&(m.LE(d)||m.LE(e)||m.LE(c))||3===i&&m.JE(b,{_orientation:0,pE:1})):k&&j<0?(j=m.KE(b,c,!0))>0?(i=m.FE(k),3===i||2===i?m.JE(b,{_orientation:0,pE:-2}):1===i&&m.JE(b,{_orientation:0,pE:-1})):0!==j&&m.KE(c,k,!0)>0&&(i=m.FE(k),3===i&&m.JE(b,{_orientation:0,pE:1})):0===j&&(!c||m.KE(b,c,!0)>0)&&(i=m.FE(k),3===i||2===i?m.JE(b,{_orientation:0,pE:-2}):1===i&&m.JE(b,{_orientation:0,pE:-1})):m.JE(b,{_orientation:0,pE:1})),(f||g||h)&&(l=m.IE(g,h),m.ME(b,f,g,h)?(j=m.KE(l,b,!0))>0?(i=m.FE(l),m.LE(b)&&(m.LE(g)||m.LE(h)||m.LE(f))||(3===i?m.JE(b,{_orientation:0,nE:-2}):2!==i&&1!==i||m.JE(b,{_orientation:0,nE:-1}))):j<=0&&((j=m.KE(b,f,!0))>0?(i=m.FE(l),3===i&&m.JE(b,{_orientation:0,nE:1})):0!==j&&m.JE(b,{_orientation:0,nE:-1})):m.JE(b,{_orientation:0,nE:-2}))},a.SE=function(b,c,d,e,f,h,i){var j,k,l,m,n=a;(c||d||e)&&(l=n.IE(d,e),k=n.KE(l,b,!0),n.ME(b,c,d,e)?k>0?(j=n.FE(l),n.LE(b)&&(n.LE(d)||n.LE(e)||n.LE(c))||3===j&&n.JE(b,{_orientation:1,pE:1})):k<0?(k=n.KE(b,c,!0),k>0?(j=n.FE(l),3===j||2===j?n.JE(b,{_orientation:1,pE:-2}):1===j&&n.JE(b,{_orientation:1,pE:-1})):0!==k&&n.KE(c,l,!0)>0&&(j=n.FE(l),3===j&&n.JE(b,{_orientation:1,pE:1}))):0===k&&n.KE(b,c,!0)>0&&(j=n.FE(l),3===j||2===j?n.JE(b,{_orientation:1,pE:-2}):1===j&&n.JE(b,{_orientation:1,pE:-1})):n.JE(b,{_orientation:1,pE:1})),(f||h||i)&&(m=n.IE(h,i),k=n.KE(b,m,!0),n.ME(b,f,h,i)?k<0?(j=n.FE(m),n.LE(b)&&(n.LE(h)||n.LE(i)||n.LE(f))||(3===j||2===j?n.JE(b,{_orientation:1,nE:-2}):1===j&&n.JE(b,{_orientation:1,nE:-1}))):m!==g&&k>=0&&(k=n.KE(b,f,!0),k>0?(j=n.FE(m),3===j&&n.JE(b,{_orientation:1,nE:1})):0!==k&&n.JE(b,{_orientation:1,nE:-1})):n.JE(b,{_orientation:1,nE:-2}))},a.TE=function(b,c,d,e,f,g,h,i){var j,k,l,m,n=a;i?this.SE(b,c,d,e,f,g,h):this.RE(b,c,d,e,f,g,h),j=n.LE(d),k=n.LE(e),l=n.LE(c),j&&k&&l?n.NE(b,c,d,e,-1,i):j&&!k?n.OE(b,c,f,d,e,1,-1,i,!0):!j&&k?n.OE(b,c,f,d,e,2,-1,i,!1):j&&k&&!l?n.PE(b,c,d,e,-1,i):l&&n.QE(b,c,d,e,-1,i),j=n.LE(g),k=n.LE(h),m=n.LE(f),j&&k&&m?n.NE(b,f,g,h,1,i):j&&!k?n.OE(b,c,f,g,h,1,1,i,!0):!j&&k?n.OE(b,c,f,g,h,2,1,i,!1):j&&k&&!m?n.PE(b,f,g,h,1,i):m&&n.QE(b,f,g,h,1,i)},a.EE=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],a.kWa=function(a,b){return!(!a||!b||a.color!==b.color||a.level!==b.level||a.style!==b.style)},a}(),z=function(){function a(a,b,c,d){var e=this;e.UE=!1,e.VE=!1,e.kj=a,e.Wz=d,e.WE=b,e.XE=c}return a.prototype.YE=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o=this;if(o.ZE=[],o.$E=[],o._E=[],o.aF=[],o.bF=[],o.cF={},o.dF={},o.eF={},o.fF={},o.lWa={},o.mWa={},o.C$a={},a=o.kj,b=o.Wz,c=o.XE,d=o.WE,e=a.Gr(d,b),f=a.Hr(c,b),e&&e.length>0&&f&&f.length>0){for(g=o.$E,h=e.length,i=void 0,j=0;j<h;j++)i=e[j],i.height>0&&g.push(i.row);for(g.push(g[g.length-1]+1),k=o._E,l=f.length,m=void 0,n=0;n<l;n++)m=f[n],m.width>0&&k.push(m.col);k.push(k[k.length-1]+1)}o.UE=!0},a.prototype.gF=function(a,b,c,d,e,f,g,h){if(c){var i={cj:a,dj:b,hF:c.startColumn,iF:c.endColumn,Wqa:d,XHa:e,YHa:f,Vo:g,_v:h};this.aF.push(i)}},a.prototype.jF=function(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p,q,r,s,t,u,v=this;v.UE||v.YE(),h?v.ZE.push(h):(l=void 0,m=void 0,n=void 0,o=void 0,p=void 0,q=void 0,r=void 0,s=void 0,t=void 0,u=void 0,g&&(l=g.borderLeft,m=g.borderTop,n=g.borderRight,o=g.borderBottom,u=g.backColor,p=g.diagonalDown,q=g.diagonalUp,r=g.textOrientation,s=g.isVerticalText,t=g.textIndent),!u||l||n||m||o||v.bF.push({r:a,c:b,rc:1,cc:1}),v.kF(a,b,c,d,e,f,l,m,n,o,p,q,u,!1,!1,i,j,r,s,t&&0!==t,k))},a.prototype.kF=function(a,b,c,d,e,g,h,i,j,m,o,p,q,r,s,t,u,v,w,x,y){var z,A,B,C,D,E,F,G,H=this,I=!1,J=!1,K=!1,L=!1,M=v!==f&&v&&-90<=v&&v<=90,N=c,O=h||i||j||m;M&&O&&!w&&!x&&y&&(z=k(v*n/180),A=l(z),B=Math.floor(g/A),v>-90&&v<0&&(N=c-B),v>0&&v<90&&(N=c+B)),o&&!M&&H.lF(a,b,c-1,d-1,c+e,d+g,o,H.lWa),p&&!M&&H.lF(a,b,c+e,d-1,c-1,d+g,p,H.mWa),i&&g>0&&(I=H.lF(a,b,N,d-.5,N+e,d-.5,i,H.eF,M)),h&&e>0&&(J=H.lF(a,b,N-.5,d,c-.5,d+g,h,H.fF,M)),j&&e>0&&(L=H.lF(a,b+1,N+e-.5,d,c+e-.5,d+g,j,H.fF,M)),m&&g>0&&(K=H.lF(a+1,b,c,d+g-.5,c+e,d+g-.5,m,H.eF,M)),C=H.kj,q&&0!==C.ss.Sl(a)&&0!==C.ss._m(b)||(D=!K&&!r,E=!L&&!s,F=!I&&!r,G=!J&&!s,(D||E||F||G)&&H.mF(a,b,c,d,e,g,D,E,t,u)),!I&&!q||M||H.nF(a-1,b,H.cF),(J||q)&&H.nF(a,b-1,H.dF),!q||h||j||i||m||(H.oF(a-1,b-1,H.dF,!1),H.oF(a-1,b-1,H.cF,!0))},a.prototype.lF=function(a,b,c,d,e,f,h,i,j){if(h){var k=this.pF(a,b,i,!0);return k?(j||6!==k.style.style&&(6===h.style||y.DE(h,k.style)>0))&&(k.line=B(c,d,e,f,h.color,h.style,j),k.style=h):(k=this.pF(a,b,i),k.line=B(c,d,e,f,h.color,h.style,j),k.style=h),k.line!==g}return!1},a.prototype.mF=function(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p=this,q=3===p.Wz,r=p.kj.options.gridline;q&&r&&(k=r.color,r.showHorizontalGridline&&(g&&(l=p.pF(a,b,p.cF),l.isGridLine=!0,l.line=B(c,d+f-.5,c+e,d+f-.5,k)),i&&(m=p.pF(-1,b,p.cF,!1,!0),m.isGridLine=!0,m.line=B(c,d-.5,c+e,d-.5,k))),r.showVerticalGridline&&(h&&(n=p.pF(a,b,p.dF),n.isGridLine=!0,n.line=B(c+e-.5,d,c+e-.5,d+f,k)),j&&(o=p.pF(a,-1,p.dF,!1,!0),o.isGridLine=!0,o.line=B(c-.5,d,c-.5,d+f,k))))},a.prototype.oF=function(a,b,c,d){var e,f=this.pF(a,b,c,!0);f&&(e=f,e.line&&e.line.mE({_orientation:d?0:1,nE:-1}))},a.prototype.nF=function(a,b,c){var d,e;(a>=0&&b>=0||0===a&&b===-1||a===-1&&0===b)&&(d=c[a],d&&(e=d[b],e&&delete d[b]))},a.prototype.pF=function(a,b,c,d,e){var f,h;if(!e&&(a===-1||b===-1))return g;if(f=c[a],!f){if(d)return g;c[a]=f={}}if(h=f[b],!h){if(d)return g;f[b]=h={}}return h},a.prototype.qF=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,C,D=this,E=D.aF,F=E.length,G=D.fF,H=D.eF,I=D.dF,J=D.cF;for(a=0;a<F;a++)if(b=E[a],c=b.cj,d=b.dj,e=b.hF,f=b.Wqa,g=b.iF,h=void 0,i=b.XHa,j=b.Vo,k=b._v,l=i,m=void 0,n=f.textOrientation,o=f.borderTop,p=E[a-1],!p||p.cj!==c||p.hF!==e||p.iF!==g){for(q=e;q<g;q++)h=D.pF(c,q+1,G,!0),h&&!n?D.nF(c,q+1,G):(h=D.pF(c,q,I,!0),h&&D.nF(c,q,I));if(r=D.pF(c,d,H,!0),n&&o&&!r)for(s=void 0,s=k/Math.tan(Math.abs(n*Math.PI/180)),n>-90&&n<0&&(l=i-s),n>0&&n<90&&(l=i+s),m=l+j,t=e;t<g+1;t++)if(u=D.pF(c-1,t,J,!0),v=u&&u.line)for(u.splitLines||(u.splitLines=[],u.splitLines.push(v)),w=0;w<u.splitLines.length;w++)if(x=u.splitLines[w],y=x.qE,z=x.oE,A=x.sE,C=x.rE,l>y&&m>z&&z>l)x.oE=l;else if(l<y&&m>z)D.nF(c-1,t,D.cF);else if(l<y&&m<z&&y<m)x.qE=m;else if(l>y&&m<z){u.splitLines.splice(w,1,B(y,A,l,A,x.color),B(m,C,z,C,x.color));break}}},a.prototype.rF=function(){var a,b,c=this.ZE,d=c.length;if(d>0)for(b=0;b<d;b++)a=c[b],this.sF(a)},a.prototype.D$a=function(){var a,b,c,d,e,f,g,h;if(this.C$a={},a=this.ZE,b=a.length,b>0)for(d=0;d<b;d++)for(c=a[d],e=0;e<c.rowCount;e++)for(f=e+c.row,this.C$a[f]=this.C$a[f]||{},g=0;g<c.colCount;g++)h=g+c.col,this.C$a[f][h]=c},a.prototype.sF=function(a){var b,c,d,e,f,h,i,j,k,l,m,n,o,p,q,r,s=this,t=a.row,u=a.col,v=a.x,w=a.y,x=s.kj.getActualStyle(t,u,s.Wz),z=x?x.backColor:g,A=v,B=w,C=null,D=!0,E=null,F=!0;if(1===a.rowCount){for(h=t,j=s.kj.Sl(h,s.Wz),f=0;f<a.colCount;f++)l=0===f,n=f===a.colCount-1,i=u+f,k=s.kj.Tl(i,s.Wz),p=s.kj.getActualStyle(h,i,s.Wz),h===a.row&&i===a.col&&(q=p,C=q.diagonalDown,E=q.diagonalUp),p?(b=p.borderLeft,c=p.borderTop,d=p.borderRight,e=p.borderBottom,D&&(D=y.kWa(C,p.diagonalDown)),F&&(F=y.kWa(E,p.diagonalUp))):b=c=d=e=g,l?s.kF(h,i,A,B,k,j,b,c,g,e,g,g,z,!1,!0):n?s.kF(h,i,A,B,k,j,g,c,d,e,g,g,z,!1,!1):s.kF(h,i,A,B,k,j,g,c,g,e,g,g,z,!1,!0),A+=k;C=D?C:null,E=F?E:null,s.kF(a.row,a.col,a.x,a.y,a.width,a.height,g,g,g,g,C,E,g,!0,!0)}else if(1===a.colCount){for(i=u,k=s.kj.Tl(i,s.Wz),f=0;f<a.rowCount;f++)m=0===f,o=f===a.rowCount-1,h=t+f,j=s.kj.Sl(h,s.Wz),p=s.kj.getActualStyle(h,i,s.Wz),h===a.row&&i===a.col&&(q=p,C=q.diagonalDown,E=q.diagonalUp),p?(b=p.borderLeft,c=p.borderTop,d=p.borderRight,e=p.borderBottom,D&&(D=y.kWa(C,p.diagonalDown)),F&&(F=y.kWa(E,p.diagonalUp))):b=c=d=e=g,m?s.kF(h,i,A,B,k,j,b,c,d,g,g,g,z,!0,!1):o?s.kF(h,i,A,B,k,j,b,g,d,e,g,g,z,!1,!1):s.kF(h,i,A,B,k,j,b,g,d,g,g,g,z,!0,!1),B+=j;C=D?C:null,E=F?E:null,s.kF(a.row,a.col,a.x,a.y,a.width,a.height,g,g,g,g,C,E,g,!0,!0)}else{for(f=0;f<a.rowCount;f++){for(h=t+f,m=0===f,o=f===a.rowCount-1,j=s.kj.Sl(h,s.Wz),r=0;r<a.colCount;r++)i=u+r,l=0===r,n=r===a.colCount-1,k=s.kj.Tl(i,s.Wz),p=s.kj.getActualStyle(h,i,s.Wz),h===a.row&&i===a.col&&(q=p,C=q.diagonalDown,E=q.diagonalUp),p?(b=p.borderLeft,c=p.borderTop,d=p.borderRight,e=p.borderBottom,D&&(D=y.kWa(C,p.diagonalDown)),F&&(F=y.kWa(E,p.diagonalUp))):b=c=d=e=g,m?l?s.kF(h,i,A,B,k,j,b,c,g,g,g,g,z,!0,!0):n?s.kF(h,i,A,B,k,j,g,c,d,g,g,g,z,!0,!1):s.kF(h,i,A,B,k,j,g,c,g,g,g,g,z,!0,!0):o?l?s.kF(h,i,A,B,k,j,b,g,g,e,g,g,z,!1,!0):n?s.kF(h,i,A,B,k,j,g,g,d,e,g,g,z,!1,!1):s.kF(h,i,A,B,k,j,g,g,g,e,g,g,z,!1,!0):l?s.kF(h,i,A,B,k,j,b,g,g,g,g,g,z,!0,!0):n&&s.kF(h,i,A,B,k,j,g,g,d,g,g,g,z,!0,!1),A+=k;A=v,B+=j}C=D?C:null,E=F?E:null,s.kF(a.row,a.col,a.x,a.y,a.width,a.height,g,g,g,g,C,E,g,!0,!0)}!z||b||d||c||e||s.bF.push({r:t,c:u,rc:a.rowCount,cc:a.colCount})},a.prototype.mE=function(){var a=this,b=!1,c=!1,d=!1,e=!1;p(a.fF)||(b=!0),p(a.eF)||(c=!0),(b||c)&&(a.tF(),a.tWa()),p(a.lWa)||(d=!0),p(a.mWa)||(e=!0),(d||e)&&a.oWa(),a.bF.length>0&&a.uF()},a.prototype.E$a=function(a,b,c,d,e){var f=this,g=this.C$a[a]?this.C$a[a][b]:null;if(g)switch(e){case r.H_TOP_LEFT:return f.vF(a,b,c,d);case r.H_TOP_Right:return f.vF(a,b+g.colCount-1,c,d);case r.V_RIGHT_TOP:return f.vF(a,b+g.colCount,c,d);case r.V_RIGHT_BOTTOM:return f.vF(a+g.rowCount-1,b+g.colCount,c,d);case r.H_BOTTOM_RIGHT:return f.vF(a+g.rowCount,b+g.colCount-1,c,d);case r.H_BOTTOM_LEFT:return f.vF(a+g.rowCount,b,c,d);case r.V_LEFT_BOTTOM:return f.vF(a+g.rowCount-1,b,c,d);case r.V_LEFT_TOP:return f.vF(a,b,c,d)}return f.vF(a,b,c,d)},a.prototype.oWa=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=p.$E,s=p._E,t=q.length,u=s.length,v={},w={};for(a=0;a<t;a++)for(c=q[a],b=0;b<u;b++)d=s[b],m=p.pF(c,d,p.lWa,!1),n=p.pF(c,d,p.mWa,!1),(m||n)&&(y.LE(m)&&y.LE(n)&&(m.line.jWa(),n.line.jWa()),o=[],e=p.E$a(c,d,!1,v,r.H_TOP_LEFT),e&&e.line&&!e.isGridLine&&(o=[1,1,2],p.pWa(o,e,m,!0,1)),i=p.E$a(c,d,!1,v,r.H_TOP_Right),i&&i.line&&!i.isGridLine&&(o=[1,1,2],p.pWa(o,i,n,!0,1)),f=p.E$a(c,d,!0,w,r.V_LEFT_TOP),f&&f.line&&!f.isGridLine&&(o=[1,1,2],p.pWa(o,f,m,!0,0)),j=p.E$a(c,d,!0,w,r.V_LEFT_BOTTOM),j&&j.line&&!j.isGridLine&&(o=[1,1,2],p.pWa(o,j,n,!1,0)),g=p.E$a(c,d,!1,v,r.H_BOTTOM_LEFT),g&&g.line&&!g.isGridLine&&(o=[-1,-2,-2],p.pWa(o,g,n,!1,1)),k=p.E$a(c,d,!1,v,r.H_BOTTOM_RIGHT),k&&k.line&&!k.isGridLine&&(o=[-1,-2,-2],p.pWa(o,k,m,!1,1)),h=p.E$a(c,d,!0,w,r.V_RIGHT_TOP),h&&h.line&&!h.isGridLine&&(o=[-1,-2,-2],p.pWa(o,h,n,!0,0)),l=p.E$a(c,d,!0,w,r.V_RIGHT_BOTTOM),l&&l.line&&!l.isGridLine&&(o=[-1,-2,-2],p.pWa(o,l,m,!1,0)))},a.prototype.pWa=function(a,b,c,d,e){var f,g,h=y.LE(b),i=y.HE(b),j=b.line.uE;h&&(j=3),i&&(j=2),f=a[j-1],c&&c.line&&(g={_orientation:e},d?g.pE=f:g.nE=f,c.line.mE(g))},a.prototype.uF=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m=this,n=m.bF,o=n.length;for(a=0;a<o;a++){for(b=n[a],c=b.r,d=b.c,e=c,f=c-1,g=d-1,h=d,b.rc>1&&(e+=b.rc-1),b.cc>1&&(h+=b.cc-1),i=!1,j=!1,k=a+1;k<o&&(l=n[k],l.c===h+1&&l.r===c&&(j=!0),l.r===e+1&&l.c===d&&(i=!0),!i||!j)&&!(l.r>c+1&&l.c>d+1);k++);i||m.oF(e,g,m.cF,!0),j||m.oF(f,h,m.dF,!1)}},a.prototype.tF=function(){var a,b,c,d,e,f,h,i,j,k,l,m,n,o,p,q,r,s,t=this,u=t.$E,v=t._E,w=u.length,x=v.length,z={},A={};for(a=0;a<w;a++)for(c=u[a],b=0;b<x;b++){if(d=v[b],p=0,q=0,r=t.pF(c,d,t.fF,!0)){if(r.line&&r.line.BHb)continue;p++}else r=t.pF(c,d-1,t.dF,!0);s=t.pF(c,d,t.eF,!0),s?q++:s=t.pF(c-1,d,t.cF,!0),(r||s)&&(e=0===a?g:t.vF(u[a-1],d,!0,A),e&&e.line&&!e.isGridLine&&(p++,q++),f=0===b?g:t.vF(c,v[b-1],!1,z),f&&f.line&&!f.isGridLine&&(p++,q++),r&&(h=t.vF(c,d,!1,z),h&&h.line&&!h.isGridLine&&p++,a!==w-1&&(j=t.vF(u[a+1],d,!0,A),j&&j.line&&!j.isGridLine&&p++),0!==b&&a!==w-1&&(k=t.vF(u[a+1],v[b-1],!1,z),k&&k.line&&!k.isGridLine&&p++),a!==w-1&&(l=t.vF(u[a+1],d,!1,z),l&&l.line&&!l.isGridLine&&p++),p>0&&(y.GE(r.style)?y.TE(r,e,f,h,j,k,l,!0):y.HE(r.style)||y.SE(r,e,f,h,j,k,l))),s&&(i=t.vF(c,d,!0,A),i&&i.line&&!i.isGridLine&&q++,b!==x-1&&(m=t.vF(c,v[b+1],!1,z),m&&m.line&&!m.isGridLine&&q++),0!==a&&b!==x-1&&(n=t.vF(u[a-1],v[b+1],!0,A),n&&n.line&&!n.isGridLine&&q++),b!==x-1&&(o=t.vF(c,v[b+1],!0,A),o&&o.line&&!o.isGridLine&&q++),q>0&&(y.GE(s.style)?y.TE(s,f,e,i,m,n,o,!1):y.HE(s.style)||y.RE(s,f,e,i,m,n,o))))}},a.prototype.F$a=function(a,b,c,d){var e=this,f=this.C$a[a]?this.C$a[a][b]:null,g=c?e.mWa:e.lWa;return f?a===f.row&&b===f.col&&d===q.LEFT_TOP?e.pF(f.row,f.col,g,!1):a===f.row&&b===f.col+f.colCount-1&&d===q.RIGHT_TOP?e.pF(f.row,f.col,g,!1):a===f.row+f.rowCount-1&&b===f.col+f.colCount-1&&d===q.RIGHT_BOTTOM?e.pF(f.row,f.col,g,!1):a===f.row+f.rowCount-1&&b===f.col&&d===q.LEFT_BOTTOM?e.pF(f.row,f.col,g,!1):void 0:e.pF(a,b,g,!1)},a.prototype.tWa=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,r=p.$E,s=p._E,t=r.length,u=s.length;for(a=0;a<t;a++)for(c=r[a],b=0;b<u;b++)d=s[b],n=p.pF(c,d,p.fF,!0),n&&n.line&&n.line._noNeedAdjust||(n&&n.line&&y.LE(n)&&(e=p.F$a(c,d,!1,q.LEFT_TOP),f=p.F$a(c,d,!0,q.LEFT_BOTTOM),g=y.LE(e),h=y.LE(f),i=p.F$a(c,d-1,!1,q.RIGHT_BOTTOM),j=p.F$a(c,d-1,!0,q.RIGHT_TOP),k=y.LE(i),l=y.LE(j),e&&g&&(m={CE:2,_orientation:1,pE:2},n.line.mE(m)),f&&h&&(m={CE:2,_orientation:1,nE:-2},n.line.mE(m)),i&&k&&(m={CE:1,_orientation:1,nE:-2},n.line.mE(m)),j&&l&&(m={CE:1,_orientation:1,pE:2},n.line.mE(m))),o=p.pF(c,d,p.eF,!0),o&&o.line&&y.LE(o)&&(e=p.F$a(c,d,!1,q.LEFT_TOP),f=p.F$a(c,d,!0,q.RIGHT_TOP),g=y.LE(e),h=y.LE(f),i=p.F$a(c-1,d,!1,q.RIGHT_BOTTOM),j=p.F$a(c-1,d,!0,q.LEFT_BOTTOM),k=y.LE(i),l=y.LE(j),e&&g&&(m={CE:2,_orientation:0,pE:2},o.line.mE(m)),f&&h&&(m={CE:2,_orientation:0,nE:-2},o.line.mE(m)),i&&k&&(m={CE:1,_orientation:0,nE:-2},o.line.mE(m)),j&&l&&(m={CE:1,_orientation:0,pE:2},o.line.mE(m))))},a.prototype.vF=function(a,b,c,d){var e,g=d[a];return g||(g=d[a]={}),e=g[b],e===f&&(e=g[b]=this.wF(a,b,c)),e},a.prototype.wF=function(a,b,c){var d,e,h;if(a===f||a<0||b===f||b<0)return g;if(d=this,e=c?d.fF:d.eF,h=d.pF(a,b,e,!0),h)return h;if(e=c?d.dF:d.cF,c){if(--b,b<0)return g}else if(--a,a<0)return g;return h=d.pF(a,b,e,!0),h?h:g},a.prototype.paint=function(a){var b=this;b.UE&&(b.VE||(b.D$a(),b.rF(),b.qF(),b.mE(),b.VE=!0),a.save(),a.beginPath(),b.jp(a),a.closePath(),a.stroke(),a.restore())},a.prototype.jp=function(a){this.xF(a),this.yF(a)},a.prototype.xF=function(a){var b=this;b._d(a,b.cF),b._d(a,b.dF)},a.prototype.yF=function(a){var b=this;b._d(a,b.eF),b._d(a,b.fF),b._d(a,b.lWa),b._d(a,b.mWa)},a.prototype._d=function(a,b){var c,d,e,f,g,h;for(c in b)if(b[c]){e=b[c];for(d in e)if(e[d])if(f=e[d].line,g=e[d].splitLines,g&&g.length>0)for(h=0;h<g.length;h++)g[h]&&g[h].jp(a);else f&&f.jp(a)}},a}(),b.AF=z},"./dist/core/worksheet/worksheet-edit.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/worksheet/worksheet.js"),e=c("./dist/core/util/common.js"),f=c("./dist/core/util/domUtil.js"),g=f.GC$,h=c("Common"),i=c("./dist/core/core.enum.js"),j=c("CalcEngine"),k=!!j,l=e.Ul.Ml,m=e.Ul.rl(),n=h.Common.j.Fa,o=null,p=void 0,q="string",r={startEdit:function(a,b){var c=this;c.EF(c.Ws(),c.Jl,c.Kl,o,o,a,b)},editorStatus:function(){return this.Px||0},isEditing:function(){var a=this.Px;return 1===a||2===a},endEdit:function(a){return this.gv(a)},gv:function(a,b,c,d){var e=this;if(!e.isEditing())return!0;e.suspendPaint();try{return e.Yoa(a,b,c,d)}finally{e.resumePaint()}},Yoa:function(a,b,c,f){var h,j,k,m,p,q,r,s,t,u,v,w,x,y,z=this,A=z.mm,B=z.BF,C=z.name(),D=z.Jl,E=z.Kl,F=z.getCellType(D,E),G={sheet:z,row:D,col:E,sheetArea:3};if(F.isImeAware(G)||A.Qq(),B&&B.parentNode){if(j=F.getEditorValue(B,G),k={sheet:z,sheetName:C,row:D,col:E,editor:B,editingText:j,cancel:!1},z.Wq(e.Events.EditEnd,k),k.cancel&&!f)return;if(z.Wq(e.Events.EditEnding,k),k.cancel&&!f)return;if(m=z.parent,p=m&&m.CF,document.activeElement===(p&&p.qo)&&A.Qq(),D>=0&&E>=0&&(q=B.Ep,F.isEditingValueChanged(q,j,G)||1===b))if(a)F.setEditorValue(B,q,G),F.selectAll(B,G);else if(r=F.DF,n(r)&&(r=!0),s={cmd:"editCell",sheetName:C,row:D,col:E,newValue:j,autoFormat:r,editingFormatter:B.oja},1===b&&(s.ranges=[z.Ix()],s.endEditType=b),null===j||a||(t=z.tables&&z.tables.find&&(z.tables.find(D-1,E)||z.tables.find(D,E-1)),t&&z.tables.AHb(new e.Range(D,E,1,1),null,j,!0)),z.wu().execute(s),h=s.applyResult,2===h&&(F.focus(B,G),!f))return!1;if(z.$l=!0,F.XBb(B,G,z.getCellRect(D,E)),F.isImeAware(G))l.msie&&9===parseFloat(l.version)?A.Qq():g(B.parentNode.parentNode).css({width:0,height:0,overflow:"hidden",border:"none"});else for(u=z.zo(),v=B;v;)v.parentNode===u?u.removeChild(v):v=v.parentNode}return z.Ll=!1,w={sheet:z,sheetName:C,row:D,col:E,editingText:j},x=g.extend({},w),z.Wq(e.Events.EditEnded,w),z.Wq(e.Events.FormulatextboxEditEnded,x),!(c!==!0&&x.ignore&&!f)&&(0!==z.Px&&(y=z.Px,z.Px=0,z.Cu(y,0)),z.ITa.setCellState(D,E,i.CellStatesType.edit,!1,i.SheetArea.viewport),d.Worksheet.ao(z,"endEdit"),z.BF=o,1!==h)},FF:function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=l.hitTest(b,c);!m||m.cellTypeHitInfo&&(m.cellTypeHitInfo.outlineColumnHitInfo||m.cellTypeHitInfo.cellButtonHitInfo)||(d=m.row,e=m.col,d>=0&&e>=0&&m.rowViewportIndex>=0&&m.colViewportIndex>=0&&!m.resizeInfo&&!m.dragInfo&&d===l.Jl&&e===l.Kl&&(f=l.isEditing(),l.EF(a,d,e),!f&&l.isEditing()&&(g=m.hitTestType,h=l.getCellType(d,e),h.tw&&(i=l.getCellRect(d,e,1===g?-1:p,2===g?-1:p),j=l.getActualStyle(d,e,g),k=h.h5(b,c,j,i,{sheet:l,row:d,col:e,sheetArea:g}),k&&k.isReservedLocation&&h.tw(l,d,e,3)))))},EF:function(a,b,c,f,h,j,l,p){var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;if(g[g.sd]({tc:this.parent}),!(b<0||c<0||(q=this,r=q.name(),s=q.options,q.isEditing()||(t=q.getCellRect(b,c),!t||n(t.width)||n(t.height)||n(t.x)||n(t.y)||t.width<=0||t.height<=0)))){if(u=q.ITa,u.setCellState(b,c,i.CellStatesType.edit,!0,i.SheetArea.viewport),v=q.getActualStyle(b,c),s.isProtected&&v.locked!==!1)return void u.setCellState(b,c,i.CellStatesType.edit,!1,i.SheetArea.viewport);if(w=q.getCellType(b,c),!w)return void u.setCellState(b,c,i.CellStatesType.edit,!1,i.SheetArea.viewport);if(x=q.mm,x.zt(),y={sheet:q,row:b,col:c,sheetArea:3},z=w.isImeAware(y)?x.GF:w.a5(y),z&&z.firstChild&&(A=z.firstChild.firstChild),!A)return void u.setCellState(b,c,i.CellStatesType.edit,!1,i.SheetArea.viewport);if(q.BF=A,B={sheet:q,sheetName:r,row:b,col:c,cancel:!1},q.Wq(e.Events.EditStarting,B),B.cancel)return m.ipad&&x.Qq(),void u.setCellState(b,c,i.CellStatesType.edit,!1,i.SheetArea.viewport);q.showCell(q.Jl,q.Kl,3,3),q.CHb=!0,C=q.getValue(b,c),D=k&&q.getFormula(b,c),E=q.Px,q.HF?q.Px=1:n(C)&&n(D)?q.Px=1:q.Px=2,q.Cu(E,q.Px),F=q.am(),t=q.getCellRect(b,c,f,h),w.isImeAware(y)&&x.JF(),w.d5(z,v,t,y),q.KF(w,A,b,c,v,l,p),G=q.zo(),w.isImeAware(y)||G.insertBefore(z,o),delete q.CHb,w.g5(z,v,t,y),w.isImeAware(y)&&j||w.focus(A,y),s.allowCellOverflow&&(H=t.clone(),H.y-=2,H.height+=4,H.x=F.kt,H.width=F.er,q.repaint(H)),d.Worksheet.ao(q,"startEdit",{element:w.getEditingElement()}),j&&w.selectAll(A,y),e.Vl.Zl(q),I={sheet:q,sheetName:r,row:b,col:c},q.Wq(e.Events.EditStarted,I),q.Wq(e.Events.FormulatextboxEditStarted,I)}},KF:function(a,b,c,d,e,f,g){var h,i,j,l,m=this,o=k&&m.getFormula(c,d,!0);o&&(o="="+o),h=o,i={sheet:m,row:c,col:d,sheetArea:3,isImeInput:g},o&&0!==o.length||(o=m.getValue(c,d),j=m.parent,l=k&&j&&j.options.allowUserEditFormula,typeof o===q&&e.quotePrefix||o&&o.length>0&&"="===o[0]&&l?(o="'"+o,h=o):(h=o,o=a.kp(b,e,o,i))),b.Ep=o,n(f)||(o=f),a.setEditorValue(b,o,i),b.LF=h}},g.extend(d.Worksheet.prototype,r)},"./dist/core/worksheet/worksheet-event.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("./dist/core/worksheet/worksheet.js"),f=c("Common"),g=c("./dist/core/worksheet/worksheet-model.js"),h=c("./dist/core/util/domUtil.js"),i=c("./dist/core/util/common.js"),j=c("./dist/core/core.enum.js"),k=window,l=document,m=h.GC$.each,n=i.Ul.Ml,o=i.Ul.rl(),p=i.Ul.nl,q=i.Ul.Nl,r=f.Common.u.Kb,s=i.kf,
t=f.Common.j.Fa,u=".handler",v="mousedown"+u,w="mouseup"+u,x="mousemove"+u,y="mousewheel"+u,z="DOMMouseScroll"+u,A="mouseout"+u,B="dblclick"+u,C=null,D=void 0,E=isNaN,F=parseInt,G=Math.max,H=Math.floor,I=Math.min,J=Math.abs,K=Math.ceil,L="function",M="position",N="absolute",O="border",P="overflow",Q="top",R="left",S="width",T="height",U="resize",V="hidden",W="visible",X="none",Y="tabindex",Z="gcUIElement",$="corner",_="sizeHiddenRow",aa="sizeRow",ba="sizeCol",ca="sizeHiddenCol",da="default",ea=o.iphone||o.ipad||o.android,fa=new f.Common.ResourceManager(d.SR),ga=fa.getResource.bind(fa),ha=30;function ka(a,b){var c=3;return sa(b)<0&&(c=1),ta(b)<0&&(c=2),!(3===c||!a.vp(b.row,b.col,c,!0))}function la(a,b,c){var d,e,f,g,h,j,k,l=!1,m=a.am();return b&&(d=sa(b),e=ta(b),(d<0||e<0)&&(f=a.getCellRect(b.row,b.col,d,e),f&&f.width>0&&f.height>0&&(g=m.x,h=m.y,(f.x<m.Br+g||f.y<m.Cr+h||f.y>=m.height-m.Bt)&&(j=new i.Rect(f.x-2,f.y-2,f.width+4,f.height+4),k=void 0,k=d<0&&e<0?m.em():d<0?m.gm(e):m.fm(d),j=j.getIntersectRect(k),c.VF(j.x,j.y,j.width,j.height),l=ka(a,b))))),l}function ma(a){return a.isEditing()}function na(a){return a.endEdit()}function oa(a){return a.frozenRowCount()}function pa(a){return a.frozenColumnCount()}function qa(a,b){return a.getRowCount(b)}function ra(a,b){return a.getColumnCount(b)}function sa(a){return a.rowViewportIndex}function ta(a){return a.colViewportIndex}function ua(a){return a.hitTestType}function va(a){return a.getActiveRowIndex()}function wa(a){return a.getActiveColumnIndex()}function xa(a){return a.keyCode}function ya(a){return a.ctrlKey}function za(a){return a.shiftKey}function Aa(a){return a.altKey}function Ba(a){return a.metaKey}function Ca(a){return a.colCount}function Da(a){return a.rowCount}function Ea(a,b,c){return{action:a,index:b,sheetArea:c}}function Fa(a,b,c,d,e,f){var g={sheet:a,sheetName:b,sheetArea:e,row:c,col:d};return f&&(g.cancel=!1),g}function Ga(a,b,c,d,e,f){var g=a.kj,h=Fa(g,g.name(),g.Jl,g.Kl,D,!0);return g.Wq(i.Events.LeaveCell,h),!(!h||h.cancel!==!0)||(g.Kr(b,c,d,e,f),g.Wq(i.Events.EnterCell,Fa(g,g.name(),b,c)),g.Wq(i.Events.FormulatextboxEnterCell,Fa(g,g.name(),b,c)),void(a.cs&&a.cs(b,c)))}function Ha(a,b,c,d,e,f,g){var h,i=a.kj,j=b.call(i,f.sheetArea);return(g&&!i.getRowVisible(f.index,f.sheetArea)||!g&&!i.getColumnVisible(f.index,f.sheetArea))&&(f.index=c.call(a,f.index,f.sheetArea)),h=d.call(j,f.index),h||(h=d.call(j,e)),h}function Ia(a,b,c,d,e){var f,g=d?"movingY":"movingX",h=d?"startY":"startX";a[g]=b,a[g]<a[h]&&(a[g]=a[h]),f=d?c.y+c.height:c.x+c.width,a[g]>f&&(a[g]=f),e!==C&&a[g]>a[h]+e&&(a[g]=a[h]+e)}function Ja(a,b){var c=a.am();return oa(a)>0&&b<c.nt+c.fs?0:a.frozenTrailingRowCount()>0&&b>c.ot?2:1}function Ka(a,b){var c=a.am();return pa(a)>0&&b<c.kt+c.hs?0:a.frozenTrailingColumnCount()>0&&b>c.lt?2:1}function La(a,b,c){var d=a.Gr(b);return d?d.findNearY(c):C}function Ma(a,b,c){var d=a.Hr(b);return d?d.findNearX(c):C}function Na(a){return!a.options.isProtected||a.options.protectionOptions.allowResizeRows}function Oa(a){return!a.options.isProtected||a.options.protectionOptions.allowResizeColumns}function Pa(a,b){var c=b.row,d=b.rowCount,e=b.col,f=b.colCount,g=a.getColumnCount(),h=a.getRowCount();return f+e>g&&(f=g-e),d+c>h&&(d=h-c),{row:c,col:e,rowCount:d,colCount:f}}function Qa(a,b){var c,d=a.getViewportBottomRow(a.Er(b));if(d===-1&&(d=a.ir()),b<d)for(c=d;c>b;c--)if(0!==a.getRowHeight(c))return!1;return!0}function Ra(a){var b,c,d=a.ITa.getSelections();if(d.length>0)return b=0,c=a.getRowCount(),d.every(function(d){var e,f,g=Pa(a,d),h=!1;return 1===g.rowCount&&(b+=1,h=b<=1),e=g.row<c,f=g.col!==-1,f||h&&e})}function Sa(a,b,c){var d=a.parent,e=d.options.rowResizeMode;return c&&0===e&&(e=1),b.action!==_&&1===e&&(!Qa(a,b.index)&&(!(!a.getRowResizable(b.index,b.sheetArea)||!a.getRowResizable(b.index+1,b.sheetArea))&&Ra(a)))}function Ta(a,b,c,d){return Sa(a,b,d)&&1===c.length&&c[0].firstRow===c[0].lastRow}function Ua(a,b){var c,d=a.getViewportRightColumn(a.Fr(b));if(d===-1&&(d=a.dr()),b<d)for(c=d;c>b;c--)if(0!==a.getColumnWidth(c))return!1;return!0}function Va(a){var b,c,d=a.ITa.getSelections();if(d.length>0)return b=0,c=a.getColumnCount(),d.every(function(d){var e,f,g=Pa(a,d),h=!1;return 1===g.colCount&&(b+=1,h=b<=1),e=g.col<c,f=g.row!==-1,f||h&&e})}function Wa(a,b,c){var d=a.parent,e=d.options.columnResizeMode;return c&&0===e&&(e=1),b.action!==ca&&1===e&&(!Ua(a,b.index)&&(!(!a.getColumnResizable(b.index,b.sheetArea)||!a.getColumnResizable(b.index+1,b.sheetArea))&&Va(a)))}function Xa(a,b,c,d){return Wa(a,b,d)&&1===c.length&&c[0].firstColumn===c[0].lastColumn}function Ya(a,b,c,d,e){var f,g,h=b.index,i=a.am();Sa(a,b,e)?(f=a._q(h,c),g=a.Sl(h,c)+a.Sl(f,c),Ia(b,d,i,!0,g)):Ia(b,d,i,!0)}function Za(a,b,c,d,e){var f,g,h=b.index,i=a.am();Wa(a,b,e)?(f=a.Zq(h,c),g=a.Tl(h,c)+a.Tl(f,c),Ia(b,d,i,!1,g)):Ia(b,d,i,!1)}function $a(a,b,c){var d,e,f,g,h=c?a.frozenRowCount():a.frozenColumnCount(),i=c?a.lq:a.qq,j=!1,k=i-1;if(h>0&&h<i)for(e=i-1;e>=h;){if(d=c?a.getRowVisible(e):a.getColumnVisible(e)){if(f=c?a.getRowHeight(e):a.getColumnWidth(e),e===k&&0===f)break;if(f>0){j=!0;break}}else k--;e--}for(g=j?h:b,g--;g>=0;){if(d=c?a.getRowVisible(g):a.getColumnVisible(g))return g;g--}return-1}ia=function(){function a(a){var b=this;b.qo=a,b.jI=C,b.kI=C,b.lI=C,b.Fi=C,b.mI=!1,b.nI=!1}return a.prototype.tG=function(a){typeof a===L&&(this.kI=a)},a.prototype.PG=function(a){var b,c=this;E(a)||0===a?c.SG():(c.nI=a>0,a=J(a),b=c.jI,c.jI=a,b!==a&&c.oI())},a.prototype.oI=function(){var a=this;a.$b(),E(a.jI)||(a.lI=k.setInterval(function(){a.pI()},a.jI))},a.prototype.pI=function(){var a=this,b=a.kI;a.mI=!0,typeof b===L&&(a.Fi=b.call(a.qo,a.nI))},a.prototype.SG=function(){var a=this;a.$b(),a.jI=C,a.lI=C,a.Fi=C,a.mI=!1},a.prototype.$b=function(){var a=this.lI;a&&clearInterval(a)},a.prototype.no=function(){this.SG()},a}(),ja=function(){function a(a){this.DHb=0;var b=this;b.WF=0,b.XF=!1,b.Gma=!1,b.gA={},b.kj=a}return a.prototype.no=function(){var a=this;a.YF&&a.YF.no(),a.ZF&&a.ZF.no(),a.$F=C},a.prototype._F=function(){var a=this;return a.YF||(a.YF=new ia(a)),a.YF},a.prototype.aG=function(){var a=this;return a.ZF||(a.ZF=new ia(a)),a.ZF},a.prototype.Vs=function(){return this.kj.Vs()},a.prototype.bG=function(){var a=h.GC$(this.kj.Ws()).position();return a||(a={top:0,left:0}),a},a.prototype.AD=function(a){var b,c,d,e,f,g,h,j,k;return 2===a.button||(b=this,c=b.kj,b.tC(),n&&n.msie&&a.offsetX!==D&&a.offsetY!==D&&(d=0,e=0,a.target!==c.Xs&&(f=i.Ul.Z3(a.target,c.Xs),d=f.EB,e=f.FB),g=a.pageX-(a.offsetX+d),h=a.pageY-(a.offsetY+e),c.Ws().canvasOffset={top:h,left:g}),j=c.Vs(),k=b.cG(a,a.pageX-j.left,a.pageY-j.top),ma(c)||k||b.zt(),c.dG=!0,!1)},a.prototype.tC=function(){var a=this;a.RB||(h.GC$(l).bind("mousemove.gcSheet",function(b){a.BD(b)}).bind("mouseup.gcSheet",function(b){a.CD(b)}),a.RB=!0)},a.prototype.uC=function(){this.RB&&(this.RB=!1,h.GC$(l).unbind("mousemove.gcSheet").unbind("mouseup.gcSheet"))},a.prototype.cG=function(a,b,c){var d,f,g,h,j,k,l,m,n,o=this,p=o.kj,q=p.hitTest(b,c),r=q.row,s=q.col,u=q.dragInfo,v=q.formulaRangeHitInfo,w=q.cellTypeHitInfo,x=q.resizeTableHitInfo,y={hitInfo:q,e:a,r:C};if(e.Worksheet.ao(p,"processMouseDown",y),!y.r&&(d=p.am(),b>=d.x&&c>=d.y))if(p.yt=q,o.eG=!0,q.tableSelectInfo)this.EHb(q,p);else if(q.resizeInfo){if(!na(p))return;o.fG(q)}else if(q.dragMergeInfo){if(!na(p))return;o.Zia&&o.Zia(q)}else if(u&&u.side&&u.side!==$){if(!na(p))return;o.gG&&o.gG(q)}else if(u&&u.side===$){if(!na(p))return;o.hG&&o.hG(q)}else if(q.filterButtonHitInfo)na(p);else if(v)v.inBorder?o.iG(q):(v.inTopLeft||v.inTopRight||v.inBottomLeft||v.inBottomRight)&&o.jG(q);else if(x)o.FHb&&o.FHb(q);else if(p.Qs(sa(q)<0?-1:r,ta(q)<0?-1:s)){if(o.kG&&o.kG(p,q))return;if(f=va(p),g=wa(p),w){if(h=p.getCellType(w.row,w.col,ua(q)),w.sheet||(w.sheet=p),o.Sia(h,w)&&(j=w.sheetArea,(t(j)||3===j)&&(r!==f||s!==g))){p.suspendPaint();try{if(!na(p))return;if(k=Fa(p,p.name(),f,g,D,!0),p.Wq(i.Events.LeaveCell,k),k&&k.cancel===!0)return;l=p.ITa.getSelections(),m=p.ITa.getSpan(r,s),n=[new i.Range(m.row,m.col,m.rowCount,m.colCount)],p.Wq(i.Events.FloatingElementSelected,{type:"worksheet"}),p.yu(l,n),p.Sr(r,s,D,D,1),p.Wq(i.Events.EnterCell,Fa(p,p.name(),r,s)),p.Wq(i.Events.FormulatextboxEnterCell,Fa(p,p.name(),r,s)),p.Au(l),p.Uja=!0,o.cs&&o.cs(r,s)}finally{p.resumePaint()}}h.processCellAndPaddingMouseDown(w)}if(w&&w.isReservedLocation)return!0;o.lG(a),o.Ala(p,q,r,s)}},a.prototype.Ala=function(a,b,c,d){var e,f,g=this;try{if(g.mG=b,ma(a)&&!na(a))return}finally{g.mG=C}t(c)||t(d)||(3===ua(b)&&g.cs&&g.cs(c,d),a.Wq(i.Events.FloatingElementSelected,{type:"worksheet"}),e=a.ITa.getSelections(),g.nG(b,e),f=a.ITa.getSelections(),a.yu(e,f))},a.prototype.Sia=function(a,b){return a&&b&&b.isReservedLocation&&(!a.activeOnClick||a.activeOnClick())},a.prototype.oG=function(a){var b,c=this.kj;return!c||(b=c.am(),t(a.x)||t(a.y)||t(a.width)||t(a.height)||a.x+a.width>b.pt+b.er+b.js||a.y+a.height>b.qt+b.jr+b.gs)},a.prototype.pG=function(a,b,c,d){var e,f,g,i,j,k,l,m,n=this.kj;for(f=0,g=a.options,i=g.length;f<i;f++)if(j=g[f],j.selected){e=d[f].value;break}k=!1,n.options.isProtected&&(l=n.getActualStyle(b,c),l&&(k=l.locked)),e===D||k||(m={cmd:"editCell",sheetName:n.name(),row:b,col:c,newValue:e,autoFormat:!0},n.wu().execute(m)),h.GC$(a).hide()},a.prototype.qG=function(){var a,b=this;b.rG&&(a=b.rG.sG,3!==a&&2!==a||b.aG().tG(b.uG),3!==a&&1!==a||b._F().tG(b.vG))},a.prototype.wG=function(){var a=this;a.xG&&a.yG(),a.$ia&&a._ia&&a._ia(),a.zG&&a.AG&&a.AG(),a.BG&&a.CG&&a.CG(),a.DG&&a.EG(),a.FG&&a.GG(),a.HG&&a.IG(),a.GHb&&a.HHb&&a.HHb()},a.prototype.uG=function(a){var b,c,d,e,f,g,h,i,j=this,k=j.JG();k||(b=j.rG,c=j.kj,d=b.KG,e=c.getViewportTopRow(d),f=c.getViewportBottomRow(d),a?f<qa(c)-c.frozenTrailingRowCount()-1?c.mq(c._q(e)):(g=c.Gr(d),g&&g.length>0&&(h=c.am(),i=g[g.length-1],i.y+i.height>=h.qt+h.jr&&c.mq(c._q(e)))):e>oa(c)&&c.mq(c.gr(e))),j.wG()},a.prototype.vG=function(a){var b,c,d,e,f,g,h,i,j=this,k=j.LG();k||(b=j.kj,c=j.rG,d=c.MG,e=b.getViewportLeftColumn(d),f=b.getViewportRightColumn(d),a?f<ra(b)-b.frozenTrailingColumnCount()-1?b.rq(b.Zq(e)):(g=b.Hr(d),g&&g.length>0&&(h=b.am(),i=g[g.length-1],i.x+i.width>=h.pt+h.er&&b.rq(b.Zq(e)))):e>pa(b)&&b.rq(b.br(e))),j.wG()},a.prototype.JG=function(){var a,b,c,d,e,f,g=this.kj,h=g.am(),i=oa(g),j=g.frozenTrailingRowCount(),k=this.$F,l=this.rG,m=l.KG;if(0===m){if(k.y>h.qt)return g.mq(g._t()),l.KG=1,!0}else if(1===m){if(a=g.Gr(1),a&&a.length>0){if(b=a[0],i>0&&k.y<h.qt&&b.row<=g._t())return l.KG=0,!0;if(b=a[a.length-1],j>0&&k.y>h.ot&&b.row>=g.ir()&&b.y+b.height<=h.ot)return l.KG=2,!0}}else if(2===m&&(a=g.Gr(1),a&&a.length>0&&k.y<h.ot)){if(b=a[a.length-1],b.y+b.height>h.ot){for(c=h.jr,d=qa(g)-j-1,e=0,f=d;f>=i;f--)if(e+=g.Sl(f),e>c){d=I(f+1,d);break}g.mq(g._q(d-1))}return l.KG=1,!0}return!1},a.prototype.LG=function(){var a,b,c,d,e,f,g=this.kj,h=g.frozenTrailingColumnCount(),i=pa(g),j=g.am(),k=this.$F,l=this.rG,m=l.MG;if(0===m){if(k.x>j.pt)return g.rq(g.$t()),l.MG=1,!0}else if(1===m){if(a=g.Hr(1),a&&a.length>0){if(b=a[0],i>0&&k.x<j.pt&&b.col<=g.$t())return l.MG=0,!0;if(b=a[a.length-1],h>0&&k.x>j.lt&&b.col>=g.dr()&&b.x+b.width<=j.lt)return l.MG=2,!0}}else if(2===m&&(a=g.Hr(1),a&&a.length>0&&k.x<j.lt)){if(b=a[a.length-1],b.x+b.width>j.lt){for(c=j.er,d=ra(g)-h-1,e=0,f=d;f>=i;f--)if(e+=g.Tl(f),e>c){d=I(f+1,d);break}g.rq(g.Zq(d-1))}return l.MG=1,!0}return!1},a.prototype.NG=function(){var a,b,c,d,e,f,g,h,i,j=this;(j.OG||j.O3||j.lV)&&(a=j.kj,b=a.am(),c=j.rG,d=c.KG,e=c.MG,f=j.$F,g=C,d>=0&&e>=0?g=b.Ft(d,e):d>=0?g=b.fm(d):e>=0&&(g=b.gm(e)),g&&(h=0,i=0,f.x<=g.x?h=f.x-g.x:f.x>=g.x+g.width&&(h=f.x-(g.x+g.width)),f.y<=g.y?i=f.y-g.y:f.y>=g.y+g.height&&(i=f.y-(g.y+g.height)),j._F().PG(j.QG(h)),j.aG().PG(j.QG(i))))},a.prototype.RG=function(){this._F().SG(),this.aG().SG()},a.prototype.fG=function(a){var b,c,d,e,f,h,i=this,j=g.yp.prototype,k=i.kj,l=a.resizeInfo;l.action===aa||l.action===_?(b=Ha(i,k.Jt,i.TG,j.findRow,a.row,l,!0),l.startY=b.y):(c=Ha(i,k.Kt,i.UG,j.findCol,a.col,l,!1),l.startX=c.x),d=k.parent,e=a.x,f=a.y,d&&(h=d.options.showResizeTip,(1!==h||l.action!==ba&&l.action!==ca)&&(2!==h||l.action!==aa&&l.action!==_)&&3!==h||(f-ha<0?f+=ha/2:f-=ha,d.uw(i.VG(),e,f))),i.isResizing=!0,i.OG=!0,i.ctrl&&(i.fCb=!0)},a.prototype.WG=function(){var a,b,c,d=this,e=d.kj,f=e.yt,g=f.resizeInfo,h=d.$F,i=h.x,j=h.y,k=e.am(),l=e.parent,m=g.sheetArea;g&&d.OG&&d.isResizing&&(f.x===i&&f.y===j||(g.action===aa||g.action===_?Ya(e,g,m,j,d.fCb):Za(e,g,m,i,d.fCb),a=e.yl,b=a.bm(),a.Mx(k.x,k.y,k.width,k.height),a.Pw(b),l&&(c=l.options.showResizeTip,(1!==c||g.action!==ba&&g.action!==ca)&&(2!==c||g.action!==aa&&g.action!==_)&&3!==c||l.ww(d.XG(g)))))},a.prototype.YG=function(){var a,b,c,d,e,f,g,i,j,k,l,m,n=this;n.isResizing=!1,n.OG=!1,a=!0,b=n.kj,c=b.yt,d=c.resizeInfo,d&&(n.xw(),d.action===aa||d.action===_?t(d.movingY)?a=!1:(e=G(0,(d.movingY-d.startY)/b.zoom()),f=[],g="resizeRow",b.tp(d.index)?h.GC$.each(b.ITa.getSelections(),function(a,c){if(c.col===-1)if(1===d.sheetArea)f.push({firstRow:d.index,lastRow:d.index});else{var e=b.Tq(c);f.push({firstRow:e.row,lastRow:e.row+Da(e)-1})}}):f.push({firstRow:d.index,lastRow:d.index}),Ta(b,d,f,n.fCb)&&(g="splitResizeRow"),i=1===d.sheetArea,b.wu().execute({cmd:g,sheetName:b.name(),rows:f,size:e,columnHeader:i})):t(d.movingX)?a=!1:(e=G(0,(d.movingX-d.startX)/b.zoom()),j=[],k="resizeColumn",b.sp(d.index)?h.GC$.each(b.ITa.getSelections(),function(a,c){if(c.row===-1){var e=b.Tq(c);2===d.sheetArea?j.push({firstCol:d.index,lastCol:d.index}):j.push({firstCol:e.col,lastCol:e.col+Ca(e)-1})}}):j.push({firstCol:d.index,lastCol:d.index}),Xa(b,d,j,n.fCb)&&(k="splitResizeColumn"),l=2===d.sheetArea,b.wu().execute({cmd:k,sheetName:b.name(),columns:j,size:e,rowHeader:l})),m=b.hitTest(n.$F.x,n.$F.y),m&&n.Tw(m),a||b.repaint(),n.fCb=!1)},a.prototype.ZG=function(a,b){var c,d,e,f,g,h,i,j,k=0,l=0,m=0,n=0,o=this,p=o.kj,q=p.wq,r=oa(p),s=pa(p);if(o.o4=o.$G=p.ITa.getSelections(),o.ctrl||o.shift||p.Tr(),0===ua(a)){if(!o.shift&&(d=r?p.ar():p.lq,g=s?p.$q():p.qq,c=Ga(o,d,g,1,1,b)))return;o.ctrl||p.Tr(),p.Ur(-1,-1,qa(p),ra(p),!0)}else if(1===ua(a)){if(!o.shift&&(d=r?p.ar():p.lq,e=o._G(d,a.col,!1),c=Ga(o,e.row,e.col,1,ta(a),b)))return;o.shift||p.n_a?(k=I(p.Kl,a.col),n=J(p.Kl-a.col)+1,p.Kx(-1,k,qa(p),n,!0)):p.Ur(-1,p.Kl,qa(p),1,!0)}else if(2===ua(a)){if(!o.shift){if(h=s?p.$q():p.qq,e=o._G(a.row,h,!0),f=p.Jl!==e.row,c=Ga(o,e.row,e.col,sa(a),1,b))return;f&&q&&q.Lx()}o.shift||p.n_a?(l=I(p.Jl,a.row),m=J(p.Jl-a.row)+1,p.Kx(l,-1,m,ra(p),!0)):p.Ur(p.Jl,-1,1,ra(p),!0)}else if(3===ua(a))if(E(a.row)||E(a.col))ma(p)&&(j=p.getCellRect(p.Jl,p.Kl,p.Nr,p.Pr),p.yl.VF(j.x,j.y,j.width,j.height));else{if(!o.shift&&(p.Jl!==a.row||p.Kl!==a.col)){if(f=p.Jl!==a.row,c=Ga(o,a.row,a.col,sa(a),ta(a),b))return;f&&q&&q.Lx()}o.shift?p.aH(a.row,a.col,!0):(i=p.ITa.getSpan(a.row,a.col),p.n_a||p.Ur(i.row,i.col,Da(i),Ca(i),!0))}},a.prototype.bH=function(a){if(a&&(3!==ua(a)||!E(a.row)&&!E(a.col))){var b=this;b.OG=!0,b.xG=!0,b.rG={KG:sa(a),MG:ta(a),sG:ua(a)},b.qG()}},a.prototype.ayb=function(a,b){var c,d=this,e=d.kj,f=e.getSpan(a,b),g=a,h=b,j=1,k=1,l=e.selectionUnit(),m=!1;return 1===l?(h=-1,k=-1,g=f?f.row:g,j=f?f.rowCount:j):2===l?(g=-1,j=-1,h=f?f.col:h,k=f?f.colCount:k):m=!0,c=f&&m?f:new i.Range(g,h,j,k)},a.prototype.nG=function(a,b){var c=this,d=c.kj,e=a.row,f=a.col;d.n_a=c.I0a(e,f,b)&&d.parent.options.allowUserDeselect,d.n_a&&(d.s_a=d.Jl,d.t_a=d.Kl,d.p_a=c.ayb(e,f)),c.ZG(a),c.bH(a)},a.prototype.I0a=function(a,b,c){var d=this,e=d.kj,f=d.o_a(a,b,c);return f&&2===e.selectionPolicy()},a.prototype.o_a=function(a,b,c){var d,e,f;if(!this.ctrl)return!1;for(d=!1,e=c.length,f=0;f<e;f++)if(c[f].intersect(a,b,1,1)){d=!0;break}return d},a.prototype.yG=function(){var a,b=this;b.rG&&b.OG&&b.DA!==!0&&(a=b.rG.sG,3===a?b.cH():2===a?b.dH():1===a&&b.eH())},a.prototype.cH=function(){var a,b,c,d,e=this,f=e.kj,g=e.fH(),h=e.gH();if(g>=0&&h>=0&&f.Qs(g,h)){if(a=f.ITa.getSelections(),1===a.length&&(b=f.Jx(g,h,f.Jl,f.Kl),c=a[0],!f.n_a&&b.equals(c)))return;f.aH(g,h,!0),d=f.ITa.getSelections(),f.yu(a,d),e.NG()}},a.prototype.dH=function(){var a,b,c,d,e,f,g,h,i=this,j=i.kj,k=i.fH();if(k>=0&&j.Qs(k,-1)){if(a=I(j.Jl,k),b=G(j.Jl,k)-a+1,c=-1,d=ra(j),e=j.selectionPolicy(),0===e)return;f=j.selectionUnit(),2===f&&(a=-1,b=-1),g=j.ITa.getSelections(),j.Kx(a,c,b,d,!0),h=j.ITa.getSelections(),j.yu(g,h)}i.NG()},a.prototype.eH=function(){var a,b,c,d,e,f,g,h,i=this,j=i.kj,k=i.gH();if(k>=0&&j.Qs(-1,k)){if(a=I(j.Kl,k),b=G(j.Kl,k)-a+1,c=-1,d=qa(j),e=j.selectionPolicy(),0===e)return;f=j.selectionUnit(),1===f&&(a=-1,b=-1),g=j.ITa.getSelections(),j.Kx(c,a,d,b,!0),h=j.ITa.getSelections(),j.yu(g,h)}i.NG()},a.prototype.hH=function(){var a,b,c,d,e=this;e.rG=C,e.RG(),e.DA=C,e.OG=!1,e.xG=!1,a=e.kj,0!==a.ITa.getSelections().length&&(a.n_a&&(a.n_a=!1,b=a.p_a,a.p_a=null,a.u_a(a.ITa.getSelections(),b),delete a.s_a,delete a.t_a),a.Uja?delete a.Uja:(c=!e.$G,c||(d=a.ITa.getSelections(),c=e.zu(e.$G,d)),c&&a.Au(e.o4)),e.$G=a.ITa.getSelections())},a.prototype.iH=function(){var a=this.kj,b=Ja(a,this.$F.y),c=this.rG.KG,d=a.Gr(1);return 0===b&&c>0&&d.length>0&&d[0].row>a._t()?b=1:2===b&&c<2&&d.length>0&&d[d.length-1].row<a.ir()&&(b=1),b},a.prototype.jH=function(){var a=this.kj,b=Ka(a,this.$F.x),c=this.rG.MG,d=a.Hr(1);return 0===b&&c>0&&d.length>0&&d[0].col>a.$t()?b=1:2===b&&c<2&&d.length>0&&d[d.length-1].col<a.dr()&&(b=1),b},a.prototype.fH=function(){var a,b,c=this.kj,d=this.$F.y,e=this.iH(),f=La(c,e,d);return f?(a=c.am(),b=f.row,1===e&&d<a.qt&&b>c._t()?c._q(b-1)||b:1===e&&d>a.ot&&b>c.hr()?c.gr(b)||b:b):-1},a.prototype.gH=function(){var a,b,c=this.kj,d=this.$F.x,e=this.jH(),f=Ma(c,e,d);return f?(a=c.am(),b=f.col,1===e&&d<a.pt&&b>c.$t()?c.Zq(b-1)||b:1===e&&d>a.lt&&b>c.cr()?c.br(b)||b:b):-1},a.prototype.QG=function(a){var b,c=0;return E(a)||0===a||(b=a<0,c=K(500/J(a)),c=G(20,10*c),c>200&&(c=200),b&&(c=-c)),c},a.prototype.TG=function(a,b){var c=this.kj,d=c.gr(a,b);return d!==C?d:a},a.prototype.UG=function(a,b){var c=this.kj,d=c.br(a,b);return d!==C?d:a},a.prototype.kH=function(a,b,c){for(var d=this.kj;a>b;)if(a--,d.getRowVisible(a,c))return a;return a},a.prototype.lH=function(a,b,c){for(var d=this.kj;a>b;)if(a--,d.getColumnVisible(a,c))return a;return a},a.prototype.mH=function(a,b,c,d,e){var g,h,i,j,k,l,m,n=C;return Na(a)?(g=this,h=a.Gr(sa(b),d),!h||E(b.row)||E(b.col)||(a.getRowVisible(b.row,d)||(b.row=this.TG(b.row,d)),i=h.findRow(b.row),i&&(i.y+i.height-c<=e&&e<=i.y+i.height+c?(n=Ea(aa,b.row,d),j=h[h.length-1].row,j>=0&&(k=a.ir(d),n.index===k&&n.index!==j&&i.y+i.height-c/2<=e&&(n=Ea(g.nH(a,j,d),j,d)))):i.y-c<=e&&e<=i.y+c&&f.Common.k.Cb(h,i)>0&&(l=g.kH(b.row,0,d),n=Ea(g.nH(a,l,d),l,d))),!n&&1===sa(b)&&h.length>0&&(i=h[0],G(0,i.y-c)<=e&&e<=i.y+c&&(m=$a(a,b.row,!0),m>=0&&(n=Ea(g.nH(a,m,d),m,d))))),n&&!a.getRowResizable(n.index,d)&&(n=C),n):n},a.prototype.nH=function(a,b,c){var d=a.parent;return d&&1===d.options.resizeZeroIndicator&&a.getRowVisible(b)&&0===a.Yr(b,c)?_:aa},a.prototype.oH=function(a,b,c,d,e){var g,h,i,j,k,l,m,n=C;return Oa(a)?(g=this,h=a.Hr(ta(b),d),!h||E(b.col)||E(b.row)||(a.getColumnVisible(b.col,d)||(b.col=this.UG(b.col,d)),i=h.findCol(b.col),i&&(i.x+i.width-c<=e&&e<=i.x+i.width+c?(n=Ea(ba,b.col,d),j=h[h.length-1].col,j>=0&&(k=a.dr(d),n.index===k&&n.index!==j&&i.x+i.width-c/2<=e&&(n=Ea(g.pH(a,j,d),j,d)))):i.x-c<=e&&e<=i.x+c&&f.Common.k.Cb(h,i)>0&&(l=g.lH(b.col,0,d),n=Ea(g.pH(a,l,d),l,d))),!n&&1===ta(b)&&h.length>0&&(i=h[0],G(0,i.x-c)<=e&&e<=i.x+c&&(m=$a(a,b.col,!1),m>=0&&(n=Ea(g.pH(a,m,d),m,d))))),n&&!a.getColumnResizable(n.index,d)&&(n=C),n):n},a.prototype.pH=function(a,b,c){var d=a.parent;return d&&1===d.options.resizeZeroIndicator&&a.getColumnVisible(b)&&0===a.$r(b,c)?ca:ba},a.prototype.ur=function(a,b,c,d){var e,f,g,h,i,j,k,l=this,m=l.kj,n=m.parent,o=m.options,p=o.colHeaderVisible,q=o.rowHeaderVisible,r=C;return n&&!n.options.allowUserResize||(g=m.am(),sa(a)<0&&ta(a)>=0&&p?(r=l.oH(m,a,d,1,b),r||(r=l.mH(m,a,d,1,c))):sa(a)>=0&&ta(a)<0&&q?(r=l.mH(m,a,d,2,c),r||(r=l.oH(m,a,d,2,b))):sa(a)<0&&ta(a)<0?m.ir(2)===C&&J(c-g.Cr)<=d?(h=m.Gr(1),h&&h.length>0&&(e=h[h.length-1].row,e>=0&&m.getRowResizable(e,2)&&(r=Ea(l.nH(m,e,2),e,2)))):m.dr(1)===C&&J(b-g.Br)<=d&&(i=m.Hr(1),i&&i.length>0&&(f=i[i.length-1].col,f>=0&&m.getColumnResizable(f,1)&&(r=Ea(l.pH(m,f,1),f,1)))):sa(a)>=0&&ta(a)>=0&&(e=qa(m,1)-1,f=ra(m,2)-1,j=m.options.sheetAreaOffset.top,k=m.options.sheetAreaOffset.left,e>=0&&0===g.Cr&&j<=c&&c<=d+j&&p?r=Ea(l.nH(m,e,1),e,1):f>=0&&0===g.Br&&k<=b&&b<=d+k&&q&&(r=Ea(l.pH(m,f,2),f,2)))),r},a.prototype.qH=function(a,b,c,d){var e,f,g,h,i=this.kj,j=i.am(),k=j.Ft(1,1);if(1===b)if(e=i.Hr(b),e&&e.length>0){if(f=e[e.length-1],f.x+f.width<=c&&c<k.x+k.width)return!0}else if(k.contains(c,d))return!0;if(1===a)if(g=i.Gr(a),g&&g.length>0){if(h=g[g.length-1],h.y+h.height<=d&&d<k.y+k.height)return!0}else if(k.contains(c,d))return!0;return!1},a.prototype.BD=function(a){var b=this.Vs();this.sH(a,a.pageX-b.left,a.pageY-b.top)},a.prototype.DD=function(){var a,b,c,d=this.kj,e=d.yt;e&&(a=e.cellTypeHitInfo,a&&(b=d.getCellType(a.row,a.col,ua(e)),b.ZBb(a))),this.OG||(c={x:-1e4,y:-1e4,rowViewportIndex:C,colViewportIndex:C,row:-1,col:-1,resizeInfo:C,hitTestType:C},this.Uw(c))},a.prototype.sH=function(a,b,c){var d,e,f=this;return f.$F={e:a,x:b,y:c},d=f.kj,f.eG&&!i.Vl.Wl(d)&&i.Vl.Zl(d),f.eG&&f.OG?void(f.isResizing?f.WG():f.$ia?f._ia&&f._ia():f.zG?f.AG&&f.AG():f.BG?f.CG&&f.CG():f.DG?f.EG():f.FG?f.GG():f.HG?f.IG():f.GHb?f.HHb&&f.HHb():f.xG&&f.yG()):(e=d.hitTest(b,c),f.IHb(d,e,f),void(e&&(0===f.DHb&&e.tableSelectInfo&&f.eG&&f.JHb(d,f,e),f.Tw(e),f.Uw(e))))},a.prototype.IHb=function(a,b,c){var d,e,f,g,h;1===c.DHb?(d=c.KHb.row,e=c.KHb.col,f=b.col,g=a.getSelections()[0],a.Kx(d,e>f?f:e,g.rowCount,e-f>0?e-f+1:f-e+1,!0)):2===c.DHb&&(d=c.KHb.row,e=c.KHb.col,h=b.row,g=a.getSelections()[0],a.Kx(d>h?h:d,e,d-h>0?d-h+1:h-d+1,g.colCount,!0))},a.prototype.JHb=function(a,b,c){var d,e=a.getActiveRowIndex(),f=a.getActiveColumnIndex();b.KHb={row:e,col:f},d=c.tableSelectInfo.action,"tableColSelect"===d?b.DHb=1:"tableRowSelect"===d&&(b.DHb=2)},a.prototype.Tw=function(a){var b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s=this,t=s.kj,u=t.Ws();u&&(b=t.yt,d=!b||a.row!==b.row||a.col!==b.col||ua(a)!==ua(b)||a.resizeInfo&&!b.resizeInfo||!a.resizeInfo&&b.resizeInfo||a.resizeInfo&&a.resizeInfo.action!==b.resizeInfo.action||a.dragInfo&&!b.dragInfo||!a.dragInfo&&b.dragInfo||a.dragInfo&&a.dragInfo.action!==b.dragInfo.action||a.resizeTableHitInfo&&!b.resizeTableHitInfo,b&&d&&(e=b.cellTypeHitInfo,e&&(c=t.getCellType(e.row,e.col,ua(b)),c.ZBb(e))),f=a.resizeInfo,g=a.dragMergeInfo,h=a.dragInfo,j=a.formulaRangeHitInfo,k=a.cellTypeHitInfo,l=t.yl,m=a.resizeTableHitInfo,n=a.tableSelectInfo,n?"tableRowSelect"===n.action?u.style.cursor="url(data:image/ico;base64,AAABAAEACAgAAAEAIABIAQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAATQAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAACtAAAAkAAAAAsAAAAAAAAAeAAAAHkAAAB5AAAAewAAANcAAAD9AAAAjAAAAA0AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD5AAAAngAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAPkAAACeAAAAeAAAAHkAAAB5AAAAewAAANcAAAD9AAAAjAAAAA0AAAAAAAAAAAAAAAAAAAAFAAAArQAAAJAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAUAAABNAAAAEQAAAAAAAAAA4wAAAOEAAAAAAAAAAAAAAAAAAAAAAAAA4QAAAOMAAAA=) 8 4,auto":"tableColSelect"===n.action?u.style.cursor="url(data:image/ico;base64,AAABAAEACAgAAAEAIABIAQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAACKAAAAigAAAAgAAAAAAAAAAAAAAAAAAAAHAAAAfAAAAPYAAAD2AAAAewAAAAcAAAAAAAAACAAAAHwAAAD3AAAA/wAAAP8AAAD3AAAAfAAAAAgAAAAVAAAAVwAAAJ8AAAD/AAAA/wAAAJ4AAABXAAAAFQAAAAAAAAAAAAAAYAAAAP8AAAD/AAAAYAAAAAAAAAAAAAAAAAAAAAAAAABgAAAA/wAAAP8AAABgAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAD/AAAA/wAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAXwAAAPwAAAD8AAAAXwAAAAAAAAAAwwAAAIEAAAAAAAAAAAAAAMMAAADDAAAAwwAAAMMAAAA=) 8 4,auto":"tableCornerSelect"===n.action?u.style.cursor="url(data:image/ico;base64,AAABAAEACgoAAAEAIADgAQAAFgAAACgAAAAKAAAAFAAAAAEAIAAAAAAAkAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAACTAAAA/QAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAEwAAAJ8AAAD8AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAoAAAA3AAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAATAAAAngAAAPwAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAASAAAAnwAAAP0AAAD/AAAA+gAAANwAAAD6AAAA/wAAAAAAAAASAAAAnwAAAP0AAAD/AAAA/QAAAJ4AAAAlAAAAnwAAAP0AAAAVAAAAngAAAP0AAAD/AAAA/QAAAJ8AAAASAAAAAAAAABQAAACTAAAApwAAAP0AAAD/AAAA/QAAAJ8AAAASAAAAAAAAAAAAAAAAAAAACgAAAG0AAADqAAAA/gAAAJ4AAAASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAbQAAAKgAAAAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAOAAAADwAAAA4AAAAMAAAACAAAAAAQAAAAOAAAAHwAAAD8AAAA==) 10 5,auto":"tableSelect"===n.action?u.style.cursor="move":"default"===n.action&&(u.style.cursor=""):f?f.action===ba?u.style.cursor=i.CursorResource.ResizeCol:f.action===aa?u.style.cursor=i.CursorResource.ResizeRow:f.action===ca?u.style.cursor=i.CursorResource.ResizeHiddenCol:f.action===_?u.style.cursor=i.CursorResource.ResizeHiddenRow:u.style.cursor=da:g?g.left||g.right?u.style.cursor="w-resize":(g.top||g.bottom)&&(u.style.cursor="n-resize"):h&&"drag"===h.action?h.side===$?u.style.cursor="crosshair":h.side?u.style.cursor="move":u.style.cursor=da:j?(j.inBorder?u.style.cursor="move":j.inTopLeft?u.style.cursor="nw-resize":j.inTopRight?u.style.cursor="ne-resize":j.inBottomLeft?u.style.cursor="sw-resize":j.inBottomRight&&(u.style.cursor="se-resize"),o=s.isFormulaRangeHoving,p=s.tH,q=p&&p.paramRange,r=j.paramRange,s.isFormulaRangeHoving=!0,s.tH={paramRange:r},o&&r.index===q.index||l.uH()):m?u.style.cursor="se-resize":(k&&(c=t.getCellType(k.row,k.col,ua(a)),k.sheet=t,d&&c.processMouseEnter(k),c.YBb(k)),!d&&k&&k.isReservedLocation||(u.style.cursor=da),s.isFormulaRangeHoving&&(s.isFormulaRangeHoving=!1,s.tH=C,l.uH())))},a.prototype.CD=function(a){var b=this,c=b.kj;return b.uC(),!c.dG||(c.dG=!1,b.vH(a),!1)},a.prototype.vH=function(a){var b,c,d,e=this,f=e.kj,g=i.Vl.Xl();e.eG=!1,e.DHb=0,g&&g!==f&&g.endEdit&&(g.Cw&&g.Cw.V4||(g.endEdit(),g.repaint())),i.Vl.Zl(f),e.isResizing?e.YG():e.$ia?e.aja&&e.aja():e.zG?e.wH&&e.wH():e.BG?e.xH&&e.xH():e.DG?e.yH():e.FG?e.zH():e.HG?e.AH():e.GHb?e.LHb&&e.LHb():f.yt&&(b=f.yt,c=b.cellTypeHitInfo,!b.filterButtonHitInfo&&!b.resizeInfo&&b.row>=0&&b.col>=0&&(c&&(d=f.getCellType(c.row,c.col,ua(b)),c.sheet||(c.sheet=f),d.XGb(c)),c&&c.isReservedLocation||f.Wq(i.Events.CellClick,Fa(f,f.name(),b.row,b.col,ua(b))),e.hH())),e.lG(a)},a.prototype.UF=function(a,b,c){var d,e=this.kj;e.isEditing&&e===i.Vl.Xl()&&(d=e.Ws(),za(a)||ya(a)||e.FF(d,b,c))},a.prototype.nm=function(a){var b,c,d,e,f,g,h,j,k,l=this,m=l.kj;if(m){if(b=va(m),c=wa(m),d=m.getCellType(b,c),e={isEditing:ma(m),sheet:m,row:b,col:c,sheetArea:3},f={sheet:m,row:b,col:c,sheetArea:3},d&&d.isReservedKey(a,e))return void(ma(m)||d.processKeyDown(a,f));if(g=m.Cw,g&&g.BH(a))return;if(h=m.parent&&m.parent.CF,h&&h.BH(a,e))return}if(j=!(ma(m)||ya(a)||Ba(a)||34!==xa(a)&&33!==xa(a)&&37!==xa(a)&&39!==xa(a)&&9!==xa(a)&&13!==xa(a)&&38!==xa(a)&&40!==xa(a)),m.CH&&(m.CH=!1,m.yl.DH()),k=l.EH(a),j&&k&&i.Vl.Wl(m)){if(l.Uoa=new Date,l.FH)return l.GH<25&&l.GH++,void p(a);l.FH=!0,l.GH=1,l.HH(a,!0)}},a.prototype.VG=function(){var a,b,c,d,e=this.kj,f=e.yt,g=f.resizeInfo;return g.action===aa||g.action===_?(a=e.Jt(g.sheetArea),e.getRowVisible(g.index)||(g.index=this.TG(g.index,g.sheetArea)),b=a.findRow(g.index),b||(b=a.findRow(f.row)),r(ga().Tip_Height,[b.height.toFixed(0)])):(c=e.Kt(g.sheetArea),e.getColumnVisible(g.index)||(g.index=this.UG(g.index,g.sheetArea)),d=c.findCol(g.index),d||(d=c.findCol(f.col)),r(ga().Tip_Width,[d.width.toFixed(0)]))},a.prototype.XG=function(a){return a.action===aa||a.action===_?r(ga().Tip_Height,[(a.movingY-a.startY).toFixed(0)]):r(ga().Tip_Width,[(a.movingX-a.startX).toFixed(0)])},a.prototype.HH=function(a,b){var c=this;if(c.FH){if(new Date-c.Uoa>100)return void c.Ux();b||c.EH(a),c.FH&&(c.WF=k.setTimeout(function(){c.HH(a)},500/c.GH))}},a.prototype.IH=function(a,b){var c,d,e=this.kj,f=e.Ws();if(f){e.HF=!0;try{c=ma(e),e.EF&&e.EF(f,e.Jl,e.Kl,C,C,!0,C,b),!c&&ma(e)&&(d=e.getCellType(e.Jl,e.Kl),!d.tw||32!==xa(a)||ya(a)||za(a)||Aa(a)||d.tw(e,e.Jl,e.Kl,3),d.JH&&d.JH(a))}finally{e.HF=!1}}},a.prototype.EH=function(a){var b,c,d,f,g,i,j,l,m,n,o=this,q=o.kj;if(o.lG(a),ma(q)||27!==xa(a)||Aa(a)||ya(a)||za(a)||!q.KH||(h.GC$(q.KH).remove(),q.KH=C),ma(q)||34!==xa(a)&&33!==xa(a)&&35!==xa(a)&&36!==xa(a)&&38!==xa(a)&&40!==xa(a)||p(a),ma(q)||37!==xa(a)&&39!==xa(a)||p(a),ma(q)&&ya(a)&&(89===xa(a)||90===xa(a)))return p(a),!1;if(b=q.wu(),c=b.getShortcutKey(xa(a),ya(a),za(a),Aa(a),Ba(a)),d=b.getCommands(c))for(f=0;f<d.length;f++)if(g=d[f].execute(q.parent,{sheetName:q.name()}))return g.ignoreCancelDefault||p(a),!0;return i={e:a,r:C},e.Worksheet.ao(q,"processKeyDown",i),!!i.r||(o.LH(a)&&(j=q.Cw,j&&j.MH&&j.NH(),l=ma(q),l||(m=k.Yl.Bm(a.target),n=m&&"gcAttachedFormulaTextBox"===m.getAttribute(Z),n||o.IH(a))),!1)},a.prototype.Ux=function(){var a=this;a.FH=!1,a.WF>0&&(clearTimeout(a.WF),a.WF=0)},a.prototype.om=function(a){var b,c,d,e,f,g,h,i,j=this;if(j.Ux(),b=j.kj){if(c=va(b),d=wa(b),e=b.getCellType(c,d),f={isEditing:ma(b),sheet:b,row:c,col:d,sheetArea:3},g={sheet:b,row:c,col:d,sheetArea:3},e&&e.isReservedKey(a,f))return void(ma(b)||e.processKeyUp(a,g));if(h=b.Cw,h&&h.BH(a))return;if(i=b.parent&&b.parent.CF,i&&i.BH(a))return}j.lG(a)},a.prototype.pm=function(a){this.IH(a,!0)},a.prototype.LH=function(a){return!(ya(a)||Aa(a)||Ba(a))&&(xa(a)>=65&&xa(a)<=90||xa(a)>=48&&xa(a)<=57||xa(a)>=96&&xa(a)<=105||xa(a)>=186&&xa(a)<=192||xa(a)>=220&&xa(a)<=222||219===xa(a)||xa(a)>=106&&xa(a)<=111||32===xa(a)||61===xa(a)||173===xa(a)||229===xa(a)||0===xa(a)||8===xa(a))},a.prototype.lG=function(a){var b,c,d,e,f,g=this,h=g.kj,j=i.Ul.sl(),k=j?Ba(a):ya(a);g.ctrl=k&&!za(a),g.shift=za(a)&&!k,h.Hx=!1,9===xa(a)&&(b=h.ITa.getSelections().length,b>1?h.Hx=!0:(c=h.Ix(),c&&b>0&&(h.Hx=!(h.Jl===c.row&&h.Kl===c.col&&h.Lr>=Da(c)&&h.Mr>=Ca(c))))),g.zG===!0&&(d=h.Ix(),e=g.OH,f=g.PH,d.row===-1||d.col===-1?g.OH=za(a):g.OH=!1,g.PH=k,e===g.OH&&f===g.PH||h.yl.QH&&h.yl.QH()),g.RH=k},a.prototype.Vx=function(){var a=this;a.shift=!1,a.ctrl=!1,a.kj.Hx=!1,a.zG=!1,a.OH=!1,a.PH=!1,a.RH=!1},a.prototype.Qw=function(a){var b,c,d,e,f,g,i,j,k,l,m,n;a&&a.sheet?(b=a.sheet,c=a.editor,d=a.canvasOffset):(b=this.kj,c=b.BF),ma(b)&&(e=b.Jl,f=b.Kl,g=b.getCellType(e,f),i=b.am(),j=b.getActualStyle(e,f),k=b.getCellRect(e,f),c&&c.parentNode&&(l=c.parentNode.parentNode,k&&k.width>0&&k.height>0&&k.x>=i.kt&&k.y>=i.nt&&k.x+k.width<=i.lt+i.js&&k.y+k.height<=i.ot+i.gs?(m={sheet:b,row:e,col:f,sheetArea:3,canvasOffset:d},g.g5(l,j,k,m,!0)):h.GC$(l).css({top:-1e4,left:-1e4})),n=b.Cw,n&&n.SH())},a.prototype.TH=function(a,b){var c,d;if(!a)return C;for(c=a.firstChild;c;){if(c.id===b||c.name===b)return c;if(d=this.TH(c,b))return d;c=c.nextSibling}return C},a.prototype.zu=function(a,b){var c,d,e,f=!0;if(a.length===b.length)for(c=0;c<a.length;c++){if(d=a[c],e=b[c],d.row!==e.row||d.col!==e.col||Da(d)!==Da(e)||Ca(d)!==Ca(e)){f=!0;break}f=!1}return f},a.prototype.UH=function(a,b,c,d){var e,f,g,i,j,k=this,l=k.kj,m={sheet:l,row:b,col:c,sheetArea:3},o=l.zo(),p=a.isImeAware(m),r=ea?N:"fixed";return d&&k.VH(),p&&!k.GF&&(e=a.a5(m),k.WH||(k.WH={overflow:W,border:X,position:N}),k.WH.overflow=e.style.overflow,k.WH.border=e.style.border,k.WH.position=e.style.position,h.GC$(e).css(M,r).css(P,V).css(Q,"0px").css(R,"0px").css(S,"0px").css(T,"0px").css(O,X),l.KF&&e.firstChild&&(f=e.firstChild.firstChild,l.KF(a,f,b,c,l.getActualStyle(b,c)),g=a.getEditorValue(f,m),n.safari&&(""===g||t(g))&&a.setEditorValue(f," ",m)),o&&o.insertBefore(e,C),k.GF=e),k.XH||(e=q("div"),h.GC$(e).css(M,r).css(P,V).css(Q,"0px").css(R,"0px").css(S,"0px").css(T,"0px"),k.XH=e,i=q("textarea"),h.GC$(i).attr(Z,"gcSheetFocusInput").attr(Y,-1).css(M,N).css(P,V).css(O,X).css(U,X),i.value=" ",e.insertBefore(i,C),k.YH=i,j=q("div"),h.GC$(j).css(M,N).css(P,V).attr(Z,"gcSheetFocusInput").attr(Y,-1),e.insertBefore(j,C),k.ZH=j,o&&o.insertBefore(e,C)),ea&&(k.GF&&k.$H(l,k.GF),k.$H(l,k.XH)),p?k.GF:k.YH},a.prototype.JF=function(){var a=this;a.GF&&a.WH&&h.GC$(a.GF).css(P,a.WH.overflow).css(O,a.WH.border).css(M,a.WH.position)},a.prototype.VH=function(){var a=this;a.GF&&(a.GF.parentElement&&a.GF.parentElement.removeChild(a.GF),a.GF.comboBox&&(a.GF.comboBox=C),
a.GF=C)},a.prototype.zt=function(a){i.Vl.Wl(this.kj)||this._H(!0,!0,a)},a.prototype.Cm=function(){var a=this.ZH;a&&a.focus()},a.prototype.Qq=function(){this._H(!0,!0)},a.prototype.aI=function(){this.bI&&(clearTimeout(this.bI),this.bI=C)},a.prototype._H=function(a,b,c){var d,e,f,g,h,j,m,p,q,r,s;0===arguments.length&&(a=!0),d=this,d.Gma||(d.XF=!1,d.aI(),e=d.kj,f=va(e),g=wa(e),h=e.getCellType(f,g),d.UH(h,f,g,b),j={sheet:e,row:f,col:g,sheetArea:3},m=h.isImeAware(j)&&d.GF.firstChild?d.GF.firstChild.firstChild:d.YH,p=m,b&&!n.msie&&h.setImeMode(p,e.getActualStyle(f,g).imeMode,j),l.body.focus(),q=function(){var a=function(){try{h.isImeAware(j)?(h.focus(p,j),h.selectAll(p,j)):(m.focus(),m.select())}catch(a){}};b&&n.msie&&h.setImeMode(p,e.getActualStyle(f,g).imeMode,j),a()},r=o,!e.CH&&!r.ipad||!a&&h.isImeAware(j)?e._enhanceIme===!1||c||q():!ma(e)&&(n.metroMode||r.ipad||r.iphone||r.android)?b&&(s=d.GF&&d.GF.firstChild&&d.GF.firstChild.firstChild,h.setImeMode(s,e.getActualStyle(f,g).imeMode,j)):d.bI=k.setTimeout(function(){d.aI(),ma(e)||e._enhanceIme===!1||c||q()},200),i.Vl.Wl(e)||i.Vl.Zl(e),d.byb(e)||d.cs&&d.cs(e.Jl,e.Kl))},a.prototype.$H=function(a,b){var c,d,e,f,g,i,j,l=va(a),m=wa(a),n=a.Nr,o=a.Pr,p=a.getCellRect(l,m,n,o),q=this,r=a.Vs(),s=q.bG(),t=q.GF,u=0,v=0,w=0,x=0;t&&(e=h.GC$(t),u=parseInt(e.css(Q),10),v=parseInt(e.css(R),10),w=parseInt(e.css(T),10),x=parseInt(e.css(S),10)),q.oG(p)?(c=u,d=v):(c=p.y+s.top-2,d=p.x+s.left-2),f=k.pageYOffset-r.top+s.top,g=k.innerHeight+f-w,i=k.pageXOffset-r.left+s.left,j=k.innerWidth+i-x,(E(c)||c<f||c>g)&&(c=f),(E(d)||d<i||d>j)&&(d=i),h.GC$(b).css(Q,c).css(R,d)},a.prototype.cI=function(a){var b,c,d,e,f=this;f.aI(),ma(f.kj)||f.XF&&l.activeElement===f.ZH||(b=f.kj,a?(c=a.row,d=a.col):(c=b.Jl,d=b.Kl),e=b.getCellType(c,d),f.UH(e,c,d,!1),f.ZH.focus(),f.XF=!0)},a.prototype.dI=function(a,b){var c=this;c.XF&&(c.XF=!1,!b&&c._H(a))},a.prototype.gx=function(a){var b=this.kj,c=b.tu();c&&(c.ska(a),c.M4(),this.Gma=!0,a&&c.N4())},a.prototype.hx=function(){var a=this,b=a.kj.tu();b&&b.ska(""),a.Gma=!1,a._H(!0,!1)},a.prototype.MF=function(){var a,b=this;b.aI(),a=b.GF,a&&(h.GC$(a).remove(),b.GF=D),a=b.XH,a&&(h.GC$(a).remove(),b.YH=D,b.XH=C,b.ZH=C)},a.prototype.uw=function(a,b,c,d){var e=this.kj.parent;e&&e.uw(a,b,c,d)},a.prototype.ww=function(a,b,c,d){var e=this.kj.parent;e&&e.ww(a,b,c,d)},a.prototype.xw=function(){var a=this.kj.parent;a&&a.xw()},a.prototype.Uw=function(a){var b,c,d,e,f,g,h,i,k;function l(a,b){var c=!1;return a||b?a&&b&&(c=a.action===b.action&&a.index===b.index&&a.sheetArea===b.sheetArea):c=!0,c}b=this,c=b.kj,d=c.hCb,e=c.iCb,f=c.yt,g=!1,f||(g=!0),g||a||(g=!0),g||(g=a.col!==f.col||a.row!==f.row||ta(a)!==ta(f)||sa(a)!==sa(f)||ua(a)!==ua(f)||!l(a.resizeInfo,f.resizeInfo)),c.yt=a,g&&(f&&!t(f.hitTestType)&&(c.ITa.setCellState(d,e,j.CellStatesType.hover,!1,f.hitTestType),c.MHb&&c.MHb(j.CellStatesType.hover,d,e,f.hitTestType,f.rowViewportIndex,f.colViewportIndex)),a&&!t(a.hitTestType)&&(c.hCb=a.row,c.iCb=a.col,a.resizeInfo||(c.ITa.setCellState(a.row,a.col,j.CellStatesType.hover,!0,a.hitTestType),c.MHb&&c.MHb(j.CellStatesType.hover,a.row,a.col,a.hitTestType,a.rowViewportIndex,a.colViewportIndex))),c.fI=!0,h=c.yl,i=la(c,f,h),k=la(c,a,h),i=i||k,c.fI=!1,i&&h.im())},a.prototype._G=function(a,b,c){var d=this.gI(a,b,c);return this.hI(d)},a.prototype.gI=function(a,b,c){var d=this.kj.ITa.getSpan(a,b),e=Da(d),f=Ca(d);return 1===e&&1===f?d:c&&1===e||!c&&1===f?d:(c?b++:a++,this.gI(a,b,c))},a.prototype.hI=function(a){var b,c,d,e=this.kj,f=a.row,g=qa(e);for(b=f;b<g&&e.getRowVisible(b)!==!0;b++);for(b<g&&(f=b),c=a.col,d=ra(e),b=c;b<d&&e.getColumnVisible(b)!==!0;b++);return b<d&&(c=b),s(f,c,Da(a),Ca(a))},a.prototype.byb=function(a){var b,c,d=a.floatingObjects&&a.floatingObjects.all(),e=a.shapes&&a.shapes.all();if(!t(d))for(b=0;b<d.length;b++)if(d[b].isSelected())return!0;if(!t(e))for(c=0;c<e.length;c++)if(e[c].isSelected())return!0},a}(),b.iI=ja,e.Worksheet.$n("eventHandler",{beforeSetHost:function(){var a=this;a.mm=new ja(a)},dispose:function(a){var b,c,d,e=this;h.GC$(e.Ws()).unbind(v).unbind(w).unbind(x).unbind(y).unbind(z).unbind(A).unbind(B),b=e.mm,b&&(b.no(),b.MF()),c=e.BF,c&&h.GC$(c).remove(),d=e.NF,d&&d.close(),a.clearCache!==!1&&(e.OF=C,e.PF=C,e.QF=C,e.RF=C,e.SF=C,e.TF=C,e.mm=C)},setHost:function(a){function b(a,b){var d=c.Vs(),e=b.pageX-d.left,f=b.pageY-d.top,g=c.hitTest(e,f),h=g.dragInfo;g.tableSelectInfo||(h&&a.cyb&&"corner"===h.side?a.cyb():a.UF(b,e,f))}if(a){var c=this,d=c.mm;c.OF=function(a){var b={e:a,r:C};if(e.Worksheet.ao(c,"preProcessMouseDown",b),!b.r)return d.AD(a)},c.PF=function(a){var b={e:a,r:C};e.Worksheet.ao(c,"preProcessMouseMove",b),b.r||d.RB||d.BD(a)},c.QF=function(a){var b={e:a,r:C};if(e.Worksheet.ao(c,"preProcessMouseUp",b),!b.r&&!c.XD){if(d.RB)return;return d.CD(a)}},c.RF=function(a){var b,d,f,g,h,i,j,l,m;if(a=a||k.event,b={e:a,r:C},e.Worksheet.ao(c,"preProcessMouseWheel",b),!b.r)return d=a.detail?a.detail:a.wheelDelta/-40,f=0,g=(new Date).valueOf(),h=a.wheelDeltaY,i=a.wheelDeltaX,J(h)>=J(i)?i=0:h=0,j=!c.nka||g-c.nka>200,(n.safari||n.chrome)&&(l=n.safari?-4:-40,t(h)||(j?(d=h/l,d=(d>=0?1:-1)*H(J(d)),c.oka=0):(d=h/l,c.oka+=d,d=(d>=0?1:-1)*H(J(c.oka)),c.oka-=d)),t(i)||(j?(f=i/l,f=(f>=0?1:-1)*H(J(f)),c.pka=0):(f=i/l,c.pka+=f,f=(f>=0?1:-1)*H(J(c.pka)),c.pka-=f))),c.nka=g,(0!==d||0!==f)&&(m=c.parent.ku.Rw(a,F(d,10)||0,F(f,10)||0),!!m&&void 0)},c.SF=function(a){var b={e:a,r:C};if(e.Worksheet.ao(c,"preProcessMouseOut",b),!b.r)return d.DD(a)},c.TF=function(a){var f,g,h={e:a,r:C};e.Worksheet.ao(c,"preProcessMouseDbClick",h);function j(a,b){var c,d,e=a.kj,f=b.resizeInfo;return!!f&&(f.action===aa||f.action===_?(c=[],e.tp(f.index)?m(e.ITa.getSelections(),function(a,b){var d,f;if(b.col===-1)for(d=e.Tq(b),f=0;f<Da(d);f++)c.push({row:d.row+f})}):c.push({row:f.index}),e.wu().execute({cmd:"autoFitRow",sheetName:e.name(),rows:c,columnHeader:1===f.sheetArea})):(d=[],e.sp(f.index)?m(e.ITa.getSelections(),function(a,b){var c,f;if(b.row===-1)for(c=e.Tq(b),f=0;f<Ca(c);f++)d.push({col:c.col+f})}):d.push({col:f.index}),e.wu().execute({cmd:"autoFitColumn",sheetName:e.name(),columns:d,rowHeader:2===f.sheetArea})),!0)}h.r||(f=c.yt,f&&(g=!1,3===ua(f)?b(d,a):g=j(d,f),g||c.Wq(i.Events.CellDoubleClick,Fa(c,c.name(),f.row,f.col,ua(f)))))},a.bind(v,function(a){return c.OF(a)}).bind(w,function(a){return c.QF(a)}).bind(x,function(a){return c.PF(a)}).bind(y,function(a){return c.RF(a)}).bind(z,function(a){return c.RF(a)}).bind(A,function(a){return c.SF(a)}).bind(B,function(a){return c.TF(a)})}}})},"./dist/core/worksheet/worksheet-formatter.js":function(a,b,c){"use strict";var d,e,f,g,h;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/util/domUtil.js"),e=c("./dist/core/worksheet/worksheet.js"),f=c("./dist/core/worksheet/style.js"),g=c("./dist/core/util/common.js"),h=c("Common"),d.GC$.extend(e.Worksheet.prototype,{getFormatter:function(a,b,c){return this.tq(a,b,"formatter",c)},setFormatter:function(a,b,c,d){var e=this.Iq(a,b,d);e||(e=new f.Style),e.formatter=c,this.setStyle(a,b,e,d)}}),e.Worksheet.$n("formatter",{settingText:function(a){var b,c=g.util.tl(a.value),d=h.Formatter&&h.Formatter.GeneralFormatter;d&&c&&(b={},(new d).getPreferredDisplayFormatter(a.value,b),"number"==typeof b.value&&(a.value=b.value))}})},"./dist/core/worksheet/worksheet-json.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/worksheet/worksheet.js"),f=c("./dist/core/worksheet/style.js"),g=f.Style.kxb,h=c("./dist/core/util/common.js"),i=c("./dist/core/util/theme.js"),j=c("./dist/core/util/domUtil.js"),k=c("./dist/core/worksheet/stylehelper.js"),l=d.Common.CultureManager,m=e.Worksheet._n,n=h.util.Ol,o=j.GC$.each,p=j.GC$.isEmptyObject,q=d.Common.D,r=d.Common.j.Fa,s="string",t=parseInt,u=isNaN,v=void 0;function w(a,b,c){var d,f,g,h=a.ITa,i=h.XTa(),j=h.XTa(1),k=h.YTa(!0),l=h.YTa(!0,1),m=h.zl(),n=h.zl(1),o=i.getColumnCount();for(d=0;d<b;d++)for(i.setNode(d,-1,j.RTa(d,-1)),k.Kp(d,l.Jp(d)),f=c;f<o;f++)g=j.RTa(d,f),g||(g={}),g.style=a.Dq(d,f,1),i.setNode(d,f,g);n.getSpans().forEach(function(a){m.add(a)}),a.frozenRowCount(b),h.dWa(e.Worksheet.Vp,o,1),h.fWa(!1,1),h.eWa(1)}function x(a,b,c){var d,f,g,h=a.ITa,i=h.XTa(),j=h.XTa(2),k=h.YTa(!1),l=h.YTa(!1,2),m=h.zl(),n=h.zl(2),o=i.getRowCount();for(d=0;d<b;d++)for(i.setNode(-1,d,j.RTa(-1,d)),k.Kp(d,l.Jp(d)),f=c;f<o;f++)g=j.RTa(f,d),g||(g={}),g.style=a.Dq(f,d,2),i.setNode(f,d,g);n.getSpans().forEach(function(a){m.add(a)}),a.frozenColumnCount(b),h.dWa(o,e.Worksheet.Tp,2),h.fWa(!1,2),h.eWa(2)}function y(a,b,c){var d,e,f,g=a.ITa,i=g.XTa(),j=g.XTa(1),k=g.YTa(!1),l=g.YTa(!1,1),m=g.zl(),n=g.zl(1),o=i.getColumnCount();for(j.setRowCount(b),d=0;d<b;d++)for(j.setNode(d,-1,i.RTa(d,-1)),l.Kp(d,k.Jp(d)),e=c;e<o;e++)j.setNode(d,e,i.RTa(d,e));f=m.getSpans(h.kf(0,0,b,o)),f.forEach(function(a){n.add(a)}),a.frozenRowCount(0)}function z(a,b,c){var d,e,f,g=a.ITa,i=g.XTa(),j=g.XTa(2),k=g.YTa(!1),l=g.YTa(!1,2),m=g.zl(),n=g.zl(2),o=i.getRowCount();for(j.setColumnCount(b),d=0;d<b;d++)for(j.setNode(-1,d,i.RTa(-1,d)),l.Kp(d,k.Jp(d)),e=c;e<o;e++)j.setNode(e,d,i.RTa(e,d));f=m.getSpans(h.kf(0,0,o,b)),f.forEach(function(a){n.add(a)}),a.frozenColumnCount(0)}function A(a,b){switch(a){case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":case"activeRow":case"activeCol":return 0===b;case"rowCount":return 200===b;case"columnCount":return 20===b;case"zoomFactor":case"rowHeaderColCount":case"colHeaderRowCount":return 1===b;case"visible":return b===!0}return!1}function B(a,b){return n(a)?a:b}function C(a,b,c){n(c)&&b.call(a,c,!1)}function D(a,b){var c,d,e,f,g,h,i,j,k,l=a.ITa.zHb.anchors;for(c in l)if(d=+c,e=l[c],f=b[d],e&&f)for(g in e)h=+g,i=e[g],i&&(j=f[h],j&&(k={row:i.row,rowCount:i.rowCount,col:i.col,colCount:i.colCount,isDynamicArray:!0},i.isValid||(k.isInvalid=!0),j.arrayInfo=k))}j.GC$.extend(e.Worksheet.prototype,{qI:function(a,b,c,d){var e,f;a[b]||(a[b]={}),e=a[b],e[c]||(e[c]={}),f=e[c],f.value=d},toJSON:function(a){var b,c,d,f,g,i,j,l,n,s,t,u,v,y,z,B,C,E=this,F=E.getRowCount(1),G=E.getColumnCount(2),H=a&&a.rowHeadersAsFrozenColumns,I=a&&a.columnHeadersAsFrozenRows,J=a&&a.ignoreStyle,K=H&&G>0,L=I&&F>0;K&&E.addColumns(0,G),L&&E.addRows(0,F,L),K&&x(E,G,L?F:0),L&&w(E,F,K?G:0),b=E.getRowCount(),c=E.getColumnCount(),d=E.getRowCount(1),f=E.getColumnCount(2),g={name:E.name(),rowCount:b,columnCount:c,activeRow:E.Jl,activeCol:E.Kl,zoomFactor:E.zoom(),rowHeaderColCount:f,colHeaderRowCount:d,visible:E.visible()},J||(g.frozenRowCount=E.frozenRowCount(),g.frozenColCount=E.frozenColumnCount(),g.frozenTrailingRowCount=E.frozenTrailingRowCount(),g.frozenTrailingColCount=E.frozenTrailingColumnCount(),g.theme=E.Pm.toJSON()),i=E.ITa,j=i.toJSON(a);for(l in j)g[l]=j[l];m&&o(m,function(b,c){c.toJson&&c.toJson.call(E,g,a)}),n={};for(s in g)q(g,s)&&(t=g[s],r(t)||A(s,t)||(n[s]=t));if(D(E,g.data.dataTable),o(E.options,function(a,b){var c,d,f,g=b;"gridline"===a&&(g={},c=b.color,d=b.showHorizontalGridline,f=b.showVerticalGridline,c&&c!==h.Im.Lm("gc-gridlineColor").borderTopColor&&(g.color=c),d===!1&&(g.showHorizontalGridline=d),f===!1&&(g.showVerticalGridline=f)),"sheetAreaOffset"===a&&(g={},b.left&&(g.left=b.left),b.top&&(g.top=b.top)),"_ps"===a||r(g)||e.Worksheet.Qp[a]===g||"object"==typeof g&&p(g)||(n[a]=g)}),u=[],v=E.Lq,v){for(y in v)q(v,y)&&(z=v[y],z&&(B=z.toJSON(),C=z.font,p(B)||(C&&(B.font=k.To.Jo(C)),u.push(B))));u.length>0&&(n.namedStyles=u)}return n},fromJSON:function(a,b,c,d,h){var j,k,p,r,w,x,A,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da;if(c&&(j=c.noSchema,k=c.version),a){p=this,r=d&&d.ignoreStyle,p.T3(),e.Worksheet.ao(p,"preFromJson"),p.suspendPaint(),w=l.culture(),l.culture(""),x=B(a.rowCount,e.Worksheet.Rp),A=B(a.columnCount,e.Worksheet.Sp);try{if(p.cq(a.name+"",!0),p.setRowCount(x),p.setColumnCount(A),p.Lq={},D=a.namedStyles)for(E=0;E<D.length;E++)F=D[E],G=new f.Style,g(F,p),G.fromJSON(F,j,p),p.Kq(G);H=p.options;for(I in H)if(q(H,I)&&(J=a[I],"protectionOptions"===I?J=J||a.protectionOption:"allowCellOverflow"===I&&(J=n(a[I])?a[I]:!k||k>=11),n(J)))if("object"==typeof J)for(K in J)q(J,K)&&(H[I][K]=J[K]);else"borderWidth"===I?(H.sheetAreaOffset.left=J,H.sheetAreaOffset.top=J):H[I]=J;if(L=B(a.activeRow,p.Jl),M=B(a.activeCol,p.Kl),p.Kr(L,M,v,v,!0),r||(C(p,p.frozenRowCount,a.frozenRowCount),C(p,p.frozenColumnCount,a.frozenColCount),C(p,p.frozenTrailingRowCount,a.frozenTrailingRowCount),C(p,p.frozenTrailingColumnCount,a.frozenTrailingColCount)),!r){if(N=a.colStyles)for(O in N)u(O)||p.setStyle(-1,t(O,10),N[O],3);if(P=a.rowStyles)for(Q in P)u(Q)||p.setStyle(t(Q,10),-1,P[Q],3)}R=B(a.rowHeaderColCount,e.Worksheet.Tp),S=B(a.colHeaderRowCount,e.Worksheet.Vp),p.setColumnCount(R,2),p.setRowCount(S,1),p.XSa(B(a._zoomFactor||a.zoomFactor,p.zoom())),C(p,p.visible,a.visible),T=p.uja,U={sheet:p,setValidator:function(a,b,c){T&&T.vja(a,b,c)},ignoreStyle:r},V=p.ITa,V.fromJSON(a,j,U),p.defaults=V.defaults,T&&T.QV(!0),W=a.theme,W&&!r&&(X=W,typeof X!==s&&n(X)&&(Y="_themeColor",Z="_name",$=X.themeColor||X[Y],_=new i.ColorScheme($.name||$[Z]),_.fromJSON($,j),X=new i.Theme(X.name||X.Cj,_,X.headingFont||X.Vaa,X.bodyFont||X.Waa)),p.currentTheme(X)),m&&o(m,function(c,e){var f=e.fromJson;f&&f.call(p,a,j,d,!n(b)||b)}),aa=d&&d.frozenColumnsAsRowHeaders,ba=d&&d.frozenRowsAsColumnHeaders,ca=ba?a.frozenRowCount||0:0,da=aa?a.frozenColCount||0:0,ba&&ca>0&&y(p,ca,da),aa&&da>0&&z(p,da,ca),h||(ca>0&&p.deleteRows(0,ca),da>0&&p.deleteColumns(0,da)),p.clearPendingChanges()}finally{l.culture(w),p.resumePaint()}}}})},"./dist/core/worksheet/worksheet-model.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),$=this&&this.__rest||function(a,b){var c,d,e={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.indexOf(c)<0&&(e[c]=a[c]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(d=0,c=Object.getOwnPropertySymbols(a);d<c.length;d++)b.indexOf(c[d])<0&&(e[c[d]]=a[c[d]]);return e};Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("./dist/core/worksheet/style.js"),f=c("Common"),g=c("CalcEngine"),h=c("./dist/core/util/common.js"),i=c("./dist/core/util/common.js"),j=c("./dist/core/util/domUtil.js"),k=c("./dist/core/core.enum.js"),l=c("CalcEngine"),m=c("./dist/core/celltype/celltype.ns.js"),n=!!l,o=j.GC$.each,p=j.GC$.isEmptyObject,q=j.GC$.extend,r=RegExp("^\\d*(\\.\\d+)?\\*$"),s=null,t=void 0,u="string",v=Math.min,w=Math.floor,x=Math.max,y=Math.ceil,z="dirtyNodes",A=f.Common.A,B=f.Common.B,C=f.Common.j.Fa,D=h.util.K_a,E=h.util.n0a,F=f.Common.j.C4,G=new f.Common.ResourceManager(d.SR),H=G.getResource.bind(G);function _(a,b){return a.hasOwnProperty(b)}function aa(a){return a.rowCount}function ba(a){return a.colCount}function ca(a,b,c,d){var e=c;Object.defineProperty(a,b,{get:function(){return e},set:function(a){var c=e;e=a,d(this,a,b,c)}})}function da(a,b){a.cache={},b&&b.forEach(function(b){ea(a,b)})}function ea(a,b){var c,d;if(a.Ef=x(a.Ef,b.row+aa(b)-1),a.Ff=x(a.Ff,b.col+ba(b)-1),!a.suspendUpdatingCache)for(c=0;c<b.rowCount;c++)for(d=0;d<b.colCount;d++)a.cache[b.row+c+"_"+(b.col+d)]=b}function fa(a,b){var c,d;if(!a.suspendUpdatingCache)for(c=0;c<b.rowCount;c++)for(d=0;d<b.colCount;d++)a.cache[b.row+c+"_"+(b.col+d)]=t}I=function(){function a(){ca(this,"spans",[],da),this.Ff=-1,this.Ef=-1,this.cache={},this.suspendUpdatingCache=!1}return a.prototype.find=function(a,b){return this.cache[a+"_"+b]||s},a.prototype.get=function(a,b){return this.find(a,b)||h.kf(a,b,1,1)},a.prototype.remove=function(a,b){var c=this.spans.indexOf(a);c>=0?(b&&(b[0].push("spans"),b[1]=[].concat(this.spans)),this.removeSpan(c,1)):b&&(b.length=0)},a.prototype.removeSpan=function(a,b){for(var c=0;c<b;c++)fa(this,this.spans[a+c]);this.spans.splice(a,b)},a.prototype.update=function(a,b){var c=this;fa(c,c.spans[a]),c.spans[a]=b,ea(c,b)},a.prototype.add=function(a,b){b&&(b[0].push("spans"),b[1]=[].concat(this.spans)),ea(this,a),this.spans.push(a)},a.prototype.Zz=function(a,b,c,d,e,f,g){var i,j,k,l,m,n,o,p=this,q=!1;for(g&&(i=[].concat(p.spans)),j=p.spans.length,o=[],n=0;n<j;n++)k=p.spans[n],m=k.col,l=k.row,(a===-1||a<=l&&l<a+e)&&(b===-1||b<=m&&m<b+f)?(o.push(h.kf(a===-1?l:c+l-a,b===-1?m:d+m-b,aa(k),ba(k))),q=!0):(a===-1||c<=l&&l<c+e)&&(b===-1||d<=m&&m<d+f)&&(p.removeSpan(n,1),n--,j--,q=!0);for(n=0;n<o.length;n++){if(k=o[n],!p.LTa(p.spans,0,p.spans.length,k))throw Error(H().Exp_OverlappingSpans);p.add(k)}g&&(q?(g[0].push("spans"),g[1]=i):g.length=0)},a.prototype.LTa=function(a,b,c,d){for(var e=b;e<c&&e<a.length;e++)if(a[e].intersect(d.row,d.col,aa(d),ba(d)))return!1;return!0},a.prototype.getSpans=function(a){var b,c,d,e=this.spans;if(!a)return[].concat(e);for(b=[],c=0;c<e.length;c++)d=e[c],d.intersect(a.row,a.col,aa(a),ba(a))&&b.push(d);return b},a.prototype.qu=function(a,b,c,d){var e,f,g=this.spans;for(e=0;e<g.length;e++)if(f=g[e],f.intersect(a,b,c,d)&&(a!==-1&&(f.row<a||f.row+aa(f)>a+c)||b!==-1&&(f.col<b||f.col+ba(f)>b+d)))return!0;return!1},a.prototype.MTa=function(a,b,c,d){var e,f,g=!1,h=this.spans;for(e=0,f=h.length;e<f;e++){if(a>=0||b>=0)for(;e<f&&!h[e].intersect(a,b,c,d);)e++;if(e<f){g=!0;break}}return g},a.prototype.$b=function(a,b,c,d,e){var f,g,h,i,j,k=this.spans,l=!1;for(e&&(f=[].concat(k)),g=0;g<k.length;g++)h=k[g],i=h.row,j=h.col,(a===-1||a<=i&&i<a+c)&&(b===-1||b<=j&&j<b+d)&&(this.removeSpan(g,1),g--,l=!0);e&&(l?(e[0].push("spans"),e[1]=f):e.length=0)},a.prototype.aB=function(a,b,c,d,e,f,g){var i,j,k,l,m,n,o,p,q,r=this,s=!1;for(g&&(i=[].concat(r.spans)),j=[],k=[],l=r.spans.length,p=0;p<l;p++)m=r.spans[p],n=m.row,o=m.col,(a===-1||a<=n&&n<a+e)&&(b===-1||b<=o&&o<b+f)?(q=h.kf(a===-1?n:c+n-a,b===-1?o:d+o-b,aa(m),ba(m)),k.push(q),s=!0):(a===-1||c<=n&&n<c+e)&&(b===-1||d<=o&&o<d+f)?s=!0:j.push(m);if(s){if(k.length>0)for(p=0;p<k.length;p++){if(q=k[p],!r.LTa(j,0,j.length,q))throw Error(H().Exp_OverlappingSpans);j.push(q)}for(r.spans.length=0,r.cache={},p=0;p<j.length;p++)r.add(j[p]);g&&(g[0].push("spans"),g[1]=i)}else g&&(g.length=0)},a.prototype.NTa=function(a,b,c){var d,e,f,g,i,j,k,l,m,n=this,o=n.spans;for(n.suspendUpdatingCache=!0,d=!1,c&&(e=[].concat(o)),f=o.length,g=0;g<f;g++)i=o[g],j=i.row,k=i.col,l=aa(i),m=ba(i),j>=a?(n.update(g,h.kf(j+b,k,l,m)),d=!0):a<j+l&&(n.update(g,h.kf(j,k,l+b,m)),d=!0);n.suspendUpdatingCache=!1,d&&da(n,o),c&&(d?(c[0].push("spans"),c[1]=e):c.length=0)},a.prototype.OTa=function(a,b,c){var d,e,f,g,i,j,k,l,m,n=this,o=n.spans;for(n.suspendUpdatingCache=!0,d=!1,c&&(e=[].concat(o)),f=o.length,g=0;g<f;g++)i=o[g],j=i.row,k=i.col,l=aa(i),m=ba(i),k>=a?(n.update(g,h.kf(j,k+b,l,m)),d=!0):a<k+m&&(n.update(g,h.kf(j,k,l,m+b)),d=!0);n.suspendUpdatingCache=!1,d&&da(n,o),c&&(d?(c[0].push("spans"),c[1]=e):c.length=0)},a.prototype.PTa=function(a,b,c){var d,e,f,g,i,j,k,l,m,n,o,p,q=this,r=q.spans;for(q.suspendUpdatingCache=!0,d=!1,c&&(e=[].concat(r)),f=[],g=r.length,i=0;i<g;i++)j=r[i],k=j.row,l=j.col,m=aa(j),n=ba(j),k>=a?k<a+b?(f.push(i),d=!0):(q.update(i,h.kf(k-b,l,m,n)),d=!0):a<k+m&&(o=h.kf(k,l,m-v(k+m-a,b),n),q.update(i,o),1===o.rowCount&&1===o.colCount&&f.push(i),d=!0);for(i=f.length-1;i>=0;i--)p=f[i],q.removeSpan(p,1);q.suspendUpdatingCache=!1,d&&da(q,r),c&&(d?(c[0].push("spans"),c[1]=e):c.length=0)},a.prototype.QTa=function(a,b,c){var d,e,f,g,i,j,k,l,m,n,o,p,q=this,r=q.spans;for(q.suspendUpdatingCache=!0,d=!1,c&&(e=[].concat(r)),f=[],g=r.length,i=0;i<g;i++)j=r[i],k=j.row,l=j.col,m=aa(j),n=ba(j),l>=a?l<a+b?(f.push(i),d=!0):(q.update(i,h.kf(k,l-b,m,n)),d=!0):a<l+n&&(o=h.kf(k,l,m,n-v(l+n-a,b)),q.update(i,o),1===o.rowCount&&1===o.colCount&&f.push(i),d=!0);for(i=f.length-1;i>=0;i--)p=f[i],q.removeSpan(p,1);q.suspendUpdatingCache=!1,d&&da(q,r),c&&(d?(c[0].push("spans"),c[1]=e):c.length=0)},a.prototype.toJSON=function(){var a=[].concat(this.spans);return 0===a.length?t:a},a.prototype.fromJSON=function(a){var b,c,d;if(a)for(this.spans=[],b=a,c=0;c<b.length;c++)d=b[c],this.add(h.kf(d.row,d.col,aa(d),ba(d)))},a}(),J=function(){function a(){Array.apply(this,arguments)}return a.prototype.pop=function(){return s},a.prototype.push=function(a){return 0},a.prototype.splice=function(a,b){var c,d=[];for(c=2;c<arguments.length;c++)d[c-2]=arguments[c];return s},a.prototype.slice=function(a,b){return null},a}(),J.prototype=[],K=function(a){Z(b,a);function b(){var b=a.call(this)||this;return b.headingOverflowlayouts=s,b.trailingOverflowLayouts=s,b}return b.prototype.find=function(a){var b,c,d=this,e=d.length,f=[];for(c=0;c<e;c++)b=d[c],b.contains(a)&&f.push(b);return f},b}(J),b.np=K,L=function(){function a(a,b,c,d,e,f,g,h){var i=this;i.column=a,i.startColumn=b,i.endColumn=c,i.valueWidth=d,i.columnWidth=e,i.backgroundWidth=f,i.backgroundLeftWidth=g,i.backgroundRightWidth=h}return a.prototype.contains=function(a){return a>=this.startColumn&&a<=this.endColumn},a}(),b.op=L;function ga(a,b,c){var d,e,f,g,i=h.kf(-1,-1,-1,-1);return a&&(d=a.col,e=a.row,f=e===-1,g=d===-1,i.row=f?0:e,i.rowCount=f?b:aa(a),i.col=g?0:d,i.colCount=g?c:ba(a)),i}M=function(){function a(){this.selections=[],this.selectionPolicy=2,this.selectionUnit=0}return a.prototype.getProperty=function(a){return this[a]},a.prototype.setProperty=function(a,b,c){c&&(c[0].push(a),c[1]=this[a]),this[a]=b},a.prototype.clear=function(a){a&&(a.push(["selections",this.get()]),a.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=[],this.activeSelectedRangeIndex=-1},a.prototype.add=function(a,b,c,d,e){e&&(e.push(["selections",this.get()]),e.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex]));var f=this,g=f.selectionPolicy,i=f.selectionUnit;0===g?(c=v(c,1),d=v(d,1),f.clear()):1===g&&f.clear(),1===i?(b=-1,d=-1):2===i&&(a=-1,c=-1),f.selections.push(h.kf(a,b,c,d)),f.activeSelectedRangeIndex=f.selections.length-1},a.prototype.get=function(){return[].concat(this.selections)},a.prototype.set=function(a,b){b&&(b.push(["selections",this.get()]),b.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=a,this.activeSelectedRangeIndex>=a.length&&(this.activeSelectedRangeIndex=0)},a.prototype.toJSON=function(){var a,b=this,c={},d=b.selectionPolicy,e=b.selectionUnit,f=b.activeSelectedRangeIndex,g=b.selections.length;for(2!==d&&(c.selectionPolicy=d),0!==e&&(c.selectionUnit=e),0!==f&&(c.activeSelectedRangeIndex=f),c.length=g,a=0;a<g;a++)c[a]=b.selections[a];return p(c)?t:c},a.prototype.fromJSON=function(a){var b,c,d,e,f,g;if(a){for(b=this,b.clear(),c=a.selectionPolicy,d=a.selectionUnit,e=a.length,C(e)&&(e=1),f=0;f<e;f++)g=a[f],b.selections.push(h.kf(g?g.row:0,g?g.col:0,g?aa(g):1,g?ba(g):1));b.activeSelectedRangeIndex=a.activeSelectedRangeIndex||0,C(c)||(b.selectionPolicy=c),C(d)||(b.selectionUnit=d)}},a.prototype.sp=function(a){var b,c,d,e=this.selections;for(b=0;b<e.length;b++)if(c=e[b],d=c.col===-1?0:c.col,c.row===-1&&a>=d&&a<d+ba(c))return!0;return!1},a.prototype.tp=function(a){var b,c,d,e=this.selections;for(b=0;b<e.length;b++)if(c=e[b],d=c.row===-1?0:c.row,c.col===-1&&a>=d&&a<d+aa(c))return!0;return!1},a.prototype.vp=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o=!1,p=this.selections,q=f?1:0;for(g=0,h=p.length;g<h&&(i=p[g],j=ga(i,d,e),k=j.row,l=j.col,m=k-q<=a&&a<k+aa(j)+q,n=l-q<=b&&b<l+ba(j)+q,3===c||C(c)?o=m&&n:2===c?o=m:1===c?o=n:0===c&&(o=i.row===-1&&i.col===-1),!o);g++);return o},a.prototype.wp=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p=this.selections,q=!1;for(f=0;f<p.length&&(g=p[f],h=g.row,i=g.col,j=aa(g),k=ba(g),l=i===-1,m=h===-1,C(c)||3===c||(2===c?(n=m?0:h,q=l&&a>=n&&a<n+j):1===c?(o=l?0:i,q=m&&b>=o&&b<o+k):0===c&&(q=m&&l&&j===d&&k===e),!q));f++);return q},a}();function ha(a,b,c,d,e){var f,g,h=a.length,i=!1;for(g=0;g<h;g++)if(f=a[g],i=C(b)||C(c)?C(b)?C(c)?C(d)?f.containsY(e):f.containsX(d):f.col===c:f.row===b:f.contains(b,c))return f;return s}function ia(a,b,c){var d=s,e=a.length,f=!C(b);return e>0&&(d=f?a.findX(b):a.findY(c),d||(d=f&&b<a[0].x||!f&&c<a[0].y?a[0]:a[e-1])),d}N=function(a){Z(b,a);function b(){return a.call(this)||this}return b.prototype.findCell=function(a,b){var c,d,e=this.length;for(d=0;d<e;d++)if(c=this[d],c.contains(a,b))return c;return s},b.prototype.findRow=function(a){var b,c,d=this.length;for(c=0;c<d;c++)if(b=this[c],b.row===a)return b;return s},b.prototype.findCol=function(a){var b,c,d=this.length;for(c=0;c<d;c++)if(b=this[c],b.col===a)return b;return s},b.prototype.findX=function(a){return ha(this,t,t,a)},b.prototype.findY=function(a){return ha(this,t,t,t,a)},b.prototype.findNearX=function(a){return ia(this,a)},b.prototype.findNearY=function(a){return ia(this,t,a)},b}(J),b.yp=N,O=function(){function a(a,b,c,d,e,f,g,h,i){var j=this;j.rowCount=g,j.colCount=h,j.row=a,j.col=b,j.x=c,j.y=d,j.width=e,j.height=f,j.isAutoMerge=i}return a.prototype.contains=function(a,b){var c=this;return a<c.row+aa(c)&&c.row<=a&&b<c.col+ba(c)&&c.col<=b},a.prototype.intersect=function(a){var b=this;return(b.x<0||a.x<b.x+b.width&&b.x<a.x+a.width)&&(b.y<0||a.y<b.y+b.height&&b.y<a.y+a.height)},a.prototype.containsX=function(a){return this.x<=a&&a<this.x+this.width},a.prototype.containsY=function(a){return this.y<=a&&a<this.y+this.height},a}(),b.zp=O;function ja(a,b,c,d,e,f,g,h){if(c>=0&&d>=0){f[c]||(f[c]={});var i=f[c];i[d]=e}else c>=0&&d===-1&&a>=0&&b===-1?g[c]=e:d>=0&&c===-1&&b>=0&&a===-1&&(h[d]=e)}P=function(){function a(a,b){var c=this;c.Xj=a,c.OZ=b,c.dataTable={},c.rowDataArray=[],c.columnDataArray=[],c.defaultDataNode=s,c.Ap={},c.gga=0,c.Ff=-1,c.Ef=-1}return a.prototype.getRowCount=function(){return this.Xj},a.prototype.getColumnCount=function(){return this.OZ},a.prototype.setRowCount=function(a){this.Xj=a},a.prototype.setColumnCount=function(a){this.OZ=a},a.prototype.Cp=function(a,b,c,d){var e,f,g,h,i=this,j=i.Ap;i.gga>0||a>=0&&b>=0&&(d&&(d.type="updateDirty",d.row=a,d.col=b,j[a]?j[a][b]||(d.isEmptyCol=!0):d.isEmptyRow=!0),j[a]||(j[a]={}),e=j[a],e[b]||(e[b]={}),f=e[b],"n"!==e.rs&&(e.rs="e"),g=c.Dp,h=c.Ep,C(g)||(d&&(d.originalItem=e.originalItem),e.originalItem=g),C(h)||(d&&(d.oldValue=f.oldValue),f.oldValue=h))},a.prototype.gWa=function(a){var b=this.Ap,c=a.row,d=a.col;a.isEmptyRow?delete b[c]:a.isEmptyCol?delete b[c][d]:(a.hasOwnProperty("originalItem")&&(C(a.originalItem)&&!C(b[c].originalItem)?delete b[c].originalItem:b[c].originalItem=a.originalItem),a.hasOwnProperty("oldValue")&&(C(a.oldValue)&&!C(b[c][d].oldValue)?delete b[c][d].oldValue:b[c][d].oldValue=a.oldValue))},a.prototype.getValue=function(a,b,c){var d=this.RTa(a,b);return d&&!C(d.value)?1!==c?D(d.value):C(d.value.richText)?d.value:q(!0,{},d.value):s},a.prototype.setValue=function(a,b,c,d,e){var f,g=this.RTa(a,b,!0,d?d[0]:t);g&&g.value!==c?(f=g.value,g.value=c,this.Cp(a,b,{Ep:f},e),d&&(d[0].push("value"),d[1]=f)):d&&(d.length=0)},a.prototype.getStyle=function(a,b,c){var d=this.RTa(a,b),e=d&&d.style;return e&&c&&e.clone&&(e=e.clone(!0)),e},a.prototype.setStyle=function(a,b,c,d){var e,f=this.RTa(a,b,!0,d?d[0]:t);f&&f.style!==c?(e=f.style,f.style=c,d&&(d[0].push("style"),d[1]=e)):d&&(d.length=0)},a.prototype.getCellState=function(a,b){var c=this.RTa(a,b);return c?c.cellState:s},a.prototype.setCellState=function(a,b,c,d){var e,f=this.RTa(a,b,!0,t);f&&(e=f.cellState||0,d?f.cellState=e|c:f.cellState=e&~c)},a.prototype.getValueForKey=function(a,b,c){var d=this.RTa(a,b);return d&&d[c]},a.prototype.setValueForKey=function(a,b,c,d,e){var f,g=this.RTa(a,b,!0,e?e[0]:t);g&&g[c]!==d?(f=g[c],g[c]=d,e&&(e[0].push(c),e[1]=f)):e&&(e.length=0)},a.prototype.getFormatString=function(a,b){var c=this.RTa(a,b);return c&&c.formatString},a.prototype.setFormatString=function(a,b,c,d){var e,f=this.RTa(a,b,!0,d?d[0]:t);f&&f.formatString!==c?(e=f.formatString,f.formatString=c,d&&(d[0].push("formatString"),d[1]=e)):d&&(d.length=0)},a.prototype.NTa=function(a,b,c){var d,e=this,f=e.Xj,g=e.dataTable,h=e.Ap;if(0<=a&&a<=f&&b>=0&&(A(g,f,a,b),A(e.rowDataArray,f,a,b),A(h,f,a,b),e.Xj+=b,!c))for(d=0;d<b;d++)g[a+d]={rs:"n"},h[a+d]=g[a+d]},a.prototype.STa=function(a,b,c){var d,e,f=this,g=f.Xj;if(0<=a&&a<g&&b>0){if(a+b>g&&(b=g-a),c)for(d=0;d<b;d++)e=a+d,c.push([["dataTable",e],f.dataTable[e]]),c.push([["rowDataArray",e],f.rowDataArray[e]]),c.push([[z,e],f.Ap[e]]);B(f.dataTable,g,a,b),B(f.rowDataArray,g,a,b),B(f.Ap,g,a,b),f.Xj-=b}},a.prototype.OTa=function(a,b){var c,d,e=this,f=e.OZ;if(0<=a&&a<=f&&b>=0){for(c=0;c<e.Xj;c++)d=e.dataTable[c],d&&a<f&&A(d,f,a,b);A(e.columnDataArray,f,a,b),e.OZ+=b}},a.prototype.TTa=function(a,b,c){var d,e,f,g,h,i,j=this,k=j.OZ;if(0<=a&&a<k&&b>0){for(d=0;d<j.Xj;d++)if(e=j.dataTable[d]){if(c)for(f=0;f<b;f++)g=a+f,c.push([["dataTable",d,g],e[g]]);B(e,k,a,b)}if(c)for(h=0;h<b;h++)i=a+h,c.push([["columnDataArray",i],j.columnDataArray[i]]);B(j.columnDataArray,k,a,b),a+b>k&&(b=k-a),j.OZ-=b}},a.prototype.RTa=function(a,b,c,d){var e,f=this,g=f.dataTable,h=f.columnDataArray,i=f.rowDataArray,j=s;return a<f.Xj&&b<f.OZ&&(a>=0&&b>=0?(e=g[a],c&&!e&&(e=g[a]={},a>f.Ef&&(f.Ef=a)),e&&(j=e[b],c&&!j&&(j=e[b]={},f.Ff<b&&(f.Ff=b))),d&&d.push("dataTable",a,b)):a===-1&&b>=0?(j=h[b],c&&!j&&(j=h[b]={},f.Ff<b&&(f.Ff=b)),d&&d.push("columnDataArray",b)):a>=0&&b===-1?(j=i[a],c&&!j&&(j=i[a]={},f.Ef<a&&(f.Ef=a)),d&&d.push("rowDataArray",a)):a===-1&&b===-1&&(j=f.defaultDataNode,c&&!j&&(j=f.defaultDataNode={}),d&&d.push("defaultDataNode"))),j},a.prototype.setNode=function(a,b,c){var d,e=this,f=e.dataTable,g=e.columnDataArray,h=e.rowDataArray;a<e.Xj&&b<e.OZ&&(a>=0&&b>=0?(d=f[a],d||(d=f[a]={}),d[b]=c):a===-1&&b>=0?g[b]=c:b===-1&&a>=0&&(h[a]=c))},a.prototype._f=function(a,b,c,d,e){var f,g,h,i,j,k,l,m;e&&(f=[],g=[]),h=this,i=h.dataTable,j=h.rowDataArray,k=h.columnDataArray,l=h.RTa(a,b,t,f),m=h.RTa(c,d,t,g),e&&(e.push([f,l]),e.push([g,m])),l?ja(a,b,c,d,l,i,j,k):m&&ja(a,b,c,d,s,i,j,k),m?ja(c,d,a,b,m,i,j,k):l&&ja(c,d,a,b,s,i,j,k)},a.prototype.Yea=function(a){a++;for(var b=this.Xj,c=this.dataTable;a>=0&&a<b&&!c[a];)a++;return a<b?a:-1},a.prototype.Hl=function(a,b){var c=this,d=s,e=c.OZ;if(a>=0&&a<c.Xj&&(d=c.dataTable[a]),d){for(b++;b>=0&&b<e&&!d[b];)b++;if(b<e)return b}return-1},a.prototype.NHb=function(a){var b,c,d,e,f,g=a.row,h=a.col,i=a.rowCount,j=a.colCount,k=this;for(b=g,c=0;c<i;c++,b++)for(d=h,e=0;e<j;e++,d++)f=k.RTa(b,d),f&&(f.value=s)},a.prototype.clear=function(a,b,c,d,e,g,h){var i,j,k,l,m,n,o,p=this,q=p.Xj,r=p.OZ,u=[],w=!!h,x=[];if(a>=0&&b>=0){if(c=v(c,q-a),d=v(d,r-b),c>0&&d>0)for(k=a;k<a+c;k++)if(!g||f.Common.k.Cb(g,k)<0)for(j=b;j<b+d;j++)w&&(l=[]),i=p.RTa(k,j,t,l),i&&(u.push(i),w&&x.push(l),(1&e)>0&&!C(i.value)&&(m=void 0,w&&(m={}),p.Cp(k,j,{Ep:i.value},m),m&&h.push(m)))}else if(a>=0&&b===-1){if(c=v(c,q-a),c>0)for(k=a;k<a+c;k++)w&&(l=[]),i=p.RTa(k,-1,t,l),i&&(u.push(i),w&&x.push(l))}else if(a===-1&&b>=0){if(d=v(d,r-b),d>0)for(j=b;j<b+d;j++)w&&(l=[]),i=p.RTa(-1,j,t,l),i&&(u.push(i),w&&x.push(l))}else a===-1&&b===-1&&(w&&(l=[]),i=p.RTa(-1,-1,t,l),i&&(u.push(i),w&&x.push(l)));for(n=function(a){if(i=u[a]){var b=w?[]:t;(8&e)>0&&(b&&b.push(["tag",i.tag]),i.tag=s),(2&e)>0&&(b&&b.push(["style",i.style]),i.style=s),(1&e)>0&&(b&&b.push(["value",i.value]),i.value=s),(16&e)>0&&(b&&b.push(["sparkline",i.sparkline]),i.sparkline=s),(64&e)>0&&(b&&b.push(["bindingPath",i.bindingPath]),i.bindingPath=s),(128&e)>0&&(b&&b.push(["formatString",i.formatString]),i.formatString=s),(4&e)>0&&(b&&b.push(["comment",i.comment]),i.comment=s),w&&b.forEach(function(b){var c=[].concat(x[a]);c.push(b[0]),b[0]=c,h.push(b)})}},o=0;o<u.length;o++)n(o)},a.prototype.toJSON=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,q,r,u,v;function w(a,d,e){var f,g,h,i,j,k,l,m,n;return a?(f={},g=a.value,C(g)||(f.value=g),h=a.formatString,h&&(i=c.et.getFormulaByName(h),f.formatString="="+i),j=b&&b.ignoreStyle,j||(k=a.style,"string"==typeof k?f.style=k:k&&(l=k.toJSON(d,e),l&&(l.name=t,f.style=l))),
m=a.bindingPath,C(m)||(f.bindingPath=m),n=a.tag,C(n)||(f.tag=n),f):s}for(d=this,e={},f={},g=d.Yea(-1);g>=0;){for(i={},j=!1,h=d.Hl(g,-1);h>=0;)k=d.RTa(g,h),k&&(l=w(k),p(l)||(i[h]=l,j=!0)),h=d.Hl(g,h);j&&(f[g]=i),g=d.Yea(g)}for(p(f)||(e.dataTable=f),m=[],n=d.rowDataArray,g=0;g<d.Xj;g++)_(n,g)&&n[g]&&(o=w(n[g]),p(o)||(m[g]=o));for(m.length>0&&(e.rowDataArray=m),q=[],r=d.columnDataArray,h=0;h<d.OZ;h++)_(r,h)&&r[h]&&(u=w(r[h]),p(u)||(q[h]=u));return q.length>0&&(e.columnDataArray=q),v=w(d.defaultDataNode,a,!0),p(v)||(e.defaultDataNode=v),e},a.prototype.fromJSON=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n;if(a){if(d=this,d.gga++,e=a.dataTable,h=d.Xj,i=d.OZ,e)for(f=0;f<h;f++)if(j=e[f])for(g=0;g<i;g++)k=j[g],k&&ka(k,d.RTa(f,g,!0),b,f,g,c);if(l=a.rowDataArray||a.Hf)for(f=0;f<h;f++)_(l,f)&&l[f]&&ka(l[f],d.RTa(f,-1,!0),b,f,-1,c);if(m=a.columnDataArray||a.If)for(g=0;g<i;g++)_(m,g)&&m[g]&&ka(m[g],d.RTa(-1,g,!0),b,-1,g,c);n=a.defaultDataNode||a.Jf,n&&ka(n,d.RTa(-1,-1,!0),b,-1,-1,c),d.gga--}},a}(),Q=function(){function a(){this.infos=[]}return a.prototype.uL=function(a,b){var c=this.infos,d=c.length;0<=a&&a<=d&&b>0&&A(c,d,a,b)},a.prototype.UTa=function(a,b,c){var d,e,f=this.infos,g=f.length;if(0<=a&&a<g&&b>0){if(b=v(b,g-a),c)for(d=0;d<b;d++)e=a+d,c.push([["infos",e],f[e]]);B(f,g,a,b)}},a.prototype.VTa=function(){return this.infos.length},a.prototype.Hp=function(){return this.infos},a.prototype.Jp=function(a){return this.infos[a]},a.prototype.Kp=function(a,b,c){var d=this.infos[a];this.infos[a]=b,c&&(c[0].push("infos",a),c[1]=d)},a.prototype.getSize=function(a){var b=this.infos[a],c=s;return b&&(b.visible===!1?c=0:"number"==typeof b.size&&(c=w(b.size))),c},a.prototype.getActualSize=function(a){var b=this.infos[a];return b?w(b.size):s},a.prototype.setSize=function(a,b,c){var d,e=this.infos,f=e[a];f||(f=e[a]={}),d=f.size,d!==b&&(f.size=b),c&&(c[0].push("infos",a,"size"),c[1]=d)},a.prototype.getStarSize=function(a){var b=this.infos[a];return b?b.starSize:t},a.prototype.setStarSize=function(a,b,c){var d,e=this.infos,f=this.infos[a];f||(f=e[a]={}),d=f.starSize,C(b)&&C(d)||(d!==b&&(C(b)?delete f.starSize:f.starSize=b),c&&(c[0].push("infos",a,"starSize"),c[1]=d))},a.prototype.toJSON=function(a){var b,c,d,e,f,g,h,j,k=this.infos,l=[];if(a&&a.ignoreStarSize)for(b=0;b<k.length;b++)C(k[b])||(c=k[b],d=c.cellType,e=$(c,["cellType"]),l[b]=F(e),d&&(f=m._o,g=d.typeName,h=f[d.type]||f[g]||i.getTypeFromString(g),h&&(j=new h,j.fromJSON(d.toJSON(),a),l[b].cellType=j)),delete l[b].starSize);else for(b=0;b<k.length;b++)C(k[b])||(l[b]=k[b]);return l.length>0?l:t},a.prototype.fromJSON=function(a){a&&(this.infos=a)},a}(),R=Q.prototype,o({visible:!0,resizable:!0,pageBreak:!1},function(a,b){var c=a[0].toUpperCase()+a.substr(1);R["get"+c]=function(c){var d=b,e=this.infos[c];return e&&!C(e[a])&&(d=e[a]),d},R["set"+c]=function(b,c,d){var e,f=this.infos,g=f[b];g||(g=f[b]={}),e=g[a],e!==c&&(g[a]=c),d&&(d[0].push("infos",b,a),d[1]=e)}});function ka(a,b,c,d,f,h){var j,k,l,m,o,p,q,r,v,w,x;a&&(j=a.value,j!==t&&(j=j,j!==s&&(j._calcError||j._error&&!C(j._code))&&(k=n&&g.CalcError.parse(j._calcError||j._error),k!==t&&(k=E(k),j=k)),b.value=j),l=a.style,m=h&&h.sheet,l===t||h.ignoreStyle||(o=s,typeof l===u?(b.style=l,o=m&&(m.Mq(l,!1)||m.parent&&m.parent.Mq(l,!1))):l&&(o=new e.Style,o.fromJSON(l,c),o.name=t,b.style=o),o&&o.validator&&h&&h.setValidator&&h.setValidator(d,f,o.validator)),p=a.visualState,p!==t&&(b.visualState=p),q=a.bindingPath,q!==t&&(b.bindingPath=q),r=a.tag,r!==t&&(v=r.typeName,typeof v===u&&(w=i.getTypeFromString(v),w&&(r=new w,r.fromJSON&&r.fromJSON(a.tag))),b.tag=r),x=a.formatString,x!==t&&(b.formatString=x,m.setCellFormatString(d,f,x)))}S=20,T=62,U=40,V=20;function la(a,b){for(var c,d=b[0],e=a,f=0;f<d.length-1;f++){if(C(e))return;c=d[f],e=c===z?e.Ap:e[c]}e[d[f]]=b[1]}function ma(a,b,c){var d=a.WTa>0?[["selectionModel"],t]:t;a.selectionModel.setProperty(b,c,d),d&&a.zTa.push(d)}function na(a,b,c,d,e){void 0===e&&(e=!1);var f=a[b];return e?void(f&&delete f[c]):(f||(f=a[b]={}),void(f[c]=d))}function oa(a,b,c,d){na(a,b,c,{value:d})}function pa(a,b,c,d,e,f){na(a,b,c,{value:d,oldValue:e,isAnchorCell:f})}function qa(a,b,c,d){var e,f=a[b],g=f&&f[c];return g?g.value:(e=d.getValue(b,c),oa(a,b,c,e),e)}function ra(a,b){return[a,b].join(",")}function sa(a,b){a.indexOf(b)===-1&&a.push(b)}function ta(a,b,c){var d=a[b];return d&&d[c]}function ua(a,b){var c=b.split(",").map(function(a){return+a}),d=c[0],e=c[1],f=a[d];return f&&f[e]}function va(a,b,c,d){var e=a[b];e&&delete e[c],d&&p(e)&&delete a[b]}W=5e5,X=function(){function a(a){this.modelManager=a,this.anchors={},this.cells={},this.invalidAnchors={}}return a.prototype.getAnchorCell=function(a,b){return ta(this.anchors,a,b)},a.prototype.getAnchorItem=function(a,b){return ta(this.cells,a,b)},a.prototype.getAnchorInfo=function(a,b,c){var d,e,f,g,h=this,i=h.anchors,j=h.getAnchorCell(a,b);if(j)return j;if(d=h.getAnchorItem(a,b)){e=d.anchorRefs;for(f in e)if(e[f]&&(g=ua(i,f),c||g.isValid))return g}},a.prototype.isCellHasItsOwnValue=function(a,b,c){var d,e,f,g,h=this,i=h.getAnchorItem(a,b);if(i){if(!C(i.value)||i.OHb)return!0;d=i.anchorRefs,e=h.anchors;for(f in d)if(c!==f&&d[f]&&(g=ua(e,f),g&&g.isValid))return!0}return!1},a.prototype.removeRef=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,q,r,t=this,u=t.cells,v=b.isValid,w=b.row,x=b.col,y=b.rowCount,z=b.colCount,A=1;for(g=0,h=w;g<y;g++,h++){for(i=x+A;A<z;A++,i++){if(j=ta(u,h,i),k=j&&j.anchorRefs,l=!0,v){if(m=a.getValue(h,i),n=j&&j.value,C(n)){if(o=j&&j.OHb,q=!o||o===c,k)for(r in k)if(r!==c&&k[r]){l=!1;break}q?pa(d,h,i,s,m,b.row===h&&b.col===i):n=m}e&&oa(e,h,i,n)}k&&(delete k[c],l&&f&&p(k)&&va(u,h,i,!0))}A=0}},a.prototype.PHb=function(a,b,c,d,e){var f,g,i,j=a.getRowCount(),k=a.getColumnCount();return!(b+d>j||c+e>k)&&(!(d*e>W)&&(f=a.getSheet(),g=h.kf(b,c,d,e),!f.getSpans(g).length&&(i=f.tables,!(i&&i.rn&&i.rn(b,c,d,e)))))},a.prototype.setArray=function(a,b,c,d,e,f){var h,i,j,k,l,m,o,p,q,r,t,u,v,w,x,y,z,A,B,D,E,F=this,G=ra(b,c),H=F.anchors,I=ta(H,b,c),J=F.cells;if(I&&!f)return h=F.updateItem(a,b,c),i=h[0],j=h[1],[I,i,j];if(k={},l={},m=!1,I&&I.isValid&&(m=!0,F.removeRef(a,I,G,k,l,!0)),o=I,I={row:b,col:c,rowCount:d,colCount:e,values:f,isValid:!1},na(H,b,c,I),p=a.getCalcService().QHb,I.QHb=p,q=o&&o.QHb===p&&(d!==o.rowCount||e!==o.colCount),r=a.q$a,t=r&&ta(F.invalidAnchors,b,c))pa(k,b,c,n&&g.Errors.Spill,s,I.row===b&&I.col===c),F.RHb(b,c,d,e,J,r,l,a,G,!0);else if(f){if(u=qa(l,b,c,a),v=!q&&F.PHb(a,b,c,d,e),v&&(F.RHb(b,c,d,e,J,r,l,a,G),!r))for(w=1,x=0,y=b;x<d;x++,y++){for(z=c+w;w<e;w++,z++)if(A=qa(l,y,z,a),!C(A)&&F.isCellHasItsOwnValue(y,z,G)){if(v=!1,!m)break;na(k,y,z,A,!0)}if(!m&&!v)break;w=0}if(v)for(x=0,y=b;x<d;x++,y++)for(B=f[x],w=0,z=c;w<e;w++,z++)A=qa(l,y,z,a),D=B[w],E=D,C(D)||n&&g.Convert.vf(D)?E=0:n&&(g.Convert.Ca(D)||g.Convert.Fh(D))&&(E=1===D.getRowCount()&&1===D.getColumnCount()?g.Convert.Ca(D)?D.getValue(0,0):D.getValue(0,0,0):g.Errors.Calc),pa(k,y,z,E,A,I.row===y&&I.col===z),(x||w)&&(ta(J,y,z).OHb=G);else pa(k,b,c,n&&g.Errors.Spill,u,I.row===b&&I.col===c);I.isValid=v,o&&v!==o.isValid&&F.modelManager.SHb(b,c,!v)}return[I,k,[o]]},a.prototype.RHb=function(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o=1;for(k=0;k<c;k++){for(l=a+k;o<d;o++)m=b+o,n=!j&&ta(e,l,m),n||(n={anchorRefs:{}},f&&!j||(n.value=qa(g,l,m,h)),na(e,l,m,n)),n.anchorRefs[i]=!0;o=0}},a.prototype.updateItem=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o;if(void 0===e&&(e={}),void 0===f&&(f=[]),g=ra(b,c),h=this,i=h.anchors,j=ta(i,b,c),j&&(h.removeRef(a,j,g,e,t,!0),va(e,b,c),va(i,b,c,!0)),k=h.cells,l=ta(k,b,c),l){h.modelManager.THb(b,c,l.value),l.value=d,delete l.OHb,m=l.anchorRefs;for(n in m)m[n]&&(o=ua(i,n),sa(f,o))}if(j||l)return[j&&e,f]},a.prototype.UHb=function(a,b){na(this.invalidAnchors,a,b,!0)},a.prototype.VHb=function(){this.invalidAnchors={}},a.prototype.WHb=function(a,b,c){var d,e,f,g,h,i,j,k=this,l=k.anchors,m=[];for(d in l)if(l.hasOwnProperty(d)){e=+d,f=e>=b,g=l[d];for(h in g)g.hasOwnProperty(h)&&(i=+h,f||(j=g[h],f=j&&j.rowCount+e>=b),f&&m.push([e,i]))}m.length&&m.forEach(function(b){k.updateItem(a,b[0],b[1],t)})},a.prototype.NTa=function(a,b,c){this.WHb(a,b,c)},a.prototype.PTa=function(a,b,c){this.WHb(a,b,c)},a.prototype.XHb=function(a,b){var c,d,e,f,g,h,i,j=this,k=j.anchors,l=[];for(c in k)if(k.hasOwnProperty(c)){d=+c,e=k[c];for(f in e)e.hasOwnProperty(f)&&(g=+f,h=g>=b,h||(i=e[f],h=i&&i.colCount+g>=b),h&&l.push([d,g]))}l.length&&l.forEach(function(b){j.updateItem(a,b[0],b[1],t)})},a.prototype.OTa=function(a,b,c){this.XHb(a,b)},a.prototype.QTa=function(a,b,c){this.XHb(a,b)},a}(),b.YHb=X;function wa(a,b,c,d,e){var f,h,i,j,k,l,m,n,o=a.XTa(3),p=a.zHb,q=p.anchors,r=[];for(f in q)if(q.hasOwnProperty(f)&&(h=q[f]))for(i in h)h.hasOwnProperty(i)&&(j=h[i],j&&(k=j.row,l=j.col,m=j.rowCount,n=j.colCount,(e?k+m:l+n)>=b&&(j.isValid&&o.NHb(j),(e?k:l)<b&&r.push(j))));r.length&&g.markAnchorCellDirty(r,a.kj.Bj(),p)}b.clearSpillValuesOnAddRemove=wa,Y=function(){function a(b,c,d,e,f,g){var h,i,j,k;this.ZHb=[],h=this,h.kj=b,h.sheetModels=[t,new P(e,d),new P(c,f),new P(c,d)],i=h.rowInfos=[],i[0]=i[1]=new Q,i[2]=i[3]=new Q,j=h.colInfos=[],j[0]=j[2]=new Q,j[1]=j[3]=new Q,h.spanModels=[t,new I,new I,new I],h.selectionModel=new M,h.zHb=new X(h),h.name=g||"",h.zoomFactor=1;function l(a,b,c,d){h.WTa>0&&h.zTa.push([["defaults",c],d]),h.kj.$p()}k=h.defaults={},ca(k,"rowHeight",S,l),ca(k,"colWidth",T,l),ca(k,"rowHeaderColWidth",U,l),ca(k,"colHeaderRowHeight",V,l),ca(k,"_isExcelDefaultColumnWidth",!1,l),h.WTa=0,a.ao(this,"init")}return a.prototype.addRows=function(b,c,d,e){var f,g=this;g.WTa>0&&(f={row:b,rowCount:c,type:"addRows"},g.zTa.push(f)),g.XTa(3).NTa(b,c,e),g.XTa(2).NTa(b,c,e),g.zl(3).NTa(b,c),g.zl(2).NTa(b,c),g.YTa(!0,3).uL(b,c),n&&g.zHb.NTa(g.kj.yj(),b,c),d||a.ao(g,"addRows",{row:b,rowCount:c,changes:g.zTa})},a.prototype.ZTa=function(a){var b=this,c=a.row,d=a.rowCount;wa(b,c,d,!1,!0),b.deleteRows(c,d,!0)},a.prototype.deleteRows=function(b,c,d){var e,f,g,h,i,j,k,l,m,o=this;if(o.WTa>0&&(f=[],g=[],h=[["spanModels",3],t],i=[["spanModels",2],t],j=[],e={row:b,rowCount:c,type:"deleteRows"},o.zTa.push(e)),o.XTa(3).STa(b,c,f),o.XTa(2).STa(b,c,g),o.zl(3).PTa(b,c,h),o.zl(2).PTa(b,c,i),o.YTa(!0,3).UTa(b,c,j),n&&o.zHb.PTa(o.kj.yj(),b,c),d||a.ao(o,"deleteRows",{row:b,rowCount:c,changes:o.zTa}),e){for(k=e.changes=[],l=["sheetModels",3],m=0;m<f.length;m++)f[m][0]=l.concat(f[m][0]),k.push(f[m]);for(l=["sheetModels",2],m=0;m<g.length;m++)g[m][0]=l.concat(g[m][0]),k.push(g[m]);for(h.length>0&&k.push(h),i.length>0&&k.push(i),l=["rowInfos",3],m=0;m<j.length;m++)j[m][0]=l.concat(j[m][0]),k.push(j[m])}},a.prototype.$Ta=function(a){var b,c,d=this,e=a.row,f=a.rowCount;for(wa(d,e,f,!0,!0),d.addRows(e,f,!0,!0),b=a.changes,c=b.length-1;c>=0;c--)la(d,b[c])},a.prototype.addColumns=function(b,c,d){var e,f=this;f.WTa>0&&(e={col:b,colCount:c,type:"addColumns"},f.zTa.push(e)),f.XTa(3).OTa(b,c),f.XTa(1).OTa(b,c),f.zl(3).OTa(b,c),f.zl(1).OTa(b,c),f.YTa(!1,3).uL(b,c),n&&f.zHb.OTa(f.kj.yj(),b,c),d||a.ao(f,"addColumns",{col:b,colCount:c,changes:f.zTa})},a.prototype._Ta=function(a){var b=this,c=a.col,d=a.colCount;wa(b,c,d,!1,!1),b.deleteColumns(c,d,!0)},a.prototype.deleteColumns=function(b,c,d){var e,f,g,h,i,j,k,l,m,o=this;if(o.WTa>0&&(f=[],g=[],h=[["spanModels",3],t],i=[["spanModels",1],t],j=[],e={col:b,colCount:c,type:"deleteColumns"},o.zTa.push(e)),o.XTa(3).TTa(b,c,f),o.XTa(1).TTa(b,c,g),o.zl(3).QTa(b,c,h),o.zl(1).QTa(b,c,i),o.YTa(!1,3).UTa(b,c,j),n&&o.zHb.QTa(o.kj.yj(),b,c),d||a.ao(o,"deleteColumns",{col:b,colCount:c,changes:o.zTa}),e){for(k=e.changes=[],l=["sheetModels",3],m=0;m<f.length;m++)f[m][0]=l.concat(f[m][0]),k.push(f[m]);for(l=["sheetModels",1],m=0;m<g.length;m++)g[m][0]=l.concat(g[m][0]),k.push(g[m]);for(h.length>0&&k.push(h),i.length>0&&k.push(i),l=["colInfos",3],m=0;m<j.length;m++)j[m][0]=l.concat(j[m][0]),k.push(j[m])}},a.prototype.aUa=function(a){var b,c,d=this,e=a.col,f=a.colCount;for(wa(d,e,f,!0,!1),d.addColumns(e,f,!0),b=a.changes,c=b.length-1;c>=0;c--)la(d,b[c])},a.prototype.getRowCount=function(a){return this.XTa(a).getRowCount()},a.prototype.setRowCount=function(a,b,c){var d=this,e=d.getRowCount(b);d.WTa>0&&d.zTa.push({oldRowCount:e,sheetArea:b,type:"setRowCount"}),3===b||2===b?(e>a&&d.deleteRows(a,e-a,c),d.XTa(3).setRowCount(a),d.XTa(2).setRowCount(a)):1===b&&(e>a&&d.YTa(!0,b).UTa(a,e-a),d.XTa(b).setRowCount(a))},a.prototype.bUa=function(a){this.setRowCount(a.oldRowCount,a.sheetArea,!0)},a.prototype.getColumnCount=function(a){return this.XTa(a).getColumnCount()},a.prototype.setColumnCount=function(a,b,c){var d=this,e=d.getColumnCount(b);d.WTa>0&&d.zTa.push({oldColCount:e,sheetArea:b,type:"setColumnCount"}),3===b||1===b?(e>a&&d.deleteColumns(a,e-a,c),d.XTa(3).setColumnCount(a),d.XTa(1).setColumnCount(a)):2===b&&(e>a&&d.YTa(!1,b).UTa(a,e-a),d.XTa(b).setColumnCount(a))},a.prototype.cUa=function(a){this.setColumnCount(a.oldColCount,a.sheetArea,!0)},a.prototype.getLastNonNullRow=function(a,b){var c=b?0:this.YTa(!0,a).VTa()-1;return x(this.XTa(a).Ef,this.zl(a).Ef,c)},a.prototype.getLastNonNullCol=function(a,b){var c=b?0:this.YTa(!1,a).VTa()-1;return x(this.XTa(a).Ff,this.zl(a).Ff,c)},a.prototype.$Gb=function(){var a=this.kj,b=0!==a.Dr().height&&this._Gb(!0,a.defaults.rowHeight),c=0!==a.Dr().width&&this._Gb(!1,a.defaults.colWidth);function d(b,c){var d,e,f,g,h=c.length;for(d=0;d<h;d++)e=c[d][0],f=c[d][1],g=c[d][2],g!==f&&(b?a.kq(e,3,"height",f,g):a.pq(e,3,"width",f,g))}b&&d(!0,b),c&&d(!1,c)},a.prototype._Gb=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,s=this.kj,t=[],u=s.zoom(),v=a?s.getRowCount():s.getColumnCount(),x=this.YTa(a,3),z=0,A=0;if(s.Gt&&(A=a?s.Gt().height:s.Gt().width),a){if(s.options.colHeaderVisible)for(d=0;d<s.getRowCount(1);d++)z+=y(u*s.getRowHeight(d,1));c=s.Dr().height-s.options.sheetAreaOffset.top-A-z}else{if(s.options.rowHeaderVisible)for(d=0;d<s.getColumnCount(2);d++)z+=y(u*s.getColumnWidth(d,2));c=s.Dr().width-s.options.sheetAreaOffset.left-A-z}for(e=[],f=[],g=[],h=0,i=a?s.getRowVisible:s.getColumnVisible,d=0;d<v;d++)if(j=i.call(s,d),k=s.ITa.getSize(a,3,d),l=s.ITa.getStarSize(a,3,d),r.test(l))m="*"===l?1:parseFloat(l.replace("*","")),j&&m>0?(h+=m,e.push(d),f.push(m),g.push(k)):t.push([d,0,k]);else if(k="number"==typeof k?Math.floor(k):b,j&&(c-=y(u*k),c<1))return;if(!(h+t.length===0||c<1)){for(n=e.length,d=0;d<n-1;d++)if(o=c/h/u,m=f[d],k=w(o*m),p=y(u*k),t.push([e[d],k,g[d]]),c-=p,h-=m,p<1||c<1)return;for(q=y((c-1e-4)/u),t.push([e[n-1],q,g[n-1]]),d=0;d<t.length;d++)x.setSize(t[d][0],t[d][1]);return t}},a.prototype.setCellState=function(a,b,c,d,e){var f=this.XTa(e);f&&f.setCellState(a,b,c,d)},a.prototype.toJSON=function(a){var b,c,d,e,f=this,g={};return g.data=f.XTa(3).toJSON(3,a,f.kj),g.rowHeaderData=f.XTa(2).toJSON(2,a),g.colHeaderData=f.XTa(1).toJSON(1,a),g.rows=f.YTa(!0,3).toJSON(a),g.columns=f.YTa(!1,3).toJSON(a),g.rowHeaderColInfos=f.YTa(!1,2).toJSON(a),g.colHeaderRowInfos=f.YTa(!0,1).toJSON(a),g.leftCellIndex=f.kj.qq,g.topCellIndex=f.kj.lq,b=a&&a.ignoreStyle,b||(g.spans=f.zl(3).toJSON(),g.rowHeaderSpan=f.zl(2).toJSON(),g.colHeaderSpan=f.zl(1).toJSON()),g.selections=f.selectionModel.toJSON(),g.tag=f.getValueForKey(-1,-1,"tag",3),c=f.defaults,d={colHeaderRowHeight:c.colHeaderRowHeight,colWidth:c.colWidth,rowHeaderColWidth:c.rowHeaderColWidth,rowHeight:c.rowHeight,dyb:c.dyb},e=d.rowHeight===S&&d.colWidth===T&&d.rowHeaderColWidth===U&&d.colHeaderRowHeight===V,e||(g.defaults=d),g},a.prototype.fromJSON=function(a,b,c){var d,e,f,g,h,j,l=this;l.XTa(3).fromJSON(a.data,b,c),l.XTa(2).fromJSON(a.rowHeaderData,b,c),l.XTa(1).fromJSON(a.colHeaderData,b,c),l.kj.showCell(a.topCellIndex||0,a.leftCellIndex||0,k.VerticalPosition.top,k.HorizontalPosition.left),l.YTa(!0,3).fromJSON(a.rows),l.YTa(!1,3).fromJSON(a.columns),l.YTa(!1,2).fromJSON(a.rowHeaderColInfos),l.YTa(!0,1).fromJSON(a.colHeaderRowInfos),d=c&&c.ignoreStyle,d||(l.zl(3).fromJSON(a.spans),l.zl(2).fromJSON(a.rowHeaderSpan),l.zl(1).fromJSON(a.colHeaderSpan)),l.selectionModel.fromJSON(a.selections),e=a.tag,e!==t&&(f=e.typeName,typeof f===u&&(g=i.getTypeFromString(f),g&&(e=new g,e.fromJSON&&e.fromJSON(a.tag))),l.do("setValueForKey",-1,-1,"tag",e,3)),h=a.defaults,h!==t&&(j=l.defaults,j.colHeaderRowHeight=h.colHeaderRowHeight,j.colWidth=h.colWidth,j.rowHeaderColWidth=h.rowHeaderColWidth,j.rowHeight=h.rowHeight,j.dyb=h.dyb)},a.prototype.startTransaction=function(){if(0===this.WTa){this.zTa=[];var b=this.kj,c=!b.isEventSuspended();c&&(this.zTa.events=[]),a.ao(this,"startTransaction")}this.WTa++},a.prototype.endTransaction=function(){var b,c;return this.WTa--,0===this.WTa?(a.ao(this,"endTransaction"),b=this.zTa,this.zTa=t,c=b.events,c&&0===c.length&&delete b.events,b):[]},a.prototype.dUa=function(){var a=this.zTa;if(a)return a.calc||(a.calc=[]),a.calc},a.prototype.SHb=function(a,b,c){var d=this.zTa;d&&d.push({type:"setIsValid",value:[a,b,c]})},a.prototype.THb=function(a,b,c){var d=this.zTa;d&&d.push({type:"dirtyItem",value:[a,b,c]})},a.prototype.$Hb=function(a){var b,c,d,e=a.value;e&&(b=this.zHb,c=b.getAnchorCell(e[0],e[1]),c&&(d=e[2],c.isValid=d))},a.prototype._Hb=function(a){var b,c,d,e,f,g=a.value;g&&(b=g[0],c=g[1],d=g[2],e=this.zHb,f=e.getAnchorItem(b,c),f&&(f.value=d))},a.prototype.undo=function(b){var c,d,e,f,g,h,i,j=[],k=b&&b.events;for(k&&this.YVa(k),c=b.length-1;c>=0;c--)d=b[c],e=d.type,e?"addRows"===e?this.ZTa(d):"addColumns"===e?this._Ta(d):"deleteRows"===e?this.$Ta(d):"deleteColumns"===e?this.aUa(d):"setRowCount"===e?this.bUa(d):"setColumnCount"===e?this.cUa(d):"setZoomFactor"===e?this.fUa(d.value):"updateDirty"===e?(this.gWa(d),j.push(d)):"setName"===e?this.pZa(d.value):"sortRange"===e?this.yxb(d):"setIsValid"===e?this.$Hb(d):"dirtyItem"===e&&this._Hb(d):la(this,d);f=this.kj,f.Oq={},f.Jq(),g=j.length>0,g&&(h=f.Wu,h&&h.suspend(),j.forEach(function(a){f.eyb(a.row,a.col,3,!1)})),i=b&&b.calc,i&&i.length&&f.gUa(i),a.ao(this,"undo",b),g&&(h&&h.resume(!1),f.fyb()),k&&this.YVa(k)},a.prototype.do=function(a){var b,c,d,e=[];for(b=1;b<arguments.length;b++)e[b-1]=arguments[b];c=this,a&&(d=c[a],d&&d.apply(c,e))},a.prototype.XTa=function(a){return C(a)&&(a=3),this.sheetModels[a]},a.prototype.dWa=function(a,b,c){C(c)&&(c=3),this.sheetModels[c]=new P(a,b)},a.prototype.ZVa=function(a){var b=this,c=b.zTa,d=c&&c.events;d&&d.push(a)},a.prototype.YVa=function(a){var b,c,d,e=this.kj;for(e.aIb=!0;a.length;)b=a.shift(),c=b[0],d=void 0,"cellChanged"===c?d=e.Bq:"rowChanged"===c?d=e.kq:"columnChanged"===c?d=e.pq:"zoomChanged"===c?d=e.gyb:"rowChanging"===c?d=e.pCb:"columnChanging"===c&&(d=e.qCb),d&&d.apply(e,[].slice.call(b,1));e.aIb=!1},a.prototype.getValue=function(b,c,d,e,f){if(C(d)&&(d=3),!e){var g={row:b,col:c,sheetArea:d,isValueGet:!1,value:t};if(a.ao(this,"getValue",g,function(){return g.isValueGet}),g.isValueGet)return g.value}return this.XTa(d).getValue(b,c,f)},a.prototype.setValue=function(b,c,d,e,f,g,h){var i,j,k,l,m,o,p,q,r;C(e)&&(e=3),j=this,k=j.kj,l=!g&&!k.isEventSuspended(),l&&(i=k.getValue(b,c,e,1)),m=!1,k.parent&&k.parent.options.allowDynamicArray&&n&&!j.bIb&&3===e&&(j.ZHb.push(j.zHb.updateItem(k.yj(),b,c,d)),m=!0),o=!1,f||(p={row:b,col:c,value:d,sheetArea:e,isValueSet:!1,changes:j.zTa},a.ao(j,"setValue",p,function(){return p.isValueSet}),o=p.isValueSet),o||(q=void 0,r=void 0,j.WTa>0&&!h&&(q=[["sheetModels",e],t],r={sheetArea:e}),j.XTa(e).setValue(b,c,d,q,r),q&&q.length>0&&j.zTa.push(q),r&&r.type&&j.zTa.push(r)),l&&i!==d&&k.Bq("value",b,c,e,i,d),m&&j.applyDynamicChanges()},a.prototype.applyDynamicChanges=function(){var a,b,c,d,e,f=this,h=f.ZHb,i=f.kj;if(!f.bIb&&h.length){for(f.bIb=!0,a=i.yj(),b=i.Bj(),c=0,d=h;c<d.length;c++)e=d[c],e&&(g.setSpillValues(e[0],a),g.markAnchorCellDirty(e[1],b,f.zHb));h.length=0,f.bIb=!1}},a.prototype.getDynamicArrayInfo=function(a,b){return this.zHb.getAnchorInfo(a,b)},a.prototype.getStyle=function(a,b,c){return this.XTa(c).getStyle(a,b,this.WTa>0)},a.prototype.setStyle=function(a,b,c,d){C(d)&&(d=3);var e=this.WTa>0?[["sheetModels",d],t]:t;this.XTa(d).setStyle(a,b,c,e),e&&e.length>0&&this.zTa.push(e)},a.prototype.getValueForKey=function(a,b,c,d){return this.XTa(d).getValueForKey(a,b,c)},a.prototype.setValueForKey=function(a,b,c,d,e){C(e)&&(e=3);var f=this.WTa>0?[["sheetModels",e],t]:t;this.XTa(e).setValueForKey(a,b,c,d,f),f&&f.length>0&&this.zTa.push(f)},a.prototype.getFormatString=function(a,b,c){return this.XTa(c).getFormatString(a,b)},a.prototype.setFormatString=function(a,b,c,d){C(d)&&(d=3);var e=this.WTa>0?[["sheetModels",d],t]:t;this.XTa(d).setFormatString(a,b,c,e),e&&e.length>0&&this.zTa.push(e)},a.prototype.clear=function(b,c,d,e,f,g,h){var i,j,k,l,m,o,p,q,r,u,v,w,x,y,z;if(C(h)&&(h=3),i=this.WTa>0?[]:t,j=this,k=!1,n&&!j.bIb&&3===h){for(l=j.kj,m=l.yj(),o=j.ZHb,p=j.zHb,q={},r=[],u=0;u<d;u++)for(v=0;v<e;v++)p.updateItem(m,b+u,c+v,s,q,r);o.push([q,r]),k=!0}if(this.XTa(h).clear(b,c,d,e,f,g,i),a.ao(this,"clear",{row:b,col:c,rowCount:d,colCount:e,type:f,ignoredRowList:g,sheetArea:h,changes:this.zTa}),i)for(w=["sheetModels",h],x=0,y=i.length;x<y;x++)z=i[x],z[0]=w.concat(z[0]),this.zTa.push(z);k&&this.applyDynamicChanges()},a.prototype.swapNode=function(a,b,c,d,e){var f,g,h,i,j;if(C(e)&&(e=3),f=this.WTa>0?[]:t,this.XTa(e)._f(a,b,c,d,f),f)for(g=["sheetModels",e],h=0,i=f.length;h<i;h++)j=f[h],j[0]=g.concat(j[0]),this.zTa.push(j)},a.prototype.Cp=function(a,b,c,d){var e;this.WTa>0&&(e={sheetArea:d},C(d)&&(e.sheetArea=3)),this.XTa(d).Cp(a,b,c,e),e&&this.zTa.push(e)},a.prototype.gWa=function(a){this.XTa(a.sheetArea).gWa(a)},a.prototype.hUa=function(a){return this.XTa(a).Ap},a.prototype.iUa=function(a){this.XTa(a).Ap={}},a.prototype.jUa=function(a){this.XTa(a).gga++},a.prototype.kUa=function(a){var b,c=this.XTa(a);c.gga--,b=c.gga,b<0&&(c.gga=0)},a.prototype.getName=function(){return this.name||""},a.prototype.setName=function(a){var b=this;b.WTa>0&&b.zTa.push({type:"setName",value:b.name}),b.name=a},a.prototype.pZa=function(a){this.kj.name(a)},a.prototype.yxb=function(a){var b,c=[];b=a.byRows?a.row:a.column,a.array.map(function(a,d){c[a-b]=d+b}),this.kj.sortRange(a.row,a.column,a.rowCount,a.columnCount,a.byRows,a.sortInfo,c)},a.prototype.getZoomFactor=function(){return this.zoomFactor},a.prototype.setZoomFactor=function(a){var b=this;b.WTa>0&&b.zTa.push({type:"setZoomFactor",value:b.zoomFactor}),b.zoomFactor=a},a.prototype.fUa=function(a){this.kj.zoom(a)},a.prototype.zl=function(a){return C(a)&&(a=3),this.spanModels[a]},a.prototype.eWa=function(a){C(a)&&(a=3),this.spanModels[a]=new I},a.prototype.getSpans=function(a,b){return this.zl(b).getSpans(a)},a.prototype.getSpan=function(a,b,c){return this.zl(c).get(a,b)},a.prototype.MTa=function(a,b,c,d,e){return this.zl(e).MTa(a,b,c,d)},a.prototype.qu=function(a,b,c,d,e){return this.zl(e).qu(a,b,c,d)},a.prototype.findSpan=function(a,b,c){return this.zl(c).find(a,b)},a.prototype.removeSpan=function(a,b){C(b)&&(b=3);var c=this.WTa>0?[["spanModels",b],t]:t;this.zl(b).remove(a,c),c&&c.length>0&&this.zTa.push(c)},a.prototype.addSpan=function(a,b){C(b)&&(b=3);var c=this.WTa>0?[["spanModels",b],t]:t;this.zl(b).add(a,c),c&&c.length>0&&this.zTa.push(c)},a.prototype.clearSpan=function(a,b,c,d,e){C(e)&&(e=3);var f=this.WTa>0?[["spanModels",e],t]:t;this.zl(e).$b(a,b,c,d,f),f&&f.length>0&&this.zTa.push(f)},a.prototype.moveSpan=function(a,b,c,d,e,f,g){C(g)&&(g=3);var h=this.WTa>0?[["spanModels",g],t]:t;this.zl(g).aB(a,b,c,d,e,f,h),h&&h.length>0&&this.zTa.push(h)},a.prototype.copySpan=function(a,b,c,d,e,f,g){C(g)&&(g=3);var h=this.WTa>0?[["spanModels",g],t]:t;this.zl(g).Zz(a,b,c,d,e,f,h),h&&h.length>0&&this.zTa.push(h)},a.prototype.addSelection=function(a,b,c,d){var e,f,g=this.WTa>0?[]:t;if(this.selectionModel.add(a,b,c,d,g),g)for(e=0;e<g.length;e++)f=g[e],f[0]=["selectionModel"].concat(f[0]),this.zTa.push(f)},a.prototype.getSelections=function(){return this.selectionModel.get()},a.prototype.setSelections=function(a){var b,c,d=this.WTa>0?[]:t;if(this.selectionModel.set(a,d),d)for(b=0;b<d.length;b++)c=d[b],c[0]=["selectionModel"].concat(c[0]),this.zTa.push(c)},a.prototype.clearSelection=function(){var a,b,c=this.WTa>0?[]:t;if(this.selectionModel.clear(c),c)for(a=0;a<c.length;a++)b=c[a],b[0]=["selectionModel"].concat(b[0]),this.zTa.push(b)},a.prototype.getActiveSelectedRangeIndex=function(){return this.selectionModel.getProperty("activeSelectedRangeIndex")},a.prototype.setActiveSelectedRangeIndex=function(a){var b=this.WTa>0?[["selectionModel"],t]:t;this.selectionModel.setProperty("activeSelectedRangeIndex",a,b),b&&this.zTa.push(b)},a.prototype.getSelectionPolicy=function(){return this.selectionModel.getProperty("selectionPolicy")},a.prototype.setSelectionPolicy=function(a){ma(this,"selectionPolicy",a)},a.prototype.getSelectionUnit=function(){return this.selectionModel.getProperty("selectionUnit")},a.prototype.setSelectionUnit=function(a){ma(this,"selectionUnit",a)},a.prototype.sp=function(a){return this.selectionModel.sp(a)},a.prototype.tp=function(a){return this.selectionModel.tp(a)},a.prototype.vp=function(a,b,c,d,e,f){return this.selectionModel.vp(a,b,c,d,e,f)},a.prototype.wp=function(a,b,c,d,e){return this.selectionModel.wp(a,b,c,d,e)},a.prototype.YTa=function(a,b){C(b)&&(b=3);var c=a?this.rowInfos:this.colInfos;return c[b]},a.prototype.fWa=function(a,b){C(b)&&(b=3);var c=a?this.rowInfos:this.colInfos;c[b]=new Q},a.prototype.getPageBreak=function(a,b,c){var d=this.YTa(a,b);return d.getPageBreak(c)},a.prototype.setPageBreak=function(a,b,c,d){var e,f;C(b)&&(b=3),e=this.WTa>0?[[a?"rowInfos":"colInfos",b],t]:t,f=this.YTa(a,b),f.setPageBreak(c,d,e),e&&this.zTa.push(e)},a.prototype.getVisible=function(a,b,c){var d=this.YTa(a,b);return d.getVisible(c)},a.prototype.setVisible=function(a,b,c,d){var e,f;C(b)&&(b=3),e=this.WTa>0?[[a?"rowInfos":"colInfos",b],t]:t,f=this.YTa(a,b),f.setVisible(c,d,e),e&&this.zTa.push(e)},a.prototype.getResizable=function(a,b,c){var d=this.YTa(a,b);return d.getResizable(c)},a.prototype.setResizable=function(a,b,c,d){var e,f;C(b)&&(b=3),e=this.WTa>0?[[a?"rowInfos":"colInfos",b],t]:t,f=this.YTa(a,b),f.setResizable(c,d,e),e&&this.zTa.push(e)},a.prototype.getSize=function(a,b,c){var d=this.YTa(a,b);return d.getSize(c)},a.prototype.getStarSize=function(a,b,c){var d=this.YTa(a,b);return d.getStarSize(c)},a.prototype.getActualSize=function(a,b,c){var d=this.YTa(a,b);return d.getActualSize(c)},a.prototype.setSize=function(a,b,c,d){var e,f;C(b)&&(b=3),e=this.WTa>0?[[a?"rowInfos":"colInfos",b],t]:t,f=this.YTa(a,b),f.setSize(c,d,e),e&&this.zTa.push(e),this.setStarSize(a,b,c,s)},a.prototype.setStarSize=function(a,b,c,d){var e,f;C(b)&&(b=3),e=this.WTa>0?[[a?"rowInfos":"colInfos",b],t]:t,f=this.YTa(a,b),f.setStarSize(c,d,e),e&&!C(e[1])&&this.zTa.push(e)},a.prototype.VTa=function(a,b){var c=this.YTa(a,b);return c.VTa()},a.prototype.Hp=function(a,b){var c=this.YTa(a,b);return c.Hp()},a.prototype.Jp=function(a,b,c){var d=this.YTa(a,b);return d.Jp(c)},a.prototype.setItem=function(a,b,c,d){var e,f;C(b)&&(b=3),e=this.WTa>0?[[a?"rowInfos":"colInfos",b],t]:t,f=this.YTa(a,b),f.Kp(c,d,e),e&&this.zTa.push(e)},a}(),b.lUa=Y,h.Zn(Y)},"./dist/core/worksheet/worksheet-render.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/worksheet/worksheet.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/stylehelper.js"),h=c("./dist/core/worksheet/worksheet-model.js"),i=c("./dist/core/worksheet/worksheet-border.js"),j=function(a){return a.getSparkline},k=d.Common.k,l=f.Ul.ol,m=f.Ul.fp,n=f.Ul.lZa,o=d.Common.j.Fa,p=f.Ul.Fxb,q=g.Ho,r=g.To.No,s=null,t=Math.min,u=Math.max,v=Math.abs,w=Math.sin,x=Math.cos,y=Math.tan,z=Math.floor,A=Math.round,B=parseInt,C="black",D="transparent",E="rowHeader",F="columnHeader",G="white";function X(a){return a.height}function Y(a){return a.width}function Z(a,b,c,d,e,f,g){a.beginPath(),a.lineWidth=b,a.strokeStyle=c,a.moveTo(d,e),a.lineTo(f,g),a.stroke()}H=2,I=100;function $(a,b){var c,d,e=0;return"string"==typeof a&&(c=a.split(" ",4),d=c.length,1===d?e=2*B(c[0]):2===d||3===d?e=2*B(c[1]):4===d&&(e=B(c[1])+B(c[3]))),e*b}function _(a,b,c,d,e,g,h){var i,j,k,l,n,p,q,s,t,u=e.zoom(),y=c.font,z=c.textIndent,A=c.textOrientation,B=c.isVerticalText,C=c.textIndent&&0!==c.textIndent,D=0!==A&&!o(A);return y=y?r(y,u).font:d,n=0,p=a,a&&p.richText?n=ba(p.richText,y,u):a&&D&&!B&&!C?(j=v(A*Math.PI/180),k=w(j),l=x(j),c.wordWrap?(q=e.ss,s=q.Sl(g),n=f.Vn.lHb(g,h,k,l,b,y,s)):(t=m(y),n=f.Vn.Xn(b,y)*l+t*k)):n=f.Vn.Xn(b,y),n+=da(e,z,g,h)+H,i=n+$(c.cellPadding,u)}function aa(a,b,c){if(a&&-90<=a&&a<=90){var d=z(c/y(v(a*Math.PI/180)));return d+b+4}}function ba(a,b,c){return ca(a,b,c),f.Vn.R_a(a,b,1)}function ca(a,b,c){var d,e,f,g,h;for(d=0,e=a;d<e.length;d++)f=e[d],g=void 0,f.style=f.style||{},h=f.style,g=h.font?r(h.font,c).font:b,h.font=g}function da(a,b,c,d){if(!o(c)&&!o(d)&&a.outlineColumn){var e=a.outlineColumn.LRa(c,d);if(e)return e}return b?8*b:0}function ea(a,b,c,d,e,f,g,i,j){var k,l,m,n,q,r,t,u,v,w,x,y,z,A,B,C;if(p(e.data))return s;if(k=a.ss,l=Y(e),m=Y(e),q=e.style,t=e.text,w=q.watermark,x=q.wordWrap,y=q.textOrientation,z=a.options.allowCellOverflow,b.findCell(f,g))return s;if(q.cellButtons&&q.cellButtons.length>0)return s;if(A=q.cellType||c,!A.allowOverflow||!t&&!w||!y&&x)return s;if(t||(t=w),!z&&!y)return s;if(u=_(e.data,t,q,d,a,f,g),u<=m)return s;for(B=g,C=g,r=g+(j?1:-1);(j?r<=i:r>=i)&&!b.findCell(f,r)&&(n=k.ge(f,r,3,1),v=k.Ym(f,r),v.textOrientation||o(n))&&!v.watermark&&(j?C=r:B=r,m+=k._m(r),!(u<=m));r+=j?1:-1);return j&&C===g||!j&&B===g?s:new h.op(g,B,C,u,l,m,j?-1:m,j?m:-1)}J=function(){function a(a,b,c){var d=this;d.kj=a,d.pJ=a.Hr(c),d.qJ=a.Ir(b,c),d.yI=r(a.yl.Bl(),a.zoom()).font,d.Rq=a.Al(),d.rJ={}}return a.prototype.nJ=function(a,b){var c,d,e,g,i,j,k,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=this,I=H.rJ[a];if(I)return I;if(c=H.kj,d=c.ss,e=H.pJ,g=e.length,v=new h.np,b||(b=f.Vn.bm()),g>0){for(v.headingOverflowlayouts=H.sJ(a,b),x=e[0].col,y=e[g-1].col,z=0;z<g;z++)m=e[z],Y(m)<=0||(n=m.col,q=d.ge(a,n,3,1),p=d.Ym(a,n),i=p.textOrientation,j=p.isVerticalText,k=p.textIndent&&0!==p.textIndent,A=p&&(p.borderLeft||p.borderTop||p.borderRight||p.borderBottom),o(q)&&!p.watermark||p.shrinkToFit||!i&&p.wordWrap||j||(B=c.conditionalFormats,B&&(C=B.oRa(c,a,n,q),D=C.dataBar,E=C.iconSet,D&&D.showBarOnly||E&&E.showIconOnly)||(r=d._m(n),s=d.Sl(a),F=p.cellType||H.Rq,G={},u=f.mn.vn(c,p,q,G),G&&G.content&&G.content.length>0&&!p.shrinkToFit&&i&&(u=F.nHb(b,G.content,s-4)),t=p.hAlign,3===t&&(t=l(t,q,p.formatter,i)),A&&i&&!j&&!k?0>i&&i>-90?(w=H.cIb({data:q,style:p,width:r,text:u},a,n,x),w&&v.push(w)):0<i&&i<90&&(w=H.cIb({data:q,style:p,width:r,text:u},a,n,y,!0),w&&v.push(w)):0===t?(w=H.tJ({data:q,style:p,width:r,text:u},a,n,y),w&&v.push(w)):2===t?(w=H.uJ({data:q,style:p,width:r,text:u},a,n,x),w&&v.push(w)):1===t&&(w=H.vJ({data:q,style:p,width:r,text:u},a,n,x,y),w&&v.push(w)))));v.trailingOverflowLayouts=H.wJ(a,b)}return H.rJ[a]=v,v},a.prototype.tJ=function(a,b,c,d){var e=this;return ea(e.kj,e.qJ,e.Rq,e.yI,a,b,c,d,!0)},a.prototype.uJ=function(a,b,c,d){var e=this;return ea(e.kj,e.qJ,e.Rq,e.yI,a,b,c,d)},a.prototype.cIb=function(a,b,c,d,e){var f,g,i,j,k,l,m=this,n=m.kj,o=m.qJ,p=m.Rq,q=m.yI,r=n.ss,t=Y(a),u=Y(a),v=a.style,w=a.text,x=v.watermark,y=v.wordWrap,z=v.textOrientation,A=v&&(v.borderLeft||v.borderTop||v.borderRight||v.borderBottom),B=v.isVerticalText,C=v.textIndent&&0!==v.textIndent,D=n.options.allowCellOverflow;if(o.findCell(b,c))return s;if(v.cellButtons&&v.cellButtons.length>0)return s;if(j=v.cellType||p,!j.allowOverflow||!w&&!x||!z&&y)return s;if(w||(w=x),!D&&!z)return s;if(g=!A||B||C?_(a.data,w,v,q,n,b,c):aa(z,r._m(c),r.Sl(b)),g<=u)return s;for(k=c,l=c,f=c+(e?1:-1);(e?f<=d:f>=d)&&!o.findCell(b,f)&&(i=r.Ym(b,f),!i.watermark)&&(e?l=f:k=f,u+=r._m(f),!(g<=u));f+=e?1:-1);return e&&l===c||!e&&k===c?s:new h.op(c,k,l,g,t,u,e?-1:u,e?u:-1)},a.prototype.vJ=function(a,b,c,d,e){var f,g,i,j,k,l,m,n,q,r,t,u,v,w,x,y,z,A,B,C,D;if(p(a.data))return s;if(f=this,g=f.kj,i=g.ss,j=f.qJ,k=Y(a),l=Y(a),n=a.style,r=a.text,v=n.textOrientation,w=n.watermark,x=n.wordWrap,y=g.options.allowCellOverflow,j.findCell(b,c))return s;
if(n.cellButtons&&n.cellButtons.length>0)return s;if(z=n.cellType||f.Rq,!z.allowOverflow||!r&&!w||!v&&x)return s;if(r||(r=w),!y&&!v)return s;if(t=_(a.data,r,n,f.yI,g,b,c),t<=l)return s;for(A=c,B=l/2,q=c-1;q>=d&&!j.findCell(b,q)&&(m=i.ge(b,q,3,1),u=i.Ym(b,q),u.textOrientation||o(m))&&!u.watermark&&(A=q,B+=i._m(q),!(t/2<=B));q--);for(C=c,D=l/2,q=c+1;q<=e&&!j.findCell(b,q)&&(m=i.ge(b,q,3,1),u=i.Ym(b,q),u.textOrientation||o(m))&&(C=q,D+=i._m(q),!(t/2<=D));q++);return A===C?s:new h.op(c,A,C,t,k,B+D,B,D)},a.prototype.sJ=function(a,b){var c,d,e,g,h,i,j,k,m,n,p,q,r=this,s=r.kj,t=s.ss,u=r.pJ,v=u[0].col,w=u[u.length-1].col,x=s.ITa,y=[];for(q=1;q<I;q++){if(i=v-q,i<0)return y;if(x.findSpan(a,i))return y;d=t.ge(a,i,3,1),e=t._m(i),e>0&&!o(d)&&(c=t.Ym(a,i),h=c.hAlign,3===h&&(h=l(h,d,void 0,c.textOrientation)),g=t.Sl(a),n=c.cellType||r.Rq,p={},k=f.mn.vn(s,c,d,p),p&&p.content&&p.content.length>0&&!c.shrinkToFit&&c.textOrientation&&(k=n.nHb(b,p.content,g-4)),m={data:d,style:c,width:e,text:k},0<c.textOrientation&&c.textOrientation<90?j=r.cIb(m,a,i,w,!0):0===h?j=r.tJ(m,a,i,w):1===h&&(j=r.vJ(m,a,i,v,w)),j&&j.endColumn>=v&&y.push(j))}return y},a.prototype.wJ=function(a,b){var c,d,e,g,h,i,j,k,m,n,p,q,r=this,s=r.kj,t=s.ss,u=r.pJ,v=u[0].col,w=u[u.length-1].col,x=s.ITa,y=s.getColumnCount(),z=[];for(q=1;q<I;q++){if(k=w+q,k>=y)return z;if(x.findSpan(a,k))return z;d=t.ge(a,k,3,1),e=t._m(k),e>0&&!o(d)&&(c=t.Ym(a,k),h=c.hAlign,3===h&&(h=l(h,d,void 0,c.textOrientation)),g=t.Sl(a),i=c.cellType||r.Rq,j={},n=f.mn.vn(s,c,d,j),j&&j.content&&j.content.length>0&&!c.shrinkToFit&&c.textOrientation&&(n=i.nHb(b,j.content,g-4)),p={data:d,style:c,width:e,text:n},0>c.textOrientation&&c.textOrientation>-90?m=r.cIb(p,a,k,v,!1):2===h?m=r.uJ(p,a,k,v):1===h&&(m=r.vJ(p,a,k,v,w)),m&&m.startColumn<=w&&z.push(m))}return z},a}(),b.xJ=J;function fa(a){var b=a.parent,c={nps:!0};return e.Worksheet.ao(a,"needPaintSelection",c),(f.Vl.Wl(a)||b&&!b.options.hideSelection)&&c.nps}b.needPaintSelection=fa;function ga(a){var b=a.parent;return b&&b.options.backColor||G}K=function(){function a(a){this.kj=a}return a.prototype.bm=function(){var a=this.kj,b=s,c=a.Ws();return c&&c.getContext&&(b=c.getContext("2d")),b},a.prototype.vI=function(){var a,b=this,c=b.kj,d=c.Dr(),e=c.Xs,g=Y(e),h=X(e),i=b.wI;return i&&Y(i)===g&&X(i)===h||(i&&f.En.Qn(c,i),b.wI=i=f.Ul.Nl("canvas"),i.getContext&&(b.xI=i.getContext("2d"),f.En.Kn(i,s,c),f.En.Pn(i,Y(d),X(d)))),a=b.xI,a&&(a.beginPath(),n(a,b.Cl(b.Bl())),a.name="bufferContext"),a},a.prototype.Bl=function(){return this.yI||(this.yI=q+" "+this.kj.currentTheme().bodyFont()),this.yI},a.prototype.us=function(){this.yI=s},a.prototype.zI=function(a){var b,c=this.kj,d=c.parent,e=d?d.options.grayAreaBackColor||f.Im.Mm("gc-grayArea").backgroundColor:"gray",g=f.Rm.Om(c,e);return a?(b=d?d.options.backgroundImage:s,b&&(g=D),g):g},a.prototype.Cl=function(a){var b=this.kj,c=b.zoom();return 1===c?a:r(a,c).font},a.prototype.Mx=function(a,b,c,d,e){var g,h,i,j,k,l=this,m=l.wI,n=l.bm();c<=0||d<=0||!m||!n||(e||(e=l.kj.Dr()),g=f.En.Ln(m),h=f.En.Mn(m),1!==g&&(a*=g,b*=h,c*=g,d*=h,e=new f.Rect(e.x*g,e.y*h,Y(e)*g,X(e)*h)),i=e.getIntersect(a,b,c,d),i&&(i.round(),a=i.x,b=i.y,c=Y(i),d=X(i),j=Y(m),j&&a+c>j&&(a=j-c,a<0&&(c+=a,a=0)),k=X(m),k&&b+d>k&&(b=k-d,b<0&&(d+=b,b=0)),f.Bn.Cn(n,1,1),n.clearRect(a,b,c,d),n.drawImage(m,a,b,c,d,a,b,c,d),f.Bn.Cn(n,g,h)))},a.prototype.dm=function(a,b){a&&this.Mx(a.x,a.y,Y(a),X(a),b)},a.prototype.Ow=function(a,b,c,d,e,g){var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;if(c>0&&d>0)try{h=this,i=h.kj,j=h.bm(),k=i.Ws(),l=h.vI(),m=h.wI,n=c,o=d,p=e,q=g,r=n,s=o,t=f.En.Ln(k),u=f.En.Mn(k),a=A(a*t),b=A(b*u),c=A(c*t),d=A(d*u),p=A(p*t),q=A(q*u),r=A(r*t),s=A(s*u),v=Y(m),w=X(m),v&&a+c>v&&(a=v-c,a<0&&(c+=a,a=0)),w&&b+d>w&&(b=w-d,b<0&&(d+=b,b=0)),v&&p+r>v&&(p=v-r,p<0&&(r+=p,p=0)),w&&q+s>w&&(q=w-s,q<0&&(s+=q,q=0)),f.Bn.Cn(j,1,1),f.Bn.Cn(l,1,1),j.clearRect(p,q,r,s),j.drawImage(m,a,b,c,d,p,q,r,s),l.clearRect(p,q,r,s),l.drawImage(k,p,q,r,s,p,q,r,s),f.Bn.Cn(j,t,u),f.Bn.Cn(l,t,u)}catch(a){}},a.prototype.im=function(a,b,c,d){var e,g,h,i,j,k,l,m,n,o,p,q,r,s,v,w,x,y,z,A,B=this;if(c||(c=B.bm()),e=!1,g=B.kj,h=f.kf(-1,-1,-1,-1),i=g.Hx,j=g.ITa,a&&(h=g.options.allowCellOverflow?f.kf(a.row,0,a.rowCount,g.getColumnCount()):f.kf(a.row,a.col,a.rowCount,a.colCount),!i)){if(h.col>=0){for(l=h.col,m=h.col+h.colCount-1,n=g.getRowCount(1),o=0;o<n;o++)k=j.findSpan(o,h.col,1),k?l=t(k.col,l):g.p_a&&(l=t(g.p_a.col,l)),k=j.findSpan(o,h.col+h.colCount-1,1),k?m=u(k.col+k.colCount-1,m):g.p_a&&(m=u(g.p_a.col+g.p_a.colCount-1,m));h.col=l,h.colCount=m-l+1}if(h.row>=0){for(p=h.row,q=h.row+h.rowCount-1,r=g.getColumnCount(2),s=0;s<r;s++)k=j.findSpan(h.row,s,2),k?p=t(k.row,p):g.p_a&&(p=t(g.p_a.row,p)),k=j.findSpan(h.row+h.rowCount-1,s,2),k?q=u(k.row+k.rowCount-1,q):g.p_a&&(q=u(g.p_a.row+g.p_a.rowCount-1,q));h.row=p,h.rowCount=q-p+1}}if(v=g.cm(h),g.cellStates&&g.cellStates.hasIntersectInSeletionState(h.row,h.col,h.rowCount,h.colCount)&&g.repaint(v),w=Y(v),x=X(v),y=v.x,z=v.y,w>=0||x>=0){if(v.x-=9,v.y-=9,v.width+=18,v.height+=30,b&&(v=v.getIntersectRect(b),!v))return;A=g.am(),x>0&&!i&&(g.$l=!0,B.jp(c,new f.Rect(A.x,u(A.nt,z),A.Br,x),d)),w>0&&!i&&(g.$l=!0,B.jp(c,new f.Rect(u(A.kt,y),A.y,w,A.Cr),d)),h.row!==-1||h.col!==-1||i||(g.$l=!0,B.jp(c,A.em(),d)),w>0&&x>0&&B.jp(c,v,d),e=!0}return e},a.prototype.VF=function(a,b,c,d,e){var g,h=this,i=h.kj;i.Xq<=0&&(g=h.bm(),g&&(e||(i.$l=!0),h.jp(g,new f.Rect(a,b,c,d))))},a.prototype.repaint=function(a){var b,c=this,d=c.kj;d.Xq>0||(b=c.bm(),b&&(d.$l=!0,c.jp(b,a)))},a.prototype.jp=function(a,b,c){var d=this;a&&d.kj.Xq<=0&&(c||d._l(a,b),d.Pw(a,b))},a.prototype._l=function(a,b,c){var d,e,g,h=this,i=h.kj;a&&i.Xq<=0&&(d=h.vI(),e=d?d:a,g=i.Dr(),b||(b=g),b&&b.round(),c&&c.round(),i.$l&&(i.$l=!1,d&&(d.clearRect(b.x,b.y,Y(b),X(b)),c&&d.clearRect(c.x,c.y,Y(c),X(c)),f.Bn.Dn(d,-g.x,-g.y)),h.AI(e,b),c&&h.AI(e,c),d&&f.Bn.Dn(d,g.x,g.y)),d&&(h.dm(b),c&&h.dm(c)))},a.prototype.Pw=function(a,b){var c,d,f,g,h,i=this,j=i.kj,k=j.CH;if(a&&!(j.Xq>0)&&(b&&b.round(),c=j.am(),!j.fI)){if(k){for(d=c.em(),i.dm(d),g=0;g<=2;g++)d=c.fm(g),d&&0!==Y(d)&&0!==X(d)&&i.dm(d);for(h=0;h<=2;h++)d=c.gm(h),d&&0!==Y(d)&&0!==X(d)&&i.dm(d)}for(g=0;g<=2;g++)for(h=0;h<=2;h++)d=c.Ft(g,h),d&&0!==Y(d)&&0!==X(d)&&(f=b,(k&&(1!==g||1!==h)||j.parent&&j.parent.options.allowUserDragMerge)&&(i.dm(d),f=d),f&&!d.intersectRect(f)||i.BI(a,g,h,f));i.CI(a),e.Worksheet.ao(j,"paintAdornment",{ctx:a,clipRect:b})}},a.prototype.dD=function(a,b){var c=this.kj,d=c.parent,e=d?d.options:{},g=ga(c),h=f.Rm.Om(c,g),i=e.backgroundImage;i&&(h=D),a.save(),a.fillStyle=h,a.fillRect(b.x,b.y,Y(b),X(b)),a.restore()},a.prototype.z0a=function(a){var b=this.kj,c=b.am();return a===b.ar(3)&&0===c.Cr},a.prototype.A0a=function(a){var b=this.kj,c=b.am();return a===b.$q(3)&&0===c.Br},a.prototype.DI=function(a,b,c){var d,e,f,g,h,i,j,k=this,l=k.kj,m=l.options,n=l.am(),o=m.sheetAreaOffset.top,p=m.sheetAreaOffset.left,q=0!==n.Cr,r=0!==n.Br,s=l.Gt&&l.Gt()||{x:m.sheetAreaOffset.left,y:m.sheetAreaOffset.top,width:0,height:0},t=0===s.width,u=0===s.height;for(e=0;e<=2;e++)g=n.gm(e),g&&(q&&u&&(g.y=g.y-o,g.height=g.height+o,!r&&t&&(g.x=g.x-p,g.width=g.width+p)),f=b?g.getIntersectRect(b):g,f&&k.EI(a,e,f,c));for(d=0;d<=2;d++)for(h=n.fm(d),h&&(r&&t&&(h.x=h.x-p,h.width=h.width+p,!q&&u&&(h.y=h.y-o,h.height=h.height+o)),f=b?h.getIntersectRect(b):h,f&&k.FI(a,d,f,c)),e=0;e<=2;e++)i=n.Ft(d,e),k.z0a(l.jCb(d))&&u&&(i.y=i.y-o,i.height=i.height+o),k.A0a(l.kCb(e))&&t&&(i.x=i.x-p,i.width=i.width+p),i&&(f=b?i.getIntersectRect(b):i,f&&k.GI(a,d,e,f,c));j=n.em(),j&&(f=b?j.getIntersectRect(b):j,f&&k.HI(a,f,c))},a.prototype.II=function(a){var b,c,d,e,f,g=this,h=g.kj,i=h.am(),j=i.zr,k=i.Ar,l=i.lt,m=i.ot,n=Y(i),o=X(i),p=i.qt,q=i.pt,r=0,s=h.Gr(1);s.length>0?(b=s[s.length-1],c=b.y+X(b),r=c,c<m&&(a.fillStyle=g.zI(!1),a.fillRect(j,c,n,m-c))):0===s.length&&(a.fillStyle=g.zI(!1),a.fillRect(j,p,n,m-p),r=p),d=h.Hr(1),d.length>0?(e=d[d.length-1],f=e.x+Y(e),f<l&&(a.fillStyle=g.zI(!1),a.fillRect(f,k,l-f,r),a.fillRect(f,m,l-f,o-m))):0===d.length&&(a.fillStyle=g.zI(!1),a.fillRect(q,k,l-q,r),a.fillRect(q,m,l-q,o-r))},a.prototype.B0a=function(a,b){var c=this,d=c.kj,e=c.zI(!1),f=d.options,g=f.sheetAreaOffset.left,h=f.sheetAreaOffset.top,i=b.x,j=b.y,k=Y(b),l=X(b);a.save(),g>0&&Z(a,g,e,i+g/2,h>0?j+h:j,i+g/2,j+u(0,l)),h>0&&Z(a,h,e,g>0?i+g:i,j+h/2,i+u(0,k),j+h/2),g>0&&h>0&&(a.fillStyle=c.zI(!1),a.fillRect(i,j,g,h)),a.beginPath(),a.restore()},a.prototype.AI=function(a,b){var c,d=this,f=d.kj;!a||f.Xq>0||(c=f.Dr(),a.save(),b?a.rect(b.x,b.y,Y(b),X(b)):a.rect(c.x,c.y,Y(c),X(c)),a.clip(),a.beginPath(),d.dD(a,c),e.Worksheet.ao(f,"paint",{ctx:a,clipRect:b}),d.B0a(a,c),d.DI(a,b,!1),d.II(a),d.KI(a),e.Worksheet.ao(f,"paintSheetEnd",{ctx:a,clipRect:b}),a.beginPath(),a.restore())},a.prototype.LI=function(a,b){var c,d,e=this,g=e.kj;a&&(c=g.Dr(),a.save(),d=b||new f.Rect(c.x,c.y,Y(c),X(c)),a.rect(d.x,d.y,Y(d),X(d)),a.clip(),a.beginPath(),e.dD(a,c),e.DI(a,d,!0),a.beginPath(),a.restore())},a.prototype.CI=function(a){var b,c,d,e,f,g,h,i,j,k=this.kj,l=k.mm,m=k.yt;if(l&&l.isResizing&&m&&(h=m.resizeInfo)){if(i=k.am(),j=C,a.save(),a.strokeStyle!==j&&(a.strokeStyle=j),1!==a.lineWidth&&(a.lineWidth=1),a.beginPath(),"sizeRow"===h.action||"sizeHiddenRow"===h.action)for(c=u(0,h.startY-.5),e=h.movingY-.5,f=i.x+Y(i),b=i.x;b<f;b+=2)a.moveTo(b,c),a.lineTo(b+1,c),a.moveTo(b,e),a.lineTo(b+1,e);else for(b=u(0,h.startX-.5),d=h.movingX-.5,g=i.y+X(i),c=i.y;c<g;c+=2)a.moveTo(b,c),a.lineTo(b,c+1),a.moveTo(d,c),a.lineTo(d,c+1);a.stroke(),a.beginPath(),a.restore()}},a.prototype.HI=function(a,b,c){var d,e,f,g,h,j,k,l=this.kj;a.beginPath(),d=l.am().em(),e=d.x,f=d.y,g=Y(d),h=X(d),j=l.getActualStyle(-1,-1,0),this.SI(a,[{data:s,row:-1,col:-1,x:e,y:f,width:g,height:h,style:j.clone()}],0,c),k=new i.AF(l,0,0,0),k.jF(0,0,e,f,g,h),k.paint(a)},a.prototype.KI=function(a){var b,c,d,e,g,h,i,j,k,l=this.kj,m=l.frozenRowCount(),n=l.frozenColumnCount(),o=l.frozenTrailingRowCount(),p=l.frozenTrailingColumnCount();(m||n||o||p)&&(b=l.am(),c=b.pt,d=b.qt,e=b.lt,g=b.ot,h=b.x,i=b.y,j=Y(b),k=X(b),a.save(),a.strokeStyle=f.Rm.Om(l,l.options.frozenlineColor),a.lineWidth=1,a.beginPath(),n&&(a.moveTo(c-.5,i),a.lineTo(c-.5,i+k)),m&&(a.moveTo(h,d-.5),a.lineTo(h+j,d-.5)),p&&(a.moveTo(e-.5,i),a.lineTo(e-.5,i+k)),o&&(a.moveTo(h,g-.5),a.lineTo(h+j,g-.5)),a.stroke(),a.restore())},a.prototype.EI=function(a,b,c,d){this.TI(a,-1,b,1,c,d)},a.prototype.FI=function(a,b,c,d){this.TI(a,b,-1,2,c,d)},a.prototype.GI=function(a,b,c,d,e){this.TI(a,b,c,3,d,e);var f=this.kj.at;f&&f.UI(a,d,b,c)},a.prototype.dIb=function(a,b,c,d,e){var g,h,i,j=this,k=j.kj,l=k.getRangeRect(b,c,f.kf(e.row,e.col,e.rowCount,e.colCount));l.round(),g=e.isValid,a.save(),a.lineWidth=1,a.strokeStyle="mediumblue",g||a.setLineDash([6,2]),h=l.x+.5,i=l.y+.5,a.strokeRect(h,i,Y(l),X(l)),a.beginPath(),a.restore()},a.prototype.BI=function(a,b,c,d){var e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,D,E,F,G,H,I=this,J=I.kj;if(fa(J)){if(!J.addSelection)return;if(i=J.ITa,j=J.mm,k=i.getSelections(),l=k.length,d=I.VI(b,c,d),!d)return;if(m=f.Im.Lm("gc-selection"),n=B(m.zIndex),n>2007&&I.WI(a,b,c,d),o=i.eIb=i.zHb.getAnchorInfo(J.getActiveRowIndex(),J.getActiveColumnIndex()),o&&I.dIb(a,b,c,d,o),p=I.XI(b,c,k,d),q=p.length,r=void 0,q<=0)return;for(s=I.XI(b,c,[J.p_a],d)[0],t=!1,u=void 0,u=0;u<q;u++)if(r=p[u],!d.containsRect(r)){t=!0;break}if(s&&!d.containsRect(s)&&(t=!0),a.save(),t&&(a.rect(d.x,d.y,Y(d),X(d)),a.clip()),a.beginPath(),q>0)for(h=f.Rm.Om(J,J.getSelectionBackColor()),a.fillStyle!==h&&(a.fillStyle=h),e=0,g=0,n>2007&&(e=1,g=-3),u=0;u<q;u++)r=p[u],a.fillRect(r.x+e,r.y+e,Y(r)+g,X(r)+g);v=J.Jl,w=J.Kl,s&&(v=J.s_a,w=J.t_a),x=J.getCellRect(v,w,b,c),y=void 0,z=void 0,A=void 0,D=void 0,x&&x.intersectRect(d)&&(y=x.x,z=x.y,A=Y(x),D=X(x),e=1,g=-2,n>2007&&(e=0,g=0),I.Mx(y+e,z+e,A+g,D+g),l>1&&(a.strokeStyle=C,a.lineWidth=1,a.strokeRect(y+1.5,z+1.5,A-4,D-4))),a.restore(),a.save(),a.beginPath(),1===l&&(j&&j.BG&&j.ZI&&j.ZI()&&!j.$I&&(E=j._I&&j._I(),F=J.getRangeRect(b,c,E),G=Y(F),H=X(F),F&&G>0&&H>0&&(a.fillStyle=m&&m.color,a.fillRect(F.x,F.y,G,H))),r&&Y(r)>=0&&X(r)>=0&&(I.YI(d,J,b,c,n),I.aJ(a,b,c,r,d,k[0]))),s&&(a.save(),t&&(a.rect(d.x,d.y,Y(d),X(d)),a.clip()),a.beginPath(),a.fillStyle="rgba(255,255,255,0.4)",a.fillRect(s.x+e,s.y+e,Y(s)+g,X(s)+g),a.fillStyle=h,a.strokeStyle="rgb(124,124,124)",a.lineWidth=1,a.strokeRect(s.x-.5,s.y-.5,Y(s),X(s)),a.restore()),a.beginPath(),a.restore()}},a.prototype.YI=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=b.frozenTrailingRowCount(),r=b.frozenTrailingColumnCount(),s=b.getSelections(),t=b.am(),u=b.getRowCount()-q-1,v=b.getColumnCount()-r-1,w=b.Hr(1,3),x=b.Gr(1,3);1===s.length&&e>2007&&(f=b.frozenRowCount(),g=b.frozenColumnCount(),h=s[0],i=h.row,j=h.col,k=h.rowCount,l=h.colCount,f>0&&(i>=f&&b.gr(i)<f?(a.y-=2,a.height+=2):i+k<=f&&b._q(i+k-1)===b.lq&&(a.height+=2)),g>0&&(j>=g&&b.br(j)<g?(a.x-=2,a.width+=2):j+l<=g&&b.Zq(j+l-1)===b.qq&&(a.width+=2)),0===i&&0===j&&(a.x-=2,a.y-=2,a.width+=2,a.height+=2),i===-1&&(i=0,k=b.getRowCount()),j===-1&&(j=0,l=b.getColumnCount()),m=!1,n=!1,o=x.findRow(u),p=w.findCol(v),o&&o.y+X(o)<t.qt+t.jr&&(m=!0),p&&p.x+Y(p)<t.pt+t.er&&(n=!0),m&&i+k-1===u&&(a.height+=2),n&&j+l-1===v&&(a.width+=2))},a.prototype.WI=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F=this,G=F.kj,H=G.ITa.getSelections(),I=G.am(),J=I.kt,K=I.nt,L=H.length,M=0!==I.Cr,N=0!==I.Br;if(!(L<=0)){if(e=H[0],f=e.row,g=e.rowCount,h=e.col,i=e.colCount,f===-1&&(f=0),h===-1&&(h=0),g===-1&&(g=G.getRowCount()),i===-1&&(i=G.getColumnCount()),a.save(),a.beginPath(),a.lineWidth=2,a.strokeStyle=G.getSelectionBorderColor(),j=d.x,k=d.y,l=Y(d),m=X(d),n=G.frozenRowCount(),M&&(1!==L||0!==n||G.lq<=f||G.lq>=f+g))for(o=F.bJ(c),p=0,q=o.length;p<q;p++)r=o[p],s=0,t=0,u=r.x,v=r.x+Y(r),r.x<j+l&&j<r.x+Y(r)&&(1===L&&(0===n&&G.lq===f||n>0&&0===f)&&(s=-1,t=1),r.x<j&&(s=0,u=j),r.x+Y(r)>j+l&&(t=0,v=j+l),a.moveTo(u+s-1,K-1),a.lineTo(v+t,K-1),a.stroke());if(w=G.frozenColumnCount(),N&&(1!==L||0!==w||G.qq<=h||G.qq>=h+i))for(x=F.cJ(b),y=0,z=x.length;y<z;y++)A=x[y],B=0,C=0,D=A.y,E=A.y+X(A),A.y<k+m&&k<A.y+X(A)&&(1===L&&(0===w&&G.qq===h||w>0&&0===h)&&(B=-1,C=1),A.y<k&&(B=0,D=k),A.y+X(A)>k+m&&(C=0,E=k+m),a.moveTo(J-1,D+B-1),a.lineTo(J-1,E+C),a.stroke());a.beginPath(),a.restore()}},a.prototype.bJ=function(a){var b,c,d,e,g,h,i,j,k,l,m,n=this.kj,o=n.ITa.getSelections(),p=o.length,q=n.Hr(a),r=[];for(b=0;b<p;b++)c=o[b],c&&(d=c.col,d===-1?(e=n.Hr(0,3),g=n.Hr(1,3),h=n.Hr(2,3),i=-1,j=-1,e.length>0&&(i=e[0].x,j=e[e.length-1].x+e[e.length-1].width-i,r.push(new f.Rect(i,(-1),j,(-1)))),g.length>0&&(i=g[0].x,j=g[g.length-1].x+g[g.length-1].width-i,r.push(new f.Rect(i,(-1),j,(-1)))),h.length>0&&(i=h[0].x,j=h[h.length-1].x+h[h.length-1].width-i,r.push(new f.Rect(i,(-1),j,(-1))))):q&&(k=q.findCol(d),l=q.findCol(d+c.colCount-1),(k||l)&&(m=new f.Rect((-1),(-1),(-1),(-1)),k?m.x=k.x:m.x=q[0].x,l?m.width=l.x+Y(l)-m.x:m.width=q[q.length-1].x+q[q.length-1].width-m.x,r.push(m))));return r},a.prototype.cJ=function(a){var b,c,d,e,g,h,i,j,k,l,m,n=this.kj,o=n.ITa.getSelections(),p=o.length,q=n.Gr(a),r=[];for(b=0;b<p;b++)c=o[b],c&&(d=c.row,d===-1?(e=n.Gr(0,3),g=n.Gr(1,3),h=n.Gr(2,3),i=-1,j=-1,e.length>0&&(i=e[0].y,j=e[e.length-1].y+e[e.length-1].height-i,r.push(new f.Rect((-1),i,(-1),j))),g.length>0&&(i=g[0].y,j=g[g.length-1].y+g[g.length-1].height-i,r.push(new f.Rect((-1),i,(-1),j))),h.length>0&&(i=h[0].y,j=h[h.length-1].y+h[h.length-1].height-i,r.push(new f.Rect((-1),i,(-1),j)))):q&&(k=q.findRow(d),l=q.findRow(d+c.rowCount-1),(k||l)&&(m=new f.Rect((-1),(-1),(-1),(-1)),k?m.y=k.y:m.y=q[0].y,l?m.height=l.y+X(l)-m.y:m.height=q[q.length-1].y+q[q.length-1].height-m.y,r.push(m))));return r},a.prototype.aJ=function(a,b,c,d,e,g){var h,i,j=this,k=j.kj,l=k.parent,m=k.mm,n=d.x,o=d.y,p=Y(d),q=X(d),r=k.getViewportTopRow(b),s=k.getViewportLeftColumn(c),t=k.getViewportBottomRow(b),u=k.getViewportRightColumn(c),v=0,w=0,x=k.am(),y=0!==x.Cr,z=0!==x.Br;z||g.col!==s&&g.col!==-1||(v=2),y||g.row!==r&&g.row!==-1||(w=2),g.row+g.rowCount===t+1&&(e.height=e.height+1),g.col+g.colCount===u+1&&(e.width=e.width+1),p>=0&&q>=0&&(!e||d.intersect(e.x-1,e.y-1,Y(e)+2,X(e)+2))&&(a.save(),e&&!e.containsRect(d)&&(a.rect(e.x-v,e.y-w,Y(e),X(e)),a.clip()),a.beginPath(),a.strokeStyle=f.Rm.Om(k,k.getSelectionBorderColor()),a.lineWidth=2,p>0&&q>0?(m&&m.BG?(h=m.dJ,2===h?(a.moveTo(n+.5,o-.5),a.lineTo(n+p-1,o-.5)):3===h?(a.moveTo(n+.5,o+q-.5),a.lineTo(n+p-1,o+q-.5)):0===h?(a.moveTo(n-.5,o+.5),a.lineTo(n-.5,o+q-1)):1===h&&(a.moveTo(n+p-.5,o+.5),a.lineTo(n+p-.5,o+q-1))):(i=l&&l.Vv,i>2007?a.rect(n-1,o-1,p+1,q+1):a.rect(n-.5,o-.5,p,q)),a.stroke(),l&&l.options.allowUserDragFill&&j.eJ&&j.eJ(a,b,c,d,e)):0!==p&&0!==q||a.strokeRect(n-1,o-1,p+1,q+1),a.beginPath(),a.restore())},a.prototype.VI=function(a,b,c){var d,e,f,g,h=this.kj,i=h.am(),j=i.Ft(a,b);return 1===b&&(d=h.Hr(b),e=d.length>0?d[d.length-1]:s,e&&(j.width=t(Y(j),e.x+Y(e)-i.pt))),1===a&&(f=h.Gr(a),g=f.length>0?f[f.length-1]:s,g&&(j.height=t(X(j),g.y+X(g)-i.qt))),c=c?c.getIntersect(j.x,j.y,Y(j),X(j)):j},a.prototype.XI=function(a,b,c,d){var e,f,g,h,i=this.kj,j=i.ITa,k=c.length,l=[];for(h=0;h<k;h++)f=c[h],f&&(e=j.findSpan(f.row,f.col),e&&e.containsRange(f)&&(f=e),g=i.getRangeRect(a,b,f),g&&g.x<=d.x+Y(d)&&g.y<=d.y+X(d)&&d.x<=g.x+Y(g)&&d.y<=g.y+X(g)&&l.push(g));return l},a.prototype.fJ=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n;if(a.save(),d=b.x,e=b.y,f=Y(b),g=X(b),h=[6,6],a.setLineDash)a.beginPath(),a.lineWidth=2,a.strokeStyle=c,a.setLineDash(h),a.rect(d,e,f-1,g-1),a.stroke();else{for(a.beginPath(),a.lineWidth=2,a.strokeStyle=c,i=h[0],j=h[1],k=void 0,l=void 0,m=void 0,n=void 0,k=d,l=e,m=f;m>0;)if(m>=i+j)a.moveTo(k,l),a.lineTo(k+i,l),k=k+i+j,m=m-i-j;else{if(m>=i){a.moveTo(k,l),a.lineTo(k+i,l),m=m-i-j;break}if(m>0){a.moveTo(k,l),a.lineTo(k+m,l),m=m-i-j;break}}for(k=d+f-1,l=e+1,n=g-1,m<0&&(m=v(m),m>j&&(a.moveTo(k,l-2),a.lineTo(k,l+(m-j))),l+=m,n-=m);n>0;)n>=i+j?(a.moveTo(k,l),a.lineTo(k,l+i),l=l+i+j,n=n-i-j):n>=i?(a.moveTo(k,l),a.lineTo(k,l+i),n=n-i-j):n>0&&(a.moveTo(k,l),a.lineTo(k,l+n),n=n-i-j);for(k=d+f-2,l=e+g-1,m=f-1,n<0&&(n=v(n),n>j&&(a.moveTo(k+2,l),a.lineTo(k-(n-j),l)),k-=n,m-=n);m>0;)if(m>=i+j)a.moveTo(k,l),a.lineTo(k-i,l),k=k-i-j,m=m-i-j;else{if(m>=i){a.moveTo(k,l),a.lineTo(k-i,l),m=m-i-j;break}if(m>0){a.moveTo(k,l),a.lineTo(k-m,l),m=m-i-j;break}}for(k=d,l=e+g-2,n=g-1,m<0&&(m=v(m),m>j&&(a.moveTo(k,l+2),a.lineTo(k,l-(m-j))),l-=m,n-=m);n>0;)n>=i+j?(a.moveTo(k,l),a.lineTo(k,l-i),l=l-i-j,n=n-i-j):n>=i?(a.moveTo(k,l),l-i===e?a.lineTo(k,l-i-1):a.lineTo(k,l-i),n=n-i-j):n>0&&(l>e&&(a.moveTo(k,l),a.lineTo(k,l-n)),n=n-i-j);a.stroke()}a.beginPath(),a.restore()},a.prototype.fIb=function(a,b,c,d,e,f,g){var h,i,j,k;0!==b.length&&(h=b[0].col-1,i=b[b.length-1].col+1,j=c.ge(d.row,h,g,1),e&&h>=0&&f.isValid&&!f.isValid(d.row,h,j)&&a.push({style:f.getDataValidator(d.row,h).highlightStyle(),x:b[0].x-f.getColumnWidth(h),y:d.y,width:f.getColumnWidth(h),height:d.height}),k=c.ge(d.row,i,g,1),e&&f.isValid&&!f.isValid(d.row,i,k)&&a.push({style:f.getDataValidator(d.row,i).highlightStyle(),x:b[b.length-1].x+f.getColumnWidth(i),y:d.y,width:f.getColumnWidth(i),height:d.height}))},a.prototype.TI=function(a,b,c,d,f,g){var h,l,m,n,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,K,L,M,N,O,P,Q,R,S,T,U,V,W,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va;if(o(d)&&(d=3),h=this,l=h.kj,m=l.parent,n=l.am().Ft(b,c),p=m&&m.options.resizeZeroIndicator,q=l.Gr(b,d),r=l.Hr(c,d),s=l.options.sheetAreaOffset,t=l.Gt&&l.Gt()||{x:s.left,y:s.top,width:0,height:0},u=q.length,v=r.length,!(u<0||v<0)){for(w=l.Ir(b,c,d,!0),x=w.length>0,B=l.ss,E=0,F=0,G=0,H=0,L=new i.AF(l,b,c,d),M=[],N=[],O=[],P=[],Q=!g&&3===d&&m&&m.options.highlightInvalidData,a.save(),a.beginPath(),R=[],S=-1,T=-1,U=l.ar(3),V=l.$q(3),W=l.am(),Z=0===W.Cr&&0===t.height,$=0===W.Br&&0===t.width,_=!!j(this.kj),aa=0;aa<u;aa++)for(y=q[aa],h.fIb(P,r,B,y,Q,l,d),ba=0;ba<v;ba++)if(z=r[ba],A=x&&w.findCell(y.row,z.col),A?(C=A.row,D=A.col,E=A.x,F=A.y,G=Y(A),H=X(A),A.isAutoMerge&&(ca=h.gIb(A,b,c,d),E=ca.x,F=ca.y,G=ca.width,H=ca.height)):(C=y.row,D=z.col,E=z.x,F=y.y,G=Y(z),H=X(y)),1===p&&(b===-1&&l.getColumnVisible(D)&&0===l.$r(D)&&((T<0||T!==D-1)&&R.push({x1:E,y1:F,x2:E,y2:F+H,horizontal:!1}),T=D),c===-1&&l.getRowVisible(C)&&0===l.Yr(C)&&((S<0||S!==C-1)&&R.push({x1:E,y1:F,x2:E+G,y2:F,horizontal:!0}),S=C)),!(f&&(E+G<=f.x||E>=f.x+Y(f)||F+H<=f.y||F>=f.y+X(f))||0===G||0===H||A&&k.Bb(M,A))){if(da=!1,ea=void 0,I=B.ge(C,D,d,1),1===d&&0===l.frozenRowCount()&&0===l.frozenColumnCount()&&0===C&&(fa=l.getActiveRowIndex(),ga=l.getActiveColumnIndex(),ha=l.jZ&&l.jZ(),l.tables))for(ia=0;ia<l.tables.l$.length;ia++)if(ja=l.tables.l$[ia],ja.MZ&&l.tables.find(fa,ga)===ja&&ja.cj<l.lq&&D>=ja.dj&&ja.cj+ja.Xj>l.lq&&D<ja.dj+ja.OZ){if(I=l.getCell(ja.cj,D).text()+"",da=ja.filterButtonVisible(),ea=ja,ha)for(ka=0;ka<ha.length;ka++)if(ha[ka].col===D&&ha[ka].rowFilter.sj===ja){this.hIb(ha[ka],1,0,!0);break}}else if(ha&&!ja!==ea&&D>=ja.dj&&D<ja.dj+ja.OZ&&!(fa>=ja.cj&&fa<ja.cj+ja.Xj&&ga>=ja.dj&&ga<ja.dj+ja.OZ))for(ka=ha.length-1;ka>=0;ka--)if(ha[ka].tableColumnHeaderFilter&&ha[ka].col===D&&ha[ka].rowFilter.sj===ja){this.hIb(ha[ka],3,ja.cj,!1);break}K=B.Ym(C,D,d),Q&&l.isValid&&!l.isValid(C,D,I)&&P.push({style:l.getDataValidator(C,D).highlightStyle(),x:E,y:F,width:G,height:H}),3===d&&(la=l.aHb(C,D,d),o(la)||(I=la)),L.jF(C,D,E,F,G,H,K,A,C===U&&Z,D===V&&$,I),N.push({data:I,row:C,col:D,x:E,y:F,width:G,sparkline:_&&l.getSparkline(C,D),height:H,style:K,cellLayout:A,tableFilter:da}),A&&M.push(A)}if(N.length>0){if(3===d&&(ma=B.Sm(b,c,function(){return new J(l,b,c)}),O=h.hJ(a,ma,N,L),O.length>0)){for(na=f.x,oa=f.x+f.width,aa=0;aa<O.length;aa++)pa=O[aa],pa&&(qa=pa.row,ra=pa.col,sa=pa.cellOverflowLayout&&pa.cellOverflowLayout.layout,sa&&(ta=sa.x,ua=ta+sa.width,ta<na&&(na=ta),ua>oa&&(oa=ua)),L.jF(qa,ra,pa.x,pa.y,pa.width,pa.height,pa.style,pa.cellLayout,qa===U&&Z,ra===V&&$,pa.data));N=N.concat(O),f.x=na,f.width=oa-na,n&&(f=f?n.getIntersectRect(f):n)}f&&(va=l.printInfo&&l.printInfo(),g&&va&&(va.columnStart()>0||va.rowStart()>0)&&!va.showBorder()?a.rect(f.x-(va.columnStart()>0?2:0),f.y-(va.rowStart()>0?2:0),Y(f)+(va.columnStart()>0?4:0),X(f)+(va.rowStart()>0?4:0)):a.rect(f.x,f.y,Y(f),X(f)),a.clip()),h.SI(a,N,d,g)}e.Worksheet.ao(l,"paintViewport",{ctx:a,rowViewportIndex:b,colViewportIndex:c,sheetArea:d,clipRect:f,isPrinting:g}),L.paint(a),R.length>0&&h.iJ(a,R,1,3),P.length>0&&h.jJ(a,P),a.restore()}},a.prototype.hIb=function(a,b,c,d){a.sheetArea=b,a.row=c,a.tableColumnHeaderFilter=d},a.prototype.gIb=function(a,b,c,d){var e,g,h,i,j,k,l,m,n,o=a.row,p=a.col,q=a.x,r=a.y,s=a.width,t=a.height,u=this.kj,v=u.am();return 1!==b||3!==d&&2!==d||(e=v.fm(b),g=u.frozenRowCount(),h=u.getRowCount(d)-u.frozenTrailingRowCount()-1,i=e.y,j=e.height,r<i&&g<=o&&o<=h&&(t-=i-r,r=i),r+t>i+j&&g<=o+a.rowCount-1&&o+a.rowCount-1<=h&&(t-=r+t-(i+j))),1!==c||3!==d&&1!==d||(e=v.gm(c),k=u.frozenColumnCount(),l=u.getColumnCount(d)-u.frozenTrailingColumnCount()-1,m=e.x,n=e.width,q<m&&k<=p&&p<=l&&(s-=m-q,q=m),q+s>m+n&&k<=p+a.colCount-1&&p+a.colCount-1<=l&&(s-=q+s-(m+n))),new f.Rect(q,r,s,t)},a.prototype.iJ=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(0!==b.length)for(e=0,f=b.length;e<f;e++)g=b[e],h=g.x1,i=g.y1,j=g.x2,k=g.y2,l=g.horizontal,a.beginPath(),a.save(),a.lineWidth=c,a.strokeStyle=this.kJ(a,l,h,i,j,k),a.fillStyle=this.lJ(a,l,h,i,j,k),l?(m=-3,n=1,o=-1,p=-2,a.fillRect(h,i+m,j-h-1,d+2*c),i+=.5,k+=.5,a.moveTo(h+o,i+m),a.lineTo(j+p,k+m),a.moveTo(h+o,i+n),a.lineTo(j+p,k+n)):(q=-3,r=1,s=0,t=-1,a.fillRect(h+q,i+s,d+2*c,k-i-1),h+=.5,j+=.5,a.moveTo(h+q,i+s),a.lineTo(j+q,k+t),a.moveTo(h+r,i+s),a.lineTo(j+r,k+t)),a.stroke(),a.restore()},a.prototype.lJ=function(a,b,c,d,e,g){var h,i,j,k,l,m=b?E:F,n=f.Im.Km(0,"gc-"+m+"-normal"),o=n&&n.backgroundColor,p=n&&n.backgroundImage;if(!b&&p&&p.indexOf("linear-gradient")!==-1)for(i=f.Ul.wl(p),h=a.createLinearGradient(c,d,e,g),j=0,k=i.length;j<k;j++)l=i[j],h.addColorStop(l.point,l.color);else o&&(h=o);return h},a.prototype.kJ=function(a,b,c,d,e,g){var h=a.createLinearGradient(c,d,e,g),i=b?E:F,j=f.Im.Km(0,"gc-"+i+"-normal");return b?(h.addColorStop(0,j.borderTopColor),h.addColorStop(1,j.borderBottomColor)):(h.addColorStop(0,j.borderLeftColor),h.addColorStop(1,j.borderRightColor)),h},a.prototype.jJ=function(a,b){var c,d,e,f,g,h,i,j,k,l=this,m=l.kj,n=m.vu();if(b)for(c=b.length,d=0;d<c;d++)e=b[d],f=e.x,g=e.y,h=e.width,i=e.height,j=e.style,k=j.type,0===k&&this.hyb(a,f,g,h,i,j),1===k&&this.iyb(a,f,g,h,i,j),2===k&&this.jyb(a,f,g,h,i,j,n)},a.prototype.hyb=function(a,b,c,d,e,f){var g=f.color,h=b-4,i=c-4,j=d+8,k=e+8,l=.5522848,m=j/2*l,n=k/2*l,o=h+j,p=i+k,q=h+j/2,r=i+k/2;a.save(),a.lineWidth=2,a.strokeStyle=g,a.beginPath(),a.moveTo(h,r),a.bezierCurveTo(h,r-n,q-m,i,q,i),a.bezierCurveTo(q+m,i,o,r-n,o,r),a.bezierCurveTo(o,r+n,q+m,p,q,p),a.bezierCurveTo(q-m,p,h,r+n,h,r),a.closePath(),a.stroke(),a.restore()},a.prototype.iyb=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o;b-=.5,c-=.5,m=Math.min(d/2,e/2),n=f.color,o=f.position,a.save(),a.lineWidth=2,a.strokeStyle=n,a.beginPath(),a.rect(b,c,d,e),a.stroke(),a.restore(),a.save(),a.beginPath(),0===o?(g=b,h=c,i=b,j=h+m,k=g+m,l=h):2===o?(g=b+d,h=c+e,i=g,j=h-m,k=g-m,l=h):3===o?(g=b,h=c+e,i=b,j=h-m,k=g+m,l=h):1===o&&(g=b+d,h=c,i=g,j=h+m,k=g-m,l=h),a.moveTo(g,h),a.lineTo(i,j),a.lineTo(k,l),a.fillStyle=n,a.fill(),a.closePath(),a.restore()},a.prototype.jyb=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p,q,r;if(b-=.5,c-=.5,h=this.kj,i=h.zoom(),l=15,m=15,n=f.image,o=f.position,p=3,q=f.color,a.save(),a.beginPath(),a.lineWidth=2,a.strokeStyle=q,a.rect(b,c,d,e),a.stroke(),n&&"none"!==n&&g){4===o?j=b-(l+p):5===o&&(j=b+d+p);try{g.ko(n)?(r=g.lo(n),k=c+e/2-m/2,a.drawImage(r,j,k,l,m)):g.fo(n)}catch(a){}}else 4===o?j=b-(l+p)*i:5===o&&(j=b+d+p*i),k=c+e/2-m*i/2,a.translate(j,k),a.scale(.015*i,.015*i),a.beginPath(),a.moveTo(512,0),a.bezierCurveTo(229.248,0,0,229.184,0,512),a.bezierCurveTo(0,794.816,229.248,1024,512,1024),a.bezierCurveTo(794.752,1024,1024,794.752,1024,512),a.bezierCurveTo(1024,229.24800000000005,794.752,0,512,0),a.closePath(),a.moveTo(783.488,692.992),a.lineTo(692.9920000000001,783.4879999999999),a.lineTo(512,602.496),a.lineTo(331.00800000000004,783.4879999999999),a.lineTo(240.51200000000006,692.992),a.lineTo(421.504,512),a.lineTo(240.512,330.944),a.lineTo(331.008,240.44800000000004),a.lineTo(512,421.44),a.lineTo(692.992,240.384),a.lineTo(783.4879999999999,330.88),a.lineTo(602.496,512),a.lineTo(783.488,692.992),a.closePath(),a.fillStyle=q,a.fill(),a.stroke();a.restore()},a.prototype.SI=function(a,b,c,d,g,h,i){var k,l,o,p,q,t,u,v,w,x,y,z,A,B,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,Z,$,_,aa,ba,ca;for(void 0===h&&(h=0),void 0===i&&(i=0),k=this,l=k.kj,o=3===c,p=l.zoom(),q=r(k.Bl(),p),t=l.getDefaultStyle(c),u=l.Al(c),v=k.kj.conditionalFormats,w=ga(l),x=l.$q(2),y=l.ar(1),z=g?g.vu():l.vu(),a.save(),a.beginPath(),a.fillStyle=t&&t.foreColor||C,n(a,q.font),a.textAlign=o?"right":"center",D=b.length,U=[],W={sheet:l,row:-1,col:-1,fontInfo:s,lineHeight:-1,imageLoader:z,conditionalFormats:v,sheetArea:c,parentBackColor:w},A=0;A<D;A++)E=b[A],G=E.data,O=E.tableFilter,H=E.row,I=E.col,J=E.x,K=E.y,L=Y(E),M=X(E),N=E.style,P=E.cellOverflowLayout,S=N.font?r(N.font,p):q,N.font=S.font,L>0&&M>0&&(F=N.cellType||u,J--,K--,L++,M++,o?W.sparkline=E.sparkline:(R=d?0:k.mJ(H,I,c),W.visualState=R),T=m(S.font),W.lineHeight=T,W.row=H+h,W.col=I+i,W.fontInfo=S,W.cellOverflowLayout=P,W.needTopGridline=1===c&&H===y||0===c,W.needLeftGridline=2===c&&I===x||0===c,W.isPrinting=d,F.paint(a,G,J,K,L,M,N,W,O),P&&!W.showBarIconOnly&&(Z=new f.Rect(J,K,L,M),$=F.Ama?F.Ama(a,Z,N,W):Z,U.push({cellType:F,data:G,x:$.x,y:$.y,width:$.width,height:$.height,style:N,richText:Q,options:{sheet:l,row:H,col:I,fontInfo:S,lineHeight:T,cellOverflowLayout:P,parentBackColor:w,imageLoader:z}})));if(D=U.length,D>0)for(_=l.isEditing(),aa=l.Jl,ba=l.Kl,B=0;B<D;B++)V=U[B],G=V.data,W=V.options,_&&W.row===aa&&W.col===ba||(ca=j(this.kj),ca&&G&&"SparklineExValue"===G.typeName||k.BWa(a,V));for(a.restore(),D=b.length,A=0;A<D;A++)E=b[A],e.Worksheet.ao(l,"paintCell",{ctx:a,sheetArea:c,cell:E,isPrinting:d})},a.prototype.BWa=function(a,b){var c,d,e=b.cellType,g=b.data,h=b.x,i=b.y,j=Y(b),k=X(b),l=b.style,m=b.options,n=m.cellOverflowLayout;n&&e.uxb&&(c=n.layout,d=new f.Rect(c?c.x:h,c?c.y:i,c?c.width:j,c?c.height:k),e.uxb(a,d,m,g)),e.paintValue&&e.paintValue(a,g,h,i,j,k,l,m)},a.prototype.mJ=function(a,b,c){var d=this.kj,e=0;return fa(d)&&(3===c||o(c)?!d.isEditing()&&d.wt(a,b)?e=3:d.vp(a,b,c)&&(e=2):(d.vp(a,b,c)&&(e=1,d.wp(a,b,c)&&(e=2)),d.xt(a,b,c)&&(e=4))),e},a.prototype.hJ=function(a,b,c,d){var e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=this.kj,y=x.ss,z=c.length,A=[],B={},C=[],D=function(v){var w,z,D,E,F,G,H,I,J,K,L,M,N,O,P;if(e=c[v],i=e.row,j=e.col,k=e.y,m=X(e),r=b.nJ(i,a),s=r.headingOverflowlayouts,t=r.trailingOverflowLayouts,!B[i]){for(w={},z=0,D=r;z<D.length;z++)E=D[z],w[E.column]=!1;s&&s.forEach(function(a){w[a.column]=!1}),t&&t.forEach(function(a){w[a.column]=!1}),B[i]=w}for(F=B[i],u=r.find(j),G=0;G<u.length;G++)H=u[G],H&&(I=x.getCellRect(i,H.column),F[H.column]||(J=H.column,h=y.Ym(i,J),g=x.getValue(i,J,3,1),l=H.columnWidth,n=H.backgroundWidth,o=H.backgroundLeftWidth<0?I.x:H.backgroundRightWidth<0?I.x+Y(I)-n:I.x+Y(I)/2-H.backgroundLeftWidth,q={data:g,row:i,col:J,x:I.x,y:k,width:l,height:m,cellOverflowLayout:H,style:h},A.push(q),H.layout=new f.Rect(o,k,n,m),h=y.Ym(i,J),d.gF(i,J,H,h,I.x,k,l,m),F[H.column]=!0),H.column===j&&F[H.column]&&C.push(v));if(s)for(K=0;K<s.length;K++)L=s[K],L&&!F[L.column]&&L.contains(e.col)&&(j=L.column,h=y.Ym(i,j),g=x.getValue(i,j,3,1),l=L.columnWidth,n=L.backgroundWidth,M=x.getCellRect(i,L.endColumn),o=M.x+Y(M)-n,q={data:g,row:i,col:j,x:o,y:k,width:l,height:m,style:h,cellOverflowLayout:L},A.push(q),L.layout=new f.Rect(o,k,n,m),F[L.column]=!0,d.gF(i,j,L,h,o,k,l,m));if(t)for(N=0;N<t.length;N++)O=t[N],O&&!F[O.column]&&O.contains(e.col)&&(j=O.column,h=y.Ym(i,j),g=x.getValue(i,j,3,1),l=O.columnWidth,n=O.backgroundWidth,P=x.getCellRect(i,O.startColumn),o=P.x,p=P.x+n-l,q={data:g,row:i,col:j,x:p,y:k,width:l,height:m,style:h,cellOverflowLayout:O},A.push(q),O.layout=new f.Rect(o,k,n,m),d.gF(i,j,O,h,o,k,l,m),F[O.column]=!0)};for(v=0;v<z;v++)D(v);if(C.length>0)for(w=C.length-1;w>=0;w--)c.splice(C[w],1);function E(a,b){var c=a.row,d=b.row,e=a.col,f=b.col;return c!==d?c-d:e!==f?e-f:void 0}return A.length>0&&A.sort(E),A},a}(),b.oJ=K,L=".cutCopyIndicator",M=f.Events.CellChanged,N=f.Events.ClipboardChanged,O=f.Events.ValueChanged,P=f.Events.ColumnChanged,Q=f.Events.RowChanged,R=f.Events.RangeChanged,S=f.Events.ClipboardPasting,T=f.Events.ClipboardPasted,U=f.Events.DragMerging,V=f.Events.FloatingElementSelected,W=function(){function a(a){var b=this;b.yJ=!1,b.zJ=!1,b.kj=a,b.AJ()}return a.prototype.jx=function(a){var b=this;return 0===arguments.length?b.zJ:void(b.zJ=a)},a.prototype.BJ=function(a){var b,c=this;return 0===arguments.length?c.yJ:void((c.yJ!==a||a)&&(c.yJ=a,b=c.kj,b&&b.$p()))},a.prototype.AJ=function(){var a=this,b=a.kj,c=!1,d="resizable",e="isVisible";function g(){a.BJ(!1)}function h(a,b){a!==d&&a!==b&&a!==e&&g()}b.Fu(N+L,function(){a.BJ(!0)}),b.Fu(O+L,g),b.Fu(M+L,g),b.Fu(P+L,function(a,b){h(b.propertyName,"width")}),b.Fu(Q+L,function(a,b){h(b.propertyName,"height")}),b.Fu(R+L,g),b.Fu(S+L,function(){c=a.BJ()}),b.Fu(T+L,function(b,d){var e,f,g,h=d.cellRange,i=d.sheet.tu(),j=i.n5,k=c;if(h&&j&&i.PA){if(a.jx()){for(e=0,f=j;e<f.length;e++)if(g=f[e],g.intersect(h.row,h.col,h.rowCount,h.colCount)){k=!1;break}}else k=!1;a.BJ(k)}}),b.Fu(U+L,g),b.Fu(V+L,function(a,c){"worksheet"!==c.type&&(b.endEdit(),f.Vl.kmb(b))})},a.prototype.UI=function(a,b,c,d){var e,g,h,i,j,k,l,m,n,p,q,r,t,u=this;if(u.yJ&&(e=u.kj,g=e.yl,h=e.parent,i=h?h.options:{},j=e.tu(),k=j.n5,l=i.cutCopyIndicatorVisible,o(l)&&(l=!0),m=f.Rm.Om(e,i.cutCopyIndicatorBorderColor||"blue"),l&&j.PA===e&&k&&(n=g.VI(c,d,s),p=g.XI(c,d,k,b),p&&n))){for(a.save(),a.rect(n.x,n.y,Y(n),X(n)),a.clip(),q=0,r=p;q<r.length;q++)t=r[q],g.fJ(a,t,m);a.beginPath(),a.restore()}},a.prototype.rI=function(){this.BJ(!1)},a.prototype.sI=function(){this.BJ(!1)},a.prototype.tI=function(){this.BJ(!1)},a.prototype.uI=function(){this.BJ(!1);
},a.prototype.ky=function(){this.BJ(!1)},a.prototype.no=function(){var a=this.kj;a.Gu(M+L),a.Gu(N+L),a.Gu(O+L),a.Gu(P+L),a.Gu(Q+L),a.Gu(R+L),a.Gu(S+L),a.Gu(T+L),a.Gu(U+L),a.Gu(V+L)},a}(),b.CJ=W,e.Worksheet.$n("render",{init:function(){var a=this;a.yl=new K(a),a.at=new W(a)},dispose:function(a){var b,c=this;a.clearCache!==!1&&(c.yl=s,b=c.at,b&&(b.no(),c.at=s))},onLayoutChanged:function(a){var b,c=this,d=c.at;d&&(b=a.changeType,"addRows"===b?d.rI():"deleteRows"===b?d.sI():"addColumns"===b?d.tI():"deleteColumns"===b&&d.uI())}})},"./dist/core/worksheet/worksheet-selection.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/worksheet/worksheet.js"),e=c("./dist/core/util/common.js"),f=c("Common"),g=c("./dist/core/util/domUtil.js"),h=c("./dist/core/core.enum.js"),i=f.Common.j.Fa,j=f.Common.k.ac,k=null,l=Math.max,m=Math.min,n="gc-selection";function o(a,b){return a.getColumnCount(b)}function p(a,b){return a.getRowCount(b)}function q(a){return a.rowCount}function r(a){return a.colCount}function s(a,b,c){var d,e,f=[],g=a.length;for(e=0;e<g;e++)d=a[e],e===b?f=f.concat(c):f.push(d);return f}function t(a,b,c){for(var d=c-1;d>=0;d--)if(a.getColumnVisible(b+d))return b+d;return b+c-1}function u(a,b,c){for(var d=c-1;d>=0;d--)if(a.getRowVisible(b+d))return b+d;return b+c-1}g.GC$.extend(d.Worksheet.prototype,{addSelection:function(a,b,c,d){var f,g,h=this,i=a,k=b,l=c,m=d;i!==-1&&k!==-1&&(f=h.ITa.getSpans(),f&&j(f)>0&&(g=h.su(f,e.kf(a,b,c,d)),i=g.row,k=g.col,l=q(g),m=r(g))),h.ITa.do("addSelection",i,k,l,m),h.$p()},setSelection:function(a,b,c,d){this.DJ(a,b,c,d,2)},DJ:function(a,b,c,d,f){var g,h,i,j=this,k=p(j),m=o(j);a>=k&&(a=k-1),b>=m&&(b=m-1),g=l(0,a),h=l(0,b),j.Tr(),i=2===f?e.Vl.Wl(j):1===f,j.Kr(g,h,j.Er(g),j.Fr(h),!i),j.addSelection(a,b,c,d)},getSelections:function(){return this.ITa.getSelections()},clearSelection:function(){var a=this;a.Tr(),a.Kr(0,0),d.Worksheet.ao(a,"clearSelection"),a.$p()},Tr:function(){this.ITa.do("clearSelection")},Qs:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this,q=n.options,r=q.protectionOptions,s=r.allowSelectLockedCells!==!1,t=r.allowSelectUnlockedCells!==!1;if(!q.isProtected||s&&t)return!0;if(!s&&!t)return!1;if(d=c?c.locked:n.tq(a,b,"locked"),e=b<0,f=a<0,s===d&&(f||e)){for(g=f?p(n):1,a=f?0:a,h=e?o(n):1,b=e?0:b,i=n.ITa,j=a+g-1,k=b+h-1,l=void 0,m=void 0,l=a;l<=j;l++)for(m=b;m<=k;m++)if(c=i.getStyle(l,m),c&&s!==c.locked)return!1;if(f)for(l=a;l<=j;l++)if(c=i.getStyle(l,-1),c&&s!==c.locked)return!1;if(e)for(m=b;m<=k;m++)if(c=i.getStyle(-1,m),c&&s!==c.locked)return!1}return s===d},SZa:function(a,b,c,d){var e,f,g=this;for(a=a<0?0:a,b=b<0?0:b,e=a;e<a+c;e++)for(f=b;f<b+d;f++)if(g.tq(e,f,"locked"))return!0},ZZa:function(){var a,b=this.getSelections();for(a=0;a<b.length;a++)if(b[a].col!==-1)return!1;return!0},$Za:function(){var a,b=this.getSelections();for(a=0;a<b.length;a++)if(b[a].row!==-1)return!1;return!0},selectionPolicy:function(a){var b=this,c=b.ITa;return 0===arguments.length?c.getSelectionPolicy():(c.do("setSelectionPolicy",a),b)},selectionUnit:function(a){var b=this,c=b.ITa;return 0===arguments.length?c.getSelectionUnit():(c.do("setSelectionUnit",a),b)},getSelectionBackColor:function(){return this.options.selectionBackColor||e.Im.Lm(n).backgroundColor},getSelectionBorderColor:function(){return this.options.selectionBorderColor||e.Im.Lm(n).borderTopColor},m_a:function(a){return a?void(this.options.m_a=a):this.options.m_a},EJ:function(){var a,b,c=this,d=c.ITa.getSelections();j(d)>0&&(a={selections:d},b=c.ITa.getActiveSelectedRangeIndex(),0!==b&&(a.activeSelectedRangeIndex=b),c.FJ=a,c.Tr(),c.yl.im())},GJ:function(){var a=this,b=a.FJ,c=b&&b.selections;c&&(a.ITa.do("setSelections",c),a.ITa.do("setActiveSelectedRangeIndex",b.activeSelectedRangeIndex||0))},Ax:function(a,b,c){var d,e,f,g=this,h=g.HJ(a,b,c,g.Rr||0);h&&(d=h.row,e=h.col,f=h.leadingCellCol,g.IJ(d,e)&&(g.Qr=d,g.Rr=f,g.Jr(d,e)))},HJ:function(a,b,c,d){var e,f,g=this,h=p(g),j=o(g),l=a;return 0===l&&!c||0===h||0===j?k:(f=g.JJ(l,d),c||g.KJ(f),l=f.r,e=f.c,l<0&&c&&(e=g.br(e),(e<0||i(e))&&(e=g.br(j)),d=e,f=g.JJ(h,e),l=f.r,e=f.c,e===b&&l<=a)?k:{row:l,col:e,leadingCellCol:d})},Bx:function(a,b,c){var d,e,f,g=this,h=g.LJ(a,b,c,g.Rr||0);!h||h.row===a&&h.col===b||(d=h.row,e=h.col,f=h.leadingCellCol,g.IJ(d,e)&&(g.Qr=d,g.Rr=f,g.Jr(d,e)))},LJ:function(a,b,c,d){var e,f,g=this,h=p(g),j=o(g),k=a;if((k!==h-1||c)&&0!==h&&0!==j&&(f=g.MJ(k,d),c||g.KJ(f),k=f.r,e=f.c,!(k===h&&c&&(e=g.Zq(e),(e>=j||i(e))&&(e=g.Zq(-1)),d=e,f=g.MJ(-1,e),k=f.r,e=f.c,e===b&&k>=a))))return{row:k,col:e,leadingCellCol:d}},Dx:function(){var a,b,c=this,d=c.NJ();d&&(a=d.row,b=d.col,c.Qr=a,c.Rr=b,c.Jr(a,b))},NJ:function(){var a,b,c,d,e,f=this,g=f.ir(),h=f.dr(),i=h;if(!g&&!i)return k;if(a=f.options,b=a.protectionOptions,c=b.allowSelectLockedCells!==!1,d=b.allowSelectUnlockedCells!==!1,!a.isProtected||c&&d)return{row:g,col:i};if(!c&&!d)return k;for(;g!==k&&g>=0;g=f.gr(g))for(i=h;i!==k&&i>=0;i=f.br(i))if(e=f.tq(g,i,"locked"),c===e)return{row:g,col:i};return k},Cx:function(){var a,b,c=this,d=c.OJ();d&&(a=d.row,b=d.col,c.Qr=a,c.Rr=b,c.Jr(a,b))},OJ:function(){var a,b,c,d,e,f=this,g=f._q(f.frozenRowCount()-1),h=f.Zq(f.frozenColumnCount()-1),i=h,j=f.ir(),l=f.dr();if(g===k||i===k)return k;if(a=f.options,b=a.protectionOptions,c=b.allowSelectLockedCells!==!1,d=b.allowSelectUnlockedCells!==!1,!a.isProtected||c&&d)return{row:g,col:i};if(!c&&!d)return k;for(;g!==k&&g<=j;g=f._q(g))for(i=h;i!==k&&i<=l;i=f.Zq(i))if(e=f.tq(g,i,"locked"),c===e)return{row:g,col:i};return k},zx:function(a,b,c){var d,e,f,g,h=this,i=h.tables;c?(d=i&&i.iIb(a,b),d||(d=h.iy(a,b,c,h.Qr||0))):d=h.iy(a,b,c,h.Qr||0),d&&(e=d.row,f=d.col,g=d.leadingCellRow,h.IJ(e,f)&&(h.Qr=g,h.Rr=f,h.Jr(e,f)))},iy:function(a,b,c,d){var e,f,g,h=this,j=p(h),l=o(h),m=b;if(0===m&&!c||0===j||0===l)return k;for(f=h.PJ(d,m),g=d,c||h.KJ(f),e=f.r,m=f.c;m<0&&c;){if(e=h.gr(e,3,!0),(e<0||i(e))&&(e=h.gr(j,3,!0)),d=e,f=h.PJ(d,l),e=f.r,m=f.c,e===a&&m<b)return k;if(e===a&&m===b){if(d===g)return k;f=h.PJ(d,m),e=f.r,m=f.c}}return{row:e,col:m,leadingCellRow:d}},KJ:function(a){var b,c=this,d=!1;a.r<0?a.r=c.ar():a.r>=p(c)&&(a.r=c.ir(),d=!0),a.c<0?a.c=c.$q():a.c>=o(c)&&(a.c=c.dr(),d=!0),d&&(b=c.ITa.getSpan(a.r,a.c),b.row!==a.r&&(a.r=b.row),b.col!==a.c&&(a.c=b.col))},Fx:function(a,b){for(var c,d,e=this,f=e.ITa,g=f.getActiveSelectedRangeIndex(),h=-1,i=e.Tq(e.Ix()),j=i.row,k=i.col,l=i.col+r(i)-1,m=a,n=b;;){if(c=e.QJ(m,n),m=c.r,n=c.c,n>=k)break;if(h===g&&m===a&&n<=b)return;m--,m>=j?n=l+1:(d=e.Tq(e.Ix(3)),h=f.getActiveSelectedRangeIndex(),j=d.row,k=d.col,l=d.col+r(d)-1,m=d.row+q(d)-1,n=d.col+r(d))}m>=0&&(e.Jr(m,n),e.Qr=m,e.Rr=n)},Gx:function(a,b){for(var c,d,e=this,f=e.ITa,g=f.getActiveSelectedRangeIndex(),h=-1,i=e.Tq(e.Ix()),j=i.col,k=i.row+q(i)-1,l=i.col+r(i)-1,m=a,n=b;;){if(c=e.RJ(m,n),m=c.r,n=c.c,n<=l)break;if(h===g&&m===a&&n>=b)return;m++,m<=k?n=j-1:(d=e.Tq(e.Ix(4)),h=f.getActiveSelectedRangeIndex(),j=d.col,k=d.row+q(d)-1,l=d.col+r(d)-1,m=d.row,n=d.col-1)}m>=0&&(e.Jr(m,n),e.Qr=m,e.Rr=n)},Rs:function(a,b,c){var d,e,f,g,h=this,i=h.tables;c?(d=i&&i.jIb(a,b),d||(d=h.hy(a,b,c,h.Qr||0))):d=h.hy(a,b,c,h.Qr||0),!d||d.row===a&&d.col===b||(e=d.row,f=d.col,g=d.leadingCellRow,h.IJ(e,f)&&(h.Qr=g,h.Rr=f,h.Jr(e,f)))},hy:function(a,b,c,d){var e,f,g,h=this,j=p(h),l=o(h),m=b;if(m===l-1&&!c||0===j||0===l)return k;for(f=h.SJ(d,m),g=d,c||h.KJ(f),e=f.r,m=f.c;m===l&&c;){if(e=h._q(e,3,!0),(e>=j||i(e))&&(e=h._q(-1,3,!0)),d=e,f=h.SJ(d,-1),e=f.r,m=f.c,e===a&&m>b)return k;if(e===a&&m===b){if(d===g)return k;f=h.SJ(d,m),e=f.r,m=f.c}}return{row:e,col:m,leadingCellRow:d}},PJ:function(a,b){for(var c,d,f,g=this,h=b;h>=0&&(c=a,h--,!(h<0));)if(d=g.getSpans(e.kf(c,h,1,1)),d&&j(d)>0&&(f=d[0],h>=f.col&&(h=f.col,c=f.row)),g.IJ(c,h))return{r:c,c:h};return{r:c,c:h}},QJ:function(a,b){for(var c,d,e=this;b>=0&&(b--,!(b<0));){if(c=e.ITa.findSpan(a,b)){if(d=e.Ix(),!(d.row<=c.row&&c.row+q(c)<=d.row+q(d)&&d.col<=c.col&&c.col+r(c)<=d.col+r(d)))continue;if(c.row!==a||c.col!==b)continue;b>=c.col&&(b=c.col,a=c.row)}if(e.IJ(a,b))return{r:a,c:b}}return{r:a,c:b}},SJ:function(a,b){for(var c,d,f,g,h=this,i=o(h),k=b;k<i&&(c=a,d=h.ITa.getSpan(c,k),k+=r(d),!(k>=i));)if(f=h.getSpans(e.kf(c,k,1,1)),f&&j(f)>0&&(g=f[0],k>g.col?k=l(k,g.col+r(g)):c=g.row),h.IJ(c,k))return{r:c,c:k};return{r:c,c:k}},RJ:function(a,b){for(var c,d,e,f=this,g=f.ITa,h=o(f);b<h&&(c=g.getSpan(a,b),b=c.col+r(c),!(b>=h));){if(d=g.findSpan(a,b)){if(e=f.Ix(),!(e.row<=d.row&&d.row+q(d)<=e.row+q(e)&&e.col<=d.col&&d.col+r(d)<=e.col+r(e)))continue;if(d.row!==a||d.col!==b)continue;b>d.col?b=l(b,d.col+r(d)):a=d.row}if(f.IJ(a,b))return{r:a,c:b}}return{r:a,c:b}},IJ:function(a,b){var c,d,e,f=this;return!!f.Qs(a,b)&&(c=a>=0&&a<p(f)&&b>=0&&b<o(f)&&f.getRowVisible(a)&&f.getColumnVisible(b)&&f.Sl(a)>0&&f.Tl(b)>0,d=!!f.Tx,c===!0&&d===!0&&(e=f.tq(a,b,"tabStop"),e===!1&&(c=!1)),c)},JJ:function(a,b){for(var c,d,f=this;a>=0&&(a--,!(a<0));)if(c=f.getSpans(e.kf(a,b,1,1)),c&&j(c)>0&&(d=c[0],a>=d.row&&(a=d.row,b=d.col)),f.IJ(a,b))return{r:a,c:b};return{r:a,c:b}},MJ:function(a,b){for(var c,d,f,g=this,h=p(g);a<h&&(c=g.ITa.getSpan(a,b),a+=q(c),!(a>=h));)if(d=g.getSpans(e.kf(a,b,1,1)),d&&j(d)>0&&(f=d[0],a>f.row?a=l(a,f.row+q(f)):b=f.col),g.IJ(a,b))return{r:a,c:b};return{r:a,c:b}},Ur:function(a,b,c,d,e){var f=this;f.ITa.do("addSelection",a,b,c,d),e&&f.Xq<=0&&f.yl.im()},aH:function(a,b,c){var d=this,e=d.Jx(a,b,d.Jl,d.Kl),f=e.row,g=e.col,h=q(e),i=r(e),j=d.selectionPolicy(),k=d.selectionUnit();0!==j&&(1===j&&d.ITa.do("clearSelection"),1===k?(g=-1,i=-1):2===k&&(f=-1,h=-1),d.Kx(f,g,h,i,c))},Jx:function(a,b,c,d,f){var g,h,k,l,m,n=this;return i(c)&&(c=n.Jl),i(d)&&(d=n.Kl),g=n.ITa,h=g.getSpan(c,d),k=g.getSpan(a,b),f&&h.equals(k)?new e.Range(h.row,h.col,1,1):(l=h.union(k),m=n.getSpans(),m&&j(m)>0&&(l=n.TJ(m,l)),l)},Kx:function(a,b,c,d,f){var g,h,i,k,l,m,n=this,o=n.ITa,p=n.Ix();if(j(o.getSelections())>0?(h=e.kf(a,b,c,d),n.n_a?(g=n.p_a,n.p_a=h):(i=o.getSelections(),i[o.getActiveSelectedRangeIndex()]=h,o.do("setSelections",i))):n.n_a||o.do("addSelection",a,b,c,d),f&&n.Xq<=0){if(k=n.Ix(),!n.n_a&&k.row===p.row&&k.col===p.col&&q(k)===q(p)&&r(k)===r(p))return;l=n.yl,n.n_a&&(m=n.p_a,g&&g.containsRange(m)?m=g:g&&(m=g.union(m)),m=m.union(e.kf(n.getActiveRowIndex(),n.getActiveColumnIndex(),1,1)),p=m.union(p),k=m.union(k)),p.containsRange(k)?l.im(p):k.containsRange(p)?l.im(k):(l.im(p),l.im(k),l.im(n.p_a))}},kyb:function(a){var b=[];return a&&(b=this.ITa.getSpans(a)),b},lyb:function(a,b){var c=a.row,d=a.col,e=a.rowCount,f=a.colCount,g=b.row,h=b.col,i=b.rowCount,j=b.colCount,k=c+e,l=d+f,m=g+i,n=h+j,o=!1,p=!1,q;return a.intersect(g,h,i,j)&&(q=c>g||d>h||k<m||l<n,o=q,p=!q),b.myb=b.myb||p,o},nyb:function(a,b,c,d){var e,f=[],g=[];for(e=0;e<a.length;e++)g=this.oyb(a[e],b,c,d),f=f.concat(g);return f},oyb:function(a,b,c,d){var e,f,g,h,i,j=[],k=b.length;for(j.push(a),h=k-1;h>=0;h--)for(f=b[h],i=0;i<j.length;)e=j[i],this.lyb(e,f)?(g=this.v_a(e,f,c,d),j=s(j,i,g),i+=g.length):i++;return j},pyb:function(a,b){var c=b.row,d=b.col,e=b.rowCount,f=b.colCount;return a.intersect(c,d,e,f)},qyb:function(a,b){var c,d,e=a.length,f=[];for(d=e-1;d>=0;d--)c=a[d],this.pyb(c,b)||f.push(c);return f},ryb:function(a){var b=!1,c=this.getSpans(a);return 1===c.length&&(b=a.equals(c[0])),b},syb:function(a,b){var c,d,e,f,g=a,h=b.length,i=g.length,j=!0;for(e=h-1;e>=0;e--){for(d=b[e],f=i-1;f>=0;f--)if(c=g[f],c.equals(d)){j=!1;break}j&&g.push(d)}return g},tyb:function(a){var b,c,d,e,f=a.length,g=[];for(c=f-1;c>=0;c--)b=a[c],b.myb&&(delete b.myb,g.push(c));for(d=g.length,e=0;e<d;e++)a.splice(g[e],1)},v_a:function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s;return b=this.Tq(b),f=[],g=a.getIntersect(b,c,d),a&&g?(h=a.row>=0?a.row:0,i=a.col>=0?a.col:0,j=a.rowCount,k=a.colCount,l=g.row,m=g.col,n=g.rowCount,o=g.colCount,p=h+j,q=i+k,r=l+n,s=m+o,p-r>0&&f.push(e.kf(r,i,p-r,k)),q-s>0&&f.push(e.kf(l,s,n,q-s)),m-i>0&&f.push(e.kf(l,i,n,m-i)),l-h>0&&f.push(e.kf(h,i,l-h,k))):f.push(a),f},u_a:function(a,b){var c,d,e,f,g,h,i,k,l,m,n,o=[],p=this.getRowCount(3),q=this.getColumnCount(3);if(a&&a.length>0){for(d=a.length,e=[],f=[],g=[],h=void 0,i=void 0,c=!1,k=d-1;k>=0;k--)h=a[k],!this.ryb(h)||this.pyb(h,b)?(e=this.v_a(h,b,p,q),i=this.kyb(h),i.length>0&&(e=this.nyb(e,i,p,q),g=this.qyb(i,b),f=this.syb(f,g),this.tyb(f)),l=j(e),!c&&l>0&&(this.setSelection(e[l-1].row,e[l-1].col,1,1),c=!0),o=e.concat(o)):f=this.syb(f,[h]);o=f.concat(o)}for(this.Tr(),m=o.length,this.suspendPaint(),n=0;n<m;n++)this.addSelection(o[n].row,o[n].col,o[n].rowCount,o[n].colCount);c||this.setActiveCell(this.Jl,this.Kl),this.resumePaint()},Sx:function(a,b){var c,d,e,f,g,h,i,k,l,m=this,n=m.ITa.getSelections();if(!(j(n)<=0)&&(c=m.Ix(),d=m.UJ(c,a,b))){if(e=d.row,f=d.col,g=q(d),h=r(d),i=m.selectionPolicy(),k=m.selectionUnit(),0===i)return;1===i&&m.ITa.do("clearSelection"),1===k?(f=-1,h=-1):2===k&&(e=-1,g=-1),m.Kx(e,f,g,h,!0),l=m.ITa.getSelections(),m.mm.zu(n,l)&&(m.yu(n,l),m.Au(n))}},UJ:function(a,b,c,d,e){var f=this,g=f.Tq(a),h=k;return 37===b?h=c?f.VJ(g,!1,d,e):f.WJ(g,d,e):39===b?h=c?f.XJ(g,!1,d,e):f.YJ(g,d,e):38===b?h=c?f.ZJ(g,!1,d,e):f.$J(g,d,e):40===b?h=c?f._J(g,!1,d,e):f.aK(g,d,e):36===b?h=c?f.bK(g,d,e):f.cK(g,d,e):35===b?h=c?f.dK(g,d,e):f.eK(g,d,e):33===b?h=f.fK(g,d,e):34===b&&(h=f.gK(g,d,e)),h&&(a.row<0&&(h.row=-1,h.rowCount=f.getRowCount()),a.col<0&&(h.col=-1,h.colCount=f.getColumnCount())),h},WJ:function(a,b,c){for(var d,f,g,h,i,j,n,o,p,s,t=this,v=a.row,w=a.col,x=q(a),y=r(a),z=w+y-1,A=0,B=u(t,v,x);z>A;)if(z--,t.IJ(B,z)&&(d=t.Jx(B,z,b,c),f=m(v,d.row),g=m(w,d.col),h=l(v+x-1,d.row+q(d)-1),i=m(w+y-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,f!==v||g!==w||j!==x||n!==y))return o=t.qq,p=t.Kl,w<p?g<=o&&t.rq(g):w===p&&i<=o&&t.rq(i),s=t.parent&&t.parent.options.scrollByPixel,s&&g===o&&0!==t.eCb&&t.rq(g,0),e.kf(f,g,j,n);return k},VJ:function(a,b,c,d){var f,g,h,j,k,n,o,p=this,s=a.row,t=a.col,u=p.frozenColumnCount(),v=u?p.Zq(u-1):p.$q(),w=b?v:p.$q();if(!i(w))return(u<=0||b)&&p.rq(w),f=p.Jx(s,w,c,d),g=m(s,f.row),h=m(t,f.col),j=l(s+q(a)-1,f.row+q(f)-1),k=m(t+r(a)-1,f.col+r(f)-1),n=j-g+1,o=k-h+1,e.kf(g,h,n,o)},lCb:function(a){var b,c,d,e,f,g=this,h=g.parent&&g.parent.options.scrollByPixel;if(h){for(d=g.ss,e=g.Fr(a),f=g.getViewportWidth(e);0<=a&&(f-=d._m(a),!(f<0));a--);b=a,c=f}else b=g.ks(a,2),c=0;return{dj:b,UP:c}},YJ:function(a,b,c){for(var d,f,g,h,i,j,n,p,s,t,v=this,w=a.row,x=a.col,y=q(a),z=r(a),A=x,B=o(v)-1,C=u(v,w,y);A<B;)if(A++,v.IJ(C,A)&&(d=v.Jx(C,A,b,c),f=m(w,d.row),g=l(x,d.col),h=l(w+y-1,d.row+q(d)-1),i=l(x+z-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,f!==w||g!==x||j!==y||n!==z))return p=v.Aw(),s=v.Kl,x<s?g>=p&&(t=v.lCb(g),v.rq(t.dj,t.UP)):x===s&&i>=p&&(t=v.lCb(i),v.rq(t.dj,t.UP)),e.kf(f,g,j,n);return k},XJ:function(a,b,c,d){var f,g,h,j,k,n,o,p,s=this,t=a.row,u=a.col,v=s.lr();if(!i(v))return s.rq(v),f=s.dr(),b||(f+=s.frozenTrailingColumnCount()),g=s.Jx(t,f,c,d),h=m(t,g.row),j=l(u,g.col),k=l(t+q(a)-1,g.row+q(g)-1),n=l(u+r(a)-1,g.col+r(g)-1),o=k-h+1,p=n-j+1,e.kf(h,j,o,p)},$J:function(a,b,c){for(var d,f,g,h,i,j,n,o,p,s,u=this,v=a.row,w=a.col,x=q(a),y=r(a),z=v+x-1,A=0,B=t(u,w,y);z>A;)if(z--,u.IJ(z,B)&&(d=u.Jx(z,B,b,c),f=m(v,d.row),g=m(w,d.col),h=m(v+x-1,d.row+q(d)-1),i=l(w+y-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,f!==v||g!==w||j!==x||n!==y))return o=u.lq,p=u.Jl,v<p?f<=o&&u.mq(f):v===p&&h<=o&&u.mq(h),s=u.parent&&u.parent.options.scrollByPixel,s&&f===o&&0!==u.cCb&&u.mq(f,0),e.kf(f,g,j,n);return k},ZJ:function(a,b,c,d){var f,g,h,j,k,n,o,p=this,s=a.row,t=a.col,u=p.frozenRowCount(),v=u?p._q(u-1):p.ar(),w=b?v:p.ar();if(!i(w))return(u<=0||b)&&p.mq(w),f=p.Jx(w,t,c,d),g=m(s,f.row),h=m(t,f.col),j=m(s+q(a)-1,f.row+q(f)-1),k=l(t+r(a)-1,f.col+r(f)-1),n=j-g+1,o=k-h+1,e.kf(g,h,n,o)},mCb:function(a){var b,c,d,e,f,g=this,h=g.parent&&g.parent.options.scrollByPixel;if(h){for(d=g.ss,e=g.Er(a),f=g.getViewportHeight(e);0<=a&&(f-=d.Sl(a),!(f<0));a--);b=a,c=f}else b=g.ms(a,2),c=0;return{cj:b,UP:c}},aK:function(a,b,c){for(var d,f,g,h,i,j,n,o,s,u,v=this,w=a.row,x=a.col,y=q(a),z=r(a),A=w,B=p(v)-1,C=t(v,x,z);A<B;)if(A++,v.IJ(A,C)&&(d=v.Jx(A,C,b,c),f=l(w,d.row),g=m(x,d.col),h=l(w+y-1,d.row+q(d)-1),i=l(x+z-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,f!==w||g!==x||j!==y||n!==z))return o=v.Fw(),s=v.Jl,w<s?f>=o&&(u=v.mCb(f),v.mq(u.cj,u.UP)):w===s&&h>=o&&(u=v.mCb(h),v.mq(u.cj,u.UP)),e.kf(f,g,j,n);return k},_J:function(a,b,c,d){var f,g,h,j,k,n,o,p,s=this,t=a.row,u=a.col,v=s.kr();if(!i(v))return s.mq(v),f=s.ir(),b||(f+=s.frozenTrailingRowCount()),g=s.Jx(f,u,c,d),h=l(t,g.row),j=m(u,g.col),k=l(t+q(a)-1,g.row+q(g)-1),n=l(u+r(a)-1,g.col+r(g)-1),o=k-h+1,p=n-j+1,e.kf(h,j,o,p)},cK:function(a,b,c){for(var d,f,g,h,i,j,n,o=this,p=a.row,s=a.col,t=q(a),u=r(a),v=o.frozenColumnCount()-1,w=o.Kl,x=p+t-1;v<w;)if(v++,o.IJ(x,v)){if(s<=v&&s+u-1===o.Kl)break;return d=o.Jx(x,v,b,c),f=m(p,d.row),g=m(s,d.col),h=l(p+t-1,d.row+q(d)-1),i=m(s+u-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,o.rq(o.$q()),e.kf(f,g,j,n)}return k},bK:function(a,b,c){return a=this.VJ(a,!0,b,c),a=this.ZJ(a,!0,b,c)},eK:function(a,b,c){for(var d,f,g,h,i,j,n,p=this,s=a.row,t=a.col,u=q(a),v=r(a),w=o(p),x=p.Kl,y=s+u-1;w>x;)if(w--,p.IJ(y,w)){if(t+v-1>=w&&t===p.Kl)break;return d=p.Jx(y,w,b,c),f=m(s,d.row),g=l(t,d.col),h=l(s+u-1,d.row+q(d)-1),i=l(t+v-1,d.col+r(d)-1),j=h-f+1,n=i-g+1,p.rq(p.lr()),e.kf(f,g,j,n)}return k},dK:function(a,b,c){return a=this.XJ(a,!0,b,c),a=this._J(a,!0,b,c)},fK:function(a,b,c){var d,f,g,h,n,o,p,s,t,u,v=this,w=a.row,x=a.col,y=q(a),z=v.Ew();return i(z)?k:(d=v.Gr(1),f=v.mq(z),g=-1,f?g=v._q(w+y-1-j(d)):v.frozenRowCount()<=0&&(g=v.ar()),g<v.lq?g=v.lq:g>=v.Fw()&&(g=v.gr(v.Fw())),h=v.Jx(g,x,b,c),n=m(w,h.row),o=m(x,h.col),p=m(w+y-1,h.row+q(h)-1),s=l(x+r(a)-1,h.col+r(h)-1),t=p-n+1,u=s-o+1,e.kf(n,o,t,u))},gK:function(a,b,c){var d,f,g,h,n,o,p,s,t,u=this,v=a.row,w=a.col,x=q(a),y=u.$x();return i(y)?k:(d=u.Gr(1),u.mq(y),f=u.gr(v+x-1+j(d)),f<u.lq?f=u.lq:f>=u.Fw()&&(f=u.lq>=u.kr()?u.Fw():u.gr(u.Fw())),g=u.Jx(f,w,b,c),h=l(v,g.row),n=m(w,g.col),o=l(v+x-1,g.row+q(g)-1),p=l(w+r(a)-1,g.col+r(g)-1),s=o-h+1,t=p-n+1,e.kf(h,n,s,t))},Ew:function(){var a,b,c,d,e,f=this,g=f.Gr(1);if(!g||j(g)<=0)return k;for(a=f.frozenRowCount(),b=a?f._q(a-1):f.ar(),c=0,d=f.lq,e=f.am();d>b&&(d--,c+=f.Sl(d),!(c>e.jr)););return d},zw:function(){var a,b,c,d,e,f=this,g=f.Hr(1);if(!g||j(g)<=0)return k;for(a=f.frozenColumnCount(),b=a?f.Zq(a-1):f.$q(),c=0,d=f.qq,e=f.am();d>b&&(d--,c+=f.Tl(d),!(c>e.er)););return d},$x:function(){var a,b=this.Gr(1),c=j(b);return b&&c>0?(a=b[c-1].row,this.ir()<=a?this.lq:a):k},kr:function(){var a,b,c,d,e,f,g=this;if(g.ir()===g.Fw()&&(a=g.am(),b=g.Gr(1),c=j(b),b&&c>=1&&(d=b[c-1],d.y+d.height<=a.qt+a.jr)))return g.lq;e=g.lq;try{return g.lq=g.ir(),f=g.Ew(),f=g._q(f)}catch(a){}finally{g.lq=e}},lr:function(){var a,b,c,d,e,f,g=this;if(g.dr()===g.Aw()&&(a=g.am(),b=g.Hr(1),c=j(b),b&&c>=1&&(d=b[c-1],d.x+d.width<=a.pt+a.width)))return g.qq;for(a=g.am(),e=0,f=g.dr();f>0&&(e+=g.Tl(f),!(e>a.er));)f--;return f>0&&(f=g.Zq(f)),f},Fw:function(){var a=this.Gr(1),b=j(a);return a&&b>0?a[b-1].row:k},Aw:function(){var a=this.Hr(1),b=j(a);return a&&b>0?a[b-1].col:k},hr:function(){var a,b,c=this.Gr(1),d=j(c);return c&&d>0?(a=this.am(),b=d-1,c[b].y+c[b].height<=a.qt+a.jr?c[b].row:c[l(b-1,0)].row):k},cr:function(){var a,b,c=this.Hr(1),d=j(c);return c&&d>0?(a=this.am(),b=d-1,c[b].x+c[b].width<=a.pt+a.er?c[b].col:c[l(b-1,0)].col):k},ir:function(a){i(a)&&(a=3);var b=p(this,a);return 3!==a&&2!==a||(b-=this.frozenTrailingRowCount()),this.gr(b,a)},dr:function(a){i(a)&&(a=3);var b=o(this,a);return 3!==a&&1!==a||(b-=this.frozenTrailingColumnCount()),this.br(b,a)},TJ:function(a,b){var c,d,e;if(a)for(c=0,d=j(a);c<d;c++)if(e=a[c],b.intersect(e.row,e.col,q(e),r(e)))return a.splice(c,1),c--,this.TJ(a,b.union(e));return b},Ix:function(a){var b,c=this,d=c.ITa,f=j(d.getSelections()),g=e.kf(-1,-1,0,0);return f<=0?g:(b=d.getActiveSelectedRangeIndex(),3===a?(b--,b<0&&(b=f-1),d.do("setActiveSelectedRangeIndex",b)):4===a&&(b++,b>=f&&(b=0),d.do("setActiveSelectedRangeIndex",b)),b=d.getActiveSelectedRangeIndex(),b>=0&&(g=d.getSelections()[b]),g)}}),d.Worksheet.$n("selection",{init:function(){this.ITa.do("addSelection",0,0,1,1),this.ITa.setCellState(0,0,h.CellStatesType.active,!0,h.SheetArea.viewport)}})},"./dist/core/worksheet/worksheet-sort.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n;Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./dist/core/util/domUtil.js"),f=c("./dist/core/util/common.js"),g=c("./dist/core/worksheet/worksheet.js"),h=c("CalcEngine"),i=!!h,j=d.Common.l.Ra,k=d.Common.j.Fa,l="boolean",m="string",n="number";function o(a,b,c){for(var d=a[c-b];d<c;)d=a[d-b];return d}function p(a){return d.Common.pc.bc(d.Common.pc.ec(a))}function q(a,b){return a instanceof Date&&b instanceof Date?j(a)===j(b):typeof a===m&&typeof b===m?a.toLowerCase()===b.toLowerCase():a===b}function r(a,b,c,d){var e,f,g;return k(a)||(f=d?a.backColor:a.foreColor,k(f)||(f=p(f))),k(b)||(g=d?b.backColor:b.foreColor,k(g)||(g=p(g))),f=f||"",g=g||"",e=f===g?0:f===c?1:g===c?-1:0}function s(a,b){var c,d,e,f,g;return a instanceof Date&&(a=j(a)),b instanceof Date&&(b=j(b)),c=typeof a,d=typeof b,e=c===m,f=d===m,g=d===n,c===d||c!==n&&!g?!(c!==l||!f)||(!e||d!==l)&&(e&&f?a.toLowerCase()>b.toLowerCase():a>b):g}function t(a,b,c,d,e,f){var g,h,i,j,l,m,o,p,t,u,v,w,x,y,z=e,A=a,B=b;if(z)for(h=0;h<z.length&&(z[h]&&(i=z[h].ascending,j=z[h].index,0<=j&&(l=void 0,m=void 0,o=d?A:j,p=d?j:A,t=d?B:j,u=d?j:B,f?(l=f[o][p],m=f[t][u]):(l=c.getValue(o,p),m=c.getValue(t,u)),k(z[h].color)?(x=k(l)||""===l||typeof l===n&&isNaN(l),y=k(m)||""===m||typeof m===n&&isNaN(m),x||y?x&&y?g=0:x&&!y?g=1:!x&&y&&(g=-1):g=q(l,m)?0:s(l,m)?i?1:-1:i?-1:1):(v=void 0,w=void 0,v=c.getActualStyle(o,p,3,!1,!1,!0),w=c.getActualStyle(t,u,3,!1,!1,!0),g=r(v,w,z[h].color,z[h].isBackColor),i||(g*=-1)))),0===g);h++);return g}function u(a,b,c,d,e){var f,g,h,i,j,k,l,m=a.length;if(m<=1)return a;for(f=Math.floor(m/2),g=a[f],h=[],i=[],j=[],k=0;k<m;k++)l=t(a[k],g,b,c,d,e),l<0?h.push(a[k]):l>0?i.push(a[k]):j.push(a[k]);return u(h,b,c,d,e).concat(j,u(i,b,c,d,e))}function v(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q=f?d:e,r=f?b:c,s=[];for(i=0;i<q;i++)s[i]=r+i;if(f)for(k=[],j=s.length-1;j>=0;j--)l=s[j],a.Ps&&a.Ps(l)&&(s.splice(j,1),k.push({mi:j,Qb:l}));for(m=s.concat([]),n=!1,s=u(s,a,f,g,h),o=0;o<s.length;o++)if(s[o]!==m[o]){n=!0;break}if(f)for(j=k.length-1;j>=0;j--)p=k[j],s.splice(p.mi,0,p.Qb);return{array:s,isChanged:n}}function w(a,b,c){var d=a.qg(b,c,!1);d&&d.hasListeners()&&d.Yg()}function x(a,b,d,e){var f,g,h=c("SheetsCalc");h&&(f=h.CalcOperatorAdjustor.zj(a.xf,a.xf,a.Kf(b,d),b,d,0,0),a.Rf(b,d,f,e),g=a.qg(b,d,!!f),g&&g.og())}e.GC$.extend(g.Worksheet.prototype,{sortRange:function(a,b,c,d,e,h,j){var k,l,m,n,p,q,r,s,t,u,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y=this,Z=Y.getRowCount(),$=Y.getColumnCount();if(!i||Y.Vq(a,0,c,$,!1)){if(m=Y.getSpans(new f.Range(a,b,c,d)),m&&m.length>0)return!1;if(n=Y.tables,n&&(p=n.s$(a,b,c,d),q=1===p.length&&p[0].dataRange().equals(f.kf(a,b,c,d)),!(p.length<=0||q)))return!1;if(r=Y.wq,s=r&&r.Ou||q&&p[0]&&p[0].LZ(),a===-1&&(a=0),c===-1&&(c=Z),b===-1&&(b=0),d===-1&&(d=$),a<0||a>=Z||b<0||b>=$||c<0||a+c>Z||d<0||b+d>$||!h)return!1;Y.suspendPaint(),Y.suspendEvent(),i&&Y.suspendCalcService();try{if(k=[],s)for(l=[],t=a;t<a+c;t++)for(l[t]=[],u=b;u<b+d;u++)l[t][u]=Y.getValue(t,u);if(y=void 0,z=void 0,j?y=j:(z=v(Y,a,b,c,d,e,h,l),y=z.array),y){for(A=Y.ITa.WTa,A>0&&z.isChanged&&(Y.ITa.WTa=0,[].push.apply(Y.ITa.zTa,[{row:a,column:b,rowCount:c,columnCount:d,byRows:e,sortInfo:h,type:"sortRange",array:y.concat([])}])),B=void 0,C=void 0,D=void 0,E=void 0,F=void 0,G=void 0,H=void 0,I=void 0,J=Y.ITa,K=i&&Y.Bj(),L=i&&Y.yj(),M=J.Ky,N=void 0,O=M&&M.sV.length>0,P=void 0,Q=e?a:b,R=e?a+c:b+d,S=void 0,T=e?b:a,U=e?b+d:a+c,P=Q;P<R;P++)if(N=o(y,Q,P),P!==N)for(e?(B=P,D=N):(C=P,E=N),S=T;S<U;S++)e?(C=S,E=S):(B=S,D=S),s&&(F=l[B][C],G=l[D][E]),O&&(H=M.get(B,C),I=M.get(D,E)),K&&L&&(w(K,B,C),w(K,D,E),K._f(B,C,D,E),x(K,B,C),x(K,D,E)),J.do("swapNode",B,C,D,E),Y.uja&&Y.wja(B,C,D,E),O&&M.qUa(H,B,C,I,D,E),s&&(l[B][C]=G,l[D][E]=F),k.push({row:B,col:C}),k.push({row:D,col:E});if(s){for(t=a;t<a+c;t++)for(u=b;u<b+d;u++)Y.setValue(t,u,l[t][u]);l=null}if(K){for(V=a;V<a+c;V++)for(W=b;W<b+d;W++)X=K.Kf(V,W),X&&K.fg(V,W,X,void 0);Y.getCalcService().recalcRange(L,a,b,c,d)}return g.Worksheet.ao(Y,"sortRangeChanged",{column:b,columnCount:d}),A>0&&(Y.ITa.WTa=A),!0}return!1}finally{i&&Y.resumeCalcService(!1),Y.resumeEvent(),Y.resumePaint(),Y.Bu(a,b,c,d,k,4)}}},hK:function(){var a=this.options;return!a.isProtected||a.protectionOptions.allowSort},wja:function(a,b,c,d){var e=this,f=e.getDataValidator(a,b),g=e.getDataValidator(c,d);e.setDataValidator(a,b,g),e.setDataValidator(c,d,f)}})},"./dist/core/worksheet/worksheet-static.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("./dist/core/util/common.js"),f=c("Common"),g=c("CalcEngine"),h=!!g,i=c("./dist/core/util/domUtil.js"),j=f.Common.j.Fa,k=i.GC$.each,l=null,m=void 0,n=Math.min,o=Math.max,p=new f.Common.ResourceManager(d.SR),q=p.getResource.bind(p);function r(a,b){return a.getRowCount(b)}function s(a,b){return a.getColumnCount(b)}function t(a,b,c){return a.$r(b,c)}function u(a,b,c){return a.Yr(b,c)}function v(a,b,c,d){a.setColumnWidth(b,c,d)}function w(a,b,c,d){a.setRowHeight(b,c,d)}function x(a,b,c,d){return a.getActualStyle(b,c,d)}function y(a,b){return a.getDefaultStyle(b)}function z(a,b,c){a.setDefaultStyle(b,c)}function A(a,b,c,d,e){a.Pq(b,c,d,e)}function B(a,b,c,d){throw Error(f.Common.u.Kb(q().Exp_InvalidAndSpace,[a,b,c,d]))}function C(a,b,c){return b&&c.Ps&&c.Ps(a)}function D(a,b,c,d,e,f,g,h,i){var j,k,l,m,o,p,t,u;if(!a)throw Error(q().Exp_SrcIsNull);if(!d)throw Error(q().Exp_DestIsNull);j=r(a),k=s(a),l=r(d),m=s(d),(b<-1||b>=j)&&B("from row index",b,"-1",j-1),(c<-1||c>=k)&&B("from column index",c,"-1",k-1),(e<-1||e>=l)&&B("to row index",e,"-1",l-1),(f<-1||f>=m)&&B("to column index",f,"-1",m-1),o=c,c<0&&(o=0,h=k),p=f<0?0:f,(h<1||o+h>k||p+h>m)&&B("column count",h,"1",n(k-o,m-p)),t=b,b<0&&(t=0,g=j),u=e<0?0:e,(g<1||t+g>j||u+g>l)&&B("row count",g,"1",n(j-t,l-u))}function E(a){if(!a)return a;if("number"==typeof a||"string"==typeof a||"boolean"==typeof a||j(a))return a;if(a.clone)return a.clone();if(a instanceof Date)return new Date(a.valueOf());var b,c,d;b=a instanceof Object?new a.constructor:new a.constructor(a.valueOf());for(c in a)a.hasOwnProperty(c)&&(d=a[c],a.hasOwnProperty(c)&&b[c]!==d&&("object"==typeof d?b[c]=E(d):b[c]=d));return b.toString=a.toString,b.valueOf=a.valueOf,b}function F(a,b,c,d,f,g,h,i,j){var k,l,n,o,p,q,r,s,t,u,v=a.getSpans(m,j),w=d.getSpans(m,j),x=[];if(v)for(k=0;k<v.length;k++)l=v[k],n=l.row,o=l.col,p=l.rowCount,q=l.colCount,b===-1?c<=o&&o+q<=c+i&&x.push(e.kf(n,g+o-c,p,q)):c===-1?b<=n&&n+p<=b+h&&x.push(e.kf(f+n-b,o,p,q)):b<=n&&n<b+h&&c<=o&&o<c+i&&x.push(e.kf(f+n-b,g+o-c,p,q));if(w)for(k=0;k<w.length;k++)l=w[k],n=l.row,o=l.col,r=void 0,s=o>=g&&o<g+i,t=n>=f&&n<f+h,r=b===-1?s:c===-1?t:t&&s,r&&(u=d.findSpan(n,o,j),u&&u.row===n&&u.col===o&&d.do("removeSpan",u,j));for(k=0;k<x.length;k++)d.do("addSpan",x[k],j)}function G(a,b,c,d,e,f,g,h,i){var j,k=a.conditionalFormats,l=d.conditionalFormats,m=V(a,d);k&&l&&!a.kIb&&(j=k.XA(b,c,l,e,f,g,h,m),i&&k.YA(b,c,g,h,j,m))}function H(a,b,c,d,e,f,g,h,i){var j,k;b<0&&(b=0,g=n(r(a),r(d))),e<0&&(e=0),c<0&&(c=0,h=n(s(a),s(d))),f<0&&(f=0),j=!(a===d&&a.name()===d.name()),j?(k=d.ZA,k&&(i?a.ZA.count()>0&&k.$A(a,b,c,e,f,g,h):k._A(a,b,c,e,f,g,h))):(k=a.ZA,k&&(i?k.count()>0&&k.aB(b,c,e,f,g,h):k.Zz(b,c,e,f,g,h)))}function I(a,b,c,d,e,f){var g,h,i;b<0&&(b=0,e=n(s(a),s(c))),d<0&&(d=0),g=a.columnOutlines,h=c.columnOutlines,i=!(a===c&&a.name()===c.name()),i?g&&h&&h.bB(g,b,d,e,f):g&&g.cB(b,d,e,f)}function J(a,b,c,d,e,f){var g,h,i;b<0&&(b=0,e=n(r(a),r(c))),d<0&&(d=0),g=!(a===c&&a.name()===c.name()),h=a.rowOutlines,i=c.rowOutlines,g?h&&i&&i.bB(h,b,d,e,f):h&&h.cB(b,d,e,f)}function K(a,b,c,d,e,f,g,h,i,j){var k=!(a===d&&a.name()===d.name()),l=a.ITa,m=l.zl(j);k?(F(l,b,c,d.ITa,e,f,g,h,j),i&&m&&l.do("clearSpan",b,c,g,h,j)):i?l.do("moveSpan",b,c,e,f,g,h,j):l.do("copySpan",b,c,e,f,g,h,j)}function L(a,b,c,d,e,f,g,h,i){var j=b,k=c;j<0&&(j=0,g=n(r(a),r(d))),e<0&&(e=0),k<0&&(k=0,h=n(s(a),s(d))),f<0&&(f=0),b<0&&K(a,-1,k,d,-1,f,-1,h,i,1),c<0&&K(a,j,-1,d,e,-1,g,-1,i,2),K(a,j,k,d,e,f,g,h,i)}function M(a,b,c,d,e,f,g){var h,i,k,o,p,q,y,z,B;for(b<0&&(b=0,e=n(s(a),s(c))),d<0&&(d=0),h=1,i=0;i<e;i++)(64&f)>0&&(k=t(a,i+b),j(k)||(g&&v(a,i+b,a.defaults.colWidth),v(c,i+d,k)),o=a.getColumnVisible(i+b),j(o)||(g&&a.setColumnVisible(i+b,!0),c.setColumnVisible(i+d,o)),p=x(a,-1,i+b),p?(A(c,-1,i+d,p.clone()),g&&A(a,-1,i+b,l)):A(c,-1,i+d,l),p=x(a,-1,i+b,h),p?(A(c,-1,i+d,p.clone(),h),g&&A(a,-1,i+b,l,h)):A(c,-1,i+d,l,h)),(128&f)>0&&(q=a.getTag(-1,i+b),j(q)||(g&&a.setTag(-1,i+b,m),c.setTag(-1,i+d,q)));for(y=n(r(a,h),r(c,h)),z=0;z<y;z++)B=u(a,z,h),j(B)||(g&&w(a,z,a.defaults.colHeaderRowHeight,h),w(c,z,B,h))}function N(a,b,c,d,e,f,g,h){var i,k,o,p,q,y,z,B,D;for(b<0&&(b=0,e=n(r(a),r(c))),d<0&&(d=0),i=2,k=0;k<e;k++)!h&&C(d+k,g,c)||((64&f)>0&&(o=u(a,k+b),j(o)||(h&&w(a,k+b,a.defaults.rowHeight),w(c,k+d,o)),p=a.getRowVisible(k+b),j(p)||(h&&a.setRowVisible(k+b,!0),c.setRowVisible(k+d,p)),q=x(a,k+b,-1),q?(A(c,k+d,-1,q.clone()),h&&A(a,k+b,-1,l)):A(c,k+d,-1,l),q=x(a,k+b,-1,i),q?(A(c,k+d,-1,q.clone(),i),h&&A(a,k+b,-1,l,i)):A(c,k+d,-1,l,i)),(128&f)>0&&(y=a.getTag(k+b,-1),j(y)||(h&&a.setTag(k+b,-1,m),c.setTag(k+d,-1,y))));for(z=n(s(a,i),s(c,i)),B=0;B<z;B++)D=t(a,B,i),j(D)||(h&&v(a,B,a.defaults.rowHeaderColWidth,i),v(c,B,D,i))}function O(a,b,c,d){var e,f,g;a===b&&a.name()===b.name()||((64&c)>0&&(e=y(a),z(b,d?e:e.clone()),e=y(a,1),z(b,d?e:e.clone(),1),e=y(a,2),z(b,d?e:e.clone(),2),d&&(z(a,l),z(a,l,1),z(a,l,2))),f=b.defaults,g=a.defaults,f.colWidth=g.colWidth,f.rowHeight=g.rowHeight,f.rowHeaderColWidth=g.rowHeaderColWidth,f.colHeaderRowHeight=g.colHeaderRowHeight,d&&(g.colWidth=62,g.rowHeight=20,g.rowHeaderColWidth=40,g.colHeaderRowHeight=20))}function P(a,b,c,d,f,g,h,i,k,l,m,o){var p,q,t,u,v,w,x,y,z,A,B,D,F,G,H,I,J=!(a===d&&a.name()===d.name());if(2===(2&l)&&b<0)if(x=c,y=g,p=n(r(a,1),r(d,1)),q=i,c<0&&(x=0,q=s(a)),g<0&&(y=0),J)for(t=0;t<p;t++)for(u=0;u<q;u++)w=m(a,t,x+u,1),o(d,t,y+u,E(w),1);else{for(v=new e.KTa,t=0;t<p;t++)for(u=0;u<q;u++)w=m(a,t,x+u,1),j(w)||v.set(t,u,E(w));for(t=0;t<p;t++)for(u=0;u<q;u++)o(d,t,y+u,v.get(t,u),1)}if(1===(1&l)&&c<0)if(z=b,A=f,p=h,q=n(s(a,2),s(d,2)),b<0&&(z=0,p=r(a)),f<0&&(A=0),J)for(t=0;t<p;t++)for(u=0;u<q;u++)w=m(a,z+t,u,2),o(d,A+t,u,E(w),2);else{for(v=new e.KTa,t=0;t<p;t++)for(u=0;u<q;u++)w=m(a,z+t,u,2),j(w)||v.set(t,u,E(w));for(t=0;t<p;t++)for(u=0;u<q;u++)o(d,A+t,u,v.get(t,u),2)}if(B=b,D=c,F=f,G=g,H=h,I=i,b<0&&(B=0,H=n(r(a),r(d))),c<0&&(D=0,I=n(s(a),s(d))),f<0&&(F=0),g<0&&(G=0),J){for(t=0;t<H;t++)if(!C(F+t,k,d))for(u=0;u<I;u++)w=m(a,B+t,D+u,3),o(d,F+t,G+u,E(w),3)}else{v=new e.KTa;try{for(t=0;t<H;t++)for(u=0;u<I;u++)w=m(a,B+t,D+u,3),j(w)||v.set(t,u,E(w));for(t=0;t<H;t++)if(!C(F+t,k,d))for(u=0;u<I;u++)o(d,F+t,G+u,v.get(t,u),3)}catch(a){}}}function Q(a){return[a.row,a.col].join(",")}function R(a,b,c,d,f,g,h,i,k,m,n,o){var p;n&&(p=e.kf(b,c,h,i)),P(a,b,c,d,f,g,h,i,k,m,function(a,b,c,d){var e,f,g,h,i,k,m,q,s=3===d,t=a.ITa,u={};return s?(f=(n||o)&&t.getDynamicArrayInfo(b,c),f&&f.isValid?(e=l,n&&(g=Q(f),u[g]||(u[g]=f,h=f.row,i=f.col,p.contains(h,i,1,1)&&t.XTa(3).NHb(f)))):e=a.getValue(b,c,d,1)):(e=t.getValue(b,c,d,!0,1),1===d&&j(e)&&(k=a.wq,k&&k.Ou&&(m=t.Jp(!1,3,c),q=a.options.colHeaderAutoTextIndex,m&&(q>=0&&b===q||q===-1&&b===r(a,d)-1)&&(e=m.displayName||m.name)))),n&&(s?a.uq(b,c,l,d,!1):a.ITa.do("setValue",b,c,l,d,!0,!0)),e},function(a,b,c,d,e){j(d)?a.uq(b,c,l,e,!1):a.uq(b,c,d,e,!1)})}function S(a,b,c){var d,e,f,g=a.Tq(b),h=g.row,i=g.col,j=g.rowCount,k=g.colCount;for(d=0;d<j;d++)for(e=c[h+d]=c[h+d]||{},f=0;f<k;f++)e[i+f]=!0}function T(a,b,c,d,f,g,h,i,k,n,o){var p,q,r,s,t,u,v={};if(a.tables)for(p=e.kf(b,c,h,i),q=e.kf(f,g,h,i),r=a.tables.all(),s=void 0,t=0,u=r.length;t<u;t++)s=r[t].range(),p.containsRange(s)?S(a,s,v):s.containsRange(p)&&s.containsRange(q)&&S(a,p,v);P(a,b,c,d,f,g,h,i,k,n,function(a,b,c,d){var e=(3===d||j(d))&&v[b]&&v[b][c],f=a.Dq(b,c,d,m,m,m,m,e);
return o&&A(a,b,c,l,d),f},function(a,b,c,d,e){A(a,b,c,d,e)})}function U(a,b,c,d,e,f,g,h,i,j){var k,m,n,o=a.uja.Dja;for(k in o)m=o[k],m&&(n=m.condition(),n&&n.initExpression());P(a,b,c,d,e,f,g,h,i,0,function(b,c,e){var f=b.getDataValidator(c,e,3);return f&&(j&&b.setDataValidator(c,e,l),V(a,d)&&(f.Nja=!0)),f},function(b,c,e,f){b.setDataValidator(c,e,f),V(a,d)&&f&&delete f.Nja})}function V(a,b){return a===b&&a.name()===b.name()}function W(a,b,c,d,e,f,g,h,i,j){P(a,b,c,d,e,f,g,h,i,0,function(a,b,c){var d=a.ITa.Ky,e=d&&d.get(b,c);return e&&j&&d.remove(b,c),e},function(a,b,c,d){var e=a.ITa.Ky;e&&e.Cz(b,c,d)})}function X(a,b,c,d,e,f,g,h,i,k,l){P(a,b,c,d,e,f,g,h,i,k,function(a,b,c,d){var e=a.getTag(b,c,d);return!j(e)&&l&&a.setTag(b,c,m),e},function(a,b,c,e,f){d.setTag(b,c,e,f)})}function Y(a,b,c,d,e,f,g,h,i,k,m){P(a,b,c,d,e,f,g,h,i,k,function(a,b,c){var d,e=a.ITa,f=e.getFormatString(b,c);return f&&(d=a.et.getFormulaByName(f)),!j(d)&&m&&a.nCb(b,c,l),d},function(a,b,c,e){j(e)||d.oCb(b,c,e)})}function Z(a,b,c,d,e,f,g,h,i,j){var k=[];return P(a,b,c,d,e,f,g,h,i,0,function(d,e,f){var g=d.getBindingPath&&d.getBindingPath(e,f);return g&&k.push({row:e-o(0,b),col:f-o(0,c),value:d.getValue(e,f)}),j&&a.setBindingPath&&a.setBindingPath(e,f,l),g},function(a,b,c,d){a.setBindingPath&&a.setBindingPath(b,c,d)}),k}function $(a,b,d,e,f,g,h,i){var j=c("SheetsCalc");j&&j.CalcOperatorAdjustor.moveFormula(a,b,d,e,f,g,h,i)}function _(a,b,d,e,f,g,h,i){var j,l,m,n,o,p,q,r,s,t=c("SheetsCalc");if(t){if(j=t.uyb,n=a.ITa.dUa(),!a.parent||!a.parent.sheets)return o=a.getCustomNames(),void(o&&k(o,function(c,k){l=k.getExpression(),m=j(a,a,b,d,e,f,g,h,i,l),m!==l&&k.fg(m,n)}));for(p=a.parent.sheets,q=a.parent.getCustomNames(),q&&k(q,function(c,k){l=k.getExpression(),m=j(null,a,b,d,e,f,g,h,i,l),m!==l&&k.fg(m,n)}),r=function(c){var o=p[c].getCustomNames();o&&k(o,function(k,o){l=o.getExpression(),m=j(p[c],a,b,d,e,f,g,h,i,l),m!==l&&o.fg(m,n)})},s=0;s<p.length;s++)r(s)}}function aa(a,b,d,f,g,j,k,m,p,q,t,u){var v,w,x,y,z,A,B,E,F,K,P,Q,S,V,aa,ba,ca,da,ea,fa;if(D(a,b,d,f,g,j,k,m,u),u&&b<0)for(w=d,x=m,d<0&&(w=0,x=n(s(a),s(f))),y=j,j<0&&(y=0),v=!0,z=0;z<x;z++)A=a.ITa.Jp(!1,3,w+z),B=a.ITa.Jp(!1,3,y+z),E=A&&A.name,F=B&&B.name,A&&B&&E&&F||(v=!1),B=i.GC$.extend(!0,{},f.ITa.Jp(!1,3,y+z)||{}),B.displayName=A&&A.displayName,B.name=A&&A.name,f.ITa.do("setItem",!1,3,y+z,B);(64&p)>0&&(T(a,b,d,f,g,j,k,m,q,t,u),a.kIb||a.uja&&U(a,b,d,f,g,j,k,m,q,u)),(512&p)>0&&G(a,b,d,f,g,j,k,m,u),(1&p)>0&&(2&p)>0&&(P=a.tables,P&&(K=P.dB(e.kf(o(0,b),o(0,d),b<0?n(r(a),r(f)):k,d<0?n(s(a),s(f)):m),u))),Q=h,Q&&(a.suspendCalcService(),f.suspendCalcService()),S=l,(256&p)>0&&(S=Z(a,b,d,f,g,j,k,m,q,u));try{if((1&p)>0&&!v&&(R(a,b,d,f,g,j,k,m,q,t,u,(2&p)>0),h&&0===(2&p)&&f.clearFormula(g,j,k,m,function(a,b){return!q||!a.Ps||!a.Ps(b)}),(256&p)>0))for(V=S.length,aa=g<0?0:g,ba=j<0?0:j,ca=0;ca<V;ca++)da=S[ca],!u&&C(aa+da.row,q,f)||f.setValue(aa+da.row,ba+da.col,da.value);ea=f.tables,(1&p)>0&&(2&p)>0&&ea&&ea.eB(K,o(0,b),o(0,d),o(0,g),o(0,j),u),h&&(u?(_(a,b,d,f,g,j,k,m),(2&p)>0&&$(a,b,d,f,g,j,k,m)):(2&p)>0&&(fa=c("SheetsCalc"),fa&&fa.vyb(a,b,d,f,g,j,k,m,q)),(1&p)>0&&(2&p)>0&&ea&&ea.R3(K))}finally{Q&&(a.resumeCalcService(!1),f.resumeCalcService(!1))}if((4&p)>0&&W(a,b,d,f,g,j,k,m,q,u),(128&p)>0&&X(a,b,d,f,g,j,k,m,q,t,u),(768&p)>0&&Y(a,b,d,f,g,j,k,m,q,t,u),(16&p)>0&&H(a,b,d,f,g,j,k,m,u),(8&p)>0&&(b<0&&I(a,d,f,j,m,u),d<0&&J(a,b,f,g,k,u)),(32&p)>0&&(u||1!==k||1!==m)&&L(a,b,d,f,g,j,k,m,u),b<0&&g<=0&&M(a,d,f,j,m,p,u),d<0&&j<=0&&N(a,b,f,g,k,p,q,u),b<0&&g<=0&&d<0&&j<=0&&O(a,f,p,u),u&&b<0)for(w=d,x=m,d<0&&(w=0,x=n(s(a),s(f))),z=0;z<x;z++)a.getDataColumnName&&a.getDataColumnName(w+z)&&a.ITa.do("setItem",!1,3,w+z,l)}b.staticMembers={copyTo:function(a,b,c,d,e,f,g,h,i,j,k){aa(a,b,c,d,e,f,g,h,i,j,k,!1)},moveTo:function(a,b,c,d,e,f,g,h,i){aa(a,b,c,d,e,f,g,h,i,m,3,!0)}}},"./dist/core/worksheet/worksheet-ui.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/worksheet/worksheet.js"),e=c("./dist/core/worksheet/style.js"),f=c("./dist/core/util/domUtil.js"),g=c("./dist/core/util/common.js"),h=c("Common"),i=c("CalcEngine"),j=!!i,k=g.util.tt,l=void 0,m=h.Common.j.Fa,n=d.Worksheet.prototype;function p(a,b){var c=a,d=b;return function(a){var b,e,f=this,g=f.sheet,h=f.row,i=f.col,j=f.sheetArea;if(0===arguments.length)return c.call(g,h,i,j);if(h>=0&&i>=0)for(b=h;b<h+f.rowCount;b++)for(e=i;e<i+f.colCount;e++)q(g,b,e,j)&&d.call(g,b,e,a,j);return f}}function q(a,b,c,d){var e=a.getRowCount(d),f=a.getColumnCount(d);return c<0&&0<=b&&b<e||b<0&&0<=c&&c<f||0<=b&&b<e&&0<=c&&c<f}function r(a,b,c,d,f,g){if(q(a,b,c,g)){var h=a.Iq(b,c,g);h||(h=new e.Style),"font"===d&&s(a,h,f),h[d]=f,a.setStyle(b,c,h,g)}}function s(a,b,c){var d,e,f,g,h;m(b.themeFont)||(d=k(),e=d.style,f=b.font,e.font=f,g=f&&e.fontFamily,e.font=c,h=c&&e.fontFamily,h!==g&&(b.themeFont=l))}o=function(){function a(a,b,c,d,e,f){var g=this;b<0&&(b=d=-1),c<0&&(c=e=-1),g.sheet=a,g.row=b,g.rowCount=m(d)?1:d,g.col=c,g.colCount=m(e)?1:e,g.sheetArea=m(f)?3:f}return a.prototype.tag=function(a){var b=this,c=b.sheet,d=b.row,e=b.col,f=b.rowCount,g=b.colCount,h=b.sheetArea,i,j;if(0===arguments.length)return c.getTag(d,e,h);if(d>=0&&e>=0)for(i=d;i<d+f;i++)for(j=e;j<e+g;j++)c.setTag(i,j,a,h);else if(d>=0)for(i=d;i<d+f;i++)c.setTag(i,-1,a,h);else if(e>=0)for(j=e;j<e+g;j++)c.setTag(-1,j,a,h);return b},a.prototype.width=function(a){var b,c=this,d=c.sheet,e=c.row,f=c.col,g=c.sheetArea;if(0!==arguments.length){if(e<0)for(b=0;b<c.colCount;b++)d.setColumnWidth(b+f,a,g);return c}if(e<0)return d.getColumnWidth(f,g)},a.prototype.height=function(a){var b,c=this,d=c.sheet,e=c.row,f=c.col,g=c.sheetArea;if(0!==arguments.length){if(f<0)for(b=0;b<c.rowCount;b++)d.setRowHeight(b+e,a,g);return c}if(f<0)return d.getRowHeight(e,g)},a.prototype.visible=function(a){var b,c,d=this,e=d.sheet,f=d.row,g=d.col,h=d.sheetArea;if(0!==arguments.length){if(g<0&&f>=0)for(b=0;b<d.rowCount;b++)e.setRowVisible(b+f,a,h);else if(g>=0&&f<0)for(c=0;c<d.colCount;c++)e.setColumnVisible(c+g,a,h);return d}return g<0&&f>=0?e.getRowVisible(f,h):g>=0&&f<0?e.getColumnVisible(g,h):void 0},a.prototype.resizable=function(a){var b,c,d=this,e=d.sheet,f=d.row,g=d.col,h=d.sheetArea;if(0!==arguments.length){if(g<0&&f>=0)for(b=0;b<d.rowCount;b++)e.setRowResizable(b+f,a,h);else if(g>=0&&f<0)for(c=0;c<d.colCount;c++)e.setColumnResizable(c+g,a,h);return d}return g<0&&f>=0?e.getRowResizable(f,h):g>=0&&f<0?e.getColumnResizable(g,h):void 0},a.prototype.tq=function(a){var b=this;return b.sheet.tq(b.row,b.col,a,b.sheetArea)},a.prototype._w=function(a,b){var c=this,d,e,f=c.sheet,g=c.row,h=c.col,i=c.rowCount,j=c.colCount,k=c.sheetArea;if(g>=0&&h>=0)for(d=g;d<g+i;d++)for(e=h;e<h+j;e++)r(f,d,e,a,b,k);else if(g>=0)for(e=-1,d=g;d<g+i;d++)r(f,d,e,a,b,k);else if(h>=0)for(d=-1,e=h;e<h+j;e++)r(f,d,e,a,b,k);return c},a.prototype.clear=function(a){var b=this;b.sheet.clear(b.row,b.col,b.rowCount,b.colCount,b.sheetArea,a)},a.prototype.setBorder=function(a,b){var c,d,e,f,h,i,j,k,l,m,n,o=this,p=o.sheet,q=o.sheetArea;p.suspendPaint();try{if(c=new g.Range(o.row,o.col,o.rowCount,o.colCount),d=p.Tq(c,q),e=d.row,f=d.col,h=d.rowCount,i=d.colCount,j=void 0,k=void 0,l=b.all,m=b.outline,n=b.inside,b.left||l||m)for(j=0;j<h;j++)p.getCell(e+j,f,q).borderLeft(a);if(b.top||l||m)for(k=0;k<i;k++)p.getCell(e,f+k,q).borderTop(a);if(b.right||l||m)for(j=0;j<h;j++)p.getCell(e+j,f+i-1,q).borderRight(a);if(b.bottom||l||m)for(k=0;k<i;k++)p.getCell(e+h-1,f+k,q).borderBottom(a);if(b.diagonalUp)for(j=0;j<h;j++)for(k=0;k<i;k++)p.getCell(e+j,f+k,q).diagonalUp(a);if(b.diagonalDown)for(j=0;j<h;j++)for(k=0;k<i;k++)p.getCell(e+j,f+k,q).diagonalDown(a);if(b.innerHorizontal||l||n)for(j=0;j<h-1;j++)for(k=0;k<i;k++)p.getCell(e+j,f+k,q).borderBottom(a),p.getCell(e+j+1,f+k,q).borderTop(a);if(b.innerVertical||l||n)for(k=0;k<i-1;k++)for(j=0;j<h;j++)p.getCell(e+j,f+k,q).borderRight(a),p.getCell(e+j,f+k+1,q).borderLeft(a)}finally{p.resumePaint()}},a.prototype.formatString=function(a){var b=this,c=b.sheet;return void 0===a?c.getCellFormatString(b.row,b.col):c.setCellFormatString(b.row,b.col,a)},a.Pl=p,a}(),b.CellRange=o,o.prototype.value=p(n.getValue,n.setValue),o.prototype.text=p(n.getText,n.setText),o.prototype.formula=p(function(a,b){return j&&this.getFormula(a,b)},function(a,b,c,d){j&&this.setFormula(a,b,c)}),o.prototype.styleName=p(n.getStyleName,n.setStyleName),f.GC$.each(["backColor","foreColor","hAlign","vAlign","themeFont","font","formatter","borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp","locked","textIndent","wordWrap","shrinkToFit","backgroundImage","backgroundImageLayout","cellType","tabStop","textDecoration","imeMode","watermark","cellPadding","labelOptions","quotePrefix","isVerticalText","cellButtons","dropDowns","textOrientation"],function(a,b){o.prototype[b]=function(a){return 0===arguments.length?this.tq(b):this._w(b,a)}}),f.GC$.extend(n,{getRange:function(a,b,c,d,e){return new o(this,a,b,c,d,e)},getCell:function(a,b,c){return m(b)&&(b=-1),new o(this,a,b,1,1,c)}})},"./dist/core/worksheet/worksheet.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da;Object.defineProperty(b,"__esModule",{value:!0}),d=c("./dist/core/core.ns.js"),e=c("./dist/core/util/common.js"),f=c("./dist/core/util/imageLoader.js"),g=c("./dist/core/worksheet/style.js"),h=c("./dist/core/worksheet/worksheet-model.js"),i=c("./dist/core/util/domUtil.js"),j=c("./dist/core/celltype/textcelltype.js"),k=c("./dist/core/celltype/headercelltype.js"),l=c("./dist/core/core.enum.js"),m=c("Common"),n=c("CalcEngine"),o=!!n,p=c("./dist/core/util/theme.js"),q=e.util.n0a,r=m.Common.j.Fa,s=e.util.Nl,t=e.util.Pl,u=e.util.Ql,v=e.util.bq,w=i.GC$.each,x=i.GC$.isEmptyObject,y=m.Common.D,z=e.util.x0a,A=e.util.w0a,B=RegExp("^\\d*(\\.\\d+)?\\*$"),C=document,D=parseInt,E=parseFloat,F=isNaN,G=null,H=void 0,I=Math.min,J=Math.max,K=Math.floor,L=Math.ceil,M="undefined",N="string",O="width",P="height",Q="black",R="tag",S="onLayoutChanged",T="onPaintSuspend",U="isVisible",V="starSize",W="resizable",X=".gcSheet",Y=".gcSheetInternal",Z={backColor:!0,foreColor:!0,font:!0,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:!0,textDecoration:!0,cellType:!0,formatter:!0},$=new m.Common.ResourceManager(d.SR),_=$.getResource.bind($);function ea(a,b){var c,d,e,f=[],g=a.ITa.hUa();if(g)for(c in g)y(g,c)&&(d=g[c],d&&d.rs===(b?"e":"n")&&(e={row:+c,item:a.getDataItem&&a.getDataItem(+c)},b&&(e.originalItem=d.originalItem),f.push(e)));return f}function fa(a,b,c){var d,e=0;for(d=b;d<=c;d++)e+=a._m(d);return e}function ga(a,b,c){var d,e=0;for(d=b;d<=c;d++)e+=a.Sl(d);return e}function ha(a){return a.getColumnCount()}function ia(a){return a.getRowCount()}function ja(a){return a.frozenTrailingColumnCount()}function ka(a){return a.frozenTrailingRowCount()}function la(a){return a.frozenColumnCount()}function ma(a){return a.frozenRowCount()}function na(a,b){var c=e.util.Pxb(a.font),d=e.util.Pxb(b.font);return c.fontStyle+" "+c.fontWeight+" "+d.fontSize+" "+d.fontFamily}function oa(a,b,c){Object.defineProperty(a,b,{get:function(){return this["_"+b]},set:function(a){var d=this["_"+b];d!==a&&(this["_"+b]=a,c&&c(b,a,d))}})}function pa(a,b,c,d){return{row:b,col:c,newValue:a.getValue(b,c),oldValue:d}}!function(a){a[a.setFormula=0]="setFormula",a[a.copyPaste=1]="copyPaste",a[a.dragFill=2]="dragFill",a[a.dragDrop=3]="dragDrop",a[a.changePartOfArrayFornula=4]="changePartOfArrayFornula",a[a.changeSheetName=5]="changeSheetName",a[a.table=6]="table"}(aa=b.InvalidType||(b.InvalidType={})),ba={rowHeaderVisible:!0,colHeaderVisible:!0,clipBoardOptions:0,frozenlineColor:Q,rowHeaderAutoText:1,colHeaderAutoText:2,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,sheetTabColor:G,selectionBackColor:G,selectionBorderColor:G,allowCellOverflow:!0,isProtected:!1,protectionOptions:{},gridline:{},sheetAreaOffset:{left:0,top:0}},ca=function(){function a(b){var c=this;c.yn=a.Np,a.Np++,c.options=u(ba,function(a,b,d){c.Op(a,b,d)}),c.ad(b)}return a.prototype.Op=function(b,c,d){var e,f,g,h,i=this,j=i.parent;switch(b){case"allowCellOverflow":case"colHeaderAutoText":case"colHeaderAutoTextIndex":case"colHeaderVisible":case"frozenlineColor":case"rowHeaderAutoText":case"rowHeaderAutoTextIndex":case"rowHeaderVisible":case"selectionBackColor":case"selectionBorderColor":i.$p();break;case"sheetAreaOffset":e=function(a,b){b<0&&(i.options.sheetAreaOffset[a]=0),i.$p()},f=i.options.sheetAreaOffset,["left","top"].forEach(function(a){var b=c[a];oa(f,a,e),f[a]=b});break;case"gridline":g=function(){i.$p()},h=i.options.gridline,["color","showHorizontalGridline","showVerticalGridline"].forEach(function(a){var b=c[a];oa(h,a,g),h[a]=b});break;case"isProtected":j&&j.undoManager().clear(),i._p(),a.ao(i,"onProtectChanged"),i.$p();break;case"protectionOptions":i._p(),a.ao(i,"onProtectChanged");break;case"sheetTabColor":j&&j.aq()}},a.prototype.name=function(a){var b=this,c=b.parent;if(0===arguments.length)return b.ITa?b.ITa.getName():"";if(!v(a,c?c.sheets:null,b))throw _().Exp_NotSupported;return b.cq(a),c&&c.aq(),b},a.prototype.cq=function(b,c){var d=this,e=d.name();c||a.ao(d,"beforeSetName",{oldName:e,newName:b}),this.ITa.do("setName",b),c||a.ao(d,"setName",{oldName:e,newName:b})},a.prototype.addRows=function(b,c,d){var e,f,g,h;if(!(c<=0)){e=this,f=ia(e),(b<0||b>f)&&(b=f),0===e.ITa.WTa&&e.parent&&e.parent.pv.clear(),e.suspendPaint();try{if(g={changeType:"addingRows",row:b,rowCount:c,canAdd:!0},a.ao(e,S,g),!g.canAdd)return;r(g.newRow)||(b=g.newRow),h="addRows",e.pCb(b,3,h,c,f),this.ITa.do("addRows",b,c),e.jq=!0,a.ao(e,S,{changeType:h,row:b,oldValue:f,rowCount:c,rowExpand:d}),a.ao(e,S,{changeType:"addRows2",row:b,oldValue:f,rowCount:c}),e.kq(b,3,h,c,f)}finally{e.resumePaint()}}},a.prototype.deleteRows=function(b,c){var d,e,f,g,h,i,j,k=this,l=ia(k);if(!(0>b||b>=l||c<=0)){0===k.ITa.WTa&&k.parent&&k.parent.pv.clear(),k.suspendPaint();try{if(d={changeType:"deletingRows",row:b,rowCount:c,canDelete:!0},a.ao(k,S,d),!d.canDelete)return;if(e="deleteRows",k.pCb(b,3,e,c,l),k.ITa.do("deleteRows",b,c),f=k.lq,f>=0){for(g=-1,h=ma(k),i=f;i>=h;i--)if(k.getRowVisible(i)&&k.Sl(i)>0){g=i;break}g===-1&&(g=0),f!==g&&k.mq(g)}j=l,k.getActiveRowIndex()>=j&&k.setActiveCell(j-1,k.getActiveColumnIndex()),k.jq=!0,a.ao(k,S,{changeType:e,row:b,oldValue:l,rowCount:c}),k.kq(b,3,e,c,l)}finally{k.resumePaint()}}},a.prototype.addColumns=function(b,c){var d,e,f,g;c<=0||(d=this,e=ha(d),(b<0||b>e)&&(b=e),0===d.ITa.WTa&&d.parent&&d.parent.pv.clear(),f={changeType:"addingColumns",col:b,colCount:c,canAdd:!0},a.ao(d,S,f),f.canAdd&&(g="addColumns",d.qCb(b,3,g,c,e),d.ITa.do("addColumns",b,c),d.oq=!0,a.ao(d,S,{changeType:g,col:b,oldValue:e,colCount:c}),d.pq(b,3,g,c,e),d.$p()))},a.prototype.deleteColumns=function(b,c){var d,e,f,g,h,i,j,k=this,l=ha(k);if(!(0>b||b>=l||c<=0)&&(0===k.ITa.WTa&&k.parent&&k.parent.pv.clear(),d={changeType:"deletingColumns",col:b,colCount:c,canDelete:!0},a.ao(k,S,d),d.canDelete)){if(e="deleteColumns",k.qCb(b,3,e,c,l),k.ITa.do("deleteColumns",b,c),f=k.qq,f>=0){for(g=-1,h=la(k),i=f;i>=h;i--)if(k.getColumnVisible(i)&&k.Tl(i)>0){g=i;break}g===-1&&(g=0),f!==g&&k.rq(g)}j=l,k.getActiveColumnIndex()>=j&&k.setActiveCell(k.getActiveRowIndex(),j-1),k.oq=!0,a.ao(k,S,{changeType:e,col:b,oldValue:l,colCount:c}),k.pq(b,3,e,c,l),k.$p()}},a.prototype.getRowCount=function(a){return 0===a?0:this.ITa.getRowCount(a)},a.prototype.getColumnCount=function(a){return 0===a?0:this.ITa.getColumnCount(a)},a.prototype.setRowCount=function(b,c){var d,e;r(c)&&(c=3),d=this,e={changeType:"settingRowCount",rowCount:b,sheetArea:c,canSet:!0},a.ao(d,S,e),e.canSet&&d.setRowCountCore(b,c)},a.prototype.setRowCountCore=function(b,c){var d,e;b=D(b,10),F(b)||(r(c)&&(c=3),d=this,e=d.getRowCount(c),b<0||b===e||(3===c||2===c?(d.ITa.do("setRowCount",b,c),ma(d)>b&&d.frozenRowCount(b)):1===c&&d.ITa.do("setRowCount",b,c),a.ao(d,S,{changeType:"setRowCount",rowCount:b,sheetArea:c}),d.jq=!0,d.Jl>=b&&(3===c||2===c)&&d.setActiveCell(b-1,d.getActiveColumnIndex()),d.$p(),d.clearPendingChanges()))},a.prototype.setColumnCount=function(b,c){var d,e;b=D(b,10),F(b)||(d=this,e=d.getColumnCount(c),b<0||b===e||(r(c)&&(c=3),3===c||1===c?(d.ITa.do("setColumnCount",b,c),la(d)>b&&d.frozenColumnCount(b)):2===c&&d.ITa.do("setColumnCount",b,c),a.ao(d,S,{changeType:"setColumnCount",colCount:b,sheetArea:c}),d.oq=!0,d.Kl>=b&&(3===c||1===c)&&d.setActiveCell(d.getActiveRowIndex(),b-1),d.$p(),d.clearPendingChanges()))},a.prototype.aHb=function(a,b,d){var e,f,g,h,i,j,k,l,m,n=this,o=n.getCell(a,b,d),p=n.ITa,q=p.getFormatString(a,b);if(q&&(f=c("SheetsCalc"),g=f.rangeToFormula(o,0,0,0),h=n.et.getFormulaByName(q),void 0!==h&&null!==h)){if(i=q.substring(q.indexOf("#")+1,q.lastIndexOf("#")),""!==i){for(j=i.split(/-/),k=h.split(""),l=0;l<j.length;l++)m=D(j[l],10),k[m]=g;h=k.join("")}e=f.evaluateFormula(n,h,0,0,!1)}return e},a.prototype.getText=function(a,b,c){var d,e,f,g,h,i;return r(c)&&(c=3),d=this,e=d.getValue(a,b,c),f=d.getCellType(a,b,c),g=d.tq(a,b,"formatter",c),g||(g=d.tq(a,b,"_autoFormatter",c)),h={},i=d.tq(a,b,"quotePrefix",c),e=f.format(e,g,h,{sheet:d,row:a,col:b,sheetArea:c,quotePrefix:i}),e&&"string"==typeof e&&(e=e.replace(/\r\n?/g,"\n")),e},a.prototype.setText=function(b,c,d,e){var f,g,h,i,j,k,l=this;r(e)&&(e=3),f=d,g={value:d},a.ao(l,"settingText",g),d=g.value,h=d,i=l.getCellType(b,c,e),j=l.getFormatter&&l.getFormatter(b,c,e),i&&j&&(k={sheet:l,row:b,col:c,sheetArea:e},h=i.parse(f,j,k),h=r(h)?d:h),l.uq(b,c,h,e),l.$p()},a.prototype.getValue=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q;return 0===c?G:(r(c)&&(c=3),f=this,g=f.options,h=f.ITa,i=h.getRowCount(c),j=h.getColumnCount(c),k=f.vq(h,a,b,c,d),1===c?r(k)&&(m=f.wq,m&&m.Ou&&(n=f.ITa.Jp(!1,3,b),o=g.colHeaderAutoTextIndex,n&&(o>=0&&a===o||o===-1&&a===i-1)&&(k=n.displayName||n.name)),r(k)&&(l=g.colHeaderAutoTextIndex,(l<0||l>=i)&&(l=i-1),a===l&&(p=g.colHeaderAutoText,2===p?k=e.util.xq(b+1):1===p&&(k=b+1)))):2===c&&r(k)&&(l=g.rowHeaderAutoTextIndex,(l<0||l>=j)&&(l=j-1),b===l&&(q=g.rowHeaderAutoText,2===q?k=e.util.xq(a+1):1===q&&(k=a+1))),k)},a.prototype.setValue=function(a,b,c,d,e){this.uq(a,b,c,d,e),this.$p()},a.prototype.eyb=function(a,b,c,d){var e=this,f=3===c;f&&!d&&o&&e.zq(a,b),e.t4&&e.t4(a,b,1,1,c)},a.prototype.fyb=function(){var a=this.conditionalFormats;a&&a.Nm()},a.prototype.uq=function(a,b,c,d,e){var f,g,h,i;0!==d&&(r(d)&&(d=3),f=this,g=f.ITa,h=g.getRowCount(d),i=g.getColumnCount(d),a<0||a>=h||b<0||b>=i||(c=z(c),c=q(c),g.do("setValue",a,b,c,d),f.eyb(a,b,d,e),f.fyb()))},a.prototype.getActualStyle=function(a,b,c,d,e,f){var h,i,j,k,l,m,n,o,p,q,s,t,u,v,w,x,y,z,A,B,C,D,E,F,I;if(r(c)&&(c=3),0===c)return new g.Style;if(a===-1&&b===-1)return this.getDefaultStyle(c);if(h=this,n=h.Cq,x="__spreadJSDefault",y="__undefined",z=this.ITa,k=z.getStyle(a,b,c),l=z.getStyle(a,-1,c),m=z.getStyle(-1,b,c),k=k?k:G,l=l?l:G,m=m?m:G,u=y,k&&(u=k.charAt?k:x+k.yn),v=y,l&&(v=l.charAt?l:x+l.yn),w=y,m&&(w=m.charAt?m:x+m.yn),t=n[c],o=t[u],A=h.tables,B=3===c&&A&&!f?A.find(a,b):G,B||(o||(o=t[u]={}),q=o[v],q?s=q[w]:q=o[v]={}),s||(j=h.Dq(a,b,c,k,l,m,B,H,f)),3!==c||d||(s||(C=j.formatter,C&&C.hasFormatedColor&&C.hasFormatedColor()&&!f&&(D={value:G},C.format(h.getValue(a,b),D),D.value&&(i=new g.Style,i.foreColor=D.value))),E=h.conditionalFormats,E&&(i=E.Eq(i,a,b,c))),i)p=s?s:j,i.Yo(p),i&&i.font&&p&&p.font&&i.font!==p.font&&(i.font=na(i,p)),j=i;else if(s)return h.cellStates&&!d&&(F=h.cellStates.getStyle(a,b,c,G,s.locked),F&&(F.Yo(s),s=F,s.Zo(h.Pm))),e?s:s.clone(!0);return r(j.locked)&&(j.locked=!0),j=j.Zo(h.Pm),i||B||(q[w]=j.clone(!0)),h.cellStates&&!d&&(I=h.cellStates.getStyle(a,b,c,G,j.locked),I&&(I.Yo(j),j=I,j=j.Zo(h.Pm))),j},a.prototype.tq=function(a,b,c,d){var e,f,h,i,j,k,l,m,n,o,p,q,s,t,u;if(0===d)return H;for(r(d)&&(d=3),e=this,j=e.ITa,l=!1,3===d&&("foreColor"===c&&(n=e.tq(a,b,"formatter",d),n&&n.hasFormatedColor&&n.hasFormatedColor()&&(o={value:G},n.format(e.getValue(a,b),o),o.value&&(k=o.value,l=!0))),p=e.conditionalFormats,p&&p.count()>0&&(q=p.Fq(a,b,c,d),l=q.v5,k=q.Fi)),s=0;!l&&s<=4;)if(0===s?f=j.getStyle(a,b,d):1===s?(t=e.tables,u=3===d&&t?t.find(a,b):G,u&&Z[c]&&(f=u.Gq(a,b))):f=2===s?j.getStyle(a,-1,d):3===s?j.getStyle(-1,b,d):e.getDefaultStyle(d),s++,f&&f.charAt&&typeof f===N&&(f=e.Hq(f)),f){if("font"===c&&f.themeFont&&!m&&(m=f.themeFont),f[c]!==H){k=f[c],l=!0;break}for(h=f.parentName;h&&(i=e.Hq(h));){if(i[c]!==H){k=i[c],l=!0;break}h=i.parentName}}return"locked"===c?!!r(k)||k:l||m?("foreColor"!==c&&"backColor"!==c&&"font"!==c&&"borderLeft"!==c&&"borderTop"!==c&&"borderRight"!==c&&"borderBottom"!==c||(f=new g.Style,f[c]=k,"font"===c&&m&&(f.themeFont=m),f.Zo(e.Pm),k=f[c]),k):H},a.prototype.getStyle=function(a,b,c){return this.Iq(a,b,c,!0)},a.prototype.Iq=function(a,b,c,d){var e,f,h,i;if(r(c)&&(c=3),0!==c){if(e=this.ITa,f=e.getStyle(a,b,c),f instanceof g.Style)return d&&this.Jq(),f;if(typeof f===N&&(h=this.Hq(f),h!==G&&h!==H))return i=new g.Style,i.Yo(h,!1),d&&this.Jq(),i}return G},a.prototype.addNamedStyle=function(a){this.Kq(a),this.$p()},a.prototype.Kq=function(a){if(a){if(!a.name)throw Error(_().Exp_EmptyNamedStyle);var b=a.name.toUpperCase();this.Lq[b]=a}},a.prototype.getNamedStyle=function(a){return this.Mq(a,!0)},a.prototype.Mq=function(a,b){var c,d=this.Lq;return d&&a?(a=a.toUpperCase(),c=d[a],c&&b&&this.Jq(),c):G},a.prototype.Jq=function(){this.Cq=[{},{},{},{}]},a.prototype.removeNamedStyle=function(a){var b=this.Lq;b&&a&&(a=a.toUpperCase(),y(b,a)&&(delete b[a],this.Jq(),this.$p()))},a.prototype.getNamedStyles=function(){var a=[],b=this.Lq;return b&&w(b,function(b,c){a.push(c)}),this.Jq(),a},a.prototype.setStyle=function(a,b,c,d){var e,f;r(d)&&(d=3),e=this,e.Nq(a,b,c,d),a===-1&&b===-1&&(e.Oq[d]=G),a!==-1&&b!==-1||(f=c&&c.validator,f&&f.condition()&&4===f.condition().conType()&&f.condition().getExpected(this,a<0?0:a,b<0?0:b)),e.Jq(),e.$p()},a.prototype.Pq=function(a,b,c,d){var e,f,h=this;h.options.isProtected?(e=h.getStyle(a,b,d),f=void 0,c?(f=e?e.locked:H,c.locked!==f&&(c.locked=f),h.setStyle(a,b,c,d)):e&&(f=e.locked,f!==H&&(c=new g.Style,c.locked=f),h.setStyle(a,b,c,d))):h.setStyle(a,b,c,d)},a.prototype.getStyleName=function(a,b,c){var d=this.Aj(a,b,c);return d instanceof g.Style?d.name:d},a.prototype.setStyleName=function(a,b,c,d){typeof c===N&&(this.Nq(a,b,c,d),this.$p())},a.prototype.Aj=function(a,b,c){r(c)&&(c=3);var d;return 0!==c&&(d=this.ITa.getStyle(a,b,c)),d||G},a.prototype.Nq=function(a,b,c,d){var f,g,h,i,j,k,l,m,n;if(r(d)&&(d=3),0!==d){if(f=this,g=f.Aj(a,b,d),h=f.ITa,i=h.getRowCount(d),j=h.getColumnCount(d),a<-1||a>=i||b<-1||b>=j)return;k=h.getStyle(a,b,d),h.do("setStyle",a,b,c,d),l=g&&g.cellType&&g.cellType.typeName||G,m=c&&c.cellType&&c.cellType.typeName||G,a===f.Jl&&b===f.Kl&&l!==m&&e.Vl.Wl(f)&&f.mm.Qq(),n="[styleinfo]",a!==-1&&b!==-1?f.Bq(n,a,b,d,k,c):a!==-1&&b===-1?f.kq(a,d,n,c,k):a===-1&&b!==-1&&f.pq(b,d,n,c,k)}},a.prototype.getDefaultStyle=function(a){var b,c,d,e,f,h,i;return r(a)&&(a=3),b=this,c=b.Oq,(d=c[a])?d:0!==a?(e=b.ITa,f=e.getStyle(-1,-1,a),typeof f===N&&(f=b.Hq(f)),f||(f=new g.Style,e.do("setStyle",-1,-1,f,a)),f=f,h=1===a||2===a,typeof f.hAlign===M&&(f.hAlign=h?1:3),typeof f.vAlign===M&&(f.vAlign=h?1:0),typeof f.imeMode===M&&(f.imeMode=1),f.font||typeof f.themeFont!==M||(f.themeFont="Body"),c[a]=f,f):(i=new g.Style,i.locked=!0,c[a]=i,i)},a.prototype.setDefaultStyle=function(a,b){r(b)&&(b=3);var c=this;0!==b&&c.ITa.do("setStyle",-1,-1,a,b),c.Oq[b]=G,c.Jq(),c.$p()},a.prototype.Hq=function(a){var b,c=this.Mq(a,!1);return c?c:(b=this.parent,b?b.Mq(a,!1):G)},a.prototype.Dq=function(a,b,c,d,e,f,h,i,j){var k,l,m,n,o,p,q,s,t,u,v;if(r(c)&&(c=3),k=this,l=new g.Style,o=!1,0!==c){if(p=k.ITa,q=k.tables,s=p.getRowCount(c),t=p.getColumnCount(c),u=void 0,0<=a&&a<s&&0<=b&&b<t&&(u=d!==H?d:p.getStyle(a,b,c),u&&u.charAt&&(u=k.Hq(u)),u))for(l.Yo(u,!0,10),o=!0,n=u.parentName;n&&(m=k.Hq(n));)l.Yo(m,!1,10,!0),n=m.parentName;if(i)return l;if(h!==H||j||(h=3===c&&q?q.find(a,b):G),h&&!j&&(h.Yo(a,b,l),o=!0),0<=a&&a<s&&(u=e!==H?e:p.getStyle(a,-1,c),u&&u.charAt&&(u=k.Hq(u)),u))for(l.Yo(u,!o,30),o=!0,n=u.parentName;n&&(m=k.Hq(n));)l.Yo(m,!1,30,!0),n=m.parentName;if(0<=b&&b<t&&(u=f!==H?f:p.getStyle(-1,b,c),u&&u.charAt&&(u=k.Hq(u)),u))for(l.Yo(u,!o,40),o=!0,n=u.parentName;n&&(m=k.Hq(n));)l.Yo(m,!1,40,!0),n=m.parentName}if(v=k.getDefaultStyle(c),v&&v.charAt&&(v=k.Hq(v)),v)for(l.Yo(v,!o,50),n=v.parentName;n&&(m=k.Hq(n));)l.Yo(m,!1,50,!0),n=m.parentName;return l},a.prototype.getCellType=function(a,b,c){return this.tq(a,b,"cellType",c)||this.Al(c)},a.prototype.Al=function(a){r(a)&&(a=3);var b=this.Rq;return b||(b=this.Rq=new j.Text),3===a?b:1===a?new k.ColumnHeader:2===a?new k.RowHeader:0===a?new k.Corner:b},a.prototype.setCellType=function(a,b,c,d){var e=this.Iq(a,b,d);e||(e=new g.Style),e.cellType=c,this.setStyle(a,b,e,d)},a.prototype.Sq=function(a,b,c,d,f){var g,h,i,j,k,l,m=this;if(r(f)&&(f=3),g=m.ITa,g.do("clearSpan",a,b,c,d,f),h=e.kf(a,b,c,d),i=m.Tq(h,f),j=m.Fia(i,f),g.do("addSpan",j,f),3===f){for(k=m.getSelections(),l=0;l<k.length;l++)k[l].intersect(a,b,c,d)&&(k[l]=k[l].union(h));g.do("setSelections",k)}m.$p()},a.prototype.Fia=function(a,b){var c=this.getRowCount(b),d=this.getColumnCount(b),f=a.row,g=a.col,h=a.rowCount,i=a.colCount;return f+h>c&&(h=c-f),g+i>d&&(i=d-g),e.kf(f,g,h,i)},a.prototype.addSpan=function(b,c,d,e,f){var g,h,i,j,k,l=this;if((1!==d||1!==e)&&0!==f&&(g=l.getRowCount(f),h=l.getColumnCount(f),!(b>=g||c>=h||b<-1||c<-1)&&(i=!0,o&&(3===f||r(f))&&(i=l.Vq(b,c,d,e,!1)),i))){if(j=l.ITa,j.qu(b,c,d,e,f))throw Error(_().Exp_InvalidRange);l.wyb&&l.wyb(b,c,d,e),l.Sq(b,c,d,e,f),k={sheet:l,row:b,col:c,rowCount:d,colCount:e,sheetArea:f,changeType:"addSpan"},a.ao(l,S,k),l.Wq("spanChanged",k)}},a.prototype.removeSpan=function(b,c,d){var e,f,g,h=this;r(d)&&(d=3),e=h.ITa,f=e.findSpan(b,c,d),f&&f.row===b&&f.col===c&&e.do("removeSpan",f,d),g={sheet:h,row:b,col:c,sheetArea:d,changeType:"removeSpan"},a.ao(h,S,g),h.Wq("spanChanged",g),h.$p()},a.prototype.getSpans=function(a,b){return 0===b?[]:this.ITa.getSpans(a,b)},a.prototype.getSpan=function(a,b,c){return 0===c?G:this.ITa.findSpan(a,b,c)},a.prototype.repaint=function(a){this.Xq<=0&&this.yl&&this.yl.repaint(a)},a.prototype.Yq=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=o.parent&&o.parent.options.scrollByPixel,q=ma(o),r=la(o),s=r?o.Zq(r-1):o.$q(),t=q?o._q(q-1):o.ar();if(b<o.qq&&b>=s?o.rq(o.br(b+1),0):p&&b===o.qq&&0!==o.eCb&&o.rq(b,0),b>o.cr()&&b<=o.dr()){for(c=0,d=b,e=o.am(),f=o.ITa.findSpan(a,d),f&&(d=f.col+f.colCount-1);d>o.qq&&(c+=o.Tl(d),!(c>e.er));)d--;g=void 0,h=void 0,p?(d===o.qq&&c<e.er&&(c+=o.Tl(d)),g=d,h=e.er-c):(g=o.Zq(d),h=0),o.rq(g,h)}if(a<o.lq&&a>=t?o.mq(o.gr(a+1),0):p&&a===o.lq&&0!==o.cCb&&o.mq(a,0),a>o.hr()&&a<=o.ir()){for(i=0,j=a,k=o.ITa.findSpan(j,b),k&&(j=k.row+k.rowCount-1),l=o.am();j>o.lq&&(i+=o.Sl(j),!(i>l.jr));)j--;m=void 0,n=void 0,p?(j===o.lq&&i<l.jr&&(i+=o.Sl(j)),m=j,n=l.jr-i):(m=o._q(j),n=0),o.mq(m,n)}p||b!==o.dr()||o.rq(o.lr(),0)},a.prototype.hitTest=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=this;if(C.am(),e={x:a,y:b},f=C.rowOutlines,g=C.columnOutlines,f&&(h=f.hitTest(C,a,b)),!h&&g&&(h=g.hitTest(C,a,b)),h)e.outlineHitInfo=h;else{if(i=C.nr(b),j=C.or(a),e.rowViewportIndex=i,e.colViewportIndex=j,e.row=C.pr(b,i),e.col=C.qr(a,j),i>=0&&i<=2&&j>=0&&(k=C.rr(i,j,H,e.row,e.col),k&&c!==!0&&(e.row=k.row,e.col=k.col)),e.hitTestType=C.sr(i,j),l=C.mm,m=C.xr,n=m&&m.hitTest(e,a,b),o=C.tables,p=void 0,o&&(p=e.rowViewportIndex===-1?o&&o.find(C.getActiveRowIndex(),C.getActiveColumnIndex()):o.find(e.row,e.col)),n||(q=p&&p.xr,n=q&&q.hitTest(e,a,b)),r=o&&!n&&o.lIb(a,b,e))return e.tableSelectInfo=r,r.table&&r.table.xr&&(e.filterButtonHitInfo=n),e;s=l.Yia&&l.Yia(e,a,b),s?e.dragMergeInfo=s:(t=l.tr&&l.tr(e,a,b),t?e.dragInfo=t:(u=l.ur(e,a,b,5),u?e.resizeInfo=u:(v=l.vr?l.vr(e,a,b):G,v?e.formulaRangeHitInfo=v:(w=C.ITa.Ky,x=w&&w.hitTest(a,b),x?e.commentHitInfo=x:(y=C.wr,z=y&&y.hitTest(a,b,d),A=void 0,C.shapes&&(A=C.shapes.hitTest(a,b)),A?e.shapeHitInfo=A:z?e.floatingObjectHitInfo=z:n?e.filterButtonHitInfo=n:(B=p&&!p.mIb()&&l.nIb&&l.nIb(e,p),B?e.resizeTableHitInfo=B:e.cellTypeHitInfo=C.yr(e,a,b)))))))}return e},a.prototype.getCellRect=function(a,b,c,d,f){var g,h,i,j,k,l,m=3;return c===-1?m=1:d===-1&&(m=2),g=this,h=g.am(),c===-1&&d===-1?new e.Rect(h.zr,h.Ar,h.Br,h.Cr):(i=g.Dr(),r(c)&&(c=g.Er(a)),r(d)&&(d=g.Fr(b)),j=g.Gr(c,m).findRow(a),k=g.Hr(d,m).findCol(b),l=g.Ir(c,d,m,f).findCell(a,b),l?new e.Rect(l.x-i.x,l.y-i.y,l.width,l.height):j&&k?new e.Rect(k.x-i.x,j.y-i.y,k.width,j.height):new e.Rect)},a.prototype.Jr=function(a,b,c){var d,f,g,h,i=this,j=i.mm,k=!1,m=i.Jl,n=i.Kl;r(a)||(i.Jl=a,k=!0),r(b)||(i.Kl=b,k=!0),i.ITa.setCellState(m,n,l.CellStatesType.active,!1,l.SheetArea.viewport),i.MHb&&i.MHb(l.CellStatesType.active,m,n,l.SheetArea.viewport),i.ITa.setCellState(a,b,l.CellStatesType.active,!0,l.SheetArea.viewport),i.MHb&&i.MHb(l.CellStatesType.active,a,b,l.SheetArea.viewport),!c&&j&&k&&(j.Qq(),d=i.ITa,f=d.getDynamicArrayInfo(a,b),g=d.eIb,f!==g&&(d.eIb=f,i.Xq<=0&&(h=void 0,f&&g?h=e.getUnionRange(f,g):(f=f||g,h=e.kf(f.row,f.col,f.rowCount,f.colCount)),i.yl.im(h))))},a.prototype.gCb=function(a,b,c,d,e){var f=a.getCellRect(b,c,d,e),g=f.x,h=f.y,i=f.width,j=f.height;return f.x=g-2,f.y=h-2,f.width=i+4,f.height=j+4,f},a.prototype.Kr=function(a,b,c,d,f){var g,h=this,i=h.Jl,j=h.Kl,k=h.ITa,l=k.getSpan(a,b);h.Lr=l.rowCount,h.Mr=l.colCount,h.Xq<=0&&(g=k.getSpan(i,j),h.yl.im(e.kf(i,j,g.rowCount,g.colCount))),h.Nr=c,h.Pr=d,h.Jr(a,b,f),h.Qr=a,h.Rr=b},a.prototype.setActiveCell=function(a,b,c,d){this.Sr(a,b,c,d,2)},a.prototype.Sr=function(a,b,c,d,f){var g,h,i=this,j=ia(i),k=ha(i);a<0?a=0:a>=j&&(a=j-1),b<0?b=0:b>=k&&(b=k-1),i.Tr(),g=2===f?e.Vl.Wl(i):1===f,i.Kr(a,b,c,d,!g),h=i.ITa.getSpan(a,b),i.Ur(h.row,h.col,h.rowCount,h.colCount),i.$p()},a.prototype.getActiveRowIndex=function(){return this.Jl},a.prototype.getActiveColumnIndex=function(){return this.Kl},a.prototype.getRowResizable=function(a,b){return this.ITa.getResizable(!0,b,a)},a.prototype.setRowResizable=function(a,b,c){this.Vr(a,b,W,!0,c)},a.prototype.Vr=function(a,b,c,d,e){r(e)&&(e=3),c!==P&&c!==O||!B.test(b)||(c=V);var f=this,g=f.ITa,h;switch(c){case W:h=g.getResizable(d,e,a);break;case"pageBreak":h=g.getPageBreak(d,e,a);break;case U:h=g.getVisible(d,e,a);break;case P:h=g.getSize(d,e,a);break;case O:h=g.getSize(d,e,a)}switch(d?f.pCb(a,e,c,b,h):f.qCb(a,e,c,b,h),c){case W:g.do("setResizable",d,e,a,b);break;case"pageBreak":g.do("setPageBreak",d,e,a,b);break;case U:g.do("setVisible",d,e,a,b),d&&o&&3===e&&h!==b&&f.recalcRows([a]);break;case P:g.do("setSize",d,e,a,b),!o||3!==e||h===b||0!==h&&0!==b||f.recalcRows([a]);break;case O:g.do("setSize",d,e,a,b);break;case V:g.do("setStarSize",d,e,a,b)}d?f.kq(a,e,c,b,h):f.pq(a,e,c,b,h)},a.prototype.getColumnResizable=function(a,b){return this.ITa.getResizable(!1,b,a)},a.prototype.setColumnResizable=function(a,b,c){this.Vr(a,b,W,!1,c)},a.prototype.getRowHeight=function(a,b,c){var d,e,f,g,h,i,j,k=this;if(r(b)&&(b=3),c)return k.ITa.getStarSize(!0,b,a);if(3===b||2===b){if(d=k.getRowCount(b),a<0||a>=d)return 0;for(e=k.Wr,f=0;f<e.length;f++)if(g=e[f],!g.Xr(a))return 0}return h=k.defaults,i=h.rowHeight,1===b&&(i=h.colHeaderRowHeight),j=k.ITa.getSize(!0,b,a),j||0===j?j:K(i)},a.prototype.Yr=function(a,b){var c,d,e,f;return r(b)&&(b=3),c=this,d=c.defaults,e=d.rowHeight,1===b&&(e=d.colHeaderRowHeight),f=c.ITa.getActualSize(!0,b,a),f||0===f?f:K(e)},a.prototype.setRowHeight=function(a,b,c){this.Vr(a,b,P,!0,c),this.jq=!0,this.$p()},a.prototype.getRowVisible=function(a,b,c){var d,e,f,g=this;if(r(b)&&(b=3),!c&&(3===b||2===b))for(d=g.Wr,e=0;e<d.length;e++)if(f=d[e],!f.Xr(a))return!1;return this.ITa.getVisible(!0,b,a)},a.prototype.setRowVisible=function(a,b,c){var d=this;d.Vr(a,b,U,!0,c),d.jq=!0,d.$p()},a.prototype.getColumnWidth=function(a,b,c){var d,e,f,g,h,i,j,k=this;if(r(b)&&(b=3),c)return k.ITa.getStarSize(!1,b,a);if(d=k.defaults,e=d.colWidth,2===b&&(e=d.rowHeaderColWidth),3===b||1===b){if(f=k.getColumnCount(b),a<0||a>=f)return 0;for(g=k.Zr,h=0;h<g.length;h++)if(i=g[h],
!i.Xr(a))return 0}return j=this.ITa.getSize(!1,b,a),j||0===j?j:K(e)},a.prototype.$r=function(a,b){var c,d,e,f;return r(b)&&(b=3),c=this,d=c.defaults,e=d.colWidth,2===b&&(e=d.rowHeaderColWidth),f=c.ITa.getActualSize(!1,b,a),f||0===f?f:K(e)},a.prototype.setColumnWidth=function(a,b,c){this.Vr(a,b,O,!1,c),this.oq=!0,this.$p()},a.prototype.getColumnVisible=function(a,b){var c,d,e,f=this;if(r(b)&&(b=3),3===b||1===b)for(c=f.Zr,d=0;d<c.length;d++)if(e=c[d],!e.Xr(a))return!1;return f.ITa.getVisible(!1,b,a)},a.prototype.setColumnVisible=function(a,b,c){var d=this;d.Vr(a,b,U,!1,c),d.oq=!0,d.$p()},a.prototype.zoom=function(a){var b,c=this;return 0===arguments.length?c.ITa.getZoomFactor():(a=E(a),!F(a)&&isFinite(a)&&(a>4?a=4:a<.25&&(a=.25),b=c.ITa.getZoomFactor(),c.XSa(a),c.eCb=c.eCb/b*a,c.cCb=c.cCb/b*a,c.oq=!0,c.jq=!0,c.$p()),c)},a.prototype.XSa=function(b){this.ITa.do("setZoomFactor",b),a.ao(this,S,{changeType:"zoomSheet"})},a.prototype.invalidateLayout=function(){var b=this,c=b.mm;b.ITa.$Gb(),b._r=G,b.as={colHeader:G,viewport:G},b.bs={rowHeader:G,viewport:G},a.ao(b,S,{changeType:"invalidateLayout"}),c&&c.cs&&e.Vl.Wl(b)&&!c.byb(b)&&c.cs(b.Jl,b.Kl),b.oq&&(b.ds(),b.oq=!1),b.jq&&(b.es(),b.jq=!1),b.$l=!0},a.prototype.$p=function(){var a=this;a.Xq<=0&&(a.invalidateLayout(),a.repaint())},a.prototype.getViewportHeight=function(a){var b=this.am();return 0===a?b.fs:1===a?b.jr:2===a?b.gs:0},a.prototype.getViewportWidth=function(a){var b=this.am();return 0===a?b.hs:1===a?b.er:2===a?b.js:0},a.prototype.getViewportTopRow=function(a){var b=this,c=ma(b);return 0===a?0:1===a?J(c,b.lq):2===a?J(c,ia(b)-ka(b)):-1},a.prototype.getViewportBottomRow=function(a){var b,c,d,e,f,g,h=this;if(2===a)return ia(h)-1;for(b=h.getViewportTopRow(a),c=h.getViewportHeight(a),d=0,e=0,f=ia(h)-ka(h),0===a&&(f=I(ma(h),f)),g=b;g<f&&d<c;g++,e++)d+=h.Sl(g);return b+e-1},a.prototype.jCb=function(a){var b,c=this,d=c.getViewportTopRow(a),e=c.getViewportBottomRow(a);for(b=d;b<e+1;b++)if(b>-1&&c.getRowVisible(b,3)&&c.Sl(b,3)>0)return b;return-1},a.prototype.getViewportLeftColumn=function(a){var b=this,c=la(b);return 0===a?0:1===a?J(c,b.qq):2===a?J(c,ha(b)-ja(b)):-1},a.prototype.getViewportRightColumn=function(a){var b,c,d,e,f,g,h=this;if(2===a)return ha(h)-1;for(b=h.getViewportLeftColumn(a),c=h.getViewportWidth(a),d=0,e=0,f=ha(h)-ja(h),0===a&&(f=I(la(h),f)),g=b;g<f&&e<c;g++,d++)e+=h.Tl(g);return b+d-1},a.prototype.kCb=function(a){var b,c=this,d=c.getViewportLeftColumn(a),e=c.getViewportRightColumn(a);for(b=d;b<e+1;b++)if(b>-1&&c.getColumnVisible(b,3)&&c.Tl(b,3)>0)return b;return-1},a.prototype.showCell=function(a,b,c,d){var e,f,g,h,i,j,k=this;a<0||a>=ia(k)||b<0||b>=ha(k)||(e=k.Fr(b),f=k.Er(a),g=k.getViewportTopRow(f),h=k.getViewportLeftColumn(e),1===e&&(b=k.ks(b,d)),1===f&&(a=k.ms(a,c)),i=!1,1===f&&a!==g&&(a=I(a,k.ns()),k.lq=a,k.os(),i=!0),1===e&&b!==h&&(b=I(b,k.ps()),k.qq=b,k.qs(),i=!0),i&&(j=k.parent,j&&!j.options.scrollbarShowMax&&(k.oq=!0,k.jq=!0),k.$p()))},a.prototype.Er=function(a){var b=this,c=1;return a<ma(b)?c=0:a>=ia(b)-ka(b)&&(c=2),c},a.prototype.Fr=function(a){var b=this,c=1;return a<la(b)?c=0:a>=ha(b)-ja(b)&&(c=2),c},a.prototype.ks=function(a,b){var c=this,d=c.ss,e=c.Fr(a),f=c.getViewportLeftColumn(e),g;if(0!==b)if(1===b)for(g=K((c.getViewportWidth(e)-d._m(a))/2);0<a&&(g-=d._m(a-1),!(g<0));a--);else if(2===b)for(g=c.getViewportWidth(e)-d._m(a);0<a&&(g-=d._m(a-1),!(g<0));a--);else if(3===b&&a>=f)for(g=c.getViewportWidth(e)-d._m(a);f<a&&(g-=d._m(a-1),!(g<0));a--);return a},a.prototype.ms=function(a,b){var c=this,d=c.ss,e=c.Er(a),f=c.getViewportTopRow(e),g;if(0!==b)if(1===b)for(g=K((c.getViewportHeight(e)-d.Sl(a))/2);0<a&&(g-=d.Sl(a-1),!(g<0));a--);else if(2===b)for(g=c.getViewportHeight(e)-d.Sl(a);0<a&&(g-=d.Sl(a-1),!(g<0));a--);else if(3===b&&!(a<f||f===-1))for(g=c.getViewportHeight(e)-d.Sl(a);f<a&&(g-=d.Sl(a-1),!(g<0));a--);return a},a.prototype.showColumn=function(a,b){this.showCell(this.lq,a,0,b)},a.prototype.showRow=function(a,b){this.showCell(a,this.qq,b,0)},a.prototype.suspendEvent=function(){this.jm++},a.prototype.resumeEvent=function(){this.jm--,this.jm<0&&(this.jm=0)},a.prototype.isEventSuspended=function(){return this.jm>0},a.prototype.currentTheme=function(a){var b=this;return 0===arguments.length?(b.Pm||b.ts(),b.Pm):(typeof a===N&&(a=p.Themes[a]?p.Themes[a]:new p.Theme(a)),b.Pm=a,b.yl.us(),b.Jq(),b.$p(),b)},a.prototype.P3=function(){var a=e.Im.Lm(""),b=D(a.zIndex),c=p.Themes.Office2007;return b>2007&&(c=p.Themes.Office),c},a.prototype.ts=function(){this.Pm=this.P3(),this.Jq()},a.prototype.reset=function(){var a=this;a.vs(),a.$p()},a.prototype.vs=function(){var b,c,d=this;d.Pp(),d.Nr=0,d.Pr=0,d.T3(),d._r=G,d.as={colHeader:G,viewport:G},d.bs={rowHeader:G,viewport:G},d.lq=0,d.cCb=0,d.qq=0,d.eCb=0,d.frozenRowCount(0),d.frozenColumnCount(0),d.frozenTrailingRowCount(0),d.frozenTrailingColumnCount(0),a.ao(d,"beforeSetHost"),b=d.parent,b&&(c=b.getActiveSheet(),c&&d.name()===c.name()&&d.ws(b.xs)),d.Cq=[{},{},{},{}],d.ss=new e.ln(d),d.Oq={},o&&d.resetCalc(),d.ITa=new h.lUa(d,a.Rp,a.Sp,a.Vp,a.Tp,d.name()),d.defaults=d.ITa.defaults,d.ts(),d.Lq={},d.oq=!0,d.jq=!0,d.parent&&d.parent.xD?d.Xq=d.parent.xD:d.Xq=0,d.parent&&d.parent.jm?d.jm=d.parent.jm:d.jm=0,d.gga=0,d.Js=!1,d.Ks=G,d.Wr=[],d.Zr=[],d.aIb=!1,a.ao(d,"init")},a.prototype.T3=function(){var a=this;w(ba,function(b,c){if(!r(c)){var d=c;"gridline"===b?d={color:e.Im.Lm("gc-gridlineColor").borderTopColor,showVerticalGridline:!0,showHorizontalGridline:!0}:"object"==typeof d&&(d=i.GC$.extend({},c)),a.options[b]=d}})},a.prototype.Ls=function(b){var c,d=this;for(d.parent=b,c=0;c<b.xD;c++)d.suspendPaint();d.jm=b.jm,a.ao(d,"attach",b)},a.prototype.Y3=function(a,b,c,d,f,g,h){var i=this;return!h&&i.options.isProtected&&i.ou(e.kf(a,b,c,d))?(f&&i.Os(1,f),!1):!(o&&!i.Vq(a,b,c,d))||(g&&i.Os(1,g),!1)},a.prototype.clear=function(a,b,c,d,e,f){0!==e&&this.cg(a,b,c,d,e,f)},a.prototype.cg=function(b,c,d,e,f,g,h,i){var j,k,l,m,n,p,q,s,t,u,v,w,x,y,z,A=this,B=o;try{if(B&&A.suspendCalcService(),A.suspendPaint(),j=A.defaults,k=void 0,l=void 0,m=void 0,n=void 0,p=3,r(f)||f===p){if(B&&!A.Vq(b,c,d,e))return!1;if(1&g&&A.getDataSource&&A.getDataSource()){for(A.suspendEvent(),k=b;k<b+d;k++)if(!(h&&A.Ps&&A.Ps(k)))for(l=c;l<c+e;l++)A.setValue(k,l,G,f);A.resumeEvent()}}for(q={changeType:"clear",row:b,col:c,rowCount:d,colCount:e,sheetArea:f,type:g,ignoreTable:i},a.ao(A,S,q),s=A.ITa,t=B&&A.Bj(),k=b===-1?0:b,u=b===-1?s.getRowCount(f):d,l=c===-1?0:c,v=c===-1?s.getColumnCount(f):e,w=[],x=k;x<u;x++)h&&A.Ps&&A.Ps(x)&&w.push(x);if(s.do("clear",k,l,u,v,g,w,f),t&&1&g&&(t.Sg(k,l,u,v),t.clear(k,l,u,v,s.dUa())),8&g&&!(b>=0&&c>=0))if(c>=0)for(n=0;n<v;n++)A.setTag(-1,l+n,G,f);else if(b>=0)for(m=0;m<u;m++)h&&A.Ps&&A.Ps(k+m)||A.setTag(k+m,-1,G,f);else A.setTag(-1,-1,G,f);if(128&g&&!(b>=0&&c>=0))if(c>=0)for(n=0;n<v;n++)A.nCb(-1,l+n,G);else if(b>=0)for(m=0;m<u;m++)h&&A.Ps&&A.Ps(k+m)||A.nCb(k+m,-1,G);else A.nCb(-1,-1,G);if(2&g&&!(b>=0&&c>=0))if(c>=0)for(n=0;n<v;n++)A.setStyle(-1,l+n,G,f);else if(b>=0)for(m=0;m<u;m++)h&&A.Ps&&A.Ps(k+m)||A.setStyle(k+m,-1,G,f);else A.setStyle(-1,-1,G,f);if(32&g){if(b<0)for(n=0;n<v;n++)A.setColumnVisible(l+n,!0,f),A.setColumnResizable(l+n,!0,f),A.setColumnWidth(l+n,2===f?j.rowHeaderColWidth:j.colWidth,f);if(c<0)for(m=0;m<u;m++)h&&A.Ps&&A.Ps(k+m)||(A.setRowVisible(k+m,!0,f),A.setRowResizable(k+m,!0,f),A.setRowHeight(k+m,1===f?j.colHeaderRowHeight:j.rowHeight,f))}for((r(f)||f===p)&&B&&1===(1&g)&&(y=A.Bj(),y&&y.Ag(b,c,d,e)),z=[],m=0;m<u;m++)for(n=0;n<v;n++)z.push({row:k+m,col:l+n});A.Bu(b,c,u,v,z,2,f)}finally{A.resumePaint(),B&&A.resumeCalcService(!1)}},a.prototype._p=function(){var a,b,c=this,d=c.options,e=d.protectionOptions;d.isProtected&&e&&(e.allowSelectLockedCells===!1||e.allowSelectUnlockedCells===!1)&&(a=c.Jl,b=c.Kl,c.Qs(a,b)||(c.Tr(),c.Rs(a,b,!0),c.Ss(4,a,b)))},a.prototype.setArray=function(a,b,c,d){var e,f,g,h,j=this,k=o;if(d=k&&d,e=ia(j),f=ha(j),c&&0<=a&&a<e&&0<=b&&b<f){k&&j.suspendCalcService(),j.suspendPaint();try{w(c,function(c,k){i.GC$.isArray(k)?w(k,function(i,k){g=a+c,h=b+i,g<e&&h<f&&(d?j.setFormula(g,h,k):j.setValue(g,h,k,3,!0))}):(g=a+c,h=b,g<e&&h<f&&(d?j.setFormula(g,h,k):j.setValue(g,h,k,3,!0)))})}finally{k&&j.resumeCalcService(),j.resumePaint()}}},a.prototype.getArray=function(a,b,c,d,e){var f,g,h=this,i=[],j=ia(h),k=ha(h);if(e=e&&o,0<=a&&a<j&&0<=b&&b<k)for(a+c>j&&(c=j-a),b+d>k&&(d=k-b),f=0;f<c;f++)for(i[f]=[],g=0;g<d;g++)e?i[f][g]=h.getFormula(a+f,b+g):i[f][g]=h.getValue(a+f,b+g);return i},a.prototype.setTag=function(a,b,c,d){var e,f,g,h,i,j;if(r(d)&&(d=3),e=this,0!==d){if(f=e.ITa,g=f.getRowCount(d),h=f.getColumnCount(d),a<-1||a>=g||b<-1||b>=h)return;c=z(c),i=void 0,j=e.jm>0,j||(i=e.getTag(a,b,d)),f.do("setValueForKey",a,b,R,c,d),j||i===c||(a!==-1&&b!==-1?e.Bq(R,a,b,d,i,c):a!==-1&&b===-1?e.kq(a,d,R,c,i):a===-1&&b!==-1&&e.pq(b,d,R,c,i))}},a.prototype.getTag=function(a,b,c){var d,e=this;return r(c)&&(c=3),0!==c?(d=e.ITa.getValueForKey(a,b,R,c),A(d)):G},a.prototype.tag=function(a){var b,c=this;return 0===arguments.length?(b=c.ITa.getValueForKey(-1,-1,R,3),A(b)):(c.ITa.do("setValueForKey",-1,-1,R,z(a),3),c)},a.prototype.getParent=function(){return this.parent},a.prototype.getDirtyRows=function(){return ea(this,!0)},a.prototype.getInsertRows=function(){return ea(this,!1)},a.prototype.getDeletedRows=function(){var a=[],b=this.Ts;return b&&w(b,function(b,c){c&&!i.GC$.isFunction(c)&&a.push({row:c.row,originalItem:c.data})}),a},a.prototype.hasPendingChanges=function(){var a,b=this,c=b.Ts;return!!(c&&c.length>0)||(a=b.ITa.hUa(),!x(a))},a.prototype.clearPendingChanges=function(){this.ITa.iUa(),this.Ts=[]},a.prototype.getDirtyCells=function(a,b,c,d){var e,f,g,h,i,j,k,l=this;if(r(a)&&(a=-1),r(b)&&(b=-1),(r(c)||c<=0)&&(c=1),(r(d)||d<=0)&&(d=1),e=[],f=l.ITa.hUa(),!x(f)){if(g=[],a>=0)for(h=a;h<a+c;h++)g.push(h);else for(i in f)y(f,i)&&g.push(D(i));w(g,function(a,c){var g,h;if(j=f[c],j&&"e"===j.rs)if(b>=0)for(g=b;g<b+d;g++)k=j[g],k&&e.push(pa(l,c,g,k.oldValue));else for(h in j)F(h)||(k=j[h],k&&e.push(pa(l,c,D(h),k.oldValue)))})}return e},a.prototype.suspendDirty=function(){this.gga++,this.ITa.jUa()},a.prototype.resumeDirty=function(){var a=this;a.gga--,a.gga<0&&(a.gga=0),a.ITa.kUa()},a.prototype.isDirtySuspended=function(){return this.gga>0},a.prototype.setCellFormatString=function(a,b,c){var d,e,f,g=this,h=g.getCell(a,b,3);if(null===c)g.oCb(a,b,null);else if("="===c[0])c=c.substring(1,c.length),g.oCb(a,b,c);else{for(d=c.split(/{{|}}/),""===d[0]&&d.shift(),""===d[d.length-1]&&d.pop(),e=0;e<d.length;e++)d[e].indexOf("=")===-1?d[e]='"'+d[e]+'"':d[e]=d[e].replace(/=/g,"");f="CONCAT("+d.join(",")+")",g.oCb(a,b,f,!0)}return h},a.prototype.getCellFormatString=function(a,b){var c,d,e,f,g,h,i,j=this,k=j.ITa,l=k.getFormatString(a,b);if(l&&(c=j.et.getFormulaByName(l),void 0!==c&&null!==c)){if(d=l.substring(l.indexOf("#")+1,l.lastIndexOf("#")),""!==d){for(e=d.split(/-/),f=c.split(""),g=0;g<e.length;g++)h=D(e[g],10),f[h]="@";c=f.join("")}if(l.indexOf("!")>=0){for(c=c.substring(7,c.length-1),i=c.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g),g=0;g<i.length;g++)i[g].indexOf('"')>=0?i[g]=i[g].replace(/"/g,""):i[g]="{{="+i[g]+"}}";return c=i.join("")}return c="="+c}return null},a.prototype.ad=function(a){this.Us(new e.Rect(0,0,0,0)),this.vs(),this.cq(a)},a.prototype.Vs=function(){var a,b=this,c=i.GC$(b.Ws()).offset();return c?(c.top+=C.body.clientTop||0,c.left+=C.body.clientLeft||0):c={top:0,left:0},a=b.Ws().canvasOffset,a&&(c=a),c},a.prototype.nCb=function(a,b,c){var d=this,e=d.ITa,f=e.getRowCount(3),g=e.getColumnCount(3);a<0||a>=f||b<0||b>=g||e.do("setFormatString",a,b,c,3)},a.prototype.ws=function(b){var c,d,f;b&&(c=this,c.Js=!1,d=c.Xs,d&&c.no(!1),f=s("canvas"),i.GC$(f).attr("id",b.getAttribute("id")+"_vp").attr("gcUIElement","gcWorksheetCanvas").html(_().NeedCanvasSupport).appendTo(b),e.En.Kn(f,G,c),c.Xs=f,c.fq(),c.repaint(),c.parent&&c.parent.Ys(),a.ao(c,"setHost",i.GC$(f)))},a.prototype.fq=function(){var a,b,c,d,f,g,h,j,k=this,l=k.Ws();l&&l.parentNode&&(a=getComputedStyle(l.parentNode),b=a.width,c=a.height,d=b.indexOf("px"),d>0&&(b=b.substring(0,d)),d=c.indexOf("px"),d>0&&(c=c.substring(0,d)),f=D(b),g=D(c),F(f)&&(f=i.GC$(l.parentNode).width()),F(g)&&(g=i.GC$(l.parentNode).height()),0!==f&&0!==g&&(h=J(f,0),j=J(g,0),l.style.display="none",l.style.display="",l.width=h,l.height=j,l.style.width=h+"px",l.style.height=j+"px",h=l.clientWidth||l.width,j=l.clientHeight||l.height,k.Zs.width=h,k.Zs.height=j,e.En.Pn(l,h,j),k.invalidateLayout()))},a.prototype.no=function(b){var c,d,f,g=this;g.Js!==!0&&(e.En.Sn(g),g.isEditing&&g.isEditing()&&g.Yoa(),a.ao(g,"dispose",{clearCache:b,isSpreadDestroy:!0}),c=g.Xs,c&&(d=c.parentNode,d&&d.removeChild(c),g.Xs=G),g.$s(),b!==!1&&(g.Js=!0,f=g.at,f&&f.no(),g.parent=G,g.ITa=G,g.ss=G,g.bt&&(g.bt.no(),g.bt=G),e.Vl.Wl(g)&&e.Vl.Zl(G,!0),g.uu&&(g.uu=G)))},a.prototype.$s=function(){var a=this.dt;a&&(i.GC$(a).remove(),this.dt=H)},a.prototype.vq=function(a,b,c,d,e){var f,g,h,i,j;return r(d)&&(d=3),3===d&&this.CHb&&(f=a.getDynamicArrayInfo(b,c),f&&f.isValid&&(b!==f.row||c!==f.col))?G:(g=this.et,g&&(h=g.getCalcService(),h.calcOnDemand&&3===d&&(i=g.qg(b,c),i&&i.dirty===!0&&(i.dirty=!1,g.recalculateCell(b,c)))),j=a.getValue(b,c,d,H,e),j=A(j))},a.prototype.Tq=function(a,b){var c,d,f,g,h,i;return r(b)&&(b=3),c=e.kf(-1,-1,-1,-1),a&&(d=this,f=a.row,g=a.col,h=a.rowCount,i=a.colCount,g===-1&&(g=0,i=d.getColumnCount(b)),f===-1&&(f=0,h=d.getRowCount(b)),c.col=g,c.row=f,c.colCount=i,c.rowCount=h),c},a.prototype.getRangeRect=function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=new e.Rect((-1),(-1),(-1),(-1)),v=this,w=v.am();if(0===w.width||0===w.height)return u;if(d=v.it(b),f=v.jt(a),!d||0===d.length||!f||0===f.length)return u;g=v.Tq(c),h=v.ss,i=g.row,j=g.row+g.rowCount-1,k=g.col,l=g.col+g.colCount-1,m=ma(v),n=ia(v)-ka(v)-1,o=la(v),p=ha(v)-ja(v)-1,q=d[0].col,r=d[d.length-1].col,s=f[0].row,t=f[f.length-1].row;function x(a,b){for(;a>b;)if(a--,v.getColumnVisible(a))return a;return a}function y(a,b){for(;a<b;)if(a++,v.getColumnVisible(a))return a;return a}function z(a,b){for(;a>b;)if(a--,v.getRowVisible(a))return a;return a}function A(a,b){for(;a<b;)if(a++,v.getRowVisible(a))return a;return a}return k<q&&(k=x(q,k)),l>r&&(l=y(r,l)),i<s&&(i=z(s,i)),j>t&&(j=A(t,j)),l<k||j<i?u:(0===b?k<o&&(u.x=w.kt+fa(h,0,k-1),u.width=fa(h,k,l)):1===b?k<=p&&l>=o&&(k<q?u.x=d[0].x-fa(h,k,q-1):u.x=d[0].x+fa(h,q,k-1),u.width=fa(h,k,l)):2===b&&l>p&&(k<q?u.x=w.lt-fa(h,k,q-1):u.x=w.lt+fa(h,q,k-1),u.width=fa(h,k,l)),0===a?i<m&&(u.y=w.nt+ga(h,0,i-1),u.height=ga(h,i,j)):1===a?i<=n&&j>=m&&(i<s?u.y=f[0].y-ga(h,i,s-1):u.y=f[0].y+ga(h,s,i-1),u.height=ga(h,i,j)):2===a&&j>n&&(i<s?u.y=w.ot-ga(h,i,s-1):u.y=w.ot+ga(h,s,i-1),u.height=ga(h,i,j)),u)},a.prototype.isintersectWithArrayFormula=function(a){var b,c,d=this.Bj();if(d)for(b=a.row;b<a.row+a.rowCount;b++)for(c=a.col;c<a.col+a.colCount;c++)if(d.dg(b,c,1,1))return!0;return!1},a.prototype.cm=function(a){var b,c,d,f,g,h,i,j,k,l,m,n,o,p,q=this,r=new e.Rect((-1),(-1),(-1),(-1)),s=q.am();if(0===s.width||0===s.height)return r;if(b=q.Tq(a),c=la(q),d=ma(q),f=ja(q),g=ka(q),h=q.ss,i=b.row,j=b.row+b.rowCount-1,k=b.col,l=b.col+b.colCount-1,m=ia(q),n=ha(q),k<c)r.x=s.kt+fa(h,0,k-1),r.width=fa(h,k,I(l,c-1)),c<=l&&l<n-f?(o=q.it(1),o&&o.length>0&&(r.width+=fa(h,o[0].col,I(l,o[o.length-1].col))+q.eCb)):l>=n-f&&(o=q.it(2),o&&o.length>0&&(r.width=o[0].x-r.x,r.width+=fa(h,n-f,I(l,n-1))));else if(k<n-f){if(o=q.it(1),!o||0===o.length||k>o[o.length-1].col||l<o[0].col)return r;r.x=s.pt+fa(h,o[0].col,k-1)+q.eCb,c<=l&&l<n-f?r.width=fa(h,J(k,o[0].col),I(l,o[o.length-1].col)):l>=n-f&&(o=q.it(2),o&&o.length>0&&(r.width=o[0].x-r.x,r.width+=fa(h,n-f,I(l,n-1))))}else k<n&&(o=q.it(2),o&&o.length>0&&(r.x=s.lt+fa(h,o[0].col,k-1),r.width=fa(h,k,I(l,n-1))));if(i<d)r.y=s.nt+ga(h,0,i-1),r.height=ga(h,i,I(j,d-1)),d<=j&&j<m-g?(p=q.jt(1),p&&p.length>0&&(r.height+=ga(h,p[0].row,I(j,p[p.length-1].row))+q.cCb)):j>=m-g&&(p=q.jt(2),p&&p.length>0&&(r.height=p[0].y-r.y,r.height+=ga(h,m-g,I(j,m-1))));else if(i<m-g){if(p=q.jt(1),!p||0===p.length||i>p[p.length-1].row||j<p[0].row)return r;r.y=s.qt+ga(h,p[0].row,i-1)+q.cCb,d<=j&&j<m-g?r.height=ga(h,J(i,p[0].row),I(j,p[p.length-1].row)):j>=m-g&&(p=q.jt(2),p&&p.length>0&&(r.height=p[0].y-r.y,r.height+=ga(h,m-g,I(j,m-1))))}else i<m&&(p=q.jt(2),p&&p.length>0&&(r.y=s.ot+ga(h,p[0].row,i-1),r.height+=ga(h,i,I(j,m-1))));return r},a.prototype.Ws=function(){return this.Xs},a.prototype.rt=function(a,b){return this.dp(a,b)+1},a.prototype.dp=function(a,b){var c="",d=this.yl;return c=b?b:d.Cl(d.Bl()),e.Vn.Xn(a,c)},a.prototype.or=function(a){var b=this.am(),c=G;return b.zr<a&&a<b.zr+b.Br?c=-1:b.kt<a&&a<b.kt+b.hs?c=0:b.pt<a&&a<b.pt+b.er?c=1:b.lt<a&&a<b.lt+b.js&&(c=2),c},a.prototype.nr=function(a){var b=this.am(),c=G;return b.Ar<a&&a<b.Ar+b.Cr?c=-1:b.nt<a&&a<b.nt+b.fs?c=0:b.qt<a&&a<b.qt+b.jr?c=1:b.ot<a&&a<b.ot+b.gs&&(c=2),c},a.prototype.pr=function(a,b){var c,d;if(c=b===-1?this.ut():this.jt(b),c&&(d=c.findY(a)))return d.row},a.prototype.qr=function(a,b){var c,d;if(c=b===-1?this.vt():this.it(b),c&&(d=c.findX(a)))return d.col},a.prototype.wt=function(a,b){var c=this;return c.Jl<=a&&a<c.Jl+c.Lr&&c.Kl<=b&&b<c.Kl+c.Mr},a.prototype.sp=function(a){return this.ITa.sp(a)},a.prototype.tp=function(a){return this.ITa.tp(a)},a.prototype.vp=function(a,b,c,d){var e=this,f=ia(e),g=ha(e);return this.ITa.vp(a,b,c,f,g,d)},a.prototype.wp=function(a,b,c){var d=this,e=ia(d),f=ha(d);return this.ITa.wp(a,b,c,e,f)},a.prototype.xt=function(a,b,c){var d,e,f,g,h,i,j=this,k=j.yt;if(k&&!k.resizeInfo&&!r(c)){if(g=k.hitTestType,h=k.row,i=k.col,1===c)return d=!1,e=j.ITa.findSpan(h,i,1),e&&(d=e.contains(a,b,1,1)),f=a===h&&b===i||d,g===c&&f;if(2===c)return d=!1,e=j.ITa.findSpan(h,i,2),e&&(d=e.contains(a,b,1,1)),f=a===h&&b===i||d,g===c&&f;if(3===c)return g===c&&a===h&&b===i;if(0===c)return g===c}return!1},a.prototype.sr=function(a,b){return a>=0&&a<=2&&b>=0?3:a>=0&&a<=2&&b<0?2:a<0&&b>=0?1:a<0&&b<0?0:G},a.prototype.zt=function(a){var b=this.mm;b&&b.zt(a)},a.prototype.zo=function(){var a,b=this,c=b.parent,d=c&&c.qo;return d||(a=b.Xs,d=a&&a.parentElement),d},a.prototype.Pp=function(){var a=this,b=0,c=0,d=1,e=1;a.Jl=b,a.Kl=c,a.Lr=d,a.Mr=e,a.Qr=b,a.Rr=c},a.prototype.Sl=function(a,b,c){var d=this,e=d.getRowHeight(a,b),f=d.zoom();return 1!==f&&(e*=f),c?e:L(e)},a.prototype.Tl=function(a,b,c){var d=this,e=d.getColumnWidth(a,b),f=d.zoom();return 1!==f&&(e*=f),c?e:L(e)},a.prototype.At=function(){var a,b,c,d,f,g,h,i,j,k,l=this,m=l.Dr(),n=l.options,o=n.sheetAreaOffset.left,p=n.sheetAreaOffset.top,q=new e.Rect(m.x+o,m.y+p,J(0,m.width-o),J(0,m.height-p)),r=q.width,s=q.height,t={x:q.x,y:q.y,width:q.width,height:q.height,Br:0,Cr:0,hs:0,fs:0,js:0,gs:0,Bt:0,Ct:0,Dt:0,Et:0,kt:0,nt:0,lt:0,ot:0,pt:0,qt:0,jr:0,er:0,zr:0,Ar:0,em:function(){var a=this;return new e.Rect(a.x,a.y,a.Br,a.Cr)},gm:function(a){var b=this;return 0===a?new e.Rect(b.kt,b.y,b.hs,b.Cr):1===a?new e.Rect(b.pt,b.y,b.er,b.Cr):2===a?new e.Rect(b.lt,b.y,b.js,b.Cr):G},fm:function(a){var b=this;return 0===a?new e.Rect(b.x,b.nt,b.Br,b.fs):1===a?new e.Rect(b.x,b.qt,b.Br,b.jr):2===a?new e.Rect(b.x,b.ot,b.Br,b.gs):G},Ft:function(a,b){var c=this;if(0===a){if(0===b)return new e.Rect(c.kt,c.nt,c.hs,c.fs);if(1===b)return new e.Rect(c.pt,c.nt,c.er,c.fs);if(2===b)return new e.Rect(c.lt,c.nt,c.js,c.fs)}else if(1===a){if(0===b)return new e.Rect(c.kt,c.qt,c.hs,c.jr);if(1===b)return new e.Rect(c.pt,c.qt,c.er,c.jr);if(2===b)return new e.Rect(c.lt,c.qt,c.js,c.jr)}else if(2===a){if(0===b)return new e.Rect(c.kt,c.ot,c.hs,c.gs);if(1===b)return new e.Rect(c.pt,c.ot,c.er,c.gs);if(2===b)return new e.Rect(c.lt,c.ot,c.js,c.gs)}return G}};if(l.Gt&&(a=l.Gt(),b=0,a.width>0&&(t.x+=a.width+b,r-=a.width+b),a.height>0&&(t.y+=a.height+b,s-=a.height+b)),n.rowHeaderVisible)for(g=l.getColumnCount(2),f=0;f<g;f++)t.Br+=l.Tl(f,2);if(n.colHeaderVisible)for(d=l.getRowCount(1),c=0;c<d;c++)t.Cr+=l.Sl(c,1);if(h=la(l),h>0)for(g=ha(l),f=0;f<h&&f<g;f++)l.getColumnVisible(f)&&(t.hs+=l.Tl(f));if(i=ma(l),i>0)for(d=ia(l),c=0;c<i&&c<d;c++)l.getRowVisible(c)&&(t.fs+=l.Sl(c));if(j=ja(l),j>0)for(g=ha(l),f=J(h,g-j);f<g;f++)t.js+=l.Tl(f);if(k=ka(l),k>0)for(d=ia(l),c=J(i,d-k);c<d;c++)t.gs+=l.Sl(c);return r-=t.Br,s-=t.Cr,r-=t.hs,s-=t.fs,r-=t.js,s-=t.gs,s-=t.Bt,t.er=J(0,r),t.jr=J(0,s),t.zr=t.x,t.Ar=t.y,t.kt=t.zr+t.Br,t.nt=t.Ar+t.Cr,t.pt=t.kt+t.hs,t.qt=t.nt+t.fs,t.lt=t.pt+t.er,t.ot=t.qt+t.jr,t.Dt=t.zr,t.Et=t.y+t.height-t.Bt,t},a.prototype.am=function(){var a=this;return a._r||(a._r=a.At()),a._r},a.prototype.Hr=function(a,b){return r(b)||3===b||1===b?this.it(a):2===b?this.vt():G},a.prototype.vt=function(){var a=this;return a.bs.rowHeader||(a.bs.rowHeader=a.Ht()),a.bs.rowHeader},a.prototype.it=function(a){var b=this;return b.bs.viewport||(b.bs.viewport={}),b.bs.viewport[a]||(b.bs.viewport[a]=b.It(a)),b.bs.viewport[a]},a.prototype.Ht=function(){var a,b,c=new h.yp,d=this.am(),e=d.zr,f=this.getColumnCount(2);for(b=0;b<f;b++)a=this.Tl(b,2),c.push(new h.zp((-1),b,e,(-1),a,(-1))),e+=a;return c},a.prototype.It=function(a){var b,c,d,e,f,g,i=this,j=new h.yp,k=i.am(),l=ha(i),m=i.ss,n=la(i),o=ja(i);if(0===a)for(c=k.kt,l=I(n,l),b=0;b<l;b++)d=m._m(b),j.push(new h.zp((-1),b,c,(-1),d,(-1))),c+=d;else if(1===a)for(e=i.eCb,c=k.pt+e,l-=o,f=k.er-e,g=J(n,i.qq),b=g;f>0&&b<l;b++)d=m._m(b),j.push(new h.zp((-1),b,c,(-1),d,(-1))),c+=d,f-=d;else if(2===a)for(c=k.lt,b=J(n,l-o);b<l;b++)d=m._m(b),j.push(new h.zp((-1),b,c,(-1),d,(-1))),c+=d;return j},a.prototype.Gr=function(a,b){return r(b)||3===b||2===b?this.jt(a):1===b?this.ut():G},a.prototype.Jt=function(a){var b,c,d=new h.yp;for(b=0;b<3;b++)c=this.Gr(b,a),c&&c.length>0&&(d=i.GC$.merge(d,c));return d},a.prototype.Kt=function(a){var b,c,d=new h.yp;for(b=0;b<3;b++)c=this.Hr(b,a),c&&c.length>0&&(d=i.GC$.merge(d,c));return d},a.prototype.ut=function(){var a=this;return a.as.colHeader||(a.as.colHeader=a.Lt()),a.as.colHeader},a.prototype.jt=function(a){var b=this;return b.as.viewport||(b.as.viewport={}),b.as.viewport[a]||(b.as.viewport[a]=b.Mt(a)),b.as.viewport[a]},a.prototype.Lt=function(){var a,b,c=new h.yp,d=this.am(),e=d.Ar,f=this.getRowCount(1);for(b=0;b<f;b++)a=this.Sl(b,1),c.push(new h.zp(b,(-1),(-1),e,(-1),a)),e+=a;return c},a.prototype.Mt=function(a){var b,c,d,e,f,g,i=this,j=new h.yp,k=ma(i),l=ka(i),m=i.am(),n=ia(i),o=i.ss;if(0===a)for(c=m.nt,n=I(k,n),b=0;b<n;b++)d=o.Sl(b),j.push(new h.zp(b,(-1),(-1),c,(-1),d)),c+=d;else if(1===a)for(e=i.cCb,c=m.qt+e,n-=l,f=m.jr-e,g=J(k,i.lq),b=g;f>0&&b<n;b++)d=o.Sl(b),j.push(new h.zp(b,(-1),(-1),c,(-1),d)),c+=d,f-=d;else if(2===a)for(c=m.ot,b=J(k,n-l);b<n;b++)d=o.Sl(b),j.push(new h.zp(b,(-1),(-1),c,(-1),d)),c+=d;return j},a.prototype.Ir=function(a,b,c,d){var f,g,i,j,k,l,m=this,n=m.getRowCount(c),o=m.getColumnCount(c),p=m.Gr(a,c),q=m.Hr(b,c),r=new h.yp;return p&&p.length>0&&q&&q.length>0&&(f=p[0].row,g=q[0].col,i=p[p.length-1].row,j=q[q.length-1].col,k=m.getSpans(e.kf(f,g,i-f+1,j-g+1),c),d&&m.oIb&&(l=m.oIb.pIb(c),k=k.concat(l)),k.length>0&&m.Nt(k,f,g,i,j,r,n,o,c,p,q)),r},a.prototype.rr=function(a,b,c,d,e){var f,g,i,j,k=this,l=k.getRowCount(c),m=k.getColumnCount(c),n=k.Gr(a,c),o=k.Hr(b,c),p=new h.yp;return n&&n.length>0&&o&&o.length>0?(f=n[0].row,g=o[0].col,i=k.getSpan(d,e,c),i&&(j=[],j.push(i),k.Nt(j,f,g,i.row+i.rowCount,i.col+i.colCount,p,l,m,c,n,o)),p.length>0?p[0]:G):G},a.prototype.Nt=function(a,b,c,d,e,f,g,i,j,k,l){var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=a.length;if(!(G<=0)){for(m=this,o=d+1,p=e+1,q=[],r=[],s=[],t=[],u=0,v=0,n=b-1;n>=0;n--)q[n]=m.Sl(n,j),v-=q[n],t[n]=v;for(v=0,n=b;n<o;n++)t[n]=v,q[n]=m.Sl(n,j),v+=q[n];for(n=c-1;n>=0;n--)r[n]=m.Tl(n,j),u-=r[n],s[n]=u;for(u=0,n=c;n<p;n++)s[n]=u,r[n]=m.Tl(n,j),u+=r[n];for(w=0;w<G;w++)if(x=a[w],x.intersect(b,c,d-b+1,e-c+1)){if(y=x.row+x.rowCount,y>o){for(n=o;n<y;n++)q.push(m.Sl(n,j)),t.push(t[n-1]+q[n]);o=y}if(z=x.col+x.colCount,z>p){for(n=p;n<z;n++)r.push(m.Tl(n,j)),s.push(s[n-1]+r[n]);p=z}for(A=s[x.col],B=t[x.row],C=0,D=0,E=void 0,F=void 0,F=x.col;F<x.col+x.colCount&&F<i;F++)C+=r[F];for(E=x.row;E<x.row+x.rowCount&&E<g;E++)D+=q[E];f.push(new h.zp(x.row,x.col,l[0].x+A,k[0].y+B,C,D,x.rowCount,x.colCount,x.isAutoMerge))}}},a.prototype.qs=function(){var a=this,b=a.parent,c=a.Ot(a.qq);c!==-1&&c!==a.qq&&(a.qq=c),b&&b.Pt&&b.Pt.value(a.Qt(a.qq))},a.prototype.os=function(){var a=this,b=a.parent,c=a.Rt(a.lq);c!==-1&&c!==a.lq&&(a.lq=c),b&&b.St&&b.St.value(a.Tt(a.lq))},a.prototype.ds=function(){var a=this,b=a.parent;b&&b.Ut&&(b.options.scrollIgnoreHidden&&(a.Vt=a.Wt(!0)),b.Ut())},a.prototype.es=function(){var a=this,b=a.parent;b&&b.Xt&&(b.options.scrollIgnoreHidden&&(a.Yt=a.Zt(!0)),b.Xt())},a.prototype.$t=function(){var a=this,b=0,c=la(a);return b=c>0?a.Zq(c-1):a.$q()},a.prototype._t=function(){var a=this,b=0,c=ma(a);return b=c>0?a._q(c-1):a.ar()},a.prototype.$q=function(a){return this.Zq(-1,a)},a.prototype.Zq=function(a,b,c){for(var d=this,e=d.getColumnCount(b),f=c?e-1:e-1-ja(d);a<f;)if(a++,d.getColumnVisible(a,b)&&d.Tl(a,b)>0)return a;return G},a.prototype.br=function(a,b){for(var c=this,d=la(c);a>d;)if(a--,c.getColumnVisible(a,b)&&c.Tl(a,b)>0)return a;return G},a.prototype.ar=function(a){return this._q(-1,a)},a.prototype._q=function(a,b,c){for(var d=this,e=d.getRowCount(b),f=c?e-1:e-1-ka(d);a<f;)if(a++,d.getRowVisible(a,b)&&d.Sl(a,b)>0)return a;return G},a.prototype.gr=function(a,b,c){for(var d=this,e=c?0:ma(d);a>e;)if(a--,d.getRowVisible(a,b)&&d.Sl(a,b)>0)return a;return G},a.prototype.au=function(){var a=this.parent;a&&a.options.scrollIgnoreHidden&&(this.jq=!0),this.os()},a.prototype.bu=function(){var a=this.parent;a&&a.options.scrollIgnoreHidden&&(this.oq=!0),this.qs()},a.prototype.Tt=function(a){var b,c=this.parent;return c&&c.options.scrollIgnoreHidden?(b=this.Zt().visibleIndex,b[a]):a},a.prototype.cu=function(a){var b,c=this.parent;return c&&c.options.scrollIgnoreHidden?(b=this.Zt().originalIndex,b[a]):a},a.prototype.Qt=function(a){var b,c=this.parent;return c&&c.options.scrollIgnoreHidden?(b=this.Wt().visibleIndex,b[a]):a},a.prototype.du=function(a){var b,c=this.parent;return c&&c.options.scrollIgnoreHidden?(b=this.Wt().originalIndex,b[a]):a},a.prototype.Wt=function(a){var b,c,d,e,f,g,h,i,j=this;if(j.Vt&&!a)return j.Vt;if(b=la(j),c=ha(j)-ja(j)-b,d=b,e=d+c-1,f=j.ss,g={visibleIndex:{},originalIndex:{}},e-d+1<=0)return g;for(h=0,i=d;i<=e;i++)g.originalIndex[h]=i,g.visibleIndex[i]=h,f._m(i)>0&&h++;for(i--,h--;f._m(i)<=0&&i>=d;)g.originalIndex[h]=i,g.visibleIndex[i]=h,i--;return g},a.prototype.Zt=function(a){var b,c,d,e,f,g,h,i,j=this;if(j.Yt&&!a)return j.Yt;if(b=ma(j),c=ia(j)-ka(j)-b,d=b,e=d+c-1,f=j.ss,g={visibleIndex:{},originalIndex:{}},e-d+1<=0)return g;for(h=0,i=d;i<=e;i++)g.originalIndex[h]=i,g.visibleIndex[i]=h,f.Sl(i)>0&&h++;for(i--,h--;f.Sl(i)<=0&&i>=d;)g.originalIndex[h]=i,g.visibleIndex[i]=h,i--;return g},a.prototype.Rt=function(a,b){var c,d=this,e=ma(d),f=ia(d)-ka(d)-1;if(b){if(a>f&&(a=f),c=d.gr(a+1),c!==G&&c>=e)return c}else if(a<e&&(a=e),c=d._q(a-1),c!==G&&c<=f)return c;return-1},a.prototype.Ot=function(a,b){var c,d=this,e=la(d),f=ha(d)-ja(d)-1;if(b){if(a>f&&(a=f),c=d.br(a+1),c!==G&&c>=e)return c}else if(a<e&&(a=e),c=d.Zq(a-1),c!==G&&c<=f)return c;return-1},a.prototype.eu=function(a,b,c){var d,e,f,g,h;if(c<b)return c;for(d=0,e=this.ss,f=c,g=c;g>=b;g--)if(h=e.Sl(g),!(h<=0)){if(d+=h,d>a)break;f=g}return f},a.prototype.wHb=function(a,b,c){var d,e,f=0,g=this.ss,h=c,i=0;for(d=c;d>=b;d--)if(e=g.Sl(d),!(e<=0)&&(f+=e,h=d,f>a)){i=a-f;break}return{cj:h,UP:i}},a.prototype.fu=function(a,b,c){var d,e,f,g,h;if(c<b)return c;for(d=0,e=this.ss,f=c,g=c;g>=b;g--)if(h=e._m(g),!(h<=0)){if(d+=h,d>a)break;f=g}return f},a.prototype.xHb=function(a,b,c){var d,e,f=0,g=this.ss,h=c,i=0;for(d=c;d>=b;d--)if(e=g._m(d),!(e<=0)&&(h=d,f+=e,f>a)){i=a-f;break}return{dj:h,UP:i}},a.prototype.gu=function(){var a,b,c,d=this.am(),e=this.Hr(1,3),f=0,g=0;if(e)for(a=0;a<e.length;a++)b=e[a].width,f+=b,b>0&&g++;return g=0===g?1:g,c=f/g,0===c?1:K(d.er/c)},a.prototype.hu=function(){var a,b,c,d=this.am(),e=this.Gr(1,3),f=0,g=0;if(e)for(a=0;a<e.length;a++)b=e[a].height,f+=b,b>0&&g++;return g=0===g?1:g,c=f/g,0===c?1:K(d.jr/c)},a.prototype.ns=function(a){var b,c,d,e,f,g,h;return r(a)&&(a=3),b=this,c=b.parent,d=ma(b),e=ka(b),c&&c.options.scrollbarMaxAlign?(f=b.am(),b.eu(f.jr,d,ia(b)-e-1)):(g=b.getRowCount(a),3!==a&&2!==a||(g-=e),h=b.gr(g,a),h===G&&(h=d),h)},a.prototype.ps=function(a){var b,c,d,e,f,g;return r(a)&&(a=3),b=this,c=b.parent,d=la(b),c&&c.options.scrollbarMaxAlign?(e=b.am(),b.fu(e.er,d,ha(b)-ja(b)-1)):(f=b.getColumnCount(a),3!==a&&1!==a||(f-=ja(b)),g=b.br(f,a),g===G&&(g=d),g)},a.prototype.iu=function(){var b,c,d,e,f=this,g=ma(f),h=la(f),i=ia(f)-ka(f)-1,j=ha(f)-ja(f)-1,k=f.ITa,l=k.getLastNonNullRow(3);return l>g&&(g=l),b=k.getLastNonNullCol(3),b>h&&(h=b),c=k.getLastNonNullRow(2),c>g&&(g=c),d=k.getLastNonNullCol(1),d>h&&(h=d),e=a._n,e&&w(e,function(a,b){var c,d=b.lastNonNullRowAndCol;d&&(c=d.call(f),g=J(g,c.lastNonNullRow),h=J(h,c.lastNonNullCol))}),g>i&&(g=i),h>j&&(h=j),{lastNonNullRow:g,lastNonNullCol:h}},a.prototype.mq=function(a,b,c){var d,e=this,f=e.lq,g=e.cCb;a>=e._t()&&a<=e.ns()&&(c||a!==f||b!==g)&&(d=e.parent,d&&(d.ku.ju(a,b||0,c),e.os()),d&&!d.options.scrollbarShowMax&&e.es())},a.prototype.rq=function(a,b,c){var d,e=this,f=e.qq,g=e.eCb;a>=e.$t()&&a<=e.ps()&&(c||a!==f||b!==g)&&(d=e.parent,d&&(d.ku.lu(a,b||0,c),e.qs()),d&&!d.options.scrollbarShowMax&&e.ds())},a.prototype.yr=function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=a.row,n=a.col,o=a.hitTestType;return r(m)||r(n)?G:(d=l.getSpan(m,n,o),d&&(m=d.row,n=d.col),l.oIb&&(e=l.oIb.qIb(m,n,o),e&&(m=e.row,n=e.col)),f=l.getActualStyle(m,n,o),g=1===o?-1:H,h=2===o?-1:H,i=l.getCellRect(m,n,g,h,!0),j={sheet:l,row:m,col:n,sheetArea:o},k=f.cellType||l.Al(o),k.h5(b,c,f,i,j))},a.prototype.mu=function(){this.unbindAll(),this.nu()},a.prototype.ou=function(a){var b,c,d,e,f,g,h=this.Tq(a),i=h.row,j=h.col,k=i+h.rowCount,l=j+h.colCount;for(c=i;c<k;c++)for(d=j;d<l;d++)if(e=this.getSpan(c,d),f=e?e.row:c,g=e?e.col:d,b=this.getActualStyle(f,g),b.locked===!0)return!0;return!1},a.prototype.pu=function(a,b,c,d,e,f){if(-1<=a&&a<e&&-1<=b&&b<f){if(a===-1&&b===-1)return!0;if(a===-1){if(0!==d&&b+d<=f)return!0}else if(b===-1){if(0!==c&&a+c<=e)return!0}else if(0!==d&&b+d<=f&&0!==c&&a+c<=e)return!0}return!1},a.prototype.qu=function(a,b,c,d){var e,f,g,h=this;return!(a<0&&b<0)&&(a<0&&(e=h.ITa.zl(1),e&&e.spans&&e.spans.length>0)?h.ITa.qu(-1,b,-1,d,1):b<0&&(f=h.ITa.zl(2),f&&f.spans&&f.spans.length>0)?h.ITa.qu(a,-1,c,-1,2):(g=h.ITa.zl(3),!!(g&&g.spans&&g.spans.length>0)&&h.ITa.qu(a,b,c,d,3)))},a.prototype.suspendPaint=function(){var b=this,c=b.Xq;b.Xq++,0===c&&a.ao(b,T,{suspend:!0})},a.prototype.resumePaint=function(){var b,c=this;c.Xq--,c.Xq<=0&&(c.Xq=0,a.ao(c,T,{suspend:!1}),b=c.parent,b&&b.getActiveSheet()!==c||c.$p())},a.prototype.isPaintSuspended=function(){return this.Xq>0},a.prototype.su=function(a,b){var c,d,e=this,f=a&&a.length;for(c=0;c<f;c++)if(d=a[c],b.intersect(d.row,d.col,d.rowCount,d.colCount))return a.splice(c,1),e.su(a,b.union(d));return b},a.prototype.tu=function(){var a=this,b=a.parent;return a.uu||(a.uu=b&&b.uu),a.uu},a.prototype.vu=function(){if(!this.bt){var a=this;a.bt=new f.oo(function(){a.bt&&a.repaint()})}return this.bt},a.prototype.wu=function(){var a=this,b=a.parent;if(b)return b.commandManager()},a.prototype.Os=function(a,b){this.Wq(e.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:a,message:b})},a.prototype.Bq=function(a,b,c,d,f,g){var h,i;0===this.jm&&(h={sheet:this,sheetName:this.name(),row:b,col:c,sheetArea:d,propertyName:a,oldValue:f,newValue:g},this.Wq(e.Events.CellChanged,h),i=this.ITa,i.ZVa(["cellChanged",a,b,c,d,g,f]))},a.prototype.xu=function(a,b,c,d){this.Wq(e.Events.ValueChanged,{sheet:this,sheetName:this.name(),row:a,col:b,oldValue:c,newValue:d})},a.prototype.qCb=function(a,b,c,d,f){var g,h;0===this.jm&&(g={sheet:this,sheetName:this.name(),col:a,sheetArea:b,propertyName:c,newValue:d,oldValue:f},"addColumns"!==c&&"deleteColums"!==c||(g.count=d),this.Wq(e.Events.ColumnChanging,g),h=this.ITa,h.ZVa(["columnChanging",a,b,c,f,d]))},a.prototype.pq=function(a,b,c,d,f){var g,h;0===this.jm&&(g={sheet:this,sheetName:this.name(),col:a,sheetArea:b,
propertyName:c,newValue:d,oldValue:f,isUndo:this.aIb},"addColumns"!==c&&"deleteColumns"!==c||(g.count=d),this.Wq(e.Events.ColumnChanged,g),h=this.ITa,h.ZVa(["columnChanged",a,b,c,f,d]))},a.prototype.pCb=function(a,b,c,d,f){var g,h;0===this.jm&&(g={sheet:this,sheetName:this.name(),row:a,sheetArea:b,propertyName:c,newValue:d,oldValue:f},"addRows"!==c&&"deleteRows"!==c||(g.count=d),this.Wq(e.Events.RowChanging,g),h=this.ITa,h.ZVa(["rowChanging",a,b,c,f,d]))},a.prototype.kq=function(a,b,c,d,f){var g,h;0===this.jm&&(g={sheet:this,sheetName:this.name(),row:a,sheetArea:b,propertyName:c,newValue:d,oldValue:f,isUndo:this.aIb},"addRows"!==c&&"deleteRows"!==c||(g.count=d),this.Wq(e.Events.RowChanged,g),h=this.ITa,h.ZVa(["rowChanged",a,b,c,f,d]))},a.prototype.gyb=function(a,b){b!==a&&this.Wq(e.Events.UserZooming,{sheet:this,sheetName:this.name(),oldZoomFactor:a,newZoomFactor:b})},a.prototype.yu=function(a,b){return!(this.n_a||!this.mm.zu(a,b))&&(this.Wq(e.Events.SelectionChanging,{sheet:this,sheetName:this.name(),oldSelections:a,newSelections:b}),!0)},a.prototype.Au=function(a){this.Wq(e.Events.SelectionChanged,{sheet:this,sheetName:this.name(),oldSelections:a,newSelections:this.getSelections()})},a.prototype.Bu=function(a,b,c,d,f,g,h,i){var j={sheet:this,sheetName:this.name(),row:a,col:b,rowCount:c,colCount:d,changedCells:f,action:g};h&&(j.sheetArea=h),i&&(j.value=i),f&&f.length>0&&(this.Wq(e.Events.RangeChanged,j),this.Wq(e.Events.FormulatextboxRangeChanged,j))},a.prototype.Cu=function(a,b){var c={sheet:this,sheetName:this.name(),oldStatus:a,newStatus:b};this.Wq(e.Events.EditorStatusChanged,c)},a.prototype.Du=function(){return this.b4||(this.b4=i.GC$(s("input"))),this.b4},a.prototype.bind=function(a,b,c){this.Du().bind(a+X,b,c)},a.prototype.unbind=function(a,b){this.Du().unbind(a+X,b)},a.prototype.Wq=function(a,b,c){this.updateEventsData&&this.updateEventsData(a,b),(0===this.jm||c)&&this.Du().trigger(a,b)},a.prototype.unbindAll=function(){this.unbind(X)},a.prototype.Fu=function(a,b,c){a.indexOf(".")>=0?this.bind(a,b,c):this.bind(a+Y,b,c)},a.prototype.Gu=function(a,b){a.indexOf(".")>=0?this.unbind(a,b):this.unbind(a+Y,b)},a.prototype.nu=function(){this.unbind(Y)},a.prototype.Dr=function(){var a=this.Zs;return new e.Rect(a.x,a.y,a.width,a.height)},a.prototype.Us=function(a){this.Zs=new e.Rect(a.x,a.y,a.width,a.height)},a.prototype.oCb=function(a,b,c,d){var e,f,g,h,i=this,j=i.et;if(r(i.rCb)&&(i.rCb=0),e=i.name()+i.rCb,i.rCb++,d&&(e+="!"),null!==c&&void 0!==c){for(f=[],g=c.indexOf("@");g>-1;)f.push(g),g=c.indexOf("@",g+1);h=f.join("-"),e=e+"#"+h+"#",c=c.replace(/@/g,"~"),c="="+c}j.setFormulaByName(e,c),i.nCb(a,b,e),i.repaint()},a.Np=1,a.Qp=ba,a.Rp=200,a.Sp=20,a.Tp=1,a.Vp=1,a}(),b.Worksheet=ca,e.Zn(ca),da=ca.prototype,da.visible=t("visible",!0,function(a){var b,c=this,d=c.parent,e=d.sheets,f=e.length,g=i.GC$.inArray(c,e),h=d.getActiveSheetIndex();if(a)h<0?(d.dq(g,1),d.hq&&d.hq.gq<0&&(d.hq.gq=g)):d.aq();else if(g===h){for(b=g+1;b<f&&!e[b].visible();)b++;if(b>=f)for(b=g-1;b>=0&&!e[b].visible();)b--;d.hq&&b<d.hq.gq&&(d.hq.gq=b),b<0?(c.no(!1),d.eq=b,d.fq()):d.dq(b,1)}else d.aq()}),da.frozenColumnCount=t("frozenColumnCount",0,function(a){var b=this;b.qq<a?b.qq=a:""!==a&&0!==a&&null!==a||(b.qq=0),b.oq=!0,b.$p()},function(a){return a>=0}),da.frozenRowCount=t("frozenRowCount",0,function(a){var b=this;b.lq<a?b.lq=a:""!==a&&0!==a&&null!==a||(b.lq=0),b.jq=!0,b.$p()},function(a){return a>=0}),da.frozenTrailingRowCount=t("frozenTrailingRowCount",0,function(){var a=this;a.jq=!0,a.$p()},function(a){return a>=0}),da.frozenTrailingColumnCount=t("frozenTrailingColumnCount",0,function(){var a=this;a.oq=!0,a.$p()},function(a){return a>=0})},"./node_modules/webpack/buildin/global.js":function(a,b){var c;c=function(){return this}();try{c=c||Function("return this")()}catch(a){"object"==typeof window&&(c=window)}a.exports=c},CalcEngine:function(a,b){a.exports=GC.Spread.CalcEngine},Common:function(a,b){a.exports=GC.Spread},SheetsCalc:function(a,b){a.exports=GC.Spread.Sheets.CalcEngine}});