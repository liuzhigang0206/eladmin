/*!
 * 
 * SpreadJS Library 13.0.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.CalcEngine=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="",c(c.s="./node_modules_local/@grapecity/js-calc/index.js")}({"./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js":function(a,b,c){var d="object"==typeof d?d:{};d.Spread=d.Spread||{},d.Spread.CalcEngine=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./src/calc.entry.ts")}({"./src/Parser.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/calc.common.ts"),f=void 0,g=null,h="string",i="boolean",j="TRUE",k="FALSE",l="ARRAY",m=d.Common.u,n=d.Common.j,o=n.Fa,p="Exp_FormulaInvalidChar",q="Exp_FormulaInvalid",r="Exp_NoSyntax";function F(){throw e.sR()[q]}function G(a,b,c){throw m.Kb(e.sR()[c||p],[a,b])}b.di=["+","-","%","+","-","*","/","^","&","=","<>","<","<=",">",">=",":",","," "],s={":":1,"^":2," ":3,"*":4,"/":4,",":5,"+":6,"-":6,"&":7,"<":8,"=":8,">":8,">=":8,"<=":8,"<>":8},t=".",u=",",v=";",w=",",x=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1];function H(a){return a<=255}function I(a){return a<=127}function J(a){return a===e.getBoolean().boolean_true||a===j}function K(a){return a===e.getBoolean().boolean_false||a===k}function L(a){return a>=48&&a<=57}b.isDigit=L;function M(a){var b=a.charCodeAt(0);return!H(b)||(I(b)?(b|=32,b>=96&&b<=122):0===x[b]||1===x[b])}b.ei=M;function N(a){var b=a.charCodeAt(0);return!H(b)||(I(b)?b<=57?b>=48:(b|=32,b>=96&&b<=122):0===x[b]||1===x[b])}b.fi=N;function O(a){var b=a.charCodeAt(0);return I(b)?b>=48&&b<=57:8===x[b]||10===x[b]}b.isNumber=O;function P(a,b,c,d,e,f){var g,h,i=a.length,j=c===d?0:1,k=[],l=0;for(g=b+1;g<i;g++)if(h=a[g],h===e&&(k.push(h),g++,l++,h=a[g]),h===c&&j++,h===d)if(j--,c===d&&g+2<i&&a[g+1]===c)k.push(c),g++,l++;else{if(0===j)return{result:k,endIndex:g,skipCount:l};k.push(h)}else k.push(h);f&&G(d,c,r)}function Q(a,b,c){var d,f,g,h,i=a.length,j=i-b;for(d=0;d<e.ErrorList.length;d++)if(f=e.ErrorList[d],g=f.length,b+g<=i&&(h=a.slice(b,b+g),g<=j&&f===h.join("").toUpperCase()))return{result:h,endIndex:b+g-1};c&&G([a[b],b])}function R(a,b,c){var d,e,f=a.length,g=0,h=[];for(d=b;d<f;d++)if(e=a[d],L(e.charCodeAt(0)))0===g?g=2:3===g?g=4:1===g?g=2:5!==g&&6!==g||(g=7),h.push(e);else if(e===c){if(2===g)g=4;else{if(0!==g&&1!==g)return{};g=3}h.push(".")}else if("+"===e||"-"===e){if(0===g)g=1;else{if(5!==g)return{num:h,endIndex:d-1};g=6}h.push(e)}else if("E"===e||"e"===e){if(2!==g&&4!==g)return{};g=5,h.push(e)}else if(2===g||4===g||7===g)return{num:h,endIndex:d-1};return 2===g||4===g||7===g?{num:h,endIndex:f-1}:{}}y=[].push;function S(a,b){return y.apply(a,b),a}z=function(){function a(a,b,c,d,e){var f,g,h;this.oi=[],e=e||0,f=this,f.Qb=a,g=Array.isArray(a)?a.join(""):a,f.Nc=b,f.mi=c,f.li=d||c+a.length-1,0===b&&0===e&&a?(h=g.toUpperCase(),(J(h)||K(h))&&(e=5,g=h)):1===b&&g!==l&&(g=g.toUpperCase()),f.ni=g,f.hi=e}return a.prototype.type=function(){return this.Nc},a.prototype.subType=function(){return this.hi},a.prototype.stringValue=function(){return this.ni},a}(),b.FormulaToken=z,A=function(){function a(a){void 0===a&&(a=5e3),this.priority=a}return a.prototype.resolveToken=function(a,b,c,d,e){return 0},a.prototype.unparse=function(a,b,c,d){return!0},a}(),b.TokenResolver=A,b.preOperaterTypesMap={"+":0,"-":1},b.operaterTypesMap={":":15,",":16,"+":3,"-":4,"*":5,"/":6,"^":7,"%":2,"&":8,"=":9,"<":11,"<>":10,"<=":12,">":13,">=":14};function T(a,b){for(var c=0;c<a.length;c++)if(m.Mb(a[c],b))return!0;return!1}function U(a,b){var c,d,e,f,g,h,i=[];if(b&&a.indexOf(":")>-1)for(c=a.split(":"),d=b.map(function(a){return a.name()}),e=void 0,f=void 0,g=0;g<c.length;g++)h=c[g],e=T(d,c[g]),f=h.indexOf(" ")>-1,e&&f?i.push("'"+h+"'"):i.push(h);return i}function V(a,b,c,d){var e=[];return S(e,a.slice(0,b)),S(e,d),S(e,a.slice(c+1)),e}B=function(){function a(){}return a.prototype.setParserOption=function(b){var c,e;b!==f&&d.Common.CultureManager.q4()?(e="object"==typeof b&&b.NumberFormat?b.NumberFormat:d.Common.CultureManager.q4().NumberFormat,c=b?e:{}):(c={},e=c),u=a.listSeparator=c.listSeparator||",",t=c.numberDecimalSeparator||".",!b&&a.numberDecimalSeparator||(a.numberGroupSeparator=e.numberGroupSeparator||",",a.numberDecimalSeparator=e.numberDecimalSeparator||"."),v=a.arrayGroupSeparator=c.arrayGroupSeparator||";",w=a.arrayListSeparator=c.arrayListSeparator||","},a.prototype.parse=function(a,b){var c,d;return this.setParserOption(a.culture),c=b.split(""),this.gi=c,d=this.parseToTokens(a,c,!a.ignoreError),this.buildExpressionTree(a,d,!a.ignoreError)},a.prototype.unparse=function(a,b,c){var d,e,f,g;for(void 0===c&&(c=[]),this.Cma(a,b,c),"@"===c[0]&&b&&b.arguments[0]&&1===b.arguments[0].type&&a&&a.source&&a.source.Af&&a.source.Af.allowDynamicArray!==!0&&c.splice(0,1),d=0;d<c.length;d++)if(e=c[d],e&&'"'!==e){for(f=[],g=0;g<e.length;g++)'"'===e[g]&&f.push(g);f.length%2!==0&&(c[d]=e.substr(0,f[0])+'"'+e.substr(f[0]))}return c.join("")},a.prototype.Cma=function(a,b,c){var d,e;if(b)for(this.setParserOption(a.culture),d=a.getResolvers(),e=0;e<d.length&&!d[e].unparse(a,this,b,c);e++);},a.prototype.parseToTokens=function(a,c,d,e){var f,g,h,i,j,k,m,n,o,p,q,r,s,x,A,B;for(void 0===d&&(d=!0),f=this,g=function(a,b,c){return b.length>0&&a.push(new z(b,0,c)),[]},h=c.length,i=[],j=[],k=-1,m=[],p=0,s=!1;p<h&&" "===c[p];)p++;for("="===c[p]&&p++,o=p,x=function(p){var x,B,C,D,E,F,H,I,J,K,M,N,O,T=c[p],W=T.charCodeAt(0),X=void 0;if(64===W&&a.kj&&a.kj.Wu&&a.kj.Wu.allowDynamicArray===!0)n=new z(T,1,p,p,1),i.push(n),j[++k]=n,o=p+1,s=!0;else if(W>=97&&W<=122||W>=65&&W<=90)m.push(T);else if(34===W)X=P(c,p,'"','"',"",d),X?(x=new z(X.result,0,p,p+X.result.length+2,3),X.skipCount&&(x.HTa=c.slice(p,X.endIndex+1).join(""),x.li+=X.skipCount),i.push(x),p=X.endIndex,o=p+1):(S(m,c.slice(p,h)),p=h-1);else if(39===W)X=P(c,p,"'","'","",d),X?(B=a&&a.kj&&a.kj.parent,C=B&&B.sheets,D=U(X.result.join(""),C),E=[],D.length>1&&(F=D.join(":").split(""),E=f.parseToTokens(a,F,d),H=V(c,p,X.endIndex,F),e&&(e.newCharArray=H)),E&&E.length>0?(E.forEach(function(a){a.mi+=p,a.li+=p}),S(i,E)):(m.push("'"),S(m,X.result),m.push("'")),p=X.endIndex):(m.push("'"),p=h-1);else if(91===W)if(X=P(c,p,"[","]","'",d))m.push("["),S(m,X.result),m.push("]"),p=X.endIndex;else{if(f.lda&&0===m.length&&("R"===m[0]||"r"===m[0]||"C"===m[0]||"c"===m[0]))return A=p,"continue";S(m,c.slice(p,h)),p=h-1}else{if(13===W||10===W)return A=p,"continue";if(35===W)I=Q(c,p),I?(i.push(new z(I.result,0,p,p+I.result.length-1,6)),o=p+1,p=I.endIndex):m.push(T);else if(33===W)0===m.length,J=i.length,J>0&&0===i[J-1].Nc?(K=i[J-1],y.apply(K.Qb,m),i[J-1]=new z(K.Qb,0,K.mi,p,12)):i.push(new z(m,0,o,p,12)),m=[],o=p+1;else if(43===W||45===W)M=0===i.length?null:i[i.length-1],0!==m.length?(i.push(new z(m,0,o)),i.push(new z(T,5,p)),m=[],o=p+1):(M&&7===M.Nc&&i.pop(),!M||2!==M.hi&&6!==M.Nc&&0!==M.Nc?(i.push(new z(T,4,p)),o=p+1):(i.push(new z(T,5,p)),o=p+1));else if(T===t||L(W))m.length>0?m.push(T):(N=R(c,p,t),N.num?(q=N.endIndex,O=N.num,q<=h-2&&"!"===c[q+1]?(S(m,O),o=q):(i.push(new z(O,0,p,q,4)),o=q+1),p=q):m.push(T));else if(123===W)m.length>0&&d&&G(T,p),n=new z(l,1,p,p,1),i.push(n),j[++k]=n,o=p+1;else if(T===v&&k>=0&&j[k].value===l)m=g(i,m,o),k<0&&d&&G(T,p),i.push(new z(v,3,p,p)),o=p+1;else if(125===W)m=g(i,m,o),q<0&&d&&G(T,p),r=j[k--],r=new z(T,r.Nc,p,p,2),i.push(r),o=p+1;else if(32===W)m=g(i,m,o),o=p+1;else if(T===u||T===w||T===v)m=g(i,m,o),s&&T===u&&(s=!1,r=new z(")",1,p,p,2),i.push(r)),k<0||1!==j[k].Nc?i.push(new z(u,5,p,p,10)):i.push(new z(T,3,p,p)),o=p+1;else if(37===W)m=g(i,m,o),i.push(new z(c[p],6,p,p)),o=p+1;else if(p+2<=h&&b.operaterTypesMap[T+c[p+1]])m=g(i,m,o),i.push(new z(c.slice(p,p+2),5,p,p+1,5)),p++,o=p+1;else if(b.operaterTypesMap[T])m=g(i,m,o),i.push(new z(T,5,p,p)),o=p+1;else if("("===T)m.length>0?(n=new z(m,1,o,p,1),m=[]):n=new z(T,2,p,p,1),i.push(n),j[++k]=n,o=p+1,s=!1;else if(")"===T){if(m=g(i,m,o),k<0)return d&&G(T,p),A=p,"continue";r=j[k--],r=new z(T,r.Nc,p,p,2),i.push(r),o=p+1}else if(":"===T)m=g(i,m,o),i.push(new z(T,5,p,p,11)),o=p+1;else if("\r"===T||"\n"===T);else{if("\\"===T){if(p++,p>=h)return d&&G(T,p),A=p,"continue";m.push(T),T=c[p]}m.push(T)}}A=p},B=p;B<h;B++)x(B),B=A;return g(i,m,o),i},a.prototype.buildExpressionTree=function(a,b,c){var d=this.ii(a,b,c),e=this.ji(a,d,c);return c&&(e||F(),this.rSa(e)),e},a.prototype.rSa=function(a){for(var b,c,d,e,f,g,h,i;10===a.type;)a=a.value;if(b=this,9===a.type)a.value||F(),b.rSa(a.value),a.value2&&b.rSa(a.value2);else if(7===a.type)for(c=a.arguments,d=c.length,e=a.function,e&&(f=e.minArgs,g=e.maxArgs,(d<f||d>g)&&F()),h=0;h<d;h++)i=c[h],i||F(),b.rSa(i)},a.prototype.ji=function(a,b,c){var d,f,g,h,i,j,k=this.ki(a,b,c);for(h=3;h<k.length;)if(i=k[h],j=k[h-2],9!==j.type&&c&&F(),i&&9===i.type){for(;h>=3&&s[i.value]>=s[j.value];)f=k[h-3],g=k[h-1],d=e.Kh(j.operatorType,f,g),k.splice(h-3,3,d),h-=2,h>=3&&(j=k[h-2]);h+=2}else h++;if(1===k.length)return k[0];for(h=k.length-2;h>0;h-=2)f=k[h-1],g=k[h+1],9!==k[h].type&&c&&F(),d=e.Kh(k[h].operatorType,f,g),k.splice(h-1,3,d);return d},a.prototype.ki=function(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r;for(b=Array.isArray(b)?b:[b],d=[],f=b.length,g=0;g<f;g++){if(h=b[g],i=h,9===h.type){if(0===h.operatorType||1===h.operatorType)if(g===f-1)c&&F();else{for(j=g;9===b[j].type&&b[j].operatorType<=1;)j++;for(k=this.ji(a,b[j]),l=j-1;l>=g;l--)i=e.Kh(b[l].operatorType,k),k=i;i=k,g=j}else if(2===h.operatorType){if(0!==g){i=e.Kh(h.operatorType,this.ji(a,d[d.length-1])),d[d.length-1]=i;continue}c&&F()}}else if(10===h.type)h.value=this.ji(a,h.value),i=h;else if(7===h.type){if(m=0,n=h.arguments,o=[],p=[],n.length>0){for(q=0;q<=n.length;q++)r=n[q],q===n.length||0===r.type&&r.value===u?(m===q?o.push(new e.Expression(11)):o.push(this.ji(a,p)),m=q+1,p=[]):p.push(r);h.arguments=o}i=h}d.push(i)}return d},a.prototype.ii=function(a,b,c){var d,e,f=[];for(d=0,e=b.length;d<e;)d=this.resolveToken(a,b,f,d,c);return f},a.prototype.resolveToken=function(a,b,c,d,h){var i,j,k,l,m,n,o=b[d],p=a.getResolvers();for(i=0;i<p.length;i++)if(j=p[i].resolveToken(a,this,b,d,h)){k=j.expr,l=d-1,k&&j.index!==f?d=j.index-1:k=j,m=c.length>0?c[c.length-1]:g,m&&0!==k.type&&7!==k.type&&k.type<9&&0!==m.type&&7!==m.type&&m.type<9&&(n=b[l].li,n<o.mi-1&&c.push(e.Kh(17," "))),c.push(k);break}return d+1},a.prototype.resolveSubTokens=function(a,b,c,d){for(var e=[];c<b.length&&2!==b[c].hi;)c=this.resolveToken(a,b,e,c,d);return{exprs:e,index:c+1}},a}(),b.Parser=B,C=function(){function a(a,b,c,d){this.Eh=!1,this.ignoreError=!1;var e=this;e.useR1C1=b,e.baseIdentity=c,e.option=d,e.source=a}return a.prototype.getExternalSource=function(a,b){var c,d=this.source.getCalcService(),e=d.getAllSourceModels();for(c=0;c<e.length;c++)if(m.Mb(e[c].getSource().getName(),b))return e[c].getSource();return g},a.prototype.getExternalSourceToken=function(a){return a.getName()},a.prototype.setSource=function(a){this.source=a},a.prototype.getResolvers=function(){var a=(this.source||this.kj).getCalcService();return a&&a.getResolvers()},a.prototype.addResolver=function(a){var b=(this.source||this.kj).getCalcService();b&&b.addResolver(a)},a.prototype.getFunction=function(a){var b,c=a,d=e.getMapping()&&e.getMapping().builtInFunctionsMapping;if(!o(d))for(b in d)d[b].alias===a&&(c=b);return this.source&&this.source.getCustomFunction(c)||e.Functions.findGlobalFunction(a)},a}(),b.ParserContext=C,e.CalcSource.prototype.getParserContext=function(a,b,c){return new C(this,a,b,c)};function W(a,b,c){var d,e;if(!b||0===b.length||X(a,b)||X(a,c))return[];if(d=b,c)for(d.push(":"),e=0;e<c.length;e++)d.push(c[e]);return d}function X(a,b){if(!b||0===b.length||!a.Eh)return!1;var c="'"===b[0]?1:0;return"["===b[c]&&b.indexOf("]")>c}D=function(a){E(c,a);function c(){return null!==a&&a.apply(this,arguments)||this}return c.prototype.resolveToken=function(a,c,d,g,h){var i,j,k,n,o,p,q,r,s,t,u,w=d[g],x=w.ni,y=w.Qb,z=w.Nc,A=null,B=w.hi;if(0===z&&12===B){if(o=void 0,x&&(o=x,"'"===o.charAt(0)&&(o=o.substring(1,o.length-1))),g++,o&&(A=a.getExternalSource("",o)),w=d[g],!w)return i=new e.Expression(8),i.value=x,i;x=w.ni}if(0===z)0===w.hi?(k=x.toUpperCase(),J(k)||K(k)?(w.hi=5,w.ni=k,i=new e.Expression(4),i.value=J(k)):(i=new e.Expression(8),i.value=x)):4===w.hi?(i=new e.Expression(2),i.value=parseFloat(x),i.originalValue=x):3===w.hi?(i=new e.Expression(3),i.value=x):5===w.hi?(i=new e.Expression(4),i.value=J(x)):6===w.hi?(i=new e.Expression(5),i.value=e.CalcError.parse(x)):7===w.hi&&(i=new e.Expression(8),i.value=x);else if(1===z){if(x===l){for(i=new e.Expression(6),g++,k=[[]],j=0,p=0,q=0;g<d.length&&2!==d[g].hi;){if(w=d[g],g<d.length-1&&4===w.Nc&&"-"===w.ni&&4===d[g+1].hi&&(g++,w=d[g],w.Qb.unshift("-"),w.ni="-"+w.ni),3===w.Nc){if(w.ni===v){if(p!==q)throw m.Kb(e.sR().Exp_InvalidArrayColumns,[w.mi]);k.push([]),j++,q=0}}else{if(0!==w.Nc||4!==w.hi&&3!==w.hi&&5!==w.hi&&6!==w.hi)throw e.sR().Exp_InvalidArray;r=w.ni,s=r,4===w.hi?s=parseFloat(r):5===w.hi?s="TRUE"===r.toUpperCase():6===w.hi&&(s=e.CalcError.parse(r)),k[j].push(s),0===j&&p++,q++}g++}if(p!==q)throw m.Kb(e.sR().Exp_InvalidArrayColumns,[w.mi]);return g++,i.value=new e.CalcArray(k),{expr:i,index:g}}if(y.length>0)return t=a.source&&a.source.Af&&a.source.Af.allowDynamicArray,"@"!==y[0]||t||(w.ni=y.slice(1).join(""),x=w.ni),i=new e.Expression(7),i.functionName=x,u=a.getFunction(i.functionName)||e.Functions.findGlobalFunction(i.functionName),t===!1&&u&&u.isDynamicArrayFunction===!0&&(u=f),i.function=u,(n=c.resolveSubTokens(a,d,g+1))?(i.arguments=n.exprs,{expr:i,index:n.index}):(i.arguments=[],i)}else if(4===z||6===z||5===z)i=e.Kh(4===z?b.preOperaterTypesMap[x]:b.operaterTypesMap[x],x);else if(2===z){if(i=new e.Expression(10),n=c.resolveSubTokens(a,d,g+1))return i.value=n.exprs,{expr:i,index:n.index};h&&F()}else 3===z&&(i=new e.Expression(0),i.value=x);return A&&i&&(i.source=A,i={expr:i,index:g+1}),i},c.prototype.unparse=function(a,b,c,d){var f,g,h,i,j,k=this;if(6===c.type||4===c.type||2===c.type||5===c.type||3===c.type)k.qi(a,c,d);else if(9===c.type)k.ri(a,b,c,d);else if(10===c.type)d.push("("),b.Cma(a,c.value,d),d.push(")");else{if(7!==c.type)return(1===c.type||8===c.type)&&(k.unparseRefenceExpressions(a,b,c,d),!0);for(f=c.function&&c.function.name||c.functionName,g=e.getMapping()&&e.getMapping().builtInFunctionsMapping,h=g&&g[f],S(d,(h&&h.alias||f).split("")),i="@"===f?["",""]:["(",")"],d.push(i[0]),j=0;j<c.arguments.length;j++)0!==j&&d.push(u),b.Cma(a,c.arguments[j],d);d.push(i[1])}return!0},c.prototype.unparseSource=function(a,b,c,d){if(a.getExternalSourceToken){if(c!==e.BangSource){var f=W(a,a.getExternalSourceToken(c).split(""),d&&a.getExternalSourceToken(d).split(""));if(!(f.length>0))return!1;y.apply(b,f)}return b.push("!"),!0}return!1},c.prototype.unparseRefenceExpressions=function(a,b,c,d){if(c.source===e.BangSource)d.push("!");else if(c.source){var f=this.unparseSource(a,d,c.source,c.endSource);if(!f)return void d.push("#","R","E","F","!")}8===c.type&&d.push(c.value)},c.prototype.ri=function(a,c,d,e){var f=d.operatorType;2===f?(c.Cma(a,d.value,e),e.push("%")):0===f||1===f?(e.push(b.di[f]),c.Cma(a,d.value,e)):(c.Cma(a,d.value,e),e.push(b.di[f]),c.Cma(a,d.value2,e))},c.prototype.qi=function(a,b,c){var d,j,k,l,n,o,p,q,r=e.sR().Exp_InvalidArray;if(3===b.type)c.push('"'),c.push(m.Gb(b.value,'"','""')),c.push('"');else if(2===b.type)d=b.originalValue||""+b.value,"."!==t&&(d=d.replace(".",t)),c.push(d);else if(4===b.type)c.push(b.value?e.getBoolean().boolean_true:e.getBoolean().boolean_false);else if(6===b.type){if(c.push("{"),j=b.value,j.getRowCount()<=0)throw r;for(k=0,l=j.getRowCount();k<l;k++)for(k>=1&&c.push(v),n=0,o=j.getColumnCount();n<o;n++){if(0!==n&&c.push(w),p=j.getValue(k,n),p===f||p===g)throw r;q=typeof p,q===h?(c.push('"'),c.push(p),c.push('"')):q===i?c.push(p?e.getBoolean().boolean_true:e.getBoolean().boolean_false):"number"===q&&"."!==t?c.push((""+p).replace(".",t)):c.push(""+p)}c.push("}")}else 5===b.type?c.push(""+b.value):11===b.type},c}(A),b.DefaultTokenResolver=D,e.ParserWrapper.XAb=function(){if(B.numberDecimalSeparator===f){var a=new B;a.setParserOption(!0)}return B.numberDecimalSeparator},e.ParserWrapper.YAb=function(){if(B.numberGroupSeparator===f){var a=new B;a.setParserOption(!0)}return B.numberGroupSeparator}},"./src/calc.common.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/calcEngine.res.en.ts"),b.SR={en:e.resource},b.ErrorCodeList=[0,7,15,23,29,42,36,99,100],f="number",g="string",h="boolean",i="TRUE",j="FALSE",k="#NULL!",l="#DIV/0!",m="#VALUE!",n="#REF!",o="#NAME?",p="#N/A",q="#NUM!",r="#SPILL!",s="#CALC!",t=[k,l,m,n,o,p,q,r,s],b.ErrorList=t,b.BAND_INDEX_CONST=-2147483648,b.MAX_ROW_COUNT=1048576,b.MAX_COLUMN_COUNT=16384,u=d.Common.j,v=u.Ca,w=u.Fa,x=u.Ea,y=d.Common.k.ac,z=d.Common.q,A=parseInt,B=isNaN,C=d.Common.l,D=C.Ra,E=d.Common.u;function la(a){return a&&a.toUpperCase()}function ma(a){var b,c;if(a){if(7===a.type&&("SUBTOTAL"===a.functionName||"AGGREGATE"===a.functionName))return!0;for(b=a.arguments&&a.arguments.length,c=0;c<b;c++)if(ma(a.arguments[c]))return!0;if(ma(a.value)||ma(a.value2))return!0}return!1}F=new d.Common.ResourceManager(b.SR),b.sR=F.getResource.bind(F),b.getMapping=function(){return ia&&ia.resourceMapping},b.getBoolean=function(){var a=b.getMapping()&&b.getMapping().booleanMapping;return{boolean_true:a&&a.boolean_true||i,boolean_false:a&&a.boolean_false||j}},G=null,H=void 0,I=Math.abs,J=Math.exp,K=Math.log,L=Math.pow,M=Math.floor,N={},b.BangSource=N,O={},b.RefErrorSource=O,b.missingArgument=P,Q={},R=function(){function a(c){var d=a.nf(c);if(!d)throw b.sR().Exp_NotSupported;this._error=d.error,this._code=d.code}return a.prototype.toString=function(){var a=b.getMapping()&&b.getMapping().clacErrorMapping,c=a&&a[this._error];return c||this._error},a.prototype.clone=function(){return new a(this._error)},a.prototype.toJSON=function(){return{_calcError:this._error,_code:this._code}},a.parse=function(b){try{return new a(b)}catch(a){return H}},a.nf=function(a){var c,d;if(a)for(c=0;c<t.length;c++)if(d=t[c],d===a||d===la(a))return{error:d,code:b.ErrorCodeList[c]};return H},a}(),b.CalcError=R,S={Name:new R(o),Null:new R(k),DivideByZero:new R(l),NotAvailable:new R(p),Value:new R(m),Reference:new R(n),Number:new R(q),Spill:new R(r),Calc:new R(s)},b.Errors=S,T=S.Value,U=S.Reference,V=S.Number,W=S.DivideByZero,X=S.NotAvailable,Y=S.Null,Z={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},$=function(){function a(){}return a}(),b.ParserWrapper=$;function na(a){return isNaN(a)||!isFinite(a)}function oa(a,b){var c,d,e,i,j,k,l=G;if(!a)return b.value=0,!0;c=typeof a;try{if(c===f)l=a;else if(c===g){if(a=a.trim(),0===a.length)return b.value=0,!0;if(d=$.XAb(),e=$.YAb(),"."!==d&&"."!==e&&a.indexOf(".")>=0||","!==d&&","!==e&&a.indexOf(",")>=0)return!1;if(i=!1,"%"===a.charAt(a.length-1)&&(i=!0,a=a.substr(0,a.length-1)),"$"===a[0]||"$"===a[a.length-1])return!1;if(a.indexOf(d)!==a.lastIndexOf(d))return!1;if(a.length>=2&&"0"===a[0]&&"x"===a[1])return!1;if(l=(+a).valueOf(),na(l)){if(j=a.charCodeAt(0),j|=32,a.length>4&&j>=96&&j<=122&&(k=a[0]+a[1]+a[2],k=k.toUpperCase(),!Z[k]))return!1;if("/"===a[0]||"/"===a[a.length-1])return!1;if("#"===a[0]||"#"===a[a.length-1])return!1;if(l=new Date(a),na(l.valueOf()))return!1;l=C.Ra(l)}i&&(l/=100)}else if(c===h)l=a?1:0;else{if(!(a instanceof Date))return!1;l=C.Ra(a)}}catch(a){return!1}return b.value=l,!0}function pa(a){var c={value:0};if(oa(a,c))return c.value;throw b.sR().Exp_InvalidCast}function qa(a,b){return b&&(a===G||a===H||typeof a===g&&""===a.trim())}function ra(a,b){try{if(a)if(typeof a===h);else if(a instanceof Date)a=0!==C.Ra(a);else{if(!ta(a))return!1;a=0!==a}else a=!1}catch(a){return!1}return b.value=a,!0}function sa(a,b,c,e,i){var j,k,l;if(ua(a))return a;if(j={value:G},k=Q,0!==b&&qa(a,e))return k;switch(b){case 1:case 5:if(c&&5!==b){if(typeof a===h&&i)return k;a=oa(a,j)?j.value:k}else typeof a===f||(a=a instanceof Date?C.Ra(a):k);break;case 4:typeof a===g?(l=d.Common.l.Qa(a),a=l!==H&&l!==G?C.Ra(l):k):c?a=oa(a,j)?j.value:k:typeof a===f||a instanceof Date||(a=k);break;case 3:c?a=oa(a,j)?j.value:k:typeof a!==h&&(a=k);break;case 2:a=a===G||a===H?"":""+a}return a}_=function(){function a(a){this.array=a}return a.prototype.getRowCount=function(){return this.array.length},a.prototype.getColumnCount=function(){var a=this.array[0];return a&&a.length||0},a.prototype.getValue=function(a,b){var c,d=this.array,e=a;return"number"!=typeof b&&(c=a,e=c.row,b=c.column),e<0||b<0||e>=d.length||b>=d[0].length?T:this.array[e][b]},a.prototype.getValueByIndex=function(a){var b=this.getColumnCount(),c=Math.floor(a/b),d=a%b;return this.getValue(c,d)},a.prototype.toArray=function(a,b,c,d,e,f,g){var h,i,j,k,l,m,n,o,p;if(void 0===b&&(b=!0),h=this,i=0,j=0,k=[],n=Q,i=h.getRowCount())for(j=h.getColumnCount(),o=0;o<i;o++)for(b||(m=[],k.push(m)),p=0;p<j;p++){if(l=h.getValue(o,p),c&&ua(l))return k=[l],k.isError=!0,k;if(l=sa(l,a,!1,f),d&&l===n)return k=[l],k.isError=!0,k;b?k.push(l):m.push(l)}return k.rowCount=i,k.colCount=j,k.rangeCount=1,k},a.prototype.slice=function(b,c,d,e){var f,g,h,i=this,j=i.array,k=[];for(b=b<0?0:b,c=c<0?0:c,d=b+d>i.getRowCount()?i.getRowCount()-b:d,e=c+e>i.getColumnCount()?i.getColumnCount()-c:e,g=0;g<d;g++)for(f=[],k.push(f),h=0;h<e;h++)f.push(j[g+b][h+c]);return new a(k)},a}(),b.CalcArray=_;function ta(a,b){return typeof a===f||a instanceof Date||!b&&(typeof a===h||!isNaN(a)&&!isNaN(parseFloat(a)))}function ua(a){return a instanceof R}function va(a){return a instanceof _}function wa(a){return a instanceof ea}aa=["o","n","s","b","d"],ba=function(){function a(){}return a.jja=function(a){return ua(a)&&a._code===b.ErrorCodeList[5]},a.Nh=function(a){return isNaN(a)||!isFinite(a)?V:a},a.Ph=function(b,c,d,e,f,g,h,i){var j,k,l;if(b&&b.length&&b.rowCount&&b.colCount)return b;if(va(b))j=b.toArray(c,d,e,f,g),j.isArray=!0;else if(wa(b))j=b.toArray(c,d,e,f,g,h,i),j.isReference=!0;else if(v(b)){if(j=[],0===b.length)return j;if(v(b[0]))return a.Oh(b,c,!0);for(k=0;k<b.length;k++)l=sa(b[k],c,!1),l===a.CalcConvertedError&&(j.isConvertError=!0),j.push(l);j.rowCount=1,j.colCount=b.length,j.rangeCount=1}else b=sa(b,c,!0),e&&a.vf(b)?(j=[T],j.isError=!0):b===a.CalcConvertedError?(j=[a.CalcConvertedError],j.isConvertError=!0):d?(j=[],j.push(b)):(j=[[]],j[0].push(b)),j.rowCount=1,j.colCount=1,j.rangeCount=1;return j},a.Oh=function(b,c,d){var e,g,i,j,k,l,m,n,o,p,q,r,s;if(!b||!b.length||!b[0].length)return e=[],e.isError=!0,[[T]];if(0===c)return b;if(g=aa[c],i=b.length,j=b[0].length,n={value:G},o=!1,p=!1,q=a.CalcConvertedError,e=b[g],!e)for(e=[],b[g]=e,r=0;r<i;r++)for(k=b[r],l=e[r]=[],s=0;s<j;s++)if(m=k[s],ua(m))o||(e.isError=!0,o=!0),l.push(m);else{switch(c){case 1:case 5:d&&5!==c?oa(m,n)?m=n.value:(p||(p=!0,e.isConvertError=!0),m=0):typeof m===f||m instanceof Date||(p||(p=!0,e.isConvertError=!0),m=q);break;case 3:d?ra(m,n)?m=n.value:(p||(p=!0,e.isConvertError=!0),m=!1):typeof m!==h&&(p||(p=!0,e.isConvertError=!0),m=q);break;case 2:m=m===G||m===H?"":""+m}l.push(m)}return e},a.Rh=function(a){var c=pa(a);if(I(c)<1e21)return parseInt(""+c,10);throw b.sR().Exp_InvalidCast},a.Sh=function(a,b){var c=oa(a,b);return!!c&&(I(b.value)<1e21&&(b.value=parseInt(""+b.value,10),!0))},a.Vh=function(c){if(!c)return!1;if(typeof c===h)return c;if(c instanceof Date)return 0!==C.Ra(c);if(a.Na(c))return 0!==c;if(a.vf(c))return!1;throw b.sR().Exp_InvalidCast},a.bc=function(a){try{if(a===H||a===G)return"";if(typeof a===h)return a?i:j;if(typeof a===g)return a;if(a instanceof Date)return""+C.Ra(a);if(va(a))throw b.sR().Exp_InvalidCast;return""+a}catch(a){throw b.sR().Exp_InvalidCast}},a.Wh=function(c){var d={value:G};if(a.Xh(c,d))return d.value;throw b.sR().Exp_InvalidCast},a.Xh=function(a,b){var c,e,h,i;if(a)if(a instanceof Date)b.value=new Date(a.valueOf());else if(typeof a===g){if(c=d.Common.l.Qa(a),!c)if(isNaN(a)){if(c=new Date(a),isNaN(c.valueOf()))return!1;try{if(e=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,h=E.ib(E.Db(a.replace(/ |\n/g,"")," ")," "),i=e.exec(h),i&&4===i.length&&(i.indexOf(""+c.getFullYear())===-1||i.indexOf(""+c.getMonth())===-1||i.indexOf(""+c.getDate())===-1))return!1}catch(a){return!1}}else if(c=d.Common.l.Xb(parseFloat(a)),!c)return!1;b.value=c}else{if(typeof a!==f)return!1;b.value=d.Common.l.Xb(a)}else b.value=d.Common.l.Xb(0);return!0},a.CalcConvertedError=Q,a.Ca=va,a.Na=ta,a.vf=ua,a.Fh=wa,a.wf=sa,a.j$a=qa,a.Qh=na,a.Pa=pa,a.Th=oa,a.Uh=ra,a}(),b.Convert=ba,function(a){a[a.unknow=0]="unknow",a[a.reference=1]="reference",a[a.number=2]="number",a[a.string=3]="string",a[a.boolean=4]="boolean",a[a.error=5]="error",a[a.array=6]="array",a[a.function=7]="function",a[a.name=8]="name",a[a.operator=9]="operator",a[a.parentheses=10]="parentheses",a[a.missingArgument=11]="missingArgument",a[a.expand=12]="expand",a[a.structReference=13]="structReference",a[a.spillReference=33]="spillReference"}(ca=b.ExpressionType||(b.ExpressionType={})),da=function(){function a(a){this.type=a}return a.prototype.sf=function(){return G},a.prototype.offset=function(a,b,c,d,e){return G},a.prototype.offsetWhenCopy=function(a,b,c,d,e,f,g,h,i,j){return G},a.prototype.getRange=function(a,b){var c,d=[];for(c=2;c<arguments.length;c++)d[c-2]=arguments[c];return G},a}(),b.Expression=da,ea=function(){function a(a,b){var c=this;c.xf=a,b?(c.yf=b,c.zf=b.length):c.zf=1}return a.prototype.getRangeCount=function(){return this.zf},a.prototype.getSource=function(){return this.xf},a.prototype.create=function(b){return new a(this.xf,b)},a.prototype.toArray=function(a,b,c,d,e,f,g){var h=this.xf,i=h.referenceToArray;return i&&i.call(h,this,a,b,c,d,e,f,g)},a.prototype.getRow=function(a){return this.yf?this.yf[a||0].row:0},a.prototype.getColumn=function(a){return this.yf?this.yf[a||0].col:0},a.prototype.getRowCount=function(a){return this.yf?this.yf[a||0].rowCount:this.xf.getRowCount()},a.prototype.getColumnCount=function(a){return this.yf?this.yf[a||0].colCount:this.xf.getColumnCount()},a.prototype.getValue=function(a,b,c){var d,e,g;if(typeof a===f?(d=arguments[1],e=arguments[2],b=arguments[0]):(a=a,d=a.row,e=a.col),b=b||0,d>=0||e>=0){if(g=this.yf,!g)return this.xf.getValue(d,e);if(b<g.length)return this.xf.getValue(d+g[b].row,e+g[b].col)}return U},a.prototype.getValueByIndex=function(a){var b=this.getColumnCount(),c=Math.floor(a/b),d=a%b;return this.getValue(0,c,d)},a.prototype.isHiddenRow=function(a,b,c){return this.xf.isHiddenRow(b+this.getRow(a),c)},a.prototype.isSubtotal=function(a,b,c){var d,e=this.xf;return 0===a&&b<e.getRowCount()&&c<e.getColumnCount()&&(d=e.getCalcSourceModel().ATa(b,c),ma(d))},a}(),b.CalcReference=ea,fa=function(){function a(b){this.id=a.sourceId++,this.Af=b,this.Bf=null}return a.prototype.getCalcService=function(){return this.Af},a.prototype.Cf=function(){return this.Af},a.prototype.setCalcService=function(a){this.Af=a},a.prototype.getCalcSourceModel=function(){return this.Bf},a.prototype.setCalcSourceModel=function(a){this.Bf=a},a.prototype.getValue=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a];return G},a.prototype.getName=function(){return""},a.prototype.setValue=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a]},a.prototype.getReference=function(a){return new ea(this,a&&[a])},a.prototype.getSources=function(a){return[this]},a.prototype.referenceToArray=function(a,b,c,d,e,f,g,h){return a.toArray(b,c,d,e,f,g,h)},a.prototype.setFormula=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a]},a.prototype.setArrayFormula=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a]},a.prototype.getRowCount=function(){return 1e3},a.prototype.getColumnCount=function(){return 100},a.prototype.isHiddenRow=function(a,b){return!1},a.prototype.startCalculation=function(){},a.prototype.endCalculation=function(){},a.prototype.getCustomFunction=function(a){return G},a.prototype.getCustomName=function(a){return G},a.prototype.refresh=function(){},a.prototype.toJSON=function(a,b){var c,d=[];for(c=2;c<arguments.length;c++)d[c-2]=arguments[c]},a.sourceId=1,a}(),b.CalcSource=fa;function xa(a,b,c){var d=new da(5);return b&&(d.source=b),c&&(d.endSource=c),d.value=a,d}b.Hh=xa,b.Ih=xa(U);function ya(a,b){var c=new da(7);return c.arguments=b,a instanceof da?(c.function=a.function,c.functionName=a.functionName):(c.function=a.name&&a,c.functionName=a.name||a),c}b.Jh=ya;function za(a,b){var c=new da(12);return c.value=a,c.needExpendIndexs=b,c}b.createExpandExpression=za;function Aa(a,b,c){var d=new da(9);return d.operatorType=a,d.value=b,d.value2=c,d}b.Kh=Aa;function Ba(a){var b=new da(10);return b.value=a,b}b.Lh=Ba;function Ca(a){var b=new da(3);return b.value=a,b}b.createStringExpression=Ca;function Da(a){var b=new da(2);return b.value=a,b}b.createNumberExpression=Da,ga=function(){function a(){}return a.Yh=function(a,b){var c=16777216;return a===b||I(a-b)<I(a)/(c*c);
},a.getArrayValue=function(a,b,c){return a?b<a.getRowCount()&&c<a.getColumnCount()?a.getValue(b,c):c>=a.getColumnCount()&&1===a.getColumnCount()&&b<a.getRowCount()?a.getValue(b,0):b>=a.getRowCount()&&1===a.getColumnCount()&&c<a.getColumnCount()?a.getValue(0,c):T:T},a.tryExtractToSingleValue=function(a){var b,c=!0;return(wa(a)||va(a))&&(b=ba.Ph(a,0,!1,!0),b.isError?a=b[0]:1===b.rowCount&&1===b.colCount?a=b[0][0]:(a=b,c=!1)),{value:a,success:c}},a}(),b.Zh=ga;function Ea(a,b){return a.charAt(b)}b.charAtFunc=Ea;function Fa(a,b){for(var c=a.length,d=!1;b<c&&!isNaN(+Ea(a,b));)b++,d=!0;for(b<c&&"."===Ea(a,b)&&b++;b<c&&!isNaN(+Ea(a,b));)b++,d=!0;if(b<c&&("E"===Ea(a,b)||"e"===Ea(a,b)))for(b++,d=!1,b<c&&("+"===Ea(a,b)||"-"===Ea(a,b))&&b++;b<c&&!isNaN(+Ea(a,b));)b++,d=!0;return{Vi:d,mi:b}}function Ga(a){return"string"==typeof a}ha=function(){function a(a){this.Di=a}return a.prototype.$j=function(a){var b,c,d,e,f=this.Di;if(u.Ca(f)||(f=[f]),f[0]===-1)return!0;for(b=0;b<f.length;b++)if(c=f[b],d=void 0,e=void 0,Ga(c)){if(c=c.split(" "),d=c[0],e=A(c[1]),"!="===d&&a!==e||">"===d&&a>e||">="===d&&a>=e||"%="===d&&a%2===e)return!0}else if(a===c)return!0;return!1},a.prototype._j=function(){return this.Di},a}(),function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;!function(a){a[a.normal=0]="normal",a[a.allwaysExpand=1]="allwaysExpand",a[a.neverExpand=2]="neverExpand"}(c=a.ArrayArgumentEvaluateMode||(a.ArrayArgumentEvaluateMode={})),d=function(){function a(a,b,c,d){void 0===b&&(b=0),void 0===c&&(c=0),this.name=a,this.minArgs=b,this.maxArgs=c;var e=this;e.$h=d,e.typeName=""}return a.prototype.description=function(){var a=this,c=b.sR()._h;return a.$h?a.$h:c&&c[a.name]},a.prototype.acceptsArray=function(a){return!1},a.prototype.acceptsReference=function(a){return!1},a.prototype.acceptsError=function(a){return!1},a.prototype.acceptsMissingArgument=function(a){return!1},a.prototype.isVolatile=function(){return!1},a.prototype.isContextSensitive=function(){return!1},a.prototype.isBranch=function(){return!1},a.prototype.findTestArgument=function(){return-1},a.prototype.findBranchArgument=function(a){return-1},a.prototype.expandRows=function(){return!0},a.prototype.expandColumns=function(){return!0},a.prototype.precedentReference=function(){return!0},a.prototype.returnReference=function(){return!1},a.prototype.evaluate=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a]},a.prototype.evaluateWithContext=function(a,b){var c=this,d=b;return c.isContextSensitive()&&(d=[a].concat(d)),c.evaluate.apply(c,d)},a.prototype.toJSON=function(){var a,b={};for(a in this)this.hasOwnProperty(a)&&(b[a]=this[a]);return b},a.prototype.fromJSON=function(a){if(a)for(var b in a)a[b]!==H&&(this[b]=a[b])},a.ai=function(b,c,d){var e,f=new a(b,0,255);if(c&&"function"==typeof c&&(f.evaluate=c),d)for(e in d)d.hasOwnProperty(e)&&"override"!==e&&(f[e]=d[e]);return f},a}(),a.Function=d,e=function(a){ka(b,a);function b(b,c,d,e){return a.call(this,b,c,d,e)||this}return b.prototype.isContextSensitive=function(){return!0},b.prototype.evaluate=function(a,b){return this.evaluateAsync.apply(this,arguments)},b.prototype.evaluateAsync=function(a,b){this.evaluate.apply(this,arguments)},b.prototype.defaultValue=function(){return 0},b.prototype.evaluateMode=function(){return 0},b.prototype.evaluateWhenArgumentsIsSame=function(){return!0},b.prototype.interval=function(){return 1e4},b}(d),a.AsyncFunction=e,a.AsyncFunctionEvaluateMode={onRecalculation:0,calculateOnce:1,onInterval:2},a.bi={},a.ci={};function t(b,c){return a.ci[la(b)]=c,c}a.defineGlobalCustomFunction=t;function v(c){var d,e,f;return c?(c=la(c),d=a.bi,e=a.ci,f=b.getMapping()&&b.getMapping().builtInFunctionsMapping,d&&(N(f,c)||d[c])||e&&e[c]):F()}a.findGlobalFunction=v;function C(){return F()}a.findGlobalFunctions=C;function E(b){if(!b)return a.bi={},void(a.ci={});b=la(b);var c=a.bi,d=a.ci;c[b]?delete c[b]:d[b]&&delete d[b]}a.removeGlobalFunction=E;function F(){var b,c,d=a.bi,e=a.ci,f=[];for(b in d)f.push(d[b]);for(c in e)f.push(e[c]);return f}function N(b,c){var d,e=a.bi;if(!w(b))for(d in b)if(b[d].alias===c)return e[d];return H}f=b.sR().Exp_Format,g=function(){function a(a,b,c){this.Ri=a,this.Si=b,this.kja=c||"i"}return a.prototype.Pi=function(){return this.Ri},a.prototype.Qi=function(){return this.Si},a.prototype.lja=function(){return this.kja},a.prototype.bc=function(a){a=a||"i";var b=this,c=b.Ri,d=b.Si,e="";return 0===c&&0!==d||(e+=""+c),d===-1?e+="-":0!==c&&d>0&&(e+="+"),d!==-1&&0!==d&&1!==d&&(e+=""+d),0!==d&&(e+=a),e},a}(),a.Ui=g;function O(a){function c(a){var c,d,e,h,i=0,j=0,k=!1,l=0,m=0,n=0,o=a.length;if(!a)throw b.sR().Exp_ArgumentNull;if(0===o)throw f;if(n<o&&("+"===Ea(a,n)||"-"===Ea(a,n))&&n++,h=Fa(a,n),n=h.mi,c=h.Vi,n<o&&("+"===Ea(a,n)||"-"===Ea(a,n))?(l=n,n++,h=Fa(a,n),n=h.mi,d=h.Vi,n<o&&("i"===Ea(a,n)||"j"===Ea(a,n))&&(e=Ea(a,n),n++,k=!0),m=n-l):n<o&&("i"===Ea(a,n)||"j"===Ea(a,n))?(e=Ea(a,n),n++,m=n,d=c,k=!0,c=!1):l=n,n<o)throw f;if(l>0){if(!c)throw f;i=parseInt(a.substr(0,l),10)}if(m>0){if(!k)throw f;if(1===m||2===m&&"+"===Ea(a,l))j=1;else if(2===m&&"-"===Ea(a,l))j=-1;else{if(!d)throw f;j=parseInt(a.substr(l,m-1),10)}}return new g(i,j,e)}try{return a?"number"==typeof a?new g(a,0):"string"==typeof a?c(a):null:new g(0,0)}catch(a){return null}}a.Wi=O,h=ba.Th,i=ba.Rh,j=ba.Pa,k=ba.Na,l=ba.Ph,m=ba.Nh,n=ba.vf,o=ga.Yh;function P(c,e,f){if(w(c))throw b.sR().Exp_InvalidFunctionName;if(c=c.toUpperCase(),a.bi[c])throw b.sR().Exp_InvalidOverrideFunction;var g=a.bi[c];if(g){if(!f||!f.override)throw b.sR().Exp_OverrideNotAllowed}else a.bi[c]=g=new d(c,0,255);return e&&"function"==typeof e&&(g.evaluate=e),u.H(f,function(a,b){var c;x(a,["acceptsReference","acceptsArray","acceptsError","acceptsMissingArgument","precedentReference","expandColumns","expandRows"])>=0?(c=new ha(b),g[a]=function(a){return c.$j(a)}):x(a,["isVolatile","isBranch","findTestArgument","returnReference","isContextSensitive"])>=0?(c=new ha(b),g[a]=function(){return c._j()}):f.hasOwnProperty(a)&&(g[a]=b)}),g}function S(a,b,c,d,e,f,g,h,i){return h||(h={}),c!==H&&(h.minArgs=c),d!==H&&(h.maxArgs=d),f!==H&&(h.acceptsReference=f),g!==H&&(h.acceptsArray=g),e!==H&&(h.Ci=e),h.bk!==H&&(h.acceptsMissingArgument=h.bk),h.ck!==H&&(h.isVolatile=h.ck),h.dk!==H&&(h.isContextSensitive=h.dk),h.ek!==H&&(h.precedentReference=h.ek),h.fk!==H&&(h.arrayArgumentEvaluateMode=h.fk),h.gk!==H&&(h.acceptsError=h.gk),i!==H&&(h.isDynamicArrayFunction=i),P(a,b,h)}a.ak=S,a.hk=1.79769e308;function U(a){return"boolean"==typeof a}a.ik=U,a.jk=Ga;function Z(a){return"number"==typeof a}a.Na=Z;function $(a){return a%400===0||a%4===0&&a%100!==0||1900===a}a.kk=$,p=$;function aa(a,b){switch(b){case 0:case 2:case 4:return 360;case 1:return p(a.getFullYear())?366:365;case 3:return 365;default:return-1}}a.lk=aa;function ca(a,b){return a-b}a.mk=ca;function da(a,b){return x(b,[0,2,4,6,7,9,11])>=0?31:x(b,[3,5,8,10])>=0?30:1===b?p(a)?29:28:void 0}a.nk=da,q=da;function fa(a,b,c,d){var e,f,g=c.getFullYear(),h=c.getMonth(),i=c.getDate(),j=d.getFullYear(),k=d.getMonth(),l=d.getDate();return a?(e=2===h&&q(g,h)===i,f=2===k&&q(j,k)===l,b?(e&&(i=30),f&&(l=30)):e&&f&&(i=30,l=30),31===l&&i>=30&&(l=30)):31===l&&(l=1,b&&k++),31===i&&(i=30),360*(j-g)+30*(k-h)+l-i}function ia(a,b,c){var d,e,f=1;return ca(a,b)>0&&(e=a,a=b,b=e,f=-1),d=x(c,[1,2,3])>=0?f*i(D(b)-D(a)):x(c,[4,5])>=0?f*fa(!1,5===c,a,b):f*fa(!0,6===c,a,b)}a.pk=ia;function ja(a){var b,c,d;return 0===a?c=0:(d=.5*I(a),d>=3?c=1:d<1?(b=d*d,c=((((((((.000124818987*b-.001075204047)*b+.005198775019)*b-.019198292004)*b+.059054035642)*b-.151968751364)*b+.319152932694)*b-.5319230073)*b+.797884560593)*d*2):(d-=2,c=(((((((((((((-45255659e-12*d+.00015252929)*d-19538132e-12)*d-.000676904986)*d+.001390604284)*d-.00079462082)*d-.002034254874)*d+.006549791214)*d-.010557625006)*d+.011630447319)*d-.009279453341)*d+.005353579108)*d-.002141268741)*d+.000535310849)*d+.999936657524)),a>0?.5*(c+1):.5*(1-c)}a.qk=ja;function ma(a,b,c,d,e){var f,g,h,i,j,k,n,o,p,q,r,s,t,u=c<100,v=2===c||102===c,x=v||3===c||103===c,z=5===c||105===c,A=4===c||104===c||z,B=9===c||109===c,C=1===c||101===c||B||d,D=6===c||106===c,E=D?1:0,F=!1,G=0;for(f=0;f<y(a);f++){if(q=a[f],r=void 0,r=x?l(q,0,!1,!1,!1,!1):l(q,5,!1,!1,!1,!1),r.isError)return r[0];if(r.isConvertError)return T;for(s=r.rangeCount,t=r.isReference,g=0;g<s;g++)for(h=s>1?r[g]:r,t&&(i=q.getRow(g),j=q.getColumn(g)),k=0;k<y(h);k++)if(b||!t||!q.isHiddenRow(g,k,u))for(o=h[k],n=0;n<y(o);n++)if((b||!t||!q.isSubtotal(g,k+i,n+j))&&(p=o[n],null!==p&&p!==Q)){if(p&&p._error&&!x)return e&&(e.sumx=0,e.sumx2=0,e.n=0),p;x&&!w(p)&&(!v||""!==p&&ba.Na(p,!0))?E++:A&&(!F||z&&p<E||!z&&p>E)?E=p:C?d?(e.sumx+=p,e.sumx2+=p*p,e.n++):(E+=p,G++):D&&(E*=p,G++),F=!0}}return C?B?E:d?void 0:0===G?W:m(E/G):D?m(G>0?E:0):E}a.rk=ma;function na(a,b,c){var d=c%100,e=7===d||8===d,f=7===d||10===d?1:0,g={sumx:0,sumx2:0,n:0},h=ma(a,b,c,!0,g);return h&&h._error?h:g.n<=f?W:(h=Math.max(0,(g.n*g.sumx2-g.sumx*g.sumx)/(g.n*(g.n-f))),m(e?Math.sqrt(h):h))}a.sk=na;function oa(a,b,c,d){var e,f,g,h,k,m,o,p,q,r,s,t,u,v,w,x,z,A,B;if(null===c)return T;if(c=parseInt(c,10),c<=0||c>19)return T;b||(b=0),e=1===b||3===b||5===b||7===b,f=1===b||2===b||3===b||0===b,g=2===b||3===b||6===b||7===b,h=2===c,k=h||3===c,m=12===c,o=13===c,p=14===c,q=15===c,r=16===c,s=17===c,t=18===c,u=19===c,v=p||q||r||s||t||u,w=[];function C(a){var b,d,i,j,m,o,p,q,r,s,t,u=[];if(b=k?l(a,0,!1,!1,!1,!1):l(a,5,!1,!1,!1,!1),b.isConvertError)return T;for(s=b.rangeCount,t=b.isReference,d=0;d<s;d++)for(i=s>1?b[d]:b,t&&(j=a.getRow(d),m=a.getColumn(d)),o=0;o<y(i);o++)if(!(t&&a.isHiddenRow(d,o,!1)&&e))for(q=i[o],p=0;p<y(q);p++)if(!(t&&f&&a.isSubtotal(d,o+j,p+m)||(r=q[p],null===r||g&&n(r)||n(r)&&h))){if(!g&&n(r)&&3!==c)return r;"object"==typeof r&&0===Object.keys(r).length||u.push(r)}return u}function D(a){var b,c=a.getRow(0),e=a.getColumn(0),f=a.getRowCount(0),g=a.getColumnCount(0);if(1===f&&1===g)b=a.getValue(0,0,0);else if(1!==f&&1===g&&c<=d.row&&d.row<c+f)b=a.getValue(0,d.row-c,0);else{if(!(1===f&&1!==g&&e<=d.column&&d.column<e+g))return T;b=a.getValue(0,0,d.column-e)}return b===G||""===b?V:isNaN(parseInt(b,10))?T:parseFloat(b)}if(x=y(a),v){if(2!==x)return T;if(w=C(a[0]),w._error)return w;if(z=void 0,a[1]===G)return V;if(a[1]instanceof ea)z=D(a[1]);else if(a[1]instanceof _)z=a[1].array[0][0];else{if(isNaN(parseInt(a[1],10)))return T;z=j(a[1])}return z._error?z:(17!==c&&19!==c||(z=i(z)),Ha([w,z],c))}for(A=0;A<x;A++)if(!(a[A]instanceof ea))return T;for(A=0;A<x;A++){if(B=C(a[A]),!(B instanceof Array))return B;w.push.apply(w,B)}return m||o?Ha([w],c):7===c||8===c||10===c||11===c?na(w,f,c):ma(w,!0,c)}a.mja=oa;function pa(a){var b=a.charCodeAt(0);return b>=0&&b<129||63728===b||b>=65377&&b<65440||b>=63729&&b<63732?"singleByte":b>=55296&&b<=57343?"fourByte":"doubleByte"}a.UAb=pa;function qa(a){var b,c=[];for(b=0;b<a.length;b++)w(a[b])?(c[b]=a[b+1],b++):c[b]=a[b];return c.length===a.length-1&&(c[c.length]=H),c}a.WAb=qa;function ra(a){var b,c,d,e,f=[],g=0,h=0;for(c=0;c<a.length;c++){if(b=a[c],d=pa(a[c]),"doubleByte"===d||"fourByte"===d)if("fourByte"===d){if(g%2===0){g++;continue}h++,g++,b=a[c-1]+a[c]}else h++,b=a[c];e=g>0?g/2:0,f[c-e+h]=b}return qa(f)}a.VAb=ra;function sa(a,b){var c,d;for(void 0===b&&(b=!0),c=[],d=0;d<y(a);d++)ua(a[d],c,b);return c}function ta(a){a.sort(function(a,b){return a-b})}function ua(a,b,c){var d,e;for(void 0===c&&(c=!0),d=0;d<y(a);d++)e=a[d],e!==Q&&b.push(e);c&&ta(b)}function va(){var a,b,c,d=[];for(a=0;a<arguments.length;a++)d[a]=arguments[a];return b=sa(arguments[0]),c=y(b),0===c?V:c%2===0?(j(b[c/2-1])+j(b[c/2]))/2:b[A(""+c/2)]}function wa(){var a,b,c,d,e,f,g,h,i=[];for(a=0;a<arguments.length;a++)i[a]=arguments[a];for(b=G,c=0,d=sa(arguments[0],!1),e=y(d),f=0;f<e;f++){for(h=0,g=0;g<e;g++)g!==f&&d[g]===d[f]&&h++;h>c&&(c=h,b=d[f])}return 0===c?X:b}function xa(a,b){return za(!0,a,b)}function ya(a,b){return za(!1,a,b)}function za(a,b,c){var d,e=[];return ua(b,e),d=y(e),c<1||d<c?V:(c=a?Math.ceil(c):Math.floor(c),a?e[d-c]:e[c-1])}function Aa(a,b){var c,d,e;return a=l(a,1,!0,!0,!1,!0),b=j(b),a.isError?a[0]:a.isConvertError||B(b)?T:(c=[],ua(a,c),!y(c)||b<0||b>1?V:(d=b*(y(c)-1),e=d%1,d=A(""+d),0===e?c[d]:j(c[d])+e*(j(c[d+1])-j(c[d]))))}function Ba(a,b){var c=x(b,[0,1,2,3,4]);return c<0?V:Aa(a,.25*c)}function Ca(a,b){var c,d,e,f,g,h,i=y(a),j=[];for(c=0;c<i;c++)k(a[c],!0)&&j.push(a[c]);return j.length?(d=j.length,ta(j),e=b*(d+1)-1,f=e%1,e<0||d-1<e?V:(g=M(e),h=j[g],0===f?h:h+f*(j[g+1]-h))):V}function Da(a,b){var c=x(b,[1,2,3]);return c<0?V:Ca(a,.25*(c+1))}function Ha(a,b){var c=12===b,d=13===b,e=14===b,f=15===b,g=16===b,h=17===b,i=18===b,j=19===b;return c?va(a):d?wa(a):e?xa(a[0],a[1]):f?ya(a[0],a[1]):g?Aa(a[0],a[1]):h?Ba(a[0],a[1]):i?Ca(a[0],a[1]):j?Da(a[0],a[1]):Y}a.sja=Ha;function Ia(a){var b=1,c;for(c=a;c>1;c--)b*=c;return b}a.tk=Ia;function Ja(a,b,c){var d=a.getDate(),e=b.getDate(),f=a.getMonth(),g=b.getMonth(),h=a.getFullYear(),i=b.getFullYear();return d=31===d?30:d,c?e=31===e?30:e:31===e&&(d<30?(e=1,g++,g>12&&(g=1,i++)):e=30),30*(12*(i-h)+g-f)+e-d}a.uk=Ja;function Ka(a,b,c){var d,e,f,g,h,k,l,m,n,o=ia(a,b,c);return o<0&&(o=-o,e=a,a=b,b=e),1===c?(f=a.getFullYear(),g=b.getFullYear(),h=void 0,k=void 0,l=void 0,m=void 0,h=new Date(a.valueOf()),h.setFullYear(h.getFullYear()+1),ca(b,h)>0?(m=g+1-f,h=new Date(f,0,1),k=new Date(g+1,0,1),l=i(D(k)-D(h))-365*(g+1-f)):(m=1,l=p(f)&&a.getMonth()<3||p(g)&&256*b.getMonth()+b.getDate()>=541?1:0),n=j(l)/j(m),d=365+n):d=aa(new Date,c),o/d}function La(a,b,c){return c<0||c>4?V:Ka(a,b,c)}a.vk=La;function Ma(a,b,c){var d;return 0===a?d=b<=c:1===a?d=b>=c:2===a?d=b!==c:3===a?d=b<c:4===a?d=b===c:5===a&&(d=b>c),d}function Na(a,b){var c,d=-1,e=!0,f={value:0},g=z.zb(b);4===a&&g&&(c=function(a){if(""===a)return!1;var b=z.sb(g);return b.lastIndex=0,b.test(a)});function i(a){return 0===(""+a).trim().length}return w(b)?d=0:g?e=!1:!i(b)&&h(b,f)?d=f.value:e=!1,function(f,i){var j,l;return!(!i&&f instanceof R)&&(w(f)&&(f=""),j={value:0},e&&h(f,j)?""===f?2===a:Ma(a,j.value,d):(!g||!k(f,!0))&&(l=w(b)?"":(""+b).toUpperCase(),g&&c?c(""+f):Ma(a,(""+f).toUpperCase(),l)))}}r={},s=function(){function b(){}return b.wk=function(a){var b=Math.floor(a);return o(a,b+1)?b+1:b},b.xk=function(a){var b,c,d,e,f,g,h=a,i=r;if(i||(r=i={}),b=i[h])return b;if(k(a))return b=i[h]=Na(4,a);for(c="=><",d=w(a)?"":(""+a).toUpperCase(),e="\0",f=0;f<2&&f<y(d);f++){if(g=d[f],c.indexOf(g)===-1){if("<"===e)return i[h]=b=Na(3,d.substring(1)),b;if(">"===e)return i[h]=b=Na(5,d.substring(1)),b;break}if("="===g)return b="<"===e?Na(0,d.substring(2)):">"===e?Na(1,d.substring(2)):Na(4,"\0"===e?d.substring(1):a),i[h]=b,b;if("\0"===e)e=g;else{if("<"===e)return b=">"===g?Na(2,d.substring(2)):Na(3,d.substring(1)),i[h]=b,b;if(">"===e)return i[h]=b=Na(5,d.substring(1)),b}}return i[h]=b=Na(4,a),b},b.yk=function(a){var b=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][a];return w(b)?L(10,parseFloat(a)):b},b.zk=function(a){var b=Math.ceil(a);return o(a,b-1)?b-1:b},b.Ak=function(a,c){var d=b.yk(I(c)),e=b.zk,f=b.wk;return c>0&&c<=15&&(e=Math.ceil,f=M),a=c<0?a/d:a*d,a=a<0?e(a-.5):f(a+.5),a=c<0?a*d:a/d,m(a)},b.Bk=function(a,b){var c,d;if(a<0||b<0||a<b)return V;for(c=1,b=Math.min(a-b,b),d=1;d<=b;d++)c*=a-d+1,c/=d;return m(c)},b.Ck=function(b,c){var d=I(b)>.5?L(1+b,c):J(c*K(1+b));return isFinite(d)?B(d)&&(d=5e-324):d===Number.POSITIVE_INFINITY?d=a.hk:d===Number.NEGATIVE_INFINITY&&(d=-a.hk),d},b.Dk=function(a,b){return(J(a)+(b?-1:1)*J(-a))/2},b.Ek=function(a,b){return B(a)?a:B(b)?b:1!==b&&1===a||0!==b&&b!==Number.POSITIVE_INFINITY?K(a)/K(b):NaN},b}(),a.MathHelper=s}(ia||(ia={})),b.Functions=ia;function Ha(a,b,c){var d,e,f,i,j,k,l,m,n,o;if(void 0===c&&(c=!0),ua(a))return a;if(ua(b))return b;if(e=typeof a===h,f=typeof b===h,e||f)d=e&&f?a===b?0:a>b?1:-1:e?1:-1;else{if(i=typeof a===g,j=typeof b===g,k=i||j,l=k?"":0,a=a===G||a===H?l:a,b=b===G||b===H?l:b,m=function(){if(a===b)return 0;if(i&&j){var d=void 0;try{d=c?a.localeCompare(b,"en"):a.toUpperCase().localeCompare(b.toUpperCase(),"en")}catch(e){d=c?a.localeCompare(b):a.toUpperCase().localeCompare(b.toUpperCase())}return d}return i?1:j?-1:ga.Yh(a,b)?0:a-b},!k){if(n={value:0},o={value:0},!oa(a,n)||!oa(b,o))return T;a=n.value,b=o.value}d=m()}return d}b.CLb=Ha,ja=function(a){ka(b,a);function b(b){var c=a.call(this,G)||this;return c.u4=b,c}return b.prototype.startCalculation=function(){},b.prototype.endCalculation=function(){},b.prototype.getValue=function(){return S.Reference},b.prototype.getReference=function(){var a=new ea(this,[Ia(0,0)]);return a.getValue=function(){return S.Reference},a},b.prototype.referenceToArray=function(){var a=[S.Reference];return a.isError=!0,a},b.prototype.getName=function(){return this.u4},b.prototype.setValue=function(){},b}(fa),b.ErrorSource=ja;function Ia(a,b){return{row:a,col:b}}},"./src/calc.entry.ts":function(a,b,c){"use strict";function d(a){for(var c in a)b.hasOwnProperty(c)||(b[c]=a[c])}Object.defineProperty(b,"__esModule",{value:!0}),d(c("./src/calc.common.ts")),d(c("./src/Parser.ts")),d(c("./src/evaluator.ts")),d(c("./src/calc.ts")),d(c("./src/referenceExpression.ts"))},"./src/calc.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/calc.common.ts"),f=c("./src/referenceExpression.ts"),g=c("./src/Parser.ts"),h=c("./src/evaluator.ts"),i=d.Common.A,j=d.Common.B,k=d.Common.u,l=d.Common.l,m=null,n=void 0,o=Math.abs,p=e.Errors.Name,q=e.Errors.Reference,r=e.Errors.Value,s=e.Errors.NotAvailable,t=e.Errors.Calc,u=e.Convert.Ca,v=e.Convert.Fh,w=k.Nb,x=d.Common.j,y=x.Fa,z=Math.min,A="cellListeners",B="rowSliceListeners",C="nameIDListeners",D="number",b.supportRowColumnFormula=!1,E=function(){function a(a){this.Ze=[],this.ah=a}return a.prototype.getKey=function(){return""},a.prototype.hasListeners=function(){var a,b,c,d,e,f=this,g=f.Ze;for(a=0,b=g;a<b.length;a++)if(c=b[a],d=this[c])for(e in d)if(d[e])return!0;return!1},a.prototype.gmb=function(a,b,c){var d,e=this[a];e||(this.Ze.push(a),e=this[a]={}),d=b.getKey(),c?e[d]=b:delete e[d]},a.prototype.Yg=function(){var a,b,c,d,e,f,g=[];for(a=0;a<arguments.length;a++)g[a]=arguments[a];for(b=this.Ze,d=0;d<b.length;d++)if(e=this[b[d]])for(f in e)c=e[f],c&&c.bh()},a.prototype.Bg=function(){var a,b,c,d,e,f,g=[];for(a=0;a<arguments.length;a++)g[a]=arguments[a];for(b=this.Ze,d=0;d<b.length;d++)if(e=this[b[d]])for(f in e)c=e[f],!c||c.dh||c.eh||c.fh()},a.prototype.gh=function(){var a,b,c,d,e,f,g,h,i=[];for(a=0;a<arguments.length;a++)i[a]=arguments[a];for(b=i[0],c=this.Ze,e=b?1:-1,f=0;f<c.length;f++)if(g=this[c[f]])for(h in g)d=g[h],d&&(d.delay+=e,b&&d.y$a&&d.y$a())},a.prototype.bh=function(){},a.prototype.fh=function(){},a.prototype.ng=function(){},a.prototype.og=function(){},a.prototype.ZAb=function(){return this.ah.Cf()},a}(),b.BaseCalc=E,F=function(a){P(b,a);function b(b,c){var d=a.call(this,b)||this;return d.name=c,d.delay=0,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.name},b.prototype.og=function(){var a=this;a.ah.Og(a.name,!0)},b.prototype.ng=function(){var a=this;a.ah.Og(a.name,!1)},b.prototype.bh=function(){this.ZAb().onAddAdjust(this,3)},b.prototype.fh=function(){this.ZAb().pg(this,3)},b}(E),b.NameIDCalc=F,G=function(a){P(b,a);function b(b,c,d){var e=a.call(this,b)||this;return e.id=c,e.name=d,e.delay=0,e}return b.prototype.getKey=function(){var a=this;return a.ah.getName()+","+a.id+"#"+a.name},b.prototype.og=function(){var a=this;a.ah.Ig(a.id,a.name,!0)},b.prototype.ng=function(){var a=this;a.ah.Ig(a.id,a.name,!1)},b.prototype.ZAb=function(){return this.ah.Af},b.prototype.bh=function(){this.ZAb().onAddAdjust(this,6)},b.prototype.fh=function(){this.ZAb().pg(this,6)},b}(E),b.PathCalc=G,H=function(){function a(){this.autoCalculation=!0,this.maximumIterations=1e3,this.maximumChange=.01,this.jh={},this.useR1C1=!1,this.allowDynamicArray=!1,this.mh=0,this.Bka=0,this.hmb=[];var a=this;a.kh=new g.Parser,a.lh=new h.Evaluator(a),a.nh=a.uzb&&a.uzb(),a.addResolver(new g.DefaultTokenResolver)}return a.prototype.getResolvers=function(){return this.hmb},a.prototype.addResolver=function(a){var b,c=this.hmb;for(b=0;;b++)if(!c[b]||a.priority>c[b].priority){c.splice(b,0,a);break}},a.prototype.dispose=function(){var a=this;a.jh={},a.oh=m},a.prototype.cloneFrom=function(a){var b=this;b.useR1C1=a.useR1C1,b.mh=a.mh,b.qh=a.qh,b.calcOnDemand=a.calcOnDemand},a.prototype.ih=function(){return this.nh},a.prototype.getExternalSource=function(a,b){var c,d,e=this,f=e.getAllSourceModels();for(c=0,d=f.length;c<d;c++)if(k.Mb(f[c].getSource().getName(),b))return f[c].getSource();return m},a.prototype.getSourceModel=function(a){var b=this.jh[a.id];return b||(b=a.createSourceModel?a.createSourceModel(this):this.createSourceModel(this,a),this.jh[a.id]=b,a.setCalcSourceModel(b),a.setCalcService(this)),b},a.prototype.getGlobalSourceModel=function(a){return this.oh||(a=a||new e.CalcSource,a.createSourceModel?this.oh=a.createSourceModel(this):this.oh=this.createSourceModel(this,a),a.setCalcSourceModel(this.oh)),this.oh},a.prototype.setSourceModel=function(a,b){this.jh[a.id]=b,b.setCalcService(this)},a.prototype.getAllSourceModels=function(){var a,b=[],c=this.jh;for(a in c)b.push(c[a]);return b},a.prototype.removeSource=function(a){var b,c,d,e,f,g;this.suspend(),b=this.jh[a.id],b&&(this.onRemoveSource(a),delete this.jh[a.id]),this.clearDirties(),c=this.jh;for(e in c)d=c[e],d.addDirtyNodesForCalc(!0);f=this.Dh&&this.Dh.kj,g=a&&a.kj,f&&g&&g===f&&(this.Dh=null),this.resume(!1)},a.prototype.clearSource=function(){this.jh={},this.Dh=null,this.clearDirties()},a.prototype.ignoreDirty=function(){return this.qh},a.prototype.suspend=function(a){this.mh++,this.qh=!!a},a.prototype.resume=function(a){var b=this;b.mh--,b.mh<0&&(b.mh=0),b.IsSuspended()||(b.rh=m,b.qh=!1,b.recalculateAll(a))},a.prototype.suspendAdjust=function(){this.Bka++},a.prototype.resumeAdjust=function(){var a=this;a.Bka--,a.Bka<0&&(a.Bka=0)},a.prototype.isAdjustSuspended=function(){return this.Bka>0},a.prototype.clearDirties=function(){var a,b,c,d=this,e=d.imb;if(e)for(a in e)if(e.hasOwnProperty(a))for(b=e[a];b;)c=b.eh,c?(b.eh=c.dh=n,b=c):b=m;d.imb=d.jmb=m},a.prototype.resumeWithoutCalc=function(){this.mh=0,this.clearDirties(),this.qh=!1},a.prototype.IsSuspended=function(){return this.mh>0},a.prototype.recalculateAll=function(a,b){var c,d,e,f=this;if(!f.IsSuspended()){f.QHb=Date.now(),b||f.lh.startCache(),d=f.jh;for(e in d)c=d[e],c.getSource().startCalculation(),c.addDirtyNodesForCalc(a,b);if(f.Gg(),!b)for(e in d)c=d[e],c.Fg();for(e in d)c=d[e],c.getSource().endCalculation();b||f.lh.endCache(),delete f.QHb}},a.prototype.Gg=function(a){var b,c,d,e,f,g,h,i;if(void 0===a&&(a=!0),b=this,c=b.imb){if(a){f=c[1]||c[2];for(d in c)c.hasOwnProperty(d)&&(g=parseInt(d),f&&1!==g&&2!==g||(e=c[d],e&&(e.ah.addListenersToDirty(b,g),e.processed=!0)));for(d in c)c.hasOwnProperty(d)&&(e=c[d],e&&(e.processed?delete e.processed:e.ah.addListenersToDirty(b,parseInt(d))))}for(d in c)c.hasOwnProperty(d)&&c[d].ah.initDelay(b,parseInt(d));for(d in c)c.hasOwnProperty(d)&&c[d].ah.adjustDelayOfListeners(b,parseInt(d),!0);do{h=!1;for(d in c)c.hasOwnProperty(d)&&(i=c[d].ah.calculateDirtyNodes(b,parseInt(d)),i&&(h=!0))}while(h);for(d in c)c.hasOwnProperty(d)&&c[d].ah.calculateIterations(b,parseInt(d));b.imb=b.jmb=n}},a.prototype.Ch=function(a,b){return void 0===a&&(a=0),void 0===b&&(b=0),o(b-a)},a.prototype.initParserContext=function(a){var b=this.Dh;b||(this.Dh=a.getParserContext(this.useR1C1))},a.prototype.getParserContext=function(a){var b=this,c=b.Dh;return c||(a?b.Dh=c=a.getParserContext(b.useR1C1):c=new g.ParserContext(m,b.useR1C1)),c.setSource(a),c},a.prototype.parseWithContext=function(a,b){return this.kh.parse(a,b)},a.prototype.unparseWithContext=function(a,b){return this.kh.unparse(a,b)},a.prototype.pg=function(a,b){var c,d,e,f,g=this;isNaN(b)||(e=g.imb,f=g.jmb,e||(e=g.imb={},f=g.jmb={}),c=e[b],d=f[b],a&&!a.dh&&a!==c&&(c?d.eh=a:e[b]=a,a.dh=d,a.eh=m,f[b]=a))},a.prototype.Bh=function(a,b){var c,d,e,f,g,h=this;isNaN(b)||(d=h.imb,e=h.jmb,d&&(c=h.imb[b]),a&&(a.dh||a===c)&&(f=a.dh,g=a.eh,f?f.eh=g:d&&(g?d[b]=g:delete d[b]),g?g.dh=f:e&&(f?e[b]=f:delete e[b]),a.dh=m,a.eh=m))},a.prototype.evaluateExpression=function(a,b,c){var d=this;return d.lh.evaluateExpression(b,a.getEvaluatorContext(c,!1),!1)},a.prototype.onClearExpr=function(a,b){this.lh&&this.lh.asyncManager.clearCell(a,b)},a.prototype.parse=function(a,b,c,d,e,f,g){var h,i,j=this,k=j.rh,l=j.getParserContext(a);return l.useR1C1=!g&&j.useR1C1,l.ignoreError=f,l.row=c,l.column=d,l.culture=e,k?(h=k[b])?h:(i=j.kh.parse(l,b),k[b]=i,i):j.kh.parse(l,b)},a.prototype.unparse=function(a,b,c,d,e,f){var g,h=this.getParserContext(a);return h.useR1C1=this.useR1C1,h.row=c,h.column=d,h.culture=e,f&&(h.Eh=!0,h.useR1C1=!1),g=this.kh.unparse(h,b),h.Eh=!1,g},a.prototype.recalculate=function(a,b,c,d){var e=this.getSourceModel(a);c===-1?e.Ag(b,0,1,e.cC()):b===-1?e.Ag(0,c,e.rC(),1):e.Ag(b,c,1,1),this.IsSuspended()||this.recalculateAll(!1,d)},a.prototype.recalculateByName=function(a,b){var c,d;b&&(c=Q(this,a),d=c.mg(w(b),!0),this.pg(d,3),this.IsSuspended()||this.recalculateAll(!1))},a.prototype.recalcRange=function(a,b,c,d,e){var f=this.getSourceModel(a);c===-1?f.Ag(b,0,d,f.cC()):b===-1?f.Ag(0,c,f.rC(),e):f.Ag(b,c,d,e),this.IsSuspended()||this.recalculateAll(!1)},a.prototype.evaluate=function(a,b,c,d){var f=this,g=b instanceof e.Expression?b:f.parse(a,b,c,d);return f.lh.evaluateExpression(g,a.getEvaluatorContext($(c,d),!1),!1)},a.prototype.Hg=function(a,b,c,d,f,g,h){var i,j,k,l,o,p,q,t,u,v=c.row||0,w=c.col||0,x=g?g.row:v,y=g?g.col:w,z=a.getEvaluatorContext(c,d,g),A=4===arguments.length&&d||h;if(this.allowDynamicArray&&(z.Exb=!0),i=this.lh.evaluateExpression(b,z,f,A,A),d&&arguments.length<=5)return i;if(!d&&h&&(e.Convert.Fh(i)||e.Convert.Ca(i)))return i;if(e.Convert.Fh(i)){if(j=i.getRowCount(0),k=i.getColumnCount(0),1!==i.getRangeCount())return r;try{if(l=d?v-x:v-i.getRow(0),o=d?w-y:w-i.getColumn(0),p=$(0,0),1===j&&1===k);else if(1===j&&k>1&&o>=0&&o<k)p.col=o;else if(j>1&&1===k&&l>=0&&l<j)p.row=l;else{if(!(d&&l<j&&o<k))return d?s:r;p.row=l,p.col=o}i=i.getValue(p,0)}catch(a){return r}}else if(e.Convert.Ca(i))if(d){if(q=i,t=q.getRowCount(),u=q.getColumnCount(),1!==t&&v-x>=t||1!==u&&w-y>=u)return s;i=i.getValue(1===t?0:v-x,1===u?0:w-y)}else i=i.getValueByIndex(0);return i===n||i===m?f===!1?i:0:i},a.prototype.onAddAdjust=function(a,b){this.nh.hh(a,b)},a.prototype.onRemoveSource=function(a){this.nh.ph(a)},a.prototype.createSourceModel=function(a,b){return new J(a,b)},a}(),b.CalcService=H;function Q(a,b){return a.getSourceModel(b)}function R(a,b){var c,d,e,f,g,h;if(a)for(c in a)if(d=+c,e=a[c])for(f in e)g=+f,h=e[f],h&&b.setValue(d,g,h.value,h.oldValue,h.isAnchorCell!==!0)}b.setSpillValues=R;function S(a,b){return[a,b].join(",")}function T(a,b){var c=b.split(",").map(function(a){return+a}),d=c[0],e=c[1],f=a[d];return f&&f[e]}function U(a,b,c){if(a){var d=c.anchors,e={};a.forEach(function(a){var f,g,h,i,j,k,l,m,n=a.row,o=a.col,p=S(n,o);for(b.Ag(n,o,1,1),e[p]=!0,f=a.rowCount,g=a.colCount,h=1,i=0;i<f;i++){for(;h<g;h++)if(j=c.getAnchorItem(i+n,h+o)){k=j.anchorRefs;for(l in k)p!==l&&k[l]&&(m=T(d,l),m&&!e[l]&&(b.Ag(m.row,m.col,1,1),e[l]=!0))}h=0}})}}b.markAnchorCellDirty=U,I=function(){function a(){}return a.getLength=function(a,b){return u(a)?a.getRowCount()*a.getColumnCount():v(a)?(b=b?b:0,a.getRowCount(b)*a.getColumnCount(b)):void 0},a.getRowCount=function(a,b){return u(a)?a.getRowCount():v(a)?(b=b?b:0,a.getRowCount(b)):void 0},a.getColumnCount=function(a,b){return u(a)?a.getColumnCount():v(a)?(b=b?b:0,a.getColumnCount(b)):void 0},a.getValueByIndex=function(a,b,c){if(u(a))return a.getValueByIndex(b);if(v(a)){c=c?c:0;var d=a.getColumnCount(c);return a.getValue(c,parseInt(""+b/d,10),b%d)}},a.getValue=function(a,b,c,d){return u(a)?a.getValue(b,c):v(a)?(d=d?d:0,a.getValue(d,b,c)):void 0},a}(),b.CalcArrayHelper=I,J=function(){function a(a,b){this.Ef=0,this.Ff=0,this.Gf=[],this.dataTable={},this.dataTableByName={},this.Hf=[],this.If=[],this.B5=0;var c=this;c.xf=b,c.Af=a}return a.prototype.getNode=function(a,b,c){var d,e=this,f=m;return a>=0&&b>=0?(d=e.dataTable[a],c&&!d&&(d=e.dataTable[a]={},a>e.Ef&&(e.Ef=a)),d&&(f=d[b],c&&!f&&(f=d[b]={},b>e.Ff&&(e.Ff=b)))):a===-1&&b>=0?(f=e.If[b],c&&!f&&(f=e.If[b]={},b>e.Ff&&(e.Ff=b))):a>=0&&b===-1?(f=e.Hf[a],c&&!f&&(f=e.Hf[a]={},b>e.Ff&&(e.Ff=b))):a===-1&&b===-1&&(f=e.Jf,c&&!f&&(f=e.Jf={})),f},a.prototype.getNodeByName=function(a,b){var c=this,d=c.dataTableByName[a];return b&&!d&&(d=c.dataTableByName[a]={}),d},a.prototype.Kf=function(a,b){var c=this.getNode(a,b);return c&&c.Lf},a.prototype.Mf=function(a,b){var c=this.getNode(a,b);return c&&c.Nf},a.prototype.Qf=function(a,b){return this.getWorkingNodeInfo(a,b,2)},a.prototype.BTa=function(a,b){return this.getWorkingNodeInfo(a,b,1)},a.prototype.ATa=function(a,b){return this.getWorkingNodeInfo(a,b,0)},a.prototype.CTa=function(a){var b=this.getNodeByName(a);return b&&b.Nf},a.prototype.DTa=function(a){var b=this.getNodeByName(a);return b&&b.Lf},a.prototype.clearAll=function(){var a=this;a.clear(-1,-1,-1,-1),a.dataTable={},a.dataTableByName={},a.Hf=[],a.If=[],a.Jf=m},a.prototype.clear=function(a,b,c,d,e){this.$b(a,b,c,d,e)},a.prototype.rzb=function(){var a=this;X(a.Hf),X(a.If),X(a.dataTable,!0),X(a.dataTableByName),a.eHb()},a.prototype.eHb=function(){var a=this;a.dataTable={},a.dataTableByName={},a.Hf=[],a.If=[],a.Jf=m,a.Gf=[],a.vg=m,a.xg=m},a.prototype.addRows=function(a,b){var c,d=this,e=d.rC();if(!(a<0||a>e||b<0))for(i(d.dataTable,e,a,b),i(d.Hf,e,a,b),c=0;c<b;c++)d.dataTable[a+c]&&(d.dataTable[a+c]={rs:"n"})},a.prototype.deleteRows=function(a,b){var c=this,d=c.rC();a<0||a>=d||b<=0||(a+b>d&&(b=d-a),j(c.dataTable,d,a,b),j(c.Hf,d,a,b))},a.prototype.addColumns=function(a,b){var c,d,e=this,f=e.rC(),g=e.cC();if(!(a<0||a>g||b<0)){for(c=0;c<f;c++)d=e.dataTable[c],d&&a<g&&i(d,g,a,b);i(this.If,g,a,b)}},a.prototype.deleteColumns=function(a,b){var c,d,e=this,f=e.rC(),g=e.cC();if(!(a<0||a>=g||b<0)){for(c=0;c<f;c++)d=this.dataTable[c],d&&j(d,g,a,b);j(this.If,g,a,b)}},a.prototype.ETa=function(a,b){var c=[a,b],d=this.getNode(a,b);return d&&c.push(d.Lf,d.Nf,d.Pf),c},a.prototype.FTa=function(a,b,c){a&&a.push(this.ETa(b,c))},a.prototype.dUa=function(){var a=this.getSource(),b=a&&a.getSheet(),c=b&&b.ITa;return c&&c.dUa()},a.prototype.$Va=function(a,b,c,d,e){var f=this;a===-1?f.kg(b,c,d):b===-1?f.jg(a,c,d):f.ig(a,b,c,d,e)},a.prototype.Rf=function(a,b,c,d){var e=this.getNode(a,b,!!c);e&&(d&&d.push([a,b,e.Lf]),e.Lf=c)},a.prototype.GTa=function(a,b,c,d,e,f,g){var h=this.getNode(a,b,!!c);h&&(this.FTa(g,a,b),h.Lf=c,(h.Nf||d)&&(h.Nf=d),(h.Pf||e)&&(h.Pf=e),h.isVolatile&&!c?this.Tf(h):(f||h.isVolatile)&&(h.isVolatile=f))},a.prototype.Sf=function(a,b,c){this.GTa(a,b,n,n,n,!1,c)},a.prototype.Uf=function(a,b,c,d,e,f){var g=this.getNode(b,c);g&&g.Lf&&a.GTa(d,e,g.Lf,g.Nf,g.Pf,g.isVolatile,f)},a.prototype.ega=function(a,b){var c=this.dataTable[a];return c&&c[b]},a.prototype.Wf=function(a,b,c){var d=this.getNode(a,b,!!c);d&&(d.Nf=c)},a.prototype.Xf=function(a,b,c){var d=this.getNode(a,b,!!c);d&&(d.Pf=c)},a.prototype.Yf=function(a,b){var c=this.getNode(a,b);return c&&c.calc},a.prototype.Zf=function(a,b,c){var d=this.getNode(a,b,!0);d&&(d.calc&&d.calc.isVolatile&&this.Tf(d),d.calc=c,c&&(c.node=d))},a.prototype.Q3=function(a,b,c){var d=this.getNode(a,b,!0);d&&d.calc&&(d.calc.isVolatile&&this.Tf(d),this.Af.Bh(d.calc,c),d.calc=n)},a.prototype.$f=function(a,b,c,d,e){var f,g=this;c>=0&&d>=0?(f=g.dataTable[c],f||(f=g.dataTable[c]={}),f[d]=e,e&&e.calc&&delete e.calc):c>=0&&d===-1&&a>=0&&b===-1?g.Hf[c]=e:d>=0&&c===-1&&b>=0&&a===-1&&(g.If[d]=e);
},a.prototype._f=function(a,b,c,d){var e=this,f=e.getNode(a,b),g=e.getNode(c,d);f&&f.Lf?e.$f(a,b,c,d,f):g&&g.Lf&&e.$f(a,b,c,d,m),g&&g.Lf?e.$f(c,d,a,b,g):f&&f.Lf&&e.$f(c,d,a,b,m)},a.prototype.lmb=function(){return this.Gf},a.prototype.bg=function(a){a.isVolatile||(a.isVolatile=!0,this.Gf.push(a))},a.prototype.Tf=function(a){var b,c,d,e,f;if(a.isVolatile=n,b=this,b.B5++,b.B5>100){for(b.B5=0,c=[],d=b.Gf,e=b.Gf.length,f=0;f<e;f++)d[f].isVolatile&&c.push(d[f]);b.Gf=c}},a.prototype.getCalcService=function(){return this.Af},a.prototype.setCalcService=function(a){this.Af=a},a.prototype.Cf=function(){return this.Af},a.prototype.getSource=function(){return this.xf},a.prototype.hasFormula=function(a,b){return a=a!==n?a:-1,b=b!==n?b:-1,!!this.ATa(a,b)},a.prototype.setFormula=function(a,b,c,d,e,f,g){var h,i,j,k,l,o=this;if(c&&0===c.length&&(c=m),!e&&o.dg(a,b,1,1)&&o.eg(),h=o.getFormula(a,b),f||h!==c&&(""!==h||c)&&(h||""!==c)){if(i=o.Cf(),j=m,i)try{k=a>=0?a:0,l=b>=0?b:0,j=d||(c?i.parse(o.xf,c,k,l,!1,e):m),o.fg(a,b,j,n,!1,g)}catch(a){if(!e)throw a}a>=0&&b>=0&&o.xf.setFormula(a,b,c)}},a.prototype.getFormula=function(a,b,c){var d,e,f=this.Cf();return f&&(d=this.ATa(a,b))?(e=this.Qf(a,b),a=e&&e.isDynamicArray!==!0?e.row:a,b=e&&e.isDynamicArray!==!0?e.col:b,f.unparse(this.xf,d,a,b,c)):m},a.prototype.setFormulaByName=function(a,b,c,d){var e,f,g,h;if(a&&(a=w(a),e=this,b&&0===b.length&&(b=m),f=e.getFormulaByName(a),f!==b&&(""!==f||b)&&(f||""!==b))){if(g=e.Cf(),h=m,g)try{h=b?g.parse(e.xf,b,0,0,!1,c):m,e.gg(a,h,n,!1,d)}catch(a){if(!c)throw a}e.xf.setFormula({name:a},b)}},a.prototype.getFormulaByName=function(a){var b,c=this.Cf();return c&&a&&(b=this.DTa(w(a)))?c.unparse(this.xf,b,0,0):m},a.prototype.eg=function(){throw e.sR().Exp_ArrayFromulaPart},a.prototype.rC=function(){return z(this.xf.getRowCount())},a.prototype.cC=function(){return z(this.xf.getColumnCount())},a.prototype.setArrayFormula=function(a,b,c,d,e,f,g){var h,i,j,k,l=this;if(e&&0===e.length&&(e=m),l.dg(a,b,c,d)&&l.eg(),a=a<0?0:a,b=b<0?0:b,i=l.Cf(),i&&(l.$b(a,b,c,d,g),e)){try{h=e?i.parse(l.xf,e,a,b,!1,f):m}catch(a){if(!f)throw a;return}for(j=a;j<a+c;j++)for(k=b;k<b+d;k++)l.fg(j,k,h,_(a,b,c,d),!1,g);a>=0&&b>=0&&l.xf.setArrayFormula(a,b,c,d,i.unparse(l.xf,h,a,b))}},a.prototype.getWorkingNodeInfo=function(a,b,c){var d,e=this,f=e.xf;return a>=f.getRowCount()||b>=f.getColumnCount()?d:(a>=0&&b>=0?(d=e.getNode(a,b),(!d||0===c&&!d.Lf||1===c&&!d.Nf||2===c&&!d.Pf)&&(d=e.getNode(a,-1)),(!d||0===c&&!d.Lf||1===c&&!d.Nf||2===c&&!d.Pf)&&(d=e.getNode(-1,b))):d=a>=0&&b===-1?e.getNode(a,-1):a===-1&&b>=0?e.getNode(-1,b):e.getNode(-1,-1),d&&(0===c&&d.Lf||1===c&&d.Nf||2===c&&d.Pf))},a.prototype.fg=function(a,b,c,d,e,f){var g,i,j,k,l,m,o,p,q,r,s,t,u,v=this,w=v.Cf();w.nia&&w.lh.asyncManager.endCalcCell(),g=d!==n&&null!==d,i=g?d.row:a,j=g?d.col:b,k=v.xf,l=new h.EvaluateContext(k,$(i,j),g),m=w.allowDynamicArray,o=Y(l,c,g,g?a-d.row:0,g?b-d.col:0,m,m),p=l.ELb,p&&(delete l.ELb,2===p?c=o:1===p&&(q=w.unparse(k,c,i,j),c=w.parse(k,q,i,j))),o=o===c?n:o,d!==n&&(r=d),a>=0&&b>=0?((e===n||e)&&(s=a>=0?a:0,t=b>=0?b:0,u=c?w.unparse(k,c,s,t):n,v.xf.setFormula(a,b,u)),v.ig(a,b,c,o,r,f)):a>=0&&b===-1?v.jg(a,c,o,f):a===-1&&b>=0&&v.kg(b,c,o,f),w.autoCalculation&&!w.IsSuspended()&&w.recalculateAll(!1)},a.prototype.gg=function(a,b,c,d,e){var f,g=this,i=g.Cf(),j=new h.EvaluateContext(g.xf,$(0,0),(!1)),k=Y(j,b,!1,0,0);k=k===b?n:k,d!==n&&!d||e||(f=b?i.unparse(g.xf,b,0,0):n,g.xf.setFormulaByName&&g.xf.setFormulaByName(a,f)),g.lg(a,b,k),i.autoCalculation&&!i.IsSuspended()&&(e||i.recalculateAll(!1))},a.prototype.getRowExpression=function(a){return this.Kf(a,-1)},a.prototype.getColumnExpression=function(a){return this.Kf(-1,a)},a.prototype.lg=function(a,b,c,d){var e,f=this,g=f.mg(a,!0);g&&(g.ng(),e=this.getNodeByName(a,!0),e.Lf=b,d&&(d[0].push("dataTable",a),d[1]=e.Lf),c=b&&c?c:n,e.Nf=c,g.og(),f.Af.pg(g,3))},a.prototype.ig=function(a,b,c,d,e,f){var g,h=this,i=h.qg(a,b,!0);i&&(h.FTa(f,a,b),g=h.Af,g.onClearExpr(h.xf,$(a,b)),i.ng(),h.Rf(a,b,c),c?((d||h.Mf(a,b))&&h.Wf(a,b,d),e=e?e:h.Qf(a,b),e&&e.isDynamicArray!==!0&&h.Xf(a,b,e)):(h.Wf(a,b,n),h.Xf(a,b,n)),i.og(),g.pg(i,0),g.calcOnDemand&&(i.dirty=!0))},a.prototype.jg=function(a,b,c,d){var e=this,f=e.rg(a,!0);f&&(e.FTa(d,a,-1),f.ng(),e.Rf(a,-1,b),(c||e.Mf(a,-1))&&e.Wf(a,-1,c),f.og(),e.Af.pg(f,1))},a.prototype.kg=function(a,b,c,d){var e=this,f=e.sg(a,!0);f&&(e.FTa(d,-1,a),f.ng(),e.Rf(-1,a,b),(c||e.Mf(-1,a))&&e.Wf(-1,a,c),f.og(),e.Af.pg(f,2))},a.prototype.$b=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=a<0?0:a,o=b<0?0:b,p=a<0?k.rC():c,q=b<0?k.cC():d,r=l+p-1,s=o+q-1,t=function(a,b){if(f=k.Mf(a,b),g=k.Kf(a,b),f||g){h=k.Qf(a,b);var c=h&&h.isDynamicArray!==!0?_(h.row,h.col,h.rowCount,h.colCount):n;k.fg(a,b,m,c,!0,e)}};for(i=l;i<=r&&i>=0;i++)for(b<0&&t(i,-1),j=o;j<=s&&j>=0;j++)i===l&&a<0&&t(-1,j),t(i,j);a<0&&b<0&&t(a,b)},a.prototype.dg=function(a,b,c,d){return this.tg(a,b,c,d,!0,!0)},a.prototype.tg=function(a,b,c,d,e,f){var g,h,i,j,k,l,m=this,n=a<0?0:a,o=b<0?0:b,p=a<0?m.rC():c,q=b<0?m.cC():d,r=n+(0===p?1:p)-1,s=o+(0===q?1:q)-1,t=!1,u=[],v=[],w=m.dataTable;for(i=n;i<=r&&i>=0&&!(i>m.Ef);i++)if(h=w[i])for(j=o;j<=s&&j>=0&&!(j>m.Ff);j++)if(g=h[j])if(k=g.Pf,l=void 0,k&&!k.isDynamicArray){if(k.row<n||k.row+k.rowCount-1>r||k.col<o||k.col+k.colCount-1>s){if(e)return!0;t=!0}if(i!==k.row&&i!==n)continue;u.push(_(k.row,k.col,k.rowCount,k.colCount)),l=g.Lf,v.push(l),j=k.col+k.colCount-1}else f||(l=g.Lf,l&&(u.push({row:i,col:j}),v.push(l)));return!e&&{hasPart:t,ranges:u,formulas:v}},a.prototype.getCalcObj=function(){var a,b,c,d,e,f,g,h,i,j,k,l=[];for(a=0;a<arguments.length;a++)l[a]=arguments[a];if(b=l[0],c=l[1],d=this,e=b.row,f=b.column,g=null,isNaN(e)||isNaN(f))b.name&&(g=d.mg(b.name,c));else if(e>=0&&f>=0)if(b.sf())g=d.qg(e,f,c);else for(h=b.endRow,i=b.endColumn,g=[],j=e;j<=h;j++)for(k=f;k<=i;k++)g.push(d.qg(j,k,c));else e>=0?g=d.rg(e,c):f>=0&&(g=d.sg(f,c));return g},a.prototype.mg=function(a,b){var c=this,d=m,e=c.getNodeByName(a,b);return e&&(d=e.calc,!d&&b&&(d=new F(c,a),e.calc=d,d.node=e)),d},a.prototype.qg=function(a,b,c){var d,e,f,g=this,h=m;if(a>=0&&b>=0){if(d=g.dataTable,e=d[a],!e){if(!c)return h;e=d[a]={},a>g.Ef&&(g.Ef=a)}if(f=e[b],!f)return c&&(f=e[b]={},h=new K(g,a,b),f.calc=h,h.node=f,b>g.Ff&&(g.Ff=b)),h;h=f.calc,!h&&c&&(h=new K(g,a,b),f.calc=h,h.node=f,a>g.Ef&&(g.Ef=a),b>g.Ff&&(g.Ff=b))}return h},a.prototype.rg=function(a,b){var c=this,d=m;return a>=0&&(d=c.Yf(a,-1),!d&&b&&(d=new L(c,a),c.Zf(a,-1,d),a>c.Ef&&(c.Ef=a))),d},a.prototype.sg=function(a,b){var c=this,d=m;return a>=0&&(d=c.Yf(-1,a),!d&&b&&(d=new M(c,a),c.Zf(-1,a,d),a>c.Ff&&(c.Ff=a))),d},a.prototype.ug=function(a){var b=this;return!b.vg&&a&&(b.vg=new O(b)),b.vg},a.prototype.wg=function(a,b){var c,d=this;return a=w(a),d.xg||(d.xg={}),c=d.xg[a],!c&&b&&(c=d.xg[a]=new N(d,a)),c},a.prototype.updateNameCalc=function(a,b){var c=this.wg(w(a));c&&(c.updateListening(!0,b),c.fh())},a.prototype.yg=function(a,b){var c,d,e=this,f=z(e.Ff,a+b-1);for(c=a;c!==-1&&c<=f;c++)e.isDirty(-1,c)&&(d=e.sg(c,!0),e.Af.pg(d,2))},a.prototype.zg=function(a,b){var c,d,e=this,f=z(e.Ef,a+b-1);for(c=a;c!==-1&&c<=f;c++)e.isDirty(c,-1)&&(d=e.rg(c,!0),e.Af.pg(d,1))},a.prototype.Ag=function(a,b,c,d){var e,f,g,h=this,i=null,j=z(h.Ef,a+c-1),k=z(h.Ff,b+d-1);for(e=a;e<=j;e++)for(f=b;f<=k;f++)h.ega(e,f)&&(h.Af.calcOnDemand?(i=h.qg(e,f,!1),i&&(i.Bg(),i.dirty=!0)):(i=h.qg(e,f,!0),h.Af.pg(i,0)));h.zg(a,c),h.yg(b,d),g=h.ug(!1),g&&g.Bg(a,b,c,d)},a.prototype.Cg=function(){var a,b,c,d,e,f=this,g=f.lmb();for(c=0;c<g.length;c++)d=g[c],f.Af.calcOnDemand&&d&&d.isVolatile&&(d.dirty=!0,d.Bg()),d&&d.isVolatile&&d instanceof K&&!f.Dg(d)&&(e=f.qg(d.row,d.column,!0),f.Af.pg(e,0),a=f.rg(d.row,!1),a&&!f.Eg(a)&&f.zg(d.row,1),b=f.sg(d.column,!1),b&&!f.Eg(b)&&f.yg(d.column,1))},a.prototype.Fg=function(){for(var a,b,c,d,e,f,g,h,i=this,j=i.lmb(),k=!0,l=5,m=i.Af;k&&l;){for(k=!1,l--,c=0,d=j.length;c<d;c++)e=j[c],e&&e.isVolatile&&e instanceof K&&!i.Dg(e)&&(f=e.row,g=e.column,i.recalculateCell(f,g)&&(k=!0,h=i.qg(f,g,!0),m.pg(h,0),a=i.rg(f,!1),a&&!i.Eg(a)&&i.zg(f,1),b=i.sg(g,!1),b&&!i.Eg(b)&&i.yg(g,1)));k&&m.Gg(!0)}},a.prototype.Dg=function(a){var b=this.getCalcService().imb;return!!a.dh||a===(b&&b[0])},a.prototype.Eg=function(a){var b=this.getCalcService().imb;return a.dh||a===(b&&b[1])},a.prototype.isDirtyColumn=function(a){var b=this.getCalcService().imb;return a.dh||a===(b&&b[2])},a.prototype.isDirty=function(a,b){return!(!this.Yf(a,b)&&!this.Kf(a,b))},a.prototype.recalculateForContext=function(a,b,c){var d=this.Af,e=d.getSourceModel(a),f=b.row,g=b.col;g===-1?e.Ag(f,0,1,e.cC()):f===-1?e.Ag(0,g,e.rC(),1):e.Ag(f,g,1,1),d.IsSuspended()||d.recalculateAll(!1,c)},a.prototype.recalculateCell=function(a,b){var c,d,f,g,h,i,j,k,o,p,q,s,u,v,w,x,z,A,B,C=this,E=C.xf,F=C.BTa(a,b)||C.ATa(a,b),G=E,H=G.q$a,I=G.kj.ITa;if(I.bIb=!0,d=!1,F){if(f=$(a,b),g=E.getValue(a,b),h=!1,i=void 0,j=void 0,k=void 0,o=void 0,p=C.Qf(a,b),p&&p.isDynamicArray!==!0&&(h=!0,i=p.row,j=p.col,k=p.rowCount,o=p.colCount),q=C.Af,q.nia&&q.lh.asyncManager.startCalcCell(C.xf,f),s=q.Hg(C.xf,F,f,h,!0,p&&p.isDynamicArray!==!0&&_(i,j,k,o),q.allowDynamicArray),(e.Convert.Fh(s)||e.Convert.Ca(s))&&F.ensureSingle!==!0&&(u=s.getRowCount(),v=s.getColumnCount(),p={row:a,col:b,rowCount:u,colCount:v,isDynamicArray:!0},C.Xf(a,b,p)),w=e.Convert.Fh(s)||e.Convert.Ca(s),d=!0,x=void 0,w&&(x=e.Convert.Ph(s,0,!1,!1,!1),x.isError||x.isConvertError?(s=r,w=!1):(k=x.rowCount,o=x.colCount,0===k||0===o?(s=t,w=!1):1===k&&1===o&&(s=x[0][0],y(s)&&(s=0),w=!1),F.ensureSingle&&w&&(z=C.getNode(a,b),delete F.ensureSingle,F=z.Lf=e.Jh(e.Functions.findGlobalFunction("@"),[F]),z.Nf=n,s=F.function.evaluate({row:a,column:b},s),w=!1))),w)A=G.setArray(a,b,k,o,x),A&&R(A[1],G);else if(A=G.updateItem(a,b,s),A&&(R(A[0],G),c=A[1]),g===s)d=!1;else{if(g instanceof Date){if(s instanceof Date&&g.valueOf()===s.valueOf())return!1;if(typeof s===D){if(B=l.Ra(g),B===s)return!1;s=l.Xb(s)}}E.setValue(a,b,s,g)}q.nia&&q.lh.asyncManager.endCalcCell(C.xf,f),G.Ppb&&G.Ppb(a,b)}else H||(A=G.updateItem(a,b,m),A&&(R(A[0],G),c=A[1]));return c&&U(c,C,I.zHb),I.bIb=!1,d},a.prototype.recalculateNameID=function(a){var b,c,d=this,e=d.xf,f=d.CTa(a)||d.DTa(a);if(f){if(b=e.getValueByName?e.getValueByName(a):e.getValue({name:a}),c=d.Af.Hg(d.xf,f,{name:a},!1,!0),b===c)return;if(b instanceof Date&&c instanceof Date&&b.valueOf()===c.valueOf())return;e.setValueByName?e.setValueByName(a,c):e.setValue({name:a},c)}},a.prototype.addDirtyNodesForCalc=function(a,b){var c,d,e=this;a!==!1?(c=e.cC(),d=e.rC(),e.yg(0,c),e.zg(0,d),e.Ag(0,0,d,c)):b||e.Cg()},a.prototype.addListenersToDirtyForRow=function(a){for(var b,c,d,e;a.imb[1];){for(b=a.imb[1],c=b.ah,d=c.cC(),e=0;e<d;e++)a.pg(c.qg(b.row,e,!0),0);a.Bh(b,1)}},a.prototype.addListenersToDirtyForCol=function(a){for(var b,c,d,e;a.imb[2];){if(b=a.imb[2],c=b.ah,d=c.rC(),d>0)for(e=0;e<d;e++)a.pg(c.qg(e,b.column,!0),0);else b.Bg();a.Bh(b,2)}},a.prototype.Ah=function(a,b){for(var c=a.length,d=b;d;)a[c]=d,c++,d=d.eh},a.prototype.addListenersToDirty=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;if(1===b)this.addListenersToDirtyForRow(a);else if(2===b)this.addListenersToDirtyForCol(a);else if(0===b)for(c=[],a.imb[2]&&this.Ah(c,a.imb[2]),d=a.imb[0];d;d=d.eh)for(e=d.ah,f=d.row,g=d.column,h=e.rg(f,!1),i=e.sg(g,!1),j=e.ug(!1),d.Bg(),h&&h.Bg(),i&&i.Bg(),j&&j.Bg(f,g,1,1),this.addListenersToDirtyForRow(a);a.imb[2];){for(k=a.imb[2],l=!1,m=0;m<c.length;m++)if(c[m]===k){l=!0;break}if(l)a.Bh(k,2);else{for(c[c.length]=k,e=k.ah,n=e.rC(),o=0;o<n;o++)a.pg(e.qg(o,k.column,!0),0);a.Bh(k,2)}}else if(3===b)for(p=a.imb[3];p;p=p.eh)p.Bg()},a.prototype.initDelay=function(a,c){var d,e,f,g,h,i,j;if(0===c)for(d=null,e=a.imb[0];e;e=d)d=e.eh,f=e.ah,g=f.rC(),h=f.cC(),e.row<g&&e.column<h?(b.supportRowColumnFormula&&(i=f.sg(e.column,!1),i&&(i.delay=0)),e.delay=0):a.Bh(e,0);else if(3===c)for(j=a.imb[3];j;j=j.eh)j.delay=0},a.prototype.adjustDelayOfListeners=function(a,b,c){var d,e,f,g,h,i,j,k;if(0===b)for(d=a.imb[b];d;d=d.eh)e=d.ah,f=d.row,g=d.column,h=e.rg(f,!1),i=e.sg(g,!1),j=e.ug(!1),d.gh(c),h&&h.gh(c),i&&i.gh(c),j&&j.gh(f,g,c);else if(3===b)for(k=a.imb[3];k;k=k.eh)k.gh(c)},a.prototype.calculateDirtyNodes=function(a,b){var c,d,e,f,g,h,i,j,k,l;if(a.calcOnDemand)return!1;if(c=!1,d=null,0===b){for(f=a.imb[b];f;f=e)if(e=f.eh,0===f.delay){if(d=f.ah,g=f.row,h=f.column,i=d.rg(g,!1),j=d.sg(h,!1),j&&j.delay)continue;k=d.ug(!1),d.recalculateCell(g,h),a.Bh(f,0),f.gh(!1),i&&i.gh(!1),j&&j.gh(!1),k&&k.gh(g,h,!1),c=!0}}else if(3===b)for(l=a.imb[b];l;l=e)e=l.eh,0===l.delay&&(d=l.ah,d.recalculateNameID(l.name),a.Bh(l,3),l.gh(!1),c=!0);return c},a.prototype.calculateIterations=function(a,b){var c,d,f,g,h,i,j,k,l,m,o,p;if(!a.calcOnDemand&&0===b&&(c=a.imb[b])){d=null,f=!0;for(g in a.jh)a.jh.hasOwnProperty(g)&&(h=a.jh[g].getSource(),h.clearValueCache&&h.clearValueCache());for(i=0;f&&i<a.maximumIterations;i++)for(f=!1,d=c;d;d=d.eh)j=d.ah,k=d.row,l=d.column,m=j.getSource().getValue(k,l),j.recalculateCell(k,l),f||(o=j.getSource().getValue(k,l),a.Ch(m,o)>=a.maximumChange?f=!0:m instanceof e.CalcError&&!(o instanceof e.CalcError)?f=!0:o instanceof e.CalcError&&!(m instanceof e.CalcError)&&(f=!0));for(p=null,d=c;d;d=p)p=d.eh,d.eh=n,p&&(p.dh=n)}},a.prototype.Ig=function(a,b,c,d,g,h,i){for(var j,k,l,o,p,q,r,s,t,u,v,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V=this;12===d.type;)d=d.value;for(;10===d.type;)d=d.value;for(;12===d.type;)d=d.value;if(g){for(;12===g.type;)g=g.value;for(;10===g.type;)g=g.value;for(;12===g.type;)g=g.value}if(13===d.type){if(r=d.getRange(b,c,!0),r===m)return;d=1===r.rowCount&&1===r.colCount?f.rf(m,m,r.row,r.col,!1,!1):f.uf(m,m,r.row,r.col,r.row+r.rowCount-1,r.col+r.colCount-1,!1,!1,!1,!1)}if(g&&g!==d&&8===g.type){if(g.source instanceof e.ErrorSource)return;k=g.value,G=d.source||g.source||i||V.xf,l=G.getCustomName(k),l?H=G.getCalcSourceModel():(H=V.Af.getGlobalSourceModel()||G.getCalcSourceModel(),l=H.getSource().getCustomName(k),l||(I=G.getCalcSourceModel().wg(k,!0),I.gmb(0,a,h))),p=H.wg(k,!0),p.gmb(0,a,h),g=null,l&&V.Ig(a,b,c,l,m,h,H.getSource())}if(1===d.type&&d.endSource)for(J=d,K=J.source.getSources(J.endSource),j=0;j<K.length;j++)L=f.uf(K[j],m,J.row,J.column,J.endRow,J.endColumn,J.rowRelative,J.columnRelative,J.endRowRelative,J.endColumnRelative,b,c),L.isFullRow=J.isFullRow,L.isFullColumn=J.isFullColumn,V.Ig(a,b,c,L,m,h);else if(1===d.type){if(G=d.source!==e.BangSource&&d.source||V.xf,H=G.getCalcSourceModel(),!H)return;if(M=d,N=a.row===n||a.column===n,O=M.tf(),P=f.getRangeForReference(M,b,c),u=P.row,x=P.col,z=P.rowCount,A=P.colCount,v=u+z-1,y=x+A-1,0===O){if(0<=b&&0<=c)if(aa(s,t,z,A))q=H.ug(!0),N?q.Xoa(u,x,z,A,a,h):q.Jg(u,x,z,A,a,h);else for(E=u;E<=v;E++)for(F=x;F<=y;F++)B=H.qg(E,F,!0),N?B&&B.gmb(3,a,h):B&&B.gmb(0,a,h);else if(0<=b&&c===-1)for(E=u;E<=v;E++)for(F=x;F<=y;F++)M.columnRelative||M.endColumnRelative?(C=H.rg(E,!0),C&&C.Kg(a.row,-F,h)):(B=H.qg(E,F,!0),B&&B.gmb(1,a,h));else if(0<=c&&b===-1)for(E=u;E<=v;E++)for(F=x;F<=y;F++)M.rowRelative||M.endRowRelative?(D=H.sg(F,!0),D&&D.Mg(a.column,-E,h)):(B=H.qg(E,F,!0),B&&B.gmb(2,a,h))}else if(1===O){if(0<=b&&0<=c)q=H.ug(!0),N?q.Xoa(u,x,z,A,a,h):q.Jg(u,x,z,A,a,h);else if(0<=b&&c===-1);else if(b===-1&&0<=c)if(M.rowRelative||M.endRowRelative);else for(u=M.row,v=M.endRow,E=u;E<=v;E++)C=H.rg(E,!0),C&&C.gmb(2,a,h)}else if(2===O)if(0<=b&&0<=c)q=H.ug(!0),N?q.Xoa(u,x,z,A,a,h):q.Jg(u,x,z,A,a,h);else if(0<=b&&c===-1);else if(b===-1&&0<=c)for(F=x;F<=y;F++)D=H.sg(F,!0),D&&D.gmb(2,a,h)}else if(9===d.type)V.Ig(a,b,c,d.value,g&&9===g.type&&g.value,h),d.value2&&V.Ig(a,b,c,d.value2,g&&9===g.type&&g.value2,h);else if(8===d.type){if(G=d.source||i||V.xf,k=w(d.value),l=G.getCustomName(k),l?H=G.getCalcSourceModel():(H=V.Af.getGlobalSourceModel()||G.getCalcSourceModel(),l=H.getSource().getCustomName(k),l||(o=G.getCalcSourceModel().wg(k,!0),o.gmb(0,a,h))),p=H.wg(k,!0),!p)return;p.gmb(0,a,h),l&&V.Ig(a,b,c,l,m,h,H.getSource())}else if(7===d.type){if(Q=d.function){if(Q.isVolatile()&&(h?V.bg(a):V.Tf(a)),!Q.precedentReference())return;Q instanceof e.Functions.AsyncFunction&&(V.Af.nia=!0)}for(R=d.arguments.length,j=0;j<R;j++)V.Ig(a,b,c,d.arguments[j],g&&7===g.type&&g.arguments[j],h)}else if(25===d.type||26===d.type){if(S=d,G=d.source||V.xf,H=G.getCalcSourceModel(),T=H.mg(S.value,!0),!T)return;T.gmb(0,a,h)}else 33===d.type&&(U=d,U.isReferenceError||(G=U.source||U.contextSource||V.xf,H=G.getCalcSourceModel(),P=f.getRangeForReference(U,b,c),B=H.qg(P.row,P.col,!0),B&&B.gmb(0,a,h)))},a.prototype.Og=function(a,b){var c=this.getNodeByName(a);c&&(c.Nf||c.Lf)&&this.Ig(this.mg(a),0,0,c.Nf||c.Lf,c.Lf,b)},a.prototype.Pg=function(a,b,c,d,e){var f,g,h,i,j,k=this,l=a+c,m=b+d;for(i=a;i<l;i++)for(j=b;j<m;j++)f=k.Mf(i,j),g=k.Kf(i,j),(f||g)&&(h=k.Qf(i,j),h&&h.isDynamicArray!==!0?k.Ig(k.qg(i,j),h.row,h.col,f||g,g,e):k.Ig(k.qg(i,j),i,j,f||g,g,e))},a.prototype.Qg=function(a,b,c){var d,e,f=a+b;for(d=a;d!==-1&&d<f;d++)e=this.getColumnExpression(d),e&&this.Ig(this.sg(d,!1),-1,d,e,e,c)},a.prototype.Rg=function(a,b,c,d){this.Pg(a,b,c,d,!0)},a.prototype.Sg=function(a,b,c,d){this.Pg(a,b,c,d,!1)},a.prototype.Tg=function(a,b){},a.prototype.Ug=function(a,b){},a.prototype.Vg=function(a,b){this.Qg(a,b,!0)},a.prototype.Wg=function(a,b){this.Qg(a,b,!1)},a.prototype.Xg=function(a,b,c,d,e,f,g){var h,i,j,k=a+c,l=b+d,m=this;for(h=a;h<k;h++)for(i=b;i<l;i++)j=this.qg(h,i,!1),j&&(m.FTa(g,h,i),e&&j.Yg(),f&&j.Bg())},a.prototype.Zg=function(a,b,c,d,e){var f,g,h,i,j=this,k=j.Hf;if(a!==-1&&k)for(f=z(a+b,k.length),g=a;g<f;g++)h=k[g],h&&h.calc&&(j.FTa(e,g,-1),i=h.calc,c&&i.Yg(),d&&i.Bg())},a.prototype.$g=function(a,b,c,d,e){var f,g,h,i,j=this,k=j.If;if(a!==-1&&k)for(f=z(a+b,k.length),g=a;g<f;g++)h=k[g],h&&h.calc&&(j.FTa(e,-1,g),i=h.calc,c&&i.Yg(),d&&i.Bg())},a.prototype._g=function(a,b,c,d,e,f,g){var h,i,j,k;(e||f)&&(h=this,i=void 0,g&&(i=h.dUa()),0<=a&&0<=b?(h.Xg(a,b,c,d,e,f,i),h.Zg(a,c,e,f,i),h.$g(b,d,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))):0<=a&&b===-1?(h.Xg(a,0,c,h.cC(),e,f,i),h.Zg(a,c,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))):a===-1&&0<=b?(h.Xg(0,b,h.rC(),d,e,f,i),h.$g(b,d,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))):a===-1&&b===-1&&(j=h.rC(),k=h.cC(),h.Xg(0,0,j,k,e,f,i),h.Zg(0,j,e,f,i),h.$g(0,k,e,f,i),h.vg&&(e&&h.vg.Yg(a,b,c,d),f&&h.vg.Bg(a,b,c,d))))},a.prototype.getAllNodes=function(){var a,b,c,d,e=[],f=this.dataTable,g=this.Hf,h=this.If,i=this.Jf;i&&e.push(i);for(b in g)g.hasOwnProperty(b)&&(a=g[b],a&&e.push(a));for(b in h)h.hasOwnProperty(b)&&(a=h[b],a&&e.push(a));for(c in f)if(f.hasOwnProperty(c)&&(d=f[c]))for(b in d)d.hasOwnProperty(b)&&(a=d[b],a&&e.push(a));return e},a.prototype.toJSON=function(a){this.xf.toJSON(a,this.dataTable,this.Ef,this.Ff)},a}(),b.CalcSourceModel=J,K=function(a){P(b,a);function b(b,c,d){var e=a.call(this,b)||this;return e.row=c,e.column=d,e.delay=0,e}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.row+","+a.column},b.prototype.og=function(){var a=this;a.ah.Rg(a.row,a.column,1,1)},b.prototype.ng=function(){var a=this;a.ah.Sg(a.row,a.column,1,1)},b.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,0)},b.prototype.fh=function(){var a=this.ah.Cf();a.calcOnDemand&&(this.dirty=!0),a.pg(this,0)},b.prototype.Bg=function(){var a,b,c,d,e=this.ah.Cf(),f=this.Ze;for(b=0;b<f.length;b++)if(c=this[f[b]])for(d in c)c.hasOwnProperty(d)&&(a=c[d],!a||a.dh||a.eh||a.fh(),e.calcOnDemand&&a&&!a.dirty&&(a.dirty=!0,a.Bg()))},b.prototype.y$a=function(){var a,b,c,d,e,f,g,h,i=this,j=i.ah,k=j.getCalcService();k&&k.nia&&(a=i.nia,b=a&&i.z$a,!b&&y(a)&&(c=j.getSource(),c&&(d=c.getName(),e=k.lh.asyncManager,f=e.y5[d],f&&(g=f[i.row],g&&(h=g[i.column],h&&(b=h[0],b?(i.nia=!0,i.z$a=b,b.h_a=i):i.nia=!1))))),b&&0===b.evaluateMode&&(b.v5=!1))},b}(E),b.CellCalc=K;function V(a,b,c){a[b]||(a[b]=[]),a[b].push(c)}function W(a,b,c){var d,e=a[b];if(e)for(d=0;d<e.length;d++)if(e[d]===c)return void e.splice(d,1)}L=function(a){P(b,a);function b(b,c){var d=a.call(this,b)||this;return d.row=c,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.row+",-1"},b.prototype.og=function(){this.ah.Tg(this.row,1)},b.prototype.ng=function(){this.ah.Ug(this.row,1)},b.prototype.Kg=function(a,b,c){c?V(this,B,{row:a,columnOffset:b,columnCount:1}):W(this,B,{row:a,columnOffset:b,columnCount:1})},b.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,1)},b.prototype.fh=function(){this.ah.Cf().pg(this,1)},b}(E),b.RowCalc=L,M=function(a){P(b,a);function b(b,c){var d=a.call(this,b)||this;return d.column=c,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+"-1,"+a.column},b.prototype.og=function(){this.ah.Vg(this.column,1)},b.prototype.ng=function(){this.ah.Wg(this.column,1)},b.prototype.Mg=function(a,b,c){this.gmb(2,a,c)},b.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,2)},b.prototype.fh=function(){this.ah.Cf().pg(this,2)},b}(E),b.ColumnCalc=M,N=function(a){P(b,a);function b(b,c){var d=a.call(this,b)||this;return d.name=c,d}return b.prototype.getKey=function(){var a=this,b=a.ah,c=null===b?"":b.xf.id+",";return c+a.name},b.prototype.updateListening=function(a,b){var c,d,e,f,g,h,i,j,k=this,l=k.Ze;for(e=0;e<l.length;e++)if(f=k[l[e]]){g=[];for(h in f)f.hasOwnProperty(h)&&(c=f[h],c&&g.push(c));for(i=g.length,j=0;j<i;j++)c=g[j],d=c.node,c.ng(),d&&(!d.Pf||d.Pf.row===c.row&&d.Pf.col===c.column)&&c.ah.fg(c.row,c.column,d.Lf,d.Pf,!0)}},b.prototype.updateListeningOnRemoved=function(){var a,b,c,d,e,f,g,h,i,j,k=this,l=k.Ze,m=k.ah,o=m.Cf();for(f=0;f<l.length;f++)if(g=k[l[f]])for(h in g)g.hasOwnProperty(h)&&(a=g[h],a&&(b=a.ah,c=a.row,d=a.col,c=c===n?-1:c,d=d===n?-1:d,e=b.Kf(c,d),i=b.Qf(c,d),e&&(j=o.ih().adjustFormulaOnRemoveName(m,e,k.name),j!==e&&b.fg(c,d,j,i,!0))))},b.prototype.fh=function(){var a,b,c,d,e=this.Ze;for(b=0;b<e.length;b++)if(c=this[e[b]])for(d in c)c.hasOwnProperty(d)&&(a=c[d],a&&a.fh())},b}(E),b.NameCalc=N,O=function(a){P(b,a);function b(b){return a.call(this,b)||this}return b.prototype.processListener=function(a,b,c,d,e,f,g){var h=this,i=h[a],j=b+","+c+","+d+","+e,k,l;if(3!==a||f instanceof F){if(i||(h.Ze.push(a),h[a]=i={}),k=i[j],!k){if(!g)return;k=i[j]=[],k.row=b,k.col=c,k.rowCount=d,k.colCount=e}if(g){for(l=0;l<k.length;l++)if(k[l]===f)return;k.push(f)}else for(l=0;l<k.length;l++)k[l]===f&&k.splice(l,1)}},b.prototype.Jg=function(a,b,c,d,e,f){this.processListener(0,a,b,c,d,e,f)},b.prototype.Xoa=function(a,b,c,d,e,f){this.processListener(3,a,b,c,d,e,f)},b.prototype.Yg=function(a,b,c,d){this.visit(0,a,b,c,d)},b.prototype.clearListenersCache=function(){var a,b=this.Ze;for(a=0;a<b.length;a++)delete this[b[a]+"cached"]},b.prototype.getListeners=function(a,b){var c,d,e,f,g=a[b],h=this[g];if(h&&(d=g+"cached",c=this[d],!c)){c=this[d]=[];for(e in h)h.hasOwnProperty(e)&&(f=h[e],f&&c.push(f))}return c},b.prototype.visit=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r=this.Ze;for(g=0;g<r.length;g++)if(h=this[r[g]])for(i=this.getListeners(r,g),j=0;j<i.length;j++)if(k=i[j],l=k.row,m=k.col,n=k.rowCount,o=k.colCount,(l===-1||b===-1||l<b+d&&b<l+n)&&(m===-1||c===-1||m<c+e&&c<m+o))for(p=k.length,q=0;q<p;q++)f=k[q],0===a?f.bh():f.fh()},b.prototype.Bg=function(a,b,c,d){this.visit(1,a,b,c,d)},b.prototype.gh=function(a,b,c){var d,e,f,g,h,i,j,k,l=this.Ze,m=c?1:-1;for(e=0;e<l.length;e++)if(f=this[l[e]])for(g=this.getListeners(l,e),h=0;h<g.length;h++)if(i=g[h],d=i,d&&(d.row===-1||d.row<=a&&a<d.row+d.rowCount)&&(d.col===-1||d.col<=b&&b<d.col+d.colCount))for(j=i.length,k=0;k<j;k++)i[k].delay+=m},b.prototype.og=function(){},b.prototype.ng=function(){},b}(E),b.RangeCalc=O;function X(a,b){var c,d,e;for(c in a)d=a[c],d&&(b?X(d):(e=d.calc,e&&e.ng()))}function Y(a,b,c,d,i,j,k){var l,o,t,u,v,w,x,y,z,A,B,C,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra=a.row,sa=a.column,ta=[],ua=0,va=a.arrayIdentity?a.arrayIdentity.row:ra,wa=a.arrayIdentity?a.arrayIdentity.col:sa;for(ta[ua]={expr:b,acceptsArray:j||!1,acceptsRef:k||!1,index:-1},l=0,o=0,t=!1,v=d,w=i,x=!1;ua>=0;){if(y=ta[ua],ua--,z=y.acceptsArray,A=y.acceptsRef,b=y.expr,B=m,b){if(7===b.type){if(L=b,M=L.arguments,N=M.length,!L.function){if(!a){B=e.Hh(p);continue}if(O=L.functionName,"ANCHORARRAY"===O){1===N&&(P=M[0],Q=P.source,R=a.source,1===P.type&&P.sf()?B=f.xJb(R,Q,n,P.row,P.column,P.rowRelative,P.columnRelative):5===P.type&&(B=f.FLb(R,Q))),B?a.ELb=2:B=e.Hh(p),L.ensureSingle&&(B.ensureSingle=!0),C=B;continue}L.function=a.getFunction(O)}if(S=L.function,T=y.index,K=y.neeedExpendindexs,T<0?(y.arrayArgumentEvaluateMode=x,y.arrayFormulaCatchValue=c,S&&S.arrayArgumentEvaluateMode&&(x=S.arrayArgumentEvaluateMode),y.args=[]):(S&&S.acceptsArray&&S.acceptsArray(T)?l--:t&&(K||(K=[],y.neeedExpendindexs=K),L.arguments[T]!==C,K.push(T)),y.args.push(C)),T===N-1){if(x=y.arrayArgumentEvaluateMode,c=y.arrayFormulaCatchValue,U=y.args,V=!1,U&&U.length>0)for(W=0;W<U.length;W++)if(U[W]!==L.arguments[W]){V=!0;break}B=V?e.Jh(L,U):b,K&&K.length>0&&(B=e.createExpandExpression(B,K),t=!0)}else 0===T&&S&&3===S.arrayArgumentEvaluateMode&&3===x&&(x=0),t=!1,T++,y.index=T,S&&S.acceptsArray&&S.acceptsArray(T)&&l++,++ua,ta[ua]=y,++ua,ta[ua]={expr:L.arguments[T],acceptsArray:!!S&&S.acceptsArray&&S.acceptsArray(T),acceptsRef:!!S&&S.acceptsReference&&S.acceptsReference(T),index:-1}}else if(1===b.type&&b.sf())o&&(F=b.source!==e.BangSource&&b.source||a.source,G=F.getRowCount(),H=F.getColumnCount(),I=b.rowRelative?(b.row+va)%e.MAX_ROW_COUNT%G:b.row,J=b.columnRelative?(b.column+wa)%e.MAX_COLUMN_COUNT%H:b.column,I=I<0?I+G:I,J=J<0?J+H:J,b=f.rf(b.source&&F,m,I,J,!1,!1));else if(1===b.type||13===b.type){if(13===b.type){if(X=b,E=X.getRange(ra,sa),X.tzb(ra,sa,a.source.id),!E){X._error?(delete X._error,B=C=q,a.ELb=1):(B=b,C=b);continue}b=f.uf(X.source===a.source?m:X.source,m,E.row,E.col,E.row+E.rowCount-1,E.col+E.colCount-1)}Y=b.source!==e.BangSource&&b.source,_=b,aa=_.ensureSingle,o&&(F=Y||a.source,G=e.MAX_ROW_COUNT,H=e.MAX_COLUMN_COUNT,ba=_.rowRelative?(_.row+va)%G:_.row,ca=_.columnRelative?(_.column+wa)%H:_.column,da=_.endRowRelative?(_.endRow+va)%G:_.endRow,ea=_.endColumnRelative?(_.endColumn+wa)%H:_.endColumn,ba=ba<0?ba+G:ba,ca=ca<0?ca+H:ca,da=da<0?da+G:da,ea=ea<0?ea+H:ea,fa=void 0,ba>da&&(fa=ba,ba=da,da=fa),ca>ea&&(fa=ca,ca=ea,ea=fa),G=F.getRowCount(),H=F.getColumnCount(),ba>=G?(ba%=G,da%=G):da>=G&&(da=G-1),ca>=H?(ca%=H,ea%=H):ea>=H&&(ea=H-1),b.row===e.BAND_INDEX_CONST&&(ba=da=e.BAND_INDEX_CONST),b.column===e.BAND_INDEX_CONST&&(ca=ea=e.BAND_INDEX_CONST),b=f.uf(Y,b.endSource,ba,ca,da,ea,!1,!1,!1,!1),aa&&(b.ensureSingle=!0)),k||A&&(z||!c&&1!==x&&3!==x)||ra<0||sa<0||(l>0&&!c&&1!==x&&3!==x||0===l||2===x?(E=_.getRange(ra,sa),c||(A||z)&&1===x?!_.isFullColumn&&1!==E.rowCount&&v>=E.rowCount||!_.isFullRow&&1!==E.colCount&&w>=E.colCount?B=e.Hh(s):(I=(_.isFullColumn?0:E.row)+(1===E.rowCount?0:v),J=(_.isFullRow?0:E.col)+(1===E.colCount?0:w),B=f.rf(Y,b.endSource,I,J,!1,!1)):E.rowCount>1&&E.colCount>1||E.rowCount>1&&!_.isFullColumn&&(ra<E.row||ra>=E.row+E.rowCount)||E.colCount>1&&!_.isFullRow&&(sa<E.col||sa>=E.col+E.colCount)?B=e.Hh(r):(I=_.isFullColumn||E.rowCount>1?ra:E.row,J=_.isFullRow||E.colCount>1?sa:E.col,B=f.rf(Y,b.endSource,I,J,!1,!1))):t=!0)}else if(9===b.type)ga=b.operatorType>=15,ha=A&&a.source&&a.source.Af&&a.source.Af.allowDynamicArray,y.index===-1?(y.index=b.value2?0:1,++ua,ta[ua]=y,++ua,ta[ua]=Z(b.value,ga||z,ga||ha,-1)):0===y.index?(C!==b.value&&(B=e.Kh(b.operatorType,C,b.value2),y.expr=B),t&&(K=[],K.push(0),y.neeedExpendindexs=K,t=!1),y.index=1,++ua,ta[ua]=y,++ua,ta[ua]=Z(b.value2,ga||z,ga||ha,-1)):(B=b.value2&&C!==b.value2?e.Kh(b.operatorType,b.value,C):b,K=y.neeedExpendindexs,t&&(K?K.push(1):K=[b.value2&&b.value2===u?1:0]),K&&(B=e.createExpandExpression(B,K),t=!0));else if(10===b.type)y.index===-1?(y.index=0,++ua,ta[ua]=y,++ua,ta[ua]=Z(b.value,z,A,-1)):b.value!==C&&(B=e.Lh(C));else if(8===b.type)1===y.index?(o--,B=C,y.context&&(a=y.context)):(o++,++ua,ta[ua]=Z(b,z,A,1,a),ia=void 0,ja=a,ka=void 0,b.source?(ka=b.source===e.BangSource?a.source:b.source,ja=new h.EvaluateContext(ka),ja.cloneFrom(a),ia=ka.getCustomName(b.value)):(ia=a.getName(b.value),a.source.getCustomName(b.value)||(ja=new h.GloableEvaluateContext(a.source),ja.cloneFrom(a))),ia||(ia=e.Hh(p)),a=ja||a,++ua,ta[ua]=Z(ia,z,A,-1,a));else if(6===b.type)if(la=b,ma=b.value,!z&&(l>0||c||1===x||3===x))t=!0,u=b;else if(!z&&0===l)if(na=ma.getRowCount(),oa=ma.getColumnCount(),v>=na&&na>1||w>=oa&&oa>1)B=e.Hh(s);else if(c||!(a.source&&a.source.Af&&a.source.Af.allowDynamicArray))try{1===na&&(v=0),1===oa&&(w=0),pa=la.value.getValue(v,w),"string"==typeof pa?B=e.createStringExpression(pa):typeof pa===D&&(B=e.createNumberExpression(pa)),qa=new g.Parser,B=qa.parse(a.source.getParserContext(a.useR1C1,$(0,0)),""+la.value.getValue(v,w))}catch(a){B=e.Hh(s)}}else;B===m&&(B=b),C=B}return B}b.Mh=Y;function Z(a,b,c,d,e){return{expr:a,acceptsArray:b,acceptsRef:c,index:d,context:e}}function $(a,b){return{row:a,col:b}}b.pf=$;function _(a,b,c,d){return{row:a,col:b,rowCount:c,colCount:d}}b.qf=_;function aa(a,b,c,d){return a===-1&&d>127||b===-1&&c>127||c*d>127}},"./src/calcEngine.res.en.ts":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0});function d(a,b){return{description:a,parameters:b}}function e(a,b){return{name:a,repeatable:b}}b.resource={Exp_InvalidCast:"Invalid Cast Exception",Exp_FormulaInvalidChar:"The formula contains an invalid character: '{0}' at index on {1}",Exp_FormulaInvalid:"Invalid Formula",Exp_InvalidFunctionName:"Invalid function name",Exp_InvalidOverrideFunction:"Cannot override built-in function",Exp_InvalidArray:"Invalid array",Exp_OverrideNotAllowed:"Attempt to override function while override is not allowed",Exp_NoSyntax:"No syntax '{0}' to match the syntax '{1}'.",Exp_IsValid:"'{0}' is invalid.",Exp_InvalidParameters:"Invalid function parameter at {0}.",Exp_InvalidArrayColumns:"The length of array columns are not equal at {0}.",Exp_ExprIsNull:"The argument 'expr' is null",Exp_InvalidOperation:"Invalid Operation Exception",Exp_ArgumentNull:"Argument Null Exception",Exp_CriteriaIsNull:"Criteria is null",Exp_Format:"Format",Exp_ArrayFromulaPart:"Cannot change part of an array.",Exp_NotSupported:"Not Supported Exception",_h:{ABS:d("This function calculates the absolute value of the specified value.",[e("value")]),ACCRINT:d("This function calculates the accrued interest for a security that pays periodic interest.",[e("issue"),e("first"),e("settle"),e("rate"),e("par"),e("frequency"),e("basis")]),ACCRINTM:d("This function calculates the accrued interest at maturity for a security that pays periodic interest.",[e("issue"),e("maturity"),e("rate"),e("par"),e("basis")]),ACOS:d("This function calculates the arccosine, that is, the angle whose cosine is the specified value.",[e("value")]),ACOSH:d("This function calculates the inverse hyperbolic cosine of the specified value.",[e("value")]),ADDRESS:d("This function uses the row and column numbers to create a cell address in text.",[e("row"),e("column"),e("absnum"),e("a1style"),e("sheettext")]),AGGREGATE:d("This function aggregate a list of numbers using a specified built-in function.",[e("functioncode"),e("option"),e("value1"),e("value2",!0)]),AMORDEGRC:d("This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",[e("cost"),e("datepurchased"),e("firstperiod"),e("salvage"),e("period"),e("drate"),e("basis")]),AMORLINC:d("This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",[e("cost"),e("datepurchased"),e("firstperiod"),e("salvage"),e("period"),e("drate"),e("basis")]),AND:d("Check whether all arguments are True, and returns True if all arguments are True.",[e("logical1"),e("logical2")]),ASIN:d("This function calculates the arcsine, that is, the angle whose sine is the specified value.",[e("value")]),ASINH:d("This function calculates the inverse hyperbolic sine of a number.",[e("value")]),ATAN:d("This function calculates the arctangent, that is, the angle whose tangent is the specified value.",[e("value")]),
ATAN2:d("This function calculates the arctangent of the specified x- and y-coordinates.",[e("x"),e("y")]),ATANH:d("This function calculates the inverse hyperbolic tangent of a number.",[e("value")]),AVEDEV:d("This function calculates the average of the absolute deviations of the specified values from their mean.",[e("value1"),e("value2",!0)]),AVERAGE:d("This function calculates the average of the specified numeric values.",[e("value1"),e("value2",!0)]),AVERAGEA:d("This function calculates the average of the specified values, including text or logical values as well as numeric values.",[e("value1"),e("value2",!0)]),AVERAGEIF:d("This function calculates the average of the specified numeric values provided that they meet the specified criteria.",[e("value1"),e("value2",!0),e("condition")]),AVERAGEIFS:d("This function calculates the average of all cells that meet multiple specified criteria.",[e("value1"),e("condition1"),e("value2",!0),e("condition2",!0)]),BESSELI:d("This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",[e("value"),e("order")]),BESSELJ:d("This function calculates the Bessel function of the first kind.",[e("value"),e("order")]),BESSELK:d("This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",[e("value"),e("order")]),BESSELY:d("This function calculates the Bessel function of the second kind.",[e("value"),e("order")]),BETADIST:d("This function calculates the cumulative beta distribution function.",[e("x"),e("alpha"),e("beta"),e("lower"),e("upper")]),BETAINV:d("This function calculates the inverse of the cumulative beta distribution function.",[e("prob"),e("alpha"),e("beta"),e("lower"),e("upper")]),BIN2DEC:d("This function converts a binary number to a decimal number",[e("number")]),BIN2HEX:d("This function converts a binary number to a hexadecimal number.",[e("number"),e("places")]),BIN2OCT:d("This function converts a binary number to an octal number.",[e("number"),e("places")]),BINOMDIST:d("This function calculates the individual term binomial distribution probability.",[e("x"),e("n"),e("p"),e("cumulative")]),CEILING:d("This function rounds a number up to the nearest multiple of a specified value.",[e("value"),e("signif")]),CHAR:d("This function returns the character specified by a number.",[e("value")]),CHIDIST:d("This function calculates the one-tailed probability of the chi-squared distribution.",[e("value"),e("deg")]),CHIINV:d("This function calculates the inverse of the one-tailed probability of the chi-squared distribution",[e("prob"),e("deg")]),CHITEST:d("This function calculates the test for independence from the chi-squared distribution.",[e("obs_array"),e("exp_array")]),CHOOSE:d("This function returns a value from a list of values.",[e("index"),e("value1"),e("value2",!0)]),CLEAN:d("This function removes all non-printable characters from text.",[e("text")]),CODE:d("This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",[e("text")]),COLUMN:d("This function returns the column number of a reference.",[e("reference")]),COLUMNS:d("This function returns the number of columns in an array.",[e("array")]),COMBIN:d("This function calculates the number of possible combinations for a specified number of items.",[e("k"),e("n")]),COMPLEX:d("This function converts real and imaginary coefficients into a complex number.",[e("realcoeff"),e("imagcoeff"),e("suffix")]),CONCATENATE:d("This function combines multiple text strings or numbers into one text string.",[e("text1"),e("text2",!0)]),CONFIDENCE:d("This function returns confidence interval for a population mean.",[e("alpha"),e("stdev"),e("size")]),CONVERT:d("This function converts a number from one measurement system to its equivalent in another measurement system.",[e("number"),e("from-unit"),e("to-unit")]),CORREL:d("This function returns the correlation coefficient of the two sets of data.",[e("array1"),e("array2")]),COS:d("This function returns the cosine of the specified angle.",[e("angle")]),COSH:d("This function returns the hyperbolic cosine of the specified value.",[e("value")]),COUNT:d("This function returns the number of cells that contain numbers.",[e("value1"),e("value2",!0)]),COUNTA:d("This function returns the number of number of cells that contain numbers, text, or logical values.",[e("value1"),e("value2",!0)]),COUNTBLANK:d("This function returns the number of empty (or blank) cells in a range of cells on a sheet.",[e("cellrange")]),COUNTIF:d("This function returns the number of cells that meet a certain condition",[e("cellrange"),e("condition")]),COUNTIFS:d("This function returns the number of cells that meet multiple conditions.",[e("cellrange"),e("condition")]),COUPDAYBS:d("This function calculates the number of days from the beginning of the coupon period to the settlement date.",[e("settlement"),e("maturity"),e("frequency"),e("basis")]),COUPDAYS:d("This function returns the number of days in the coupon period that contains the settlement date.",[e("settlement"),e("maturity"),e("frequency"),e("basis")]),COUPDAYSNC:d("This function calculates the number of days from the settlement date to the next coupon date.",[e("settlement"),e("maturity"),e("frequency"),e("basis")]),COUPNCD:d("This function returns a date number of the next coupon date after the settlement date.",[e("settlement"),e("maturity"),e("frequency"),e("basi")]),COUPNUM:d("This function returns the number of coupons due between the settlement date and maturity date.",[e("settlement"),e("maturity"),e("frequency"),e("basis")]),COUPPCD:d("This function returns a date number of the previous coupon date before the settlement date.",[e("settlement"),e("maturity"),e("frequency"),e("basis")]),COVAR:d("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[e("array1"),e("array2")]),CRITBINOM:d("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[e("n"),e("p"),e("alpha")]),CUMIPMT:d("This function returns the cumulative interest paid on a loan between the starting and ending periods.",[e("rate"),e("nper"),e("pval"),e("startperiod"),e("endperiod"),e("paytype")]),CUMPRINC:d("This function returns the cumulative principal paid on a loan between the start and end periods.",[e("rate"),e("nper"),e("pval"),e("startperiod"),e("endperiod"),e("paytype")]),DATE:d("This function returns the DateTime object for a particular date, specified by the year, month, and day.",[e("year"),e("month"),e("day")]),DATEDIF:d("This function returns the number of days, months, or years between two dates.",[e("date1"),e("date2"),e("outputcode")]),DATEVALUE:d("This function returns a DateTime object of the specified date.",[e("date_string")]),DAVERAGE:d("This function calculates the average of values in a column of a list or database that match the specified conditions.",[e("database"),e("field"),e("criteria")]),DAY:d("This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",[e("date")]),DAYS360:d("This function returns the number of days between two dates based on a 360-day year.",[e("startdate"),e("enddate"),e("method")]),DB:d("This function calculates the depreciation of an asset for a specified period using the fixed\u2011declining balance method",[e("cost"),e("salvage"),e("life"),e("period"),e("month")]),DCOUNT:d("This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",[e("database"),e("field"),e("criteria")]),DCOUNTA:d("This function counts the non-blank cells in a column of a list or database that match the specified conditions",[e("database"),e("field"),e("criteria")]),DDB:d("This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",[e("cost"),e("salvage"),e("life"),e("period"),e("factor")]),DEC2BIN:d("This function converts a decimal number to a binary number.",[e("number"),e("places")]),DEC2HEX:d("This function converts a decimal number to a hexadecimal number",[e("number"),e("places")]),DEC2OCT:d("This function converts a decimal number to an octal number",[e("number"),e("places")]),DEGREES:d("This function converts the specified value from radians to degrees",[e("angle")]),DELTA:d("This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",[e("value1"),e("value2")]),DEVSQ:d("This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",[e("value1"),e("value2",!0)]),DGET:d("This function extracts a single value from a column of a list or database that matches the specified conditions.",[e("database"),e("field"),e("criteria")]),DISC:d("This function calculates the discount rate for a security.",[e("settle"),e("mature"),e("pricep"),e("redeem"),e("basis")]),DMAX:d("This function returns the largest number in a column of a list or database that matches the specified conditions.",[e("database"),e("field"),e("criteria")]),DMIN:d("This function returns the smallest number in a column of a list or database that matches the specified conditions.",[e("database"),e("field"),e("criteria")]),DOLLAR:d("This function converts a number to text using currency format, with the decimals rounded to the specified place.",[e("value"),e("digits")]),DOLLARDE:d("This function converts a fraction dollar price to a decimal dollar price.",[e("fractionaldollar"),e("fraction")]),DOLLARFR:d("This function converts a decimal number dollar price to a fraction dollar price.",[e("decimaldollar"),e("fraction")]),DPRODUCT:d("This function multiplies the values in a column of a list or database that match the specified conditions.",[e("database"),e("field"),e("criteria")]),DSTDEV:d("This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[e("database"),e("field"),e("criteria")]),DSTDEVP:d("This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",[e("database"),e("field"),e("criteria")]),DSUM:d("This function adds the numbers in a column of a list or database that match the specified conditions.",[e("database"),e("field"),e("criteria")]),DURATION:d("This function returns the Macaulay duration for an assumed par value of $100.",[e("settlement"),e("maturity"),e("coupon"),e("yield"),e("frequency"),e("basis")]),DVAR:d("This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[e("database"),e("field"),e("criteria")]),DVARP:d("This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",[e("database"),e("field"),e("criteria")]),EDATE:d("This function calculates the date that is the indicated number of months before or after a specified date.",[e("startdate"),e("months")]),EFFECT:d("This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",[e("nomrate"),e("comper")]),EOMONTH:d("This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",[e("startdate"),e("months")]),ERF:d("This function calculates the error function integrated between a lower and an upper limit.",[e("limit"),e("upperlimit")]),ERFC:d("This function calculates the complementary error function integrated between a lower limit and infinity.",[e("lowerlimit")]),"ERROR.TYPE":d("This function returns a number corresponding to one of the error values.",[e("errorvalue")]),EURO:d("This function returns the equivalent of one Euro based on the ISO currency code.",[e("code")]),EUROCONVERT:d("This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",[e("currency"),e("source"),e("target"),e("fullprecision"),e("triangulation")]),EVEN:d("This function rounds the specified value up to the nearest even integer.",[e("value")]),EXACT:d("This function returns true if two strings are the same; otherwise, false.",[e("text1"),e("text2")]),EXP:d("This function returns e raised to the power of the specified value.",[e("value")]),EXPONDIST:d("This function returns the exponential distribution or the probability density.",[e("value"),e("lambda"),e("cumulative")]),FACT:d("This function calculates the factorial of the specified number.",[e("number")]),FACTDOUBLE:d("This function calculates the double factorial of the specified number.",[e("number")]),FALSE:d("This function returns the value for logical FALSE.",[]),FDIST:d("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[e("value"),e("degnum"),e("degden")]),FIND:d("This function finds one text value within another and returns the text value\u2019s position in the text you searched.",[e("findtext"),e("intext"),e("start")]),FINV:d("This function returns the inverse of the F probability distribution.",[e("p"),e("degnum"),e("degden")]),FISHER:d("This function returns the Fisher transformation for a specified value.",[e("value")]),FISHERINV:d("This function returns the inverse of the Fisher transformation for a specified value.",[e("value")]),FIXED:d("This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",[e("num"),e("digits"),e("notcomma")]),FLOOR:d("This function rounds a number down to the nearest multiple of a specified value.",[e("value"),e("signif")]),FORECAST:d("This function calculates a future value using existing values.",[e("value"),e("Yarray"),e("Xarray")]),FREQUENCY:d("This function calculates how often values occur within a range of values. This function returns a vertical array of numbers.",[e("dataarray"),e("binarray")]),FTEST:d("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[e("array1"),e("array2")]),FV:d("This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",[e("rate"),e("numper"),e("paymt"),e("pval"),e("type")]),FVSCHEDULE:d("This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",[e("principal"),e("schedule")]),GAMMADIST:d("This function returns the gamma distribution.",[e("x"),e("alpha"),e("beta"),e("cumulative")]),GAMMAINV:d("This function returns the inverse of the gamma cumulative distribution.",[e("p"),e("alpha"),e("beta")]),GAMMALN:d("This function returns the natural logarithm of the Gamma function, G(x).",[e("value")]),GCD:d("This function returns the greatest common divisor of two numbers.",[e("number1"),e("number2")]),GEOMEAN:d("This function returns the geometric mean of a set of positive data.",[e("value1"),e("value2",!0)]),GESTEP:d("This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",[e("number"),e("step")]),GROWTH:d("This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",[e("y"),e("x"),e("newx"),e("constant")]),HARMEAN:d("This function returns the harmonic mean of a data set.",[e("value1"),e("value2",!0)]),HEX2BIN:d("This function converts a hexadecimal number to a binary number.",[e("number"),e("places")]),HEX2DEC:d("This function converts a hexadecimal number to a decimal number.",[e("number")]),HEX2OCT:d("This function converts a hexadecimal number to an octal number.",[e("number"),e("places")]),HLOOKUP:d("This function searches for a value in the top row and then returns a value in the same column from a specified row.",[e("value"),e("array"),e("row"),e("approx")]),HOUR:d("This function returns the hour that corresponds to a specified time.",[e("time")]),HYPGEOMDIST:d("This function returns the hypergeometric distribution.",[e("x"),e("n"),e("M"),e("N")]),IF:d("This function performs a comparison and returns one of two provided values based on that comparison.",[e("valueTest"),e("valueTrue"),e("valueFalse")]),IFERROR:d("This function evaluates a formula and returns a value you provide if there is an error or the formula result.",[e("value"),e("error")]),IMABS:d("This function returns the absolute value or modulus of a complex number.",[e("complexnum")]),IMAGINARY:d("This function returns the imaginary coefficient of a complex number.",[e("complexnum")]),IMARGUMENT:d("This function returns the argument theta, which is an angle expressed in radians.",[e("complexnum")]),IMCONJUGATE:d("This function returns the complex conjugate of a complex number.",[e("complexnum")]),IMCOS:d("This function returns the cosine of a complex number.",[e("complexnum")]),IMDIV:d("This function returns the quotient of two complex numbers.",[e("complexnum"),e("complexdenom")]),IMEXP:d("This function returns the exponential of a complex number.",[e("complexnum")]),IMLN:d("This function returns the natural logarithm of a complex number.",[e("complexnum")]),IMLOG2:d("This function returns the base-2 logarithm of a complex number.",[e("complexnum")]),IMLOG10:d("This function returns the common logarithm of a complex number.",[e("complexnum")]),IMPOWER:d("This function returns a complex number raised to a power.",[e("complexnum"),e("powernum")]),IMPRODUCT:d("This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format.",[e("complexnum1"),e("complexnum2",!0)]),IMREAL:d("This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",[e("complexnum")]),IMSIN:d("This function returns the sine of a complex number in the x+yi or x+yj text format.",[e("complexnum")]),IMSQRT:d("This function returns the square root of a complex number in the x+yi or x+yj text format.",[e("complexnum")]),IMSUB:d("This function returns the difference of two complex numbers in the x+yi or x+yj text format.",[e("complexnum1"),e("complexnum2")]),IMSUM:d("This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",[e("complexnum1"),e("complexnum2",!0)]),INDEX:d("This function returns a value or the reference to a value from within an array or range.",[e("return"),e("row"),e("col"),e("area")]),INDIRECT:d("This function returns the reference specified by a text string. References are immediately evaluated to display their contents.",[e("ref_text"),e("a1_style")]),INT:d("This function rounds a specified number down to the nearest integer.",[e("value")]),INTERCEPT:d("This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",[e("dependent"),e("independent")]),INTRATE:d("This function calculates the interest rate for a fully invested security.",[e("settle"),e("mature"),e("invest"),e("redeem"),e("basis")]),IPMT:d("This function calculates the payment of interest on a loan.",[e("rate"),e("per"),e("nper"),e("pval"),e("fval"),e("type")]),IRR:d("This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",[e("arrayvals"),e("estimate")]),ISBLANK:d("This function tests whether a value, an expression, or contents of a referenced cell is empty.",[e("cellreference")]),ISERR:d("This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",[e("cellreference")]),ISERROR:d("This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",[e("cellreference")]),ISEVEN:d("This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",[e("cellreference")]),ISLOGICAL:d("This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",[e("cellreference")]),ISNA:d("This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",[e("cellreference")]),ISNONTEXT:d("This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",[e("cellreference")]),ISNUMBER:d("This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",[e("cellreference")]),ISODD:d("This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",[e("cellreference")]),ISPMT:d("This function calculates the interest paid during a specific period of an investment.",[e("rate"),e("per"),e("nper"),e("pv")]),ISREF:d("This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",[e("cellreference")]),ISTEXT:d("This function tests whether a value, an expression, or contents of a referenced cell has text data.",[e("cellreference")]),KURT:d("This function returns the kurtosis of a data set.",[e("value1"),e("value2"),e("value3"),e("value4",!0)]),LARGE:d("This function returns the nth largest value in a data set, where n is specified.",[e("array"),e("n")]),LCM:d("This function returns the least common multiple of two numbers.",[e("number1"),e("number2")]),LEFT:d("This function returns the specified leftmost characters from a text value, and based on the number of characters you specify.",[e("mytext"),e("num_chars")]),LEN:d("This function returns the length of the number of characters in a text string.",[e("value")]),LINEST:d("This function calculates the statistics for a line.",[e("y"),e("x"),e("constant"),e("stats")]),LN:d("This function returns the natural logarithm of the specified number.",[e("value")]),LOG:d("This function returns the logarithm base Y of a number X.",[e("number"),e("base")]),LOG10:d("This function returns the logarithm base 10 of the number given.",[e("value")]),LOGEST:d("This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",[e("y"),e("x"),e("constant"),e("stats")]),LOGINV:d("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[e("prob"),e("mean"),e("stdev")]),LOGNORMDIST:d("This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",[e("x"),e("mean"),e("stdev")]),LOOKUP:d("This function searches for a value and returns a value from the same location in a second area.",[e("lookupvalue"),e("lookupvector"),e("resultvector")]),LOWER:d("This function converts text to lower case letters.",[e("string")]),MATCH:d("This function returns the relative position of a specified item in a range.",[e("value1"),e("array"),e("type")]),MAX:d("This function returns the maximum value, the greatest value, of all the values in the arguments.",[e("value1"),e("value2",!0)]),MAXA:d("This function returns the largest value in a list of arguments, including text and logical values.",[e("value1"),e("value2",!0)]),MDETERM:d("This function returns the matrix determinant of an array.",[e("array")]),MDURATION:d("This function calculates the modified Macaulay duration of a security with an assumed par value of $100.",[e("settlement"),e("maturity"),e("coupon"),e("yield"),e("frequency"),e("basis")]),MEDIAN:d("This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",[e("value1"),e("value2",!0)]),MID:d("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of characters you specify.",[e("text"),e("start_num"),e("num_chars")]),MIN:d("This function returns the minimum value, the least value, of all the values in the arguments.",[e("value1"),e("value2",!0)]),MINA:d("This function returns the minimum value in a list of arguments, including text and logical values.",[e("value1"),e("value2",!0)]),MINUTE:d("This function returns the minute corresponding to a specified time.",[e("time")]),MINVERSE:d("This function returns the inverse matrix for the matrix stored in an array.",[e("array")]),MIRR:d("This function returns the modified internal rate of return for a series of periodic cash flows.",[e("arrayvals"),e("payment_int"),e("income_int")]),MMULT:d("This function returns the matrix product for two arrays.",[e("array1"),e("array2")]),MOD:d("This function returns the remainder of a division operation.",[e("dividend"),e("divisor")]),MODE:d("This function returns the most frequently occurring value in a set of data.",[e("value1"),e("value2",!0)]),MONTH:d("This function returns the month corresponding to the specified date value.",[e("date")]),MROUND:d("This function returns a number rounded to the desired multiple.",[e("number"),e("multiple")]),MULTINOMIAL:d("This function calculates the ratio of the factorial of a sum of values to the product of factorials.",[e("value1"),e("value2",!0)]),N:d("This function returns a value converted to a number.",[e("value")]),NA:d("This function returns the error value #N/A that means not available.",[]),NEGBINOMDIST:d("This function returns the negative binomial distribution.",[e("x"),e("r"),e("p")]),NETWORKDAYS:d("This function returns the total number of complete working days between the start and end dates.",[e("startdate"),e("enddate"),e("holidays")]),NOMINAL:d("This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",[e("effrate"),e("comper")]),NORMDIST:d("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[e("x"),e("mean"),e("stdev"),e("cumulative")]),NORMINV:d("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[e("prob"),e("mean"),e("stdev")]),NORMSDIST:d("This function returns the standard normal cumulative distribution function.",[e("value")]),NORMSINV:d("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[e("prob")]),NOT:d("This function reverses the logical value of its argument.",[e("value")]),NOW:d("This function returns the current date and time.",[]),NPER:d("This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",[e("rate"),e("paymt"),e("pval"),e("fval"),e("type")]),NPV:d("This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",[e("discount"),e("value1"),e("value2",!0)]),OCT2BIN:d("This function converts an octal number to a binary number.",[e("number"),e("places")]),OCT2DEC:d("This function converts an octal number to a decimal number.",[e("number")]),OCT2HEX:d("This function converts an octal number to a hexadecimal number.",[e("number"),e("places")]),ODD:d("This function rounds the specified value up to the nearest odd integer.",[e("value")]),ODDFPRICE:d("This function calculates the price per $100 face value of a security with an odd first period.",[e("settle"),e("maturity"),e("issue"),e("first"),e("rate"),e("yield"),e("redeem"),e("freq"),e("basis")]),ODDFYIELD:d("This function calculates the yield of a security with an odd first period.",[e("settle"),e("maturity"),e("issue"),e("first"),e("rate"),e("price"),e("redeem"),e("freq"),e("basis")]),ODDLPRICE:d("This function calculates the price per $100 face value of a security with an odd last coupon period.",[e("settle"),e("maturity"),e("last"),e("rate"),e("yield"),e("redeem"),e("freq"),e("basis")]),ODDLYIELD:d("This function calculates the yield of a security with an odd last period.",[e("settle"),e("maturity"),e("last"),e("rate"),e("price"),e("redeem"),e("freq"),e("basis")]),OFFSET:d("This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",[e("reference"),e("rows"),e("cols"),e("height"),e("width")]),OR:d("This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",[e("argument1"),e("argument2",!0)]),PEARSON:d("This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",[e("array_ind"),e("array_dep")]),PERCENTILE:d("This function returns the nth percentile of values in a range.",[e("array"),e("n")]),PERCENTRANK:d("This function returns the rank of a value in a data set as a percentage of the data set.",[e("array"),e("n"),e("sigdig")]),PERMUT:d("This function returns the number of possible permutations for a specified number of items.",[e("k"),e("n")]),PI:d("This function returns PI as 3.1415926536.",[]),PMT:d("This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",[e("rate"),e("nper"),e("pval"),e("fval"),e("type")]),POISSON:d("This function returns the Poisson distribution.",[e("nevents"),e("mean"),e("cumulative")]),POWER:d("This function raises the specified number to the specified power.",[e("number"),e("power")]),PPMT:d("This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",[e("rate"),e("per"),e("nper"),e("pval"),e("fval"),e("type")]),PRICE:d("This function calculates the price per $100 face value of a periodic interest security",[e("settlement"),e("maturity"),e("rate"),e("yield"),e("redeem"),e("frequency"),e("basis")]),PRICEDISC:d("This function returns the price per $100 face value of a discounted security.",[e("settle"),e("mature"),e("discount"),e("redeem"),e("basis")]),PRICEMAT:d("This function returns the price at maturity per $100 face value of a security that pays interest.",[e("settle"),e("mature"),e("issue"),e("rate"),e("yield"),e("basis")]),PROB:d("This function returns the probability that values in a range are between two limits.",[e("array"),e("probs"),e("lower"),e("upper")]),PRODUCT:d("This function multiplies all the arguments and returns the product.",[e("value1"),e("value2",!0)]),PROPER:d("This function capitalizes the first letter in each word of a text string.",[e("text")]),PV:d("This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",[e("rate"),e("numper"),e("paymt"),e("fval"),e("type")]),QUARTILE:d("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[e("array"),e("quart")]),
QUOTIENT:d("This function returns the integer portion of a division. Use this to ignore the remainder of a division.",[e("numerator"),e("denominator")]),RADIANS:d("This function converts the specified number from degrees to radians.",[e("value")]),RAND:d("This function returns an evenly distributed random number between 0 and 1.",[]),RANDBETWEEN:d("This function returns a random number between the numbers you specify.",[e("lower"),e("upper")]),RANK:d("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[e("number"),e("array"),e("order")]),RATE:d("This function returns the interest rate per period of an annuity.",[e("nper"),e("pmt"),e("pval"),e("fval"),e("type"),e("guess")]),RECEIVED:d("This function returns the amount received at maturity for a fully invested security.",[e("settle"),e("mature"),e("invest"),e("discount"),e("basis")]),REPLACE:d("This function replaces part of a text string with a different text string, based on the number of characters you specify.",[e("old_text"),e("start_char"),e("num_chars"),e("new_text")]),REPT:d("This function repeats text a specified number of times.",[e("text"),e("number")]),RIGHT:d("This function returns the specified rightmost characters from a text value, and based on the number of characters you specify.",[e("text"),e("num_chars")]),ROMAN:d("This function converts an Arabic numeral to a Roman numeral text equivalent.",[e("number"),e("style")]),ROUND:d("This function rounds the specified value to the nearest number, using the specified number of decimal places.",[e("value"),e("places")]),ROUNDDOWN:d("This function rounds the specified number down to the nearest number, using the specified number of decimal places.",[e("value"),e("places")]),ROUNDUP:d("This function rounds the specified number up to the nearest number, using the specified number of decimal places.",[e("value"),e("places")]),ROW:d("This function returns the number of a row from a reference.",[e("reference")]),ROWS:d("This function returns the number of rows in an array.",[e("array")]),RSQ:d("This function returns the square of the Pearson product moment correlation coefficient (R-squared) through data points in known y's and known x's.",[e("array_dep"),e("array_ind")]),SEARCH:d("This function finds one text string in another text string and returns the index of the starting position of the found text.",[e("string1"),e("string2")]),SECOND:d("This function returns the seconds (0 to 59) value for a specified time.",[e("time")]),SERIESSUM:d("This function returns the sum of a power series.",[e("x"),e("n"),e("m"),e("coeff")]),SIGN:d("This function returns the sign of a number or expression.",[e("cellreference")]),SIN:d("This function returns the sine of the specified angle.",[e("angle")]),SINH:d("This function returns the hyperbolic sine of the specified number.",[e("value")]),SKEW:d("This function returns the skewness of a distribution.",[e("number1"),e("number2",!0)]),SLN:d("This function returns the straight-line depreciation of an asset for one period.",[e("cost"),e("salvage"),e("life")]),SLOPE:d("This function calculates the slope of a linear regression.",[e("array_dep"),e("array_ind")]),SMALL:d("This function returns the nth smallest value in a data set, where n is specified.",[e("array"),e("n")]),SQRT:d("This function returns the positive square root of the specified number.",[e("value")]),SQRTPI:d("This function returns the positive square root of a multiple of pi (p).",[e("multiple")]),STANDARDIZE:d("This function returns a normalized value from a distribution characterized by mean and standard deviation.",[e("x"),e("mean"),e("stdev")]),STDEVA:d("This function returns the standard deviation for a set of numbers, text, or logical values.",[e("value1"),e("value2",!0)]),STDEVP:d("This function returns the standard deviation for an entire specified population (of numeric values).",[e("value1"),e("value2",!0)]),STDEVPA:d("This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",[e("value1"),e("value2",!0)]),STEYX:d("This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",[e("array_dep"),e("array_ind")]),SUBSTITUTE:d("This function substitutes a new string for specified characters in an existing string.",[e("text"),e("old_piece"),e("new_piece"),e("instance")]),SUBTOTAL:d("This function calculates a subtotal of a list of numbers using a specified built-in function.",[e("functioncode"),e("value1"),e("value2",!0)]),SUM:d("This function returns the sum of cells or range of cells.",[e("value1"),e("value2",!0)]),SUMIF:d("This function adds the cells using a given criteria.",[e("array"),e("condition"),e("sumrange")]),SUMIFS:d("This function adds the cells in a range using multiple criteria.",[e("array"),e("conditionarray"),e("condition",!0)]),SUMPRODUCT:d("This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",[e("array1"),e("array2",!0)]),SUMSQ:d("This function returns the sum of the squares of the arguments.",[e("value1"),e("value2",!0)]),SUMX2MY2:d("This function returns the sum of the difference of the squares of corresponding values in two arrays.",[e("array_x"),e("array_y")]),SUMX2PY2:d("This function returns the sum of the sum of squares of corresponding values in two arrays.",[e("array_x"),e("array_y")]),SUMXMY2:d("This function returns the sum of the square of the differences of corresponding values in two arrays.",[e("array_x"),e("array_y")]),SYD:d("This function returns the sum-of-years' digits depreciation of an asset for a specified period.",[e("cost"),e("salvage"),e("life"),e("period")]),T:d("This function returns the text in a specified cell.",[e("value")]),TAN:d("This function returns the tangent of the specified angle.",[e("angle")]),TANH:d("This function returns the hyperbolic tangent of the specified number.",[e("value")]),TBILLEQ:d("This function returns the equivalent yield for a Treasury bill (or T-bill)",[e("settle"),e("mature"),e("discount")]),TBILLPRICE:d("This function returns the price per $100 face value for a Treasury bill (or T-bill).",[e("settle"),e("mature"),e("discount")]),TBILLYIELD:d("This function returns the yield for a Treasury bill (or T-bill).",[e("settle"),e("mature"),e("priceper")]),TDIST:d("This function returns the probability for the t-distribution.",[e("x"),e("deg"),e("tails")]),TEXT:d("This function formats a number and converts it to text.",[e("value"),e("text")]),TIME:d("This function returns the TimeSpan object for a specified time.",[e("hour"),e("minutes"),e("seconds")]),TIMEVALUE:d("This function returns the TimeSpan object of the time represented by a text string.",[e("time_string")]),TINV:d("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[e("prog"),e("deg")]),TODAY:d("This function returns the date and time of the current date.",[]),TRANSPOSE:d("This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",[e("array")]),TREND:d("This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",[e("y"),e("x"),e("newx"),e("constant")]),TRIM:d("This function removes extra spaces from a string and leaves single spaces between words.",[e("text")]),TRIMMEAN:d("This function returns the mean of a subset of data excluding the top and bottom data.",[e("array"),e("percent")]),TRUE:d("This function returns the value for logical TRUE.",[]),TRUNC:d("This function removes the specified fractional part of the specified number.",[e("value"),e("precision")]),TTEST:d("This function returns the probability associated with a t-test.",[e("array1"),e("array2"),e("tails"),e("type")]),TYPE:d("This function returns the type of value.",[e("value")]),UPPER:d("This function converts text to uppercase letters.",[e("string")]),VALUE:d("This function converts a text string that is a number to a numeric value.",[e("text")]),VAR:d("This function returns the variance based on a sample of a population, which uses only numeric values.",[e("value1"),e("value2",!0)]),VARA:d("This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",[e("value1"),e("value2",!0)]),VARP:d("This function returns variance based on the entire population, which uses only numeric values.",[e("value1"),e("value2",!0)]),VARPA:d("This function returns variance based on the entire population, which includes numeric, logical, or text values.",[e("value1"),e("value2",!0)]),VDB:d("This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",[e("cost"),e("salvage"),e("life"),e("start"),e("end"),e("factor"),e("switchnot")]),VLOOKUP:d("This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",[e("value"),e("array"),e("colindex"),e("approx")]),WEEKDAY:d("This function returns the number corresponding to the day of the week for a specified date.",[e("date"),e("type")]),WEEKNUM:d("This function returns a number that indicates the week of the year numerically.",[e("date"),e("weektype")]),WEIBULL:d("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[e("x"),e("alpha"),e("beta"),e("cumulative")]),WORKDAY:d("This function returns the number of working days before or after the starting date.",[e("startdate"),e("numdays"),e("holidays")]),XIRR:d("This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",[e("values"),e("dates"),e("guess")]),XNPV:d("This function calculates the net present value for a schedule of cash flows that may not be periodic.",[e("rate"),e("values"),e("dates")]),YEAR:d("This function returns the year as an integer for a specified date.",[e("date")]),YEARFRAC:d("This function returns the fraction of the year represented by the number of whole days between the start and end dates.",[e("startdate"),e("enddate"),e("basis")]),YIELD:d("This function calculates the yield on a security that pays periodic interest.",[e("settle"),e("maturity"),e("rate"),e("price"),e("redeem"),e("frequency"),e("basis")]),YIELDDISC:d("This function calculates the annual yield for a discounted security.",[e("settle"),e("maturity"),e("price"),e("redeem"),e("basis")]),YIELDMAT:d("This function calculates the annual yield of a security that pays interest at maturity.",[e("settle"),e("maturity"),e("issue"),e("issrate"),e("price"),e("basis")]),ZTEST:d("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[e("array"),e("x"),e("sigma")]),HBARSPARKLINE:d("This function returns a data set used for representing a Hbar sparkline",[e("value"),e("colorScheme")]),VBARSPARKLINE:d("This function returns a data set used for representing a Vbar sparkline",[e("value"),e("colorScheme")]),VARISPARKLINE:d("This function returns a data set used for representing a variance sparkline",[e("variance"),e("reference"),e("mini"),e("maxi"),e("mark"),e("tickunit"),e("legend"),e("colorPositive"),e("colorNegative"),e("vertical")]),PIESPARKLINE:d("This function returns a data set used for representing a pie sparkline",[e("range|percentage"),e("color",!0)]),AREASPARKLINE:d("This function returns a data set used for representing a area sparkline",[e("points"),e("mini"),e("maxi"),e("line1"),e("line2"),e("colorPositive"),e("colorNegative")]),SCATTERSPARKLINE:d("This function returns a data set used for representing a scatter sparkline",[e("points1"),e("points2"),e("minX"),e("maxX"),e("minY"),e("maxY"),e("hLine"),e("vLine"),e("xMinZone"),e("xMaxZone"),e("yMinZone"),e("yMaxZone"),e("tags"),e("drawSymbol"),e("drawLines"),e("color1"),e("color2"),e("dash")]),LINESPARKLINE:d("This function returns a data set used for representing a line sparkline",[e("data"),e("dataOrientation"),e("dateAxisData"),e("dateAxisOrientation"),e("setting")]),COLUMNSPARKLINE:d("This function returns a data set used for representing a column sparkline",[e("data"),e("dataOrientation"),e("dateAxisData"),e("dateAxisOrientation"),e("setting")]),WINLOSSSPARKLINE:d("This function returns a data set used for representing a win/loss sparkline",[e("data"),e("dataOrientation"),e("dateAxisData"),e("dateAxisOrientation"),e("setting")]),BULLETSPARKLINE:d("This function returns a data set used for representing a bullet sparkline",[e("measure"),e("target"),e("maxi"),e("good"),e("bad"),e("forecast"),e("tickunit"),e("colorScheme"),e("vertical")]),SPREADSPARKLINE:d("This function returns a data set used for representing a spread sparkline",[e("points"),e("showAverage"),e("scaleStart"),e("scaleEnd"),e("style"),e("colorScheme"),e("vertical")]),STACKEDSPARKLINE:d("This function returns a data set used for representing a stacked sparkline",[e("points"),e("colorRange"),e("labelRange"),e("maximum"),e("targetRed"),e("targetGreen"),e("targetBlue"),e("tragetYellow"),e("color"),e("highlightPosition"),e("vertical"),e("textOrientation"),e("textSize")]),BOXPLOTSPARKLINE:d("This function returns a data set used for representing a boxplot sparkline",[e("points"),e("boxPlotClass"),e("showAverage"),e("scaleStart"),e("scaleEnd"),e("acceptableStart"),e("acceptableEnd"),e("colorScheme"),e("style"),e("vertical")]),CASCADESPARKLINE:d("This function returns a data set used for representing a cascade sparkline",[e("pointsRange"),e("pointIndex"),e("labelsRange"),e("minimum"),e("maximum"),e("colorPositive"),e("colorNegative"),e("vertical")]),PARETOSPARKLINE:d("This function returns a data set used for representing a pareto sparkline",[e("points"),e("pointIndex"),e("colorRange"),e("target"),e("target2"),e("highlightPosition"),e("label"),e("vertical")]),MONTHSPARKLINE:d("This function returns a data set used for representing a month sparkline",[e("year"),e("month"),e("dataRange"),e("emptyColor"),e("startColor"),e("middleColor"),e("endColor")]),YEARSPARKLINE:d("This function returns a data set used for representing a year sparkline",[e("year"),e("dataRange"),e("emptyColor"),e("startColor"),e("middleColor"),e("endColor")]),"CEILING.PRECISE":d("This function rounds a number up to the nearest integer or to the nearest multiple of a specified value.",[e("number"),e("signif")]),"COVARIANCE.S":d("This function returns the sample covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[e("array1"),e("array2")]),"FLOOR.PRECISE":d("This function rounds a number down to the nearest integer or to the nearest multiple of a specified value.",[e("number"),e("signif")]),"PERCENTILE.EXC":d("This function returns the nth percentile of values in a range.",[e("array"),e("n")]),"QUARTILE.EXC":d("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[e("array"),e("quart")]),"RANK.AVG":d("This function returns the rank of a number in a set of numbers. If some values have the same rank, it will return the average rank.",[e("number"),e("array"),e("order")]),"MODE.MULT":d("This function returns the most frequently occurring vertical array or the most frequently occurring value in a set of data.",[e("number1"),e("number2",!0)]),"STDEV.P":d("This function returns the standard deviation for an entire specified population (of numeric values).",[e("value1"),e("value2",!0)]),"VAR.P":d("This function returns variance based on the entire population, which uses only numeric values.",[e("value1"),e("value2",!0)]),"COVARIANCE.P":d("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[e("array1"),e("array2")]),"MODE.SNGL":d("This function returns the most frequently occurring value in a set of data.",[e("value1"),e("value2",!0)]),"PERCENTILE.INC":d("This function returns the nth percentile of values in a range.",[e("array"),e("n")]),"QUARTILE.INC":d("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[e("array"),e("quart")]),"RANK.EQ":d("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[e("number"),e("array"),e("order")]),STDEV:d("This function returns standard deviation is estimated based on a sample.",[e("number1"),e("number2",!0)]),"STDEV.S":d("This function returns standard deviation is estimated based on a sample.",[e("number1"),e("number2",!0)]),"VAR.S":d("This function returns the variance based on a sample of a population, which uses only numeric values.",[e("value1"),e("value2",!0)]),"BETA.INV":d("This function calculates the inverse of the cumulative beta distribution function.",[e("prob"),e("alpha"),e("beta"),e("lower"),e("upper")]),"BINOM.DIST":d("This function calculates the individual term binomial distribution probability.",[e("x"),e("n"),e("p"),e("cumulative")]),"BINOM.INV":d("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[e("n"),e("p"),e("alpha")]),"CHISQ.DIST.RT":d("This function calculates the one-tailed probability of the chi-squared distribution.",[e("value"),e("deg")]),"CHISQ.INV.RT":d("This function calculates the inverse of the one-tailed probability of the chi-squared distribution.",[e("prob"),e("deg")]),"CHISQ.TEST":d("This function calculates the test for independence from the chi-squared distribution.",[e("obs_array"),e("exp_array")]),"CONFIDENCE.NORM":d("This function returns confidence interval for a population mean.",[e("alpha"),e("stdev"),e("size")]),"EXPON.DIST":d("This function returns the exponential distribution or the probability density.",[e("value"),e("lambda"),e("cumulative")]),"F.DIST.RT":d("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[e("value"),e("degnum"),e("degden")]),"F.INV.RT":d("This function returns the inverse of the F probability distribution.",[e("p"),e("degnum"),e("degden")]),"F.TEST":d("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[e("array1"),e("array2")]),"GAMMA.DIST":d("This function returns the gamma distribution.",[e("x"),e("alpha"),e("beta"),e("cumulative")]),"GAMMA.INV":d("This function returns the inverse of the gamma cumulative distribution.",[e("p"),e("alpha"),e("beta")]),"LOGNORM.INV":d("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[e("prob"),e("mean"),e("stdev")]),"NORM.DIST":d("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[e("x"),e("mean"),e("stdev"),e("cumulative")]),"NORM.INV":d("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[e("prob"),e("mean"),e("stdev")]),"NORM.S.INV":d("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[e("prob")]),"PERCENTRANK.INC":d("This function returns the rank of a value in a data set as a percentage of the data set.",[e("array"),e("n"),e("signif")]),"POISSON.DIST":d("This function returns the Poisson distribution.",[e("nevents"),e("mean"),e("cumulative")]),"T.INV.2T":d("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[e("prog"),e("deg")]),"T.TEST":d("This function returns the probability associated with a t-test.",[e("array1"),e("array2"),e("tails"),e("type")]),"WEIBULL.DIST":d("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[e("x"),e("alpha"),e("beta"),e("cumulative")]),"Z.TEST":d("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[e("array"),e("x"),e("sigma")]),"T.DIST.RT":d("This function returns the right-tailed t-distribution.",[e("x"),e("deg")]),"T.DIST.2T":d("This function returns the two-tailed t-distribution.",[e("x"),e("deg")]),"ISO.CEILING":d("This function returns a number up to the nearest integer or to the nearest multiple of significance, regardless of sign of significance.",[e("number"),e("signif")]),"BETA.DIST":d("This function returns the beta distribution.",[e("x"),e("alpha"),e("beta"),e("cumulative"),e("lower"),e("upper")]),"GAMMALN.PRECISE":d("This function returns the natural logarithm of the gamma function.",[e("value")]),"ERF.PRECISE":d("This function returns the error function.",[e("lowerlimit")]),"ERFC.PRECISE":d("This function returns the complementary ERF function.",[e("lowerlimit")]),"PERCENTRANK.EXC":d("This function returns the percentage rank(0..1, exclusive) of a value in a data set.",[e("array"),e("n"),e("signif")]),"HYPGEOM.DIST":d("This function returns the hypergeometric distribution.",[e("x"),e("n"),e("M"),e("N"),e("cumulative")]),"LOGNORM.DIST":d("This function returns the log normal distribution of x.",[e("x"),e("mean"),e("stdev"),e("cumulative")]),"NEGBINOM.DIST":d("This function returns the negative binomial distribution.",[e("x"),e("r"),e("p"),e("cumulative")]),"NORM.S.DIST":d("This function returns the standard normal distribution.",[e("z"),e("cumulative")]),"T.DIST":d("This function returns the t-distribution.",[e("x"),e("deg"),e("cumulative")]),"F.DIST":d("This function returns the F probability distribution.",[e("x"),e("degnum"),e("degden"),e("cumulative")]),"CHISQ.DIST":d("This function returns the chi-squared distribution.",[e("x"),e("deg"),e("cumulative")]),"F.INV":d("This function returns the inverse of the F probability distribution.",[e("probability"),e("degnum"),e("degden")]),"T.INV":d("This function returns the left-tailed inverse of the t-distribution.",[e("probability"),e("deg")]),"CHISQ.INV":d("This function returns the inverse of left-tailed probability of the chi-squared distribution.",[e("probability"),e("deg")]),"CONFIDENCE.T":d("This function returns the confidence interval for a Student's t distribution.",[e("alpha"),e("stdev"),e("size")]),"NETWORKDAYS.INTL":d("This function returns the number of workdays between two dates using arguments to indicate holidays and weekend days.",[e("startdate"),e("enddate"),e("weekend"),e("holidays")]),"WORKDAY.INTL":d("This function returns the serial number of the date before or after a number of workdays with custom weekend parameters. These parameters indicate weekend days and holidays.",[e("startdate"),e("numdays"),e("weekend"),e("holidays")]),REFRESH:d("This function decides how to re-calculate the formula. Can use the evaluateMode argument to specific the formula re-calculate on the reference value changed, evaluate once , re-calculate or interval.",[e("formula"),e("evaluateMode"),e("interval")]),DAYS:d("This function returns the number of days between two dates.",[e("startdate"),e("enddate")]),ISOWEEKNUM:d("This function returns the number of the ISO week number of the year for a given date.",[e("date")]),BITAND:d('This function returns a bitwise "AND" of two numbers.',[e("number1"),e("number2")]),BITLSHIFT:d('This function returns a bitwise "OR" of two numbers.',[e("number1"),e("number2")]),BITOR:d('This function returns a bitwise "OR" of two numbers.',[e("number1"),e("number2")]),BITRSHIFT:d('This function returns a bitwise "OR" of two numbers.',[e("number1"),e("number2")]),BITXOR:d('This function returns a bitwise "XOR" of two numbers.',[e("number1"),e("number2")]),IMCOSH:d("This function returns the hyperbolic cosine of a complex number in x+yi or x+yj text format.",[e("complexnum")]),IMCOT:d("This function returns the cotangent of a complex number in x+yi or x+yj text format.",[e("complexnum")]),IMCSC:d("This function returns the cosecant of a complex number in x+yi or x+yj text format.",[e("complexnum")]),IMCSCH:d("This function returns the hyperbolic cosecant of a complex number in x+yi or x+yj text format.",[e("complexnum")]),IMSEC:d("This function returns the secant of a complex number in x+yi of x+yj text format.",[e("complexnum")]),IMSECH:d("This function returns the hyperbolic secant of a complex number in x+yi or x+yj text format.",[e("complexnum")]),IMSINH:d("This function returns the hyperbolic sine of a complex number in x+yi of x+yj text format.",[e("complexnum")]),IMTAN:d("This function returns the tangent of a complex number in x+yi or x+yj text format.",[e("complexnum")]),PDURATION:d("This function returns the number of periods required by an investment to reach a specified value.",[e("rate"),e("pval"),e("fval")]),RRI:d("This function returns an equivalent interest rate for the growth of an investment.",[e("nper"),e("pval"),e("fval")]),ISFORMULA:d("This function tests whether contains a formula of a referenced cell.",[e("cellreference")]),IFNA:d("This function returns the value you specify if the formula returns the #N/A error value, otherwise returns the result of the formula.",[e("value"),e("value_if_na")]),IFS:d("This function checks whether one or more conditions are met and returns a value that corresponds to the first TRUE condition.",[e("valueTest1"),e("valueTrue1",!0)]),SWITCH:d("This function evaluates one value for a list of values, and returns the result corresponding to the first matching value, otherwise returns the default value",[e("convertvalue"),e("matchvalue"),e("matchtrue"),e("matchfalse")]),XOR:d("This function returns a logical exclusive or of all arguments.",[e("logical",!0)]),AREAS:d("This function returns the number of areas in a reference.",[e("reference")]),FORMULATEXT:d("This function returns a formula as a string.",[e("reference")]),HYPERLINK:d("This function creates a shortcut or jump that opens a document stored on a network server, an intranet, or the Internet.",[e("link_location"),e("friendly_name")]),ACOT:d("This function calculates the inverse arccotangent of a number.",[e("value")]),ACOTH:d("This function calculates the inverse hyperbolic arccotangent of a number.",[e("value")]),ARABIC:d("This function converts a Roman numeral text to an Arabic numeral equivalent.",[e("text")]),BASE:d("This function converts a number into a text representation with the given radix (base).",[e("number"),e("radix"),e("minLength")]),"CEILING.MATH":d("This function round  a number up to the nearest integer or to the nearest multiple of significance.",[e("value"),e("signif"),e("mode")]),COMBINA:d("This function calculates the number of possible combinations with repetitions for a specified number of items.",[e("number"),e("number_choosen")]),COT:d("This function returns the cotangent of the specified angle.",[e("angle")]),COTH:d("This function returns the hyperbolic cotangent of the specified number.",[e("value")]),CSC:d("This function returns the cosecant of the specified angle.",[e("angle")]),CSCH:d("This function returns the hyperbolic cosecant of the specified number.",[e("value")]),DECIMAL:d("This function converts a text representation of a number in a given base into a decimal number.",[e("text"),e("radix")]),"FLOOR.MATH":d("This function round a number down to the nearest integer or to the nearest multiple of significance.",[e("value"),e("signif"),e("mode")]),SEC:d("This function returns the secant of the specified angle.",[e("angle")]),SECH:d("This function returns the hyperbolic secant of the specified value.",[e("value")]),"BINOM.DIST.RANGE":d("This function calculates the probability of a trial result using a binomial distribution.",[e("x"),e("n"),e("p"),e("cumulative")]),GAMMA:d("This function returns the gamma function value.",[e("number")]),MAXIFS:d("This function returns the maximum value among cells specified by a given set of conditions or criteria.",[e("array"),e("conditionarray"),e("condition",!0)]),GAUSS:d("This function calculates the probability that a member of a standard normal population will fall between the mean and z standard deviations from the mean.",[e("number")]),MINIFS:d("This function returns the minimum value among cells specified by a given set of conditions or criteria.",[e("array"),e("conditionarray"),e("condition",!0)]),PERMUTATIONA:d("This function returns the number of permutations for a given number of object that can be selected from the total objects.",[e("k"),e("n")]),PHI:d("This function returns the value of the density function for a standard normal distribution.",[e("value")]),"SKEW.P":d("This function returns the skewness of a distribution base on a poopulation: a characterization of the degree of asymmetry of a distribution around its mean.",[e("number1"),e("number2",!0)]),BAHTTEXT:d('This function converts a number to Thai text and adds a suffix of "Baht"',[e("number")]),CONCAT:d('This function combines multiple text strings or numbers into one text string, the function will stay available for compatibility with "CONCATENATE" function.',[e("text1"),e("text2",!0)]),FINDB:d("This function finds one text value within another and returns the text value's position in the text you searched, and counts each double-byte characte as 2 when set DBCS as the default language.",[e("findtext"),e("intext"),e("start")]),LEFTB:d("This function returns the specified leftmost characters from a text value, and based on the number of bytes you specify.",[e("mytext"),e("num_bytes")]),LENB:d("This function returns the length of the number of bytes in a text string.",[e("value")]),MIDB:d("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of bytes you specify.",[e("text"),e("start_num"),e("num_bytes")]),REPLACEB:d("This function replaces part of a text string with a different text string, based on the number of bytes you specify.",[e("old_text"),e("start_byte"),e("num_bytes"),e("new_text")]),RIGHTB:d("This function returns the specified rightmost characters from a text value, and based on the number of bytes you specify.",[e("text"),e("num_bytes")]),SEARCHB:d("This function finds one text string in another text string and returns the index of the starting position of the found text, and counts each double-byte characte as 2 when set DBCS as the default language.",[e("string1"),e("string2")]),TEXTJOIN:d("This function combines multiple ranges and/or strings into one text, and the text includes a delimiter you specify between each text value.",[e("delimiter"),e("ignore_empty"),e("text1"),e("text2",!0)]),UNICHAR:d("This function returns the Unicode character of a given numeric reference.",[e("number")]),UNICODE:d("This function returns the number corresponding to the first character of the text.",[e("text")]),ENCODEURL:d("This function returns a URL-encoded string.",[e("text")]),BC_QRCODE:d("This function returns a data set for representing a QRCode",[e("value"),e("color"),e("backgroundColor"),e("errorCorrectionLevel"),e("model"),e("version"),e("mask"),e("connection"),e("connectionNo"),e("charCode"),e("charset"),e("quietZoneLeft"),e("quietZoneRight"),e("quietZoneTop"),e("quietZoneBottom")]),BC_EAN13:d("This function returns a data set for representing a EAN13.",[e("value"),e("color"),e("backgroundColor"),e("showLabel"),e("labelPosition"),e("addOn"),e("addOnLabelPosition"),e("fontFamily"),e("fontStyle"),e("fontWeight"),e("textDecoration"),e("textAlign"),e("fontSize"),e("quietZoneLeft"),e("quietZoneRight"),e("quietZoneTop"),e("quietZoneBottom")]),
BC_EAN8:d("This function returns a data set for representing a EAN8.",[e("value"),e("color"),e("backgroundColor"),e("showLabel"),e("labelPosition"),e("fontFamily"),e("fontStyle"),e("fontWeight"),e("textDecoration"),e("textAlign"),e("fontSize"),e("quietZoneLeft"),e("quietZoneRight"),e("quietZoneTop"),e("quietZoneBottom")]),BC_CODABAR:d("This function returns a data set for representing a CODABAR.",[e("value"),e("color"),e("backgroundColor"),e("showLabel"),e("labelPosition"),e("checkDigit"),e("nwRatio"),e("fontFamily"),e("fontStyle"),e("fontWeight"),e("textDecoration"),e("textAlign"),e("fontSize"),e("quietZoneLeft"),e("quietZoneRight"),e("quietZoneTop"),e("quietZoneBottom")]),BC_CODE39:d("This function returns a data set for representing a CODE39.",[e("value"),e("color"),e("backgroundColor"),e("showLabel"),e("labelPosition"),e("labelWithStartAndStopCharacter"),e("checkDigit"),e("nwRatio"),e("fullASCII"),e("fontFamily"),e("fontStyle"),e("fontWeight"),e("textDecoration"),e("textAlign"),e("fontSize"),e("quietZoneLeft"),e("quietZoneRight"),e("quietZoneTop"),e("quietZoneBottom")]),BC_CODE93:d("This function returns a data set for representing a CODE93.",[e("value"),e("color"),e("backgroundColor"),e("showLabel"),e("labelPosition"),e("checkDigit"),e("fullASCII"),e("fontFamily"),e("fontStyle"),e("fontWeight"),e("textDecoration"),e("textAlign"),e("fontSize"),e("quietZoneLeft"),e("quietZoneRight"),e("quietZoneTop"),e("quietZoneBottom")]),BC_CODE128:d("This function returns a data set for representing a CODE128.",[e("value"),e("color"),e("backgroundColor"),e("showLabel"),e("labelPosition"),e("codeSet"),e("fontFamily"),e("fontStyle"),e("fontWeight"),e("textDecoration"),e("textAlign"),e("fontSize"),e("quietZoneLeft"),e("quietZoneRight"),e("quietZoneTop"),e("quietZoneBottom")]),BC_GS1_128:d("This function returns a data set for representing a GS1_128.",[e("value"),e("color"),e("backgroundColor"),e("showLabel"),e("labelPosition"),e("fontFamily"),e("fontStyle"),e("fontWeight"),e("textDecoration"),e("textAlign"),e("fontSize"),e("quietZoneLeft"),e("quietZoneRight"),e("quietZoneTop"),e("quietZoneBottom")]),BC_CODE49:d("This function returns a data set for representing a CODE49.",[e("value"),e("color"),e("backgroundColor"),e("showLabel"),e("labelPosition"),e("grouping"),e("groupNo"),e("fontFamily"),e("fontStyle"),e("fontWeight"),e("textDecoration"),e("textAlign"),e("fontSize"),e("quietZoneLeft"),e("quietZoneRight"),e("quietZoneTop"),e("quietZoneBottom")]),BC_PDF417:d("This function returns a data set for representing a PDF417.",[e("value"),e("color"),e("backgroundColor"),e("errorCorrectionLevel"),e("rows"),e("columns"),e("compact"),e("quietZoneLeft"),e("quietZoneRight"),e("quietZoneTop"),e("quietZoneBottom")]),BC_DATAMATRIX:d("This function returns a data set for representing a DATAMATRIX.",[e("value"),e("color"),e("backgroundColor"),e("eccMode"),e("ecc200SymbolSize"),e("ecc200EncodingMode"),e("ecc00_140SymbolSize"),e("structuredAppend"),e("structureNumber"),e("fileIdentifier"),e("quietZoneLeft"),e("quietZoneRight"),e("quietZoneTop"),e("quietZoneBottom")]),FILTER:d("This function filter a range or array.",[e("array"),e("include"),e("if_empty")]),RANDARRAY:d("This function returns an array of random numbers.",[e("rows"),e("columns"),e("min"),e("max"),e("whole_number")]),SEQUENCE:d("This function returns a sequence of numbers.",[e("rows"),e("columns"),e("start"),e("step")]),SINGLE:d("This function returns a single value when given a value, range or array.",[e("value")]),SORT:d("This function sorts a range or array.",[e("array"),e("sort_index"),e("sort_order"),e("by_col")]),SORTBY:d("This function sorts a range or array based on the values in a corresponding range or array.",[e("array"),e("by_array1"),e("sort_order1"),e("by_array2"),e("sort_order2"),e("...")]),UNIQUE:d("This function returns the unique values from a range or array.",[e("array"),e("by_col"),e("occurs_once")])},Fbx_Summary:"Summary",Fbx_TableName_Description:"Table name for ",Fbx_CustomName_Description:"Custom name for ",B2:{All:{name:"#All",description:"Returns the entire contents of the table, or specified table columns including column headers, data and total rows."},Data:{name:"#Data",description:"Returns the data cells of the table or specified table columns."},Headers:{name:"#Headers",description:"Returns the columns headers for the table, or specified table columns."},Totals:{name:"#Totals",description:"Returns the total rows for the table or specified table columns."},thisRow:{name:"#This Row",description:"This row."}}}},"./src/evaluator.ts":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Common"),e=c("./src/calc.common.ts"),f=c("./src/calc.common.ts"),g=d.Common.j.Fa,h=null,i=void 0,j=Math.pow,k=Math.min,l=Math.max,m="string",n="boolean",o=e.Convert.Th,p=e.Convert.vf,q=e.Convert.Ph,r=e.Convert.Ca,s=e.Convert.Fh,t=e.Errors.Reference,u=e.Errors.Value,v=e.Errors.Name,w=e.Errors.NotAvailable,x=e.Errors.DivideByZero,y=e.Errors.Number;function L(a,b,c,d){return{row:a,col:b,rowCount:c,colCount:d}}z=function(){function a(a,b,c,d){var e,f,g=[];for(e=4;e<arguments.length;e++)g[e-4]=arguments[e];this.si=0,this.ti=0,this.ui=0,f=this,f.source=a,f.arrayFormulaMode=!!c,f.identity=b||f.$Ab(0,0),f.arrayIdentity=d,f.row=d?d.row:f.identity.row||0,f.column=d?d.col:f.identity.col||0,f.rowOffset=d?f.identity.row-d.row:f.row,f.columnOffset=d?f.identity.col-d.col:f.column}return a.prototype.$Ab=function(a,b){return{row:a,col:b}},a.prototype.fga=function(a){return a===e.BangSource?this.source:a},a.prototype.getValue=function(a,b){return a?this.fga(a).getValue(b):t},a.prototype.getReference=function(a,b){return a?this.fga(a).getReference(b):t},a.prototype.getSheetRangeReference=function(a){return a&&a.source&&a.endSource?this.fga(a.source).getSheetRangeReference(a):t},a.prototype.getFunction=function(a){var b=this;return b.source?b.source.getCustomFunction(a):h},a.prototype.getName=function(a){var b,c=this,d=c.source?c.source.getCustomName(a):h;return!d&&c.source&&(b=c.source.Cf().getGlobalSourceModel(),d=b&&b.getSource().getCustomName(a)),d},a.prototype.vi=function(){return this.ui>0},a.prototype.wi=function(){this.ui++},a.prototype.xi=function(){this.ui--},a.prototype.SetAsyncResult=function(a,b){this.source.Cf().lh.SetAsyncResult(a,b)},a.prototype.cloneFrom=function(a){var b=this;b.acceptsReference=a.acceptsReference,b.arrayFormulaMode=a.arrayFormulaMode},a}(),b.EvaluateContext=z,e.CalcSource.prototype.getEvaluatorContext=function(a,b,c){return new z(this,a,b,c)},A=function(){function a(a,b){this.id=a.si++,this.ctx=a,this.row=a.row+(a.arrayFormulaMode&&a.rowOffset||0),this.col=a.column+(a.arrayFormulaMode&&a.columnOffset||0),this.node=b}return a.prototype.setAsyncResult=function(a){this.node.Fi=a,this.node.v5=!0,this.ctx.SetAsyncResult(this,a),this.ctx.source.refresh()},a.prototype.getFormula=function(){return this.ctx.source.getCalcService().unparse(this.ctx.source,this.expression,this.row,this.col)},a}(),b.AsyncEvaluateContext=A,B=function(a){K(b,a);function b(b,c,d,e,f,g,i,j){var k=a.call(this,b,isNaN(j)?h:{row:i,col:j},c,isNaN(g)?h:{row:d,col:e,rowCount:f,colCount:g})||this,l=b.Cf().getGlobalSourceModel(b);return k.yi=l&&l.getSource(),k}return b.prototype.getName=function(a){var b=this;return b.yi?b.yi.getCustomName(a):h},b}(z),b.GloableEvaluateContext=B;function M(a,b){return a&&b?a.row===b.row&&a.col===b.col:a===b}C=function(){function a(a){this.service=a,this.asyncManager=new E(this)}return a.prototype.evaluateExpression=function(a,b,c,e,f){var g,j,k=void 0===a.type&&a.Lf?a.Lf:a,l=this.evaluate(k,b,!!e,!!f);return l===i||l===h?c===!1?l:0:((r(l)&&!e||s(l)&&!f)&&(l=this.getOneValue(b,l)),g=15,"number"==typeof l&&l>-10&&l<10&&(j=""+l,(j.indexOf("000000000000")>1||j.indexOf("999999999999")>1)&&(g=14)),d.Common.o.Lma(l,g))},a.prototype.evaluate=function(a,b,c,d){var f,g,j,k;if(!a)throw e.sR().Exp_ExprIsNull;if(void 0===a.type){if(a._error)return a;a.Lf&&(a=a.Lf)}for(;10===a.type;)a=a.value;if(f=this,j=h,12===a.type?(j=a.needExpendIndexs,a=a.value):b.Exb&&(c=!0,j=[]),k=a.type,k>=2&&k<=6)g=f.evaluateConst(a,b,c);else if(1===k||13===k||33===k)g=f.evaluateReference(a,b,d,c);else if(8===k)g=f.evaluateName(a,b,c,d);else if(9!==k||a.value2){if(9===k)g=f.evaluateBinaryOperation(a,b,c,d,j);else if(7===k)g=f.evaluateFunction(a,b,c,d,j);else if(11===k)g=i;else if(b.evaluate)return b.evaluate(a,c,d)}else g=f.evaluateUnaryOperation(a,b,c,d,j);return g},a.prototype.evaluateConst=function(a,b,c){var d=a.value;return r(d)?c||b&&(b.arrayFormulaMode||b.vi())?d:d.getValue(0,0):d},a.prototype.evaluateReference=function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,p,q,r,s;if(!b)return u;if(f=a.source||b.source,g=isNaN(b.row)?0:b.row,h=isNaN(b.column)?0:b.column,i=a.getRange&&a.getRange(g,h),j=a.type,!i)return 13===j?u:t;if(33===j&&i.isSpillError)return e.Errors.Spill;if(k=i.row<0?0:i.row,l=i.col<0?0:i.col,m=i.rowCount,n=i.colCount,c||b.arrayFormulaMode)return a.endSource?b.getSheetRangeReference({source:a.source,endSource:a.endSource,row:k,col:l,rowCount:m,colCount:n}):b.getReference(f,i);if(d&&(m>1||n>1)){for(o=[],p=0;p<m;p++)for(o[p]=[],q=0;q<n;q++)o[p][q]=f.getValue(p+k,q+l);return new e.CalcArray(o)}if(m>1||n>1)if(r=g>=i.row&&g<i.row+m,s=h>=i.col&&h<i.col+n,r&&s)k=g,l=h;else{if(!r&&!s)return u;if(r&&1===n)k=g;else{if(!s||1!==m)return u;l=h}}else if(i.row===-1&&m===-1){if(1!==n)return u;k=g}else if(i.col===-1&&n===-1){if(1!==m)return u;l=h}return f.getValue(k,l)},a.prototype.evaluateName=function(a,b,c,d){var e,f;return b?(a.source&&(e=a.source,b=e.getEvaluatorContext(b.identity,b.arrayFormulaMode,b.arrayIdentity)),f=b.getName(a.value),f?this.evaluate(f,b,c,d):v):v},a.prototype.evaluateUnaryOperation=function(a,b,c,d,f){var g,h=!1;return f&&f.length>0&&(c=!0,h=!0),g=this.evaluate(a.value,b,c,h),e.Convert.vf(g)?g:g===e.missingArgument?w:this.evaluateWithArgs(a,function(c){return P(a.operatorType,c[0],b.Exb)},b,f,[g],c,d)},a.prototype.evaluateBinaryOperation=function(a,b,c,d,f){var g,h,i,j,k,l,m,n,o=b.Exb;if(o&&(c=!0),g=[c,c],h=a.operatorType>=15,i=[h,h],f&&f.length>0)for(j=0;j<f.length;j++)g[f[j]]=!0,i[f[j]]=!0;for(k=function(a,b){if(0===b){for(;10===a.type;)a=a.value;if(7===a.type&&a.function&&a.function.TAb)return null}return b},l=[a.value,a.value2],m=[],j=0;j<2;j++){if(n=k(l[j],this.evaluate(l[j],b,g[j],i[j])),e.Convert.vf(n))return n;if(n===e.missingArgument)return w;m[j]=n}return this.evaluateWithArgs(a,function(b){return P(a.operatorType,b[0],b[1])},b,f,m,c,d)},a.prototype.startCache=function(){this.Bi={},this.service.nia&&this.asyncManager.startCalc()},a.prototype.endCache=function(){this.Bi=h},a.prototype.evaluateFunction=function(a,b,c,d,f){var g,i,j,k,l,m,n,o,p,q,t,u,w,x,y,z,A,B,C,D,E,F,G;if(!a||!a.function||"string"==typeof a.function)return v;if(g=a.arguments.length,i=this,j=b.ti,k=a.function,n=h,k instanceof e.Functions.AsyncFunction&&this.asyncManager.startCalcFunction(k,a.arguments,b),0===g)l=[];else{for(l=[],p=[],q=[],t=0;t<g;t++)p[t]=k.acceptsArray(t),q[t]=k.acceptsReference(t);if(u=b.Exb,u||1!==k.arrayArgumentEvaluateMode||(u=b.Exb=!0,o=!0),f&&f.length>0||u){for(n=[],t=0;t<g;t++)n[t]=!0;for(w=u?g:f.length,t=0;t<w;t++)x=u?t:f[t],p[x]=!0,q[x]=!0,y=!(k.acceptsReference(x)&&!k.acceptsArray(x)),y&&u&&k.acceptsReference(x)&&(y=!1),n[x]=y}for(k.isBranch()&&(b.arrayFormulaMode||b.vi())&&(p[k.findTestArgument()]=!0,q[k.findTestArgument()]=!0),z=void 0,A=-1,B=-1,k.isBranch()&&(A=k.findTestArgument(),k.acceptsArray(A)&&b.wi(),z=i.evaluate(a.arguments[A],b,p[A],q[A]),k.acceptsArray(A)&&b.xi(),s(z)||r(z)||(B=k.findBranchArgument(z))),t=0;t<g;t++){if(A===t)m=z;else{if(B>=0&&t!==B){l[t]=null;continue}k.acceptsArray(t)&&b.wi(),m=i.evaluate(a.arguments[t],b,p[t],q[t]),k.acceptsArray(t)&&b.xi()}if(!k.acceptsArray(t)&&r(m)||!k.acceptsReference(t)&&s(m))if(C=r(m)?m:h,D=s(m)?m:h,C&&1===C.getRowCount()&&1===C.getColumnCount())m=C.getValue(0,0);else if(D&&1===D.getRowCount(0)&&1===D.getColumnCount(0))m=D.getValue(0,0,0);else{if(E=[],F=!1,f)for(G=0;G<f.length;G++)E.push(f[G]),f[G]===t&&(F=!0);F||(E.push(t),f=E)}if(e.Convert.vf(m)&&!k.acceptsError(t))return m;m!==e.missingArgument||k.acceptsMissingArgument(t)||(m=h),l[t]=m}}return o&&delete b.Exb,i.evaluateWithArgs(a,function(a,c,f){var g,h,l,m,n,o=Y(a,k.Ci);return a=o.Di,k.isContextSensitive()?(b.acceptsReference=d||b.vi(),k instanceof e.Functions.AsyncFunction?(i.T4=i.T4||{},k.evaluateWhenArgumentsIsSame()?i.evaluateAsyncFunction(b,c,k,j,a,f):i.evaluateWithCache(k,a,function(){return i.evaluateAsyncFunction(b,c,k,j,a,f)},i.T4)):k.evaluateWithContext(b,a)):(h=b.arrayFormulaMode,h&&(k.y0a={row:b.rowOffset,col:b.columnOffset}),l=e.getMapping()&&e.getMapping().builtInFunctionsMapping,m=l&&l[k.name]&&l[k.name].specialFun,n=function(){return o.Ei?m&&m.apply(k,a)||k.evaluate.apply(k,a):o.Fi},g=h?i.evaluateWithCache(k,a,n,i.Bi):n(),delete k.y0a,g)},b,f,l,c,d,n)},a.prototype.evaluateAsyncFunction=function(a,b,c,d,e,f){var g,h,j=this.asyncManager.getNode();if(j.v5)g=j.Fi;else if(j.canEvaluate()){if(h=new A(a,j),g=c.evaluateWithContext(h,e),h.notAsync)return g;g===i?g=j.Fi!==i?j.Fi:c.defaultValue():1===j.evaluateMode&&(j.v5=!0)}else g=j.Fi!==i?j.Fi:c.defaultValue();return j.Fi=g,f||this.asyncManager.endCalcFunction(),g},a.prototype.evaluateWithCache=function(a,b,c,d){var f,g,h,j,k,l,m,n,o,p,q,r;if(d)if(g=!1,f=d[a.name+b.length])for(h=0;h<f.length;h++){if(j=f[h],g=!1,j.args.length===b.length){for(g=!0,k=0;k<b.length;k++)if(l=j.args[k],m=b[k],l!==m){if(!(l instanceof e.CalcReference&&m instanceof e.CalcReference)){g=!1;break}if(n=l.zf,l.xf!==m.xf||n!==m.zf){g=!1;break}for(o=0;o<n;o++)if(l.getRow(o)!==m.getRow(o)||l.getColumn(o)!==m.getColumn(o)||l.getRowCount(o)!==m.getRowCount(o)||l.getColumnCount(o)!==m.getColumnCount(o)){g=!1;break}}g&&!M(j.y0a,a.y0a)&&(g=!1)}if(g)return j.flag++,j.value}else f=d[a.name+b.length]=[];if(p=c(),d&&p!==i){if(q=f.length,q>=100){for(r=[],h=0;h<q;h++)f[h].flag>0&&r.push(f[h]);r.sort(function(a,b){return b.flag-a.flag}),q=Math.min(50,r.length),f=r.slice(0,q),d[a.name+b.length]=f}f.push({args:b,value:p,flag:0,y0a:a.y0a})}return p},a.prototype.SetAsyncResult=function(a){var b,c,d=[];for(b=1;b<arguments.length;b++)d[b-1]=arguments[b];c=a.ctx,c.source.Cf().recalculate(c.source,a.row,a.col,!0)},a.prototype.evaluateWithArgs=function(a,b,c,d,f,i,j,k){var l,m,n,o,p,q,t,v,x,y,z,A,B,C,D,E,F,G=c.Exb;if(!G||d&&d.length>0||(d=[],l=7===a.type&&a.function,l&&f.forEach(function(a,b){(!l.acceptsArray(b)&&r(a)||!l.acceptsReference(b)&&s(a))&&d.push(b)})),d&&d.length>0){if(n=this.Gi(c,a,f,d,k),!n)return w;for(o=[],p=n[0].length,q=n[0][0].length,t=c.source&&c.source.Af&&c.source.Af.allowDynamicArray,v=0;v<p;v++)for(o[v]=[],x=0;x<q;x++)try{for(y=[],z=void 0,A=!1,B=0;B<f.length;B++)z=y[B]=n[B][v][x],g(z)&&(A=!0);if(m=t&&A?h:b(y,a,v+1!==p||x+1!==q),s(m)&&!G){if(7===a.type&&(l=a.function,l.returnReference&&l.returnReference()))return m;m=this.getOneValue(c,m)}o[v][x]=m}catch(a){o[v][x]=u}return new e.CalcArray(o)}try{if(m=b(f,a),c.arrayFormulaMode&&c.vi())return m;if(r(m)&&!i)return this.getOneValue(c,m);if(s(m)&&!j){if(C=m,i&&1===C.getRangeCount()){for(D=[],E=0;E<C.getRowCount(0);E++)for(D[E]=[],F=0;F<C.getColumnCount(0);F++)D[E][F]=C.getValue(0,E,F);return new e.CalcArray(D)}return this.getOneValue(c,m)}return m}catch(a){return u}},a.prototype.getOneValue=function(a,b){var c,d,e,f,g,h;return s(b)?(e=b,f=e.getRowCount(0),g=e.getColumnCount(0),e.getRangeCount()>1||!a.arrayFormulaMode&&f>1&&g>1?b=u:(a.rowOffset!==-1||a.columnOffset!==-1?(c=1===f?0:a.arrayFormulaMode?a.rowOffset:a.rowOffset-e.getRow(0),d=1===g?0:a.arrayFormulaMode?a.columnOffset:a.columnOffset-e.getColumn(0)):(c=1===f?0:a.row-e.getRow(0),d=1===g?0:a.column-e.getColumn(0)),b=c>=f||d>=g?w:e.getValue(0,c,d))):r(b)&&(h=b,!a.arrayFormulaMode||a.rowOffset===-1&&a.columnOffset===-1?b=h.getValue(0,0):(c=1===h.getRowCount()?0:a.rowOffset,d=1===h.getColumnCount()?0:a.columnOffset,b=c>=h.getRowCount()||d>=h.getColumnCount()?w:h.getValue(c,d))),s(b)||r(b)?this.getOneValue(a,b):b},a.prototype.Gi=function(a,b,c,e,f){var g,j,k,l,m,n,o,p,q,t,u,v,x,y,z,A,B,C,D=1,E=1,F=-1,G=!0,H=!0,I=1,J=1,K=7===b.type?b:h,M=K&&K.function,N=a.arrayFormulaMode;if(M&&!M.expandRows()&&(G=!1),M&&!M.expandColumns()&&(H=!1),M&&M.isBranch()&&(N||a.vi())){if(F=M.findTestArgument(),k=[],l=!1,e)for(m=0;m<e.length;m++)k.push(e[m]),e[m]===F&&(l=!0);if(l||r(c[F])||s(c[F])){for(n=0;n<K.arguments.length;n++)n!==F&&d.Common.k.Cb(k,n)<0&&(r(c[n])||s(c[n]))&&k.push(n);e=k}}for(o=[],p=0,q=e[p],t=c.length,x=[],u=0;u<t;u++)v=c[u],g=h,j=h,I=J=1,u===q?(g=r(v)?v:h,j=s(v)?v:h,(g||j)&&(I=g&&g.getRowCount()||(G?j.getRowCount(0):1),J=g&&g.getColumnCount()||(H?j.getColumnCount(0):1)),p++,q=p<e.length?e[p]:-1):f===i&&(g=r(v)?v:h,j=s(v)?v:h,(g||j)&&(I=g&&g.getRowCount()||(G?j.getRowCount(0):1),J=g&&g.getColumnCount()||(H?j.getColumnCount(0):1))),x[u]=[g,j,v,I,J],D=I>D?I:D,E=J>E?J:E;for(u=0;u<t;u++){if(y=o[u]=[],z=x[u],g=z[0],j=z[1],v=z[2],I=z[3],J=z[4],(g||j)&&(1!==I&&I!==D||1!==J&&J!==E)&&(F===-1||u===F)&&!N)return;for(A=0;A<D;A++)for(B=y[A]=[],C=0;C<E;C++)1!==I&&A>=I||1!==J&&C>=J?B[C]=w:g?B[C]=g.getValue(1===I?0:A,1===J?0:C):j?!f||f[u]?B[C]=j.getValue(0,1===I?0:A,1===J?0:C):B[C]=j.create([L(j.getRow(0)+(1===I?0:A),j.getColumn(0)+(1===J?0:C),1,1)]):B[C]=v}return o},a}(),b.Evaluator=C,D=function(){function a(a,b){this.id=a,this.Fi=i,this.v5=!1,this.oi=[],b!==i&&(this.evaluateMode=b)}return a.prototype.canEvaluate=function(){var a,b=this.oi;for(a=0;a<b.length;a++)if(!b[a].v5)return!1;return!0},a}(),b.AsyncFunctionNode=D,E=function(){function a(a){var b=this;b.w5=[],b.x5=-1,b.y5={},b.z5=-1,b.lh=a,b.vQa=0}return a.prototype.startCalc=function(){var a,b,c,d,e,f,g,h,i;if(this.vQa)for(b in this.y5)if(c=this.y5[b])for(d in c)if(e=c[d])for(f in e)if(g=e[f],g&&(a=g.length,a>0))for(h=0;h<a;h++)i=g[h],0===i.evaluateMode&&(i.v5=!1)},a.prototype.startCalcCell=function(a,b){var c,d,e,f,g=this,h=a.getName(),i=b.row,j=b.col;return g.z5=-1,g.source=a,c=g.y5[h],c||(c=g.y5[h]={}),d=c[i],d||(d=c[i]={}),(e=d[j])?void(g.cellNodes=e):(f=new D((-1)),e=d[j]=[],g.vQa++,g.x5=-1,g.cellNodes=e,g.row=i,g.col=j,e.root=f,g.w5[++g.x5]=f,void(g.evaluateMode=-1))},a.prototype.startCalcFunction=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=this;if(n.z5++,n.isNewNode=!1,d=n.cellNodes[n.z5])return n.currentNode=d,d;if(n.isNewNode=!0,e=n.evaluateMode,f=a.evaluateMode(),"REFRESH"===a.name?(f=b[1]?n.lh.evaluate(b[1],c,!1,!1):0,n.evaluateMode=f):e!==-1&&(f=e),d=new D(n.z5,f),n.cellNodes[n.z5]=d,n.w5[n.x5].oi.push(d),d.parent=n.w5[n.x5],n.w5.push(d),n.x5++,n.currentNode=d,2===f&&e===-1){for(g=6e4,h=n.intervals,i=a.interval()||g,"REFRESH"===a.name&&(d.isRefresh=!0,i=b[2]?n.lh.evaluate(b[2],c,!1,!1):g),h||(n.intervals=h={}),j=h[i],j||(j=h[i]=[],j.intervalObj=window.setInterval(function(){var a,b,c=n.intervals[i];for(k=0;k<c.length;k++)a=c[k],b=a.node,b.v5=!1,b.isRefresh&&N(b),n.lh.service.recalculate(a.source,a.row,a.col,!0),n.source.refresh()},i)),l=!1,k=0;k<j.length;k++)if(m=j[k],m.source===n.source&&m.node===d&&m.row===n.row&&m.col===n.col){l=!0;break}l||j.push({source:n.source,node:d,row:n.row,col:n.col})}return d},a.prototype.getNode=function(){return this.currentNode},a.prototype.endCalcFunction=function(){this.isNewNode&&(this.w5.pop(),this.x5--),this.currentNode=this.currentNode.parent},a.prototype.endCalcCell=function(){var a,b=[];for(a=0;a<arguments.length;a++)b[a]=arguments[a]},a.prototype.clearCell=function(a,b){var c,d,e,f,g,h,j,k,l,m,n,o,p,q,r=this;if(r.vQa){c=a.getName(),d=b.row,e=b.col,r.z5=-1,r.source=a,f=r.y5[c],f&&(g=f[d],g&&(h=g[e],h&&(j=h[0],k=j&&j.h_a,k&&(delete k.nia,delete k.z$a),g[e]=i,r.vQa--))),l=r.intervals;for(m in l)if(n=l[m]){for(o=[],p=0;p<n.length;p++)q=n[p],q.source===a&&q.row===b.row&&q.col===b.col||o.push(q);o.length?o.length!==n.length&&(o.intervalObj=n.intervalObj,l[m]=o):(l[m]=i,window.clearInterval(n.intervalObj))}}},a.prototype.setAsyncResult=function(a,b){a.Fi=b},a.prototype.addRows=function(a,b,c){this.GQa(a,b,c,!0)},a.prototype.deleteRows=function(a,b,c){this.GQa(a,b,c,!1)},a.prototype.GQa=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r=this;if(r.vQa){if(e=a.getName(),f=r.y5[e]){g={};for(h in f)i=f[h],i&&(j=parseInt(h,10),d?(k=j>=b?j+c:j,g[k]=i):j<b?g[j]=i:j>=b+c&&(g[j-c]=i));r.y5[e]=g}l=r.intervals;for(m in l)if(n=l[m]){for(o=[],p=0;p<n.length;p++)q=n[p],q.source===a&&d&&q.row>=b?q.row+=c:q.source===a&&!d&&(q.row<b||q.row>=b+c)&&(q.row=q.row<b?q.row:q.row-c,o.push(q));d||o.length===n.length||(o.intervalObj=n.intervalObj,l[m]=o)}}},a.prototype.addColumns=function(a,b,c){this.HQa(a,b,c,!0)},a.prototype.deleteColumns=function(a,b,c){this.HQa(a,b,c,!1)},a.prototype.HQa=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this;if(t.vQa){if(e=a.getName(),f=t.y5[e])for(g in f)if(h=f[g]){i={};for(j in h)k=h[j],k&&k.length&&(l=parseInt(j,10),d?(m=l>=b?l+c:l,i[m]=k):l<b?i[l]=k:l>=b+c&&(i[l-c]=k));f[g]=i}n=t.intervals;for(o in n)if(p=n[o]){for(q=[],r=0;r<p.length;r++)s=p[r],s.source===a&&d&&s.col>=b?s.col+=c:s.source===a&&!d&&(s.col<b||s.col>=b+c)&&(s.col=s.col<b?s.col:s.col-c,q.push(s));d||q.length===p.length||(q.intervalObj=p.intervalObj,n[o]=q)}}},a.prototype.changeSourceName=function(a,b){var c,d=this;d.vQa&&(c=d.y5[a],c&&(d.y5[b]=c,delete d.y5[a]))},a}();function N(a){var b,c;for(c=0;c<a.oi.length;c++)b=a.oi[c],b.v5=!1,b.oi.length>0&&N(b)}function O(a){var b,c=!0,d=a;return a&&a.getValue&&(b=q(a,0,!1,!0),b.isError?d=b[0]:1===b.rowCount&&1===b.colCount?d=b[0][0]:(d=b,c=!1)),{value:d,success:c}}function P(a,b,c){return p(b)?b:p(c)?c:a<=2?Q(a,b,c):a<=14?R(a,b,c):V(a,b,c)}b.evaluateOperator=P;function Q(a,b,c){var d,f,g,h,i,j,k,l;if(!b)return 0;if(d=O(b),d.success)return S(a,d.value);if(c){for(f=[],g=d.value,h=g.rowCount,i=g.colCount,j=0;j<h;j++)for(k=f[j]=[],l=0;l<i;l++)k[l]=S(a,g[j][l]);return new e.CalcArray(f)}}function R(a,b,c){var d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(d=a<=7?S:8===a?T:U,f=O(b),g=O(c),f.success&&g.success)return d(a,f.value,g.value);if(b=f.value,c=g.value,h=f.success?-1:b.rowCount,i=f.success?-1:b.colCount,j=g.success?-1:c.rowCount,k=g.success?-1:c.colCount,l=-1,m=-1,f.success||g.success)f.success?(l=j,m=k):(l=h,m=i);else{if(1!==h&&1!==j&&h!==j||1!==i&&1!==k&&i!==k)return w;l=1===h?j:h,m=1===i?k:i}for(n=[],o=0;o<l;o++)for(n[o]=[],p=0;p<m;p++)!f.success&&(1!==h&&h<l||1!==i&&i<m)||!g.success&&(1!==j&&j<l||1!==k&&k<m)?n[o][p]=w:(q=1===h?0:o,r=1===i?0:p,s=1===j?0:o,t=1===k?0:p,n[o][p]=d(a,f.success?b:b[q][r],g.success?c:c[s][t]));return new e.CalcArray(n)}function S(a,b,c){var d,e,f,g;function h(a){return"string"==typeof a&&0===a.trim().length}if(h(b)||h(c))return u;if(d={value:0},!o(b,d))return 0===a&&"string"==typeof b?b:u;if(e=d.value,c!==i){if(!o(c,d))return u;f=d.value}else f=0;return 0===a?e:1===a?-e:2===a?e/100:3===a?e+f:4===a?e-f:5===a?e*f:6===a?f?e/f:x:7===a?(g=j(e,f),!e&&f<0?x:g===Number.POSITIVE_INFINITY||g===Number.NEGATIVE_INFINITY?y:g):void 0}function T(a,b,c){if(8===a)return p(b)?b:p(c)?c:e.Convert.bc(b)+e.Convert.bc(c)}function U(a,b,c){var d=f.CLb(b,c,!1);return p(d)?d:9===a&&0===d||10===a&&0!==d||11===a&&d<0||12===a&&d<=0||13===a&&d>0||14===a&&d>=0}function V(a,b,c){var d,f,g,h,i,j,m,n,o,p,q,r;if(!b||!c||(1!==b.getRangeCount()||1!==c.getRangeCount())&&16!==a||b.endSource||c.endSource)return u;if(d=b.getSource(),!d||d!==c.getSource())return u;if(16===a)f=b.yf.concat(c.yf);else{if(g=15===a?k:l,h=15===a?l:k,i=b.getRow(0),j=b.getColumn(0),m=c.getRow(0),n=c.getColumn(0),o=g(i,m),p=g(j,n),q=h(i+b.getRowCount(0),m+c.getRowCount(0))-o,r=h(j+b.getColumnCount(0),n+c.getColumnCount(0))-p,q<1||r<1)return e.Errors.Null;f=[L(o,p,q,r)]}return new e.CalcReference(d,f)}F=e.Convert.Pa,G=e.Convert.Rh,H=e.Convert.bc,I=e.Convert.Xh,J=e.Convert.Vh;function W(a,b){var c,d,f,g=!0;switch(b.Hi){case 0:c=F(a),d=!0;break;case 1:c=parseFloat(a),d=!0;break;case 2:c=G(a),d=!0;break;case 3:c=parseInt(a,10),d=!0;break;case 4:c=q(a,b.Ii,b.Ji||!1,b.Ki||!1,b.Li||!1,b.Mi,b.xTa,b.DLb),c.isError&&(c=c[0],g=!1),c.isConvertError&&(c=u,g=!1);break;case 5:c=H(a),b.Ni&&""===c&&(c=u,g=!1);break;case 6:f={value:h},I(a,f)?c=f.value:(c=u,g=!1);break;case 7:c=J(a);break;case 8:c=e.Functions.Wi(a),!c||b.Oi&&0===c.Pi()&&0===c.Qi()?(c=e.Errors.Number,g=!1):c={Ri:c.Pi(),Si:c.Qi()};break;default:c=a}return d&&isNaN(c)&&(c=u,g=!1),{Ti:c,Ei:g}}function X(a,b,c){var d,f,g,h,j;for(Array.isArray(b)||(b=[b]),d=a.Ti,f=0;f<b.length;f++)if(g=b[f].split(" "),h=g[0],j=parseInt(g[1],10),"<"===h&&d<j||">"===h&&d>j||"<="===h&&d<=j||">="===h&&d>=j||"="===h&&d===j||"!="===h&&d!==j||"checkLength"===h&&d.length>j)return a.Ti=c===i?e.Errors.Number:c,void(a.Ei=!1)}function Y(a,b){var c,d,f,g,h,j=[];if(!b)return{Di:a,Ei:!0};if(b.Xi)for(f=0;f<a.length;f++)j.push(b);else j=Array.isArray(b)?b:[b];for(d=0;d<j.length;d++){if(g=j[d],g.Yi&&!a[d])throw e.sR().Exp_ArgumentNull;if(h=a[d]!==i){if(c=W(a[d],g),g.aj&&X(c,g.aj,g.bj),!c.Ei)break;a[d]=g.Zi?{$i:h,Qb:c.Ti}:c.Ti}else a[d]=g.Zi?{$i:h,Qb:g._i}:g._i}return c?{Di:a,Ei:c.Ei,Fi:c.Ti}:void 0}},"./src/referenceExpression.ts":function(a,b,c){"use strict";var d,e,f,g,h,i=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("./src/calc.common.ts"),e=void 0,f=Math.abs,g=function(a){i(b,a);function b(b){return a.call(this,b)||this}return b.prototype.sf=function(){var a=this;return a.endRow===e||a.endColumn===e},b.prototype.tf=function(){var a=this;return a.isFullRow&&a.isFullColumn?3:a.isFullRow?1:a.isFullColumn?2:0},b.prototype.getRange=function(a,b){return l(this,a,b)},b.prototype.offset=function(a,b,c,d,e){var f,g=this,h=g.source,i=g.endSource;return g.sf()?j(h,i,g.row+(g.rowRelative||c?a:0),g.column+(g.columnRelative||c?b:0),g.rowRelative,g.columnRelative):(f=k(h,i,g.row+(g.rowRelative||c?a:0),g.column+(g.columnRelative||c?b:0),g.endRow+(g.isFullColumn||!g.endRowRelative&&!c?0:a),g.endColumn+(g.isFullRow||!g.endColumnRelative&&!c?0:b),g.rowRelative,g.columnRelative,g.endRowRelative,g.endColumnRelative,d,e),f.isFullRow=g.isFullRow,f.isFullColumn=g.isFullColumn,f)},b.prototype.offset2=function(a,b,c,d,e,f){var g=this,h=k(g.source,g.endSource,g.row+(g.isFullColumn?0:a),g.column+(g.isFullRow?0:b),g.endRow+(g.isFullColumn?0:c),g.endColumn+(g.isFullRow?0:d),g.rowRelative,g.columnRelative,g.endRowRelative,g.endColumnRelative,e,f);return h.isFullRow=g.isFullRow,h.isFullColumn=g.isFullColumn,h},b}(d.Expression),b.ReferenceExpression=g;function j(a,b,c,d,e,f){var h=new g(1);return h.row=c,h.column=d,h.rowRelative=e,h.columnRelative=f,a&&(h.source=a),b&&(h.endSource=b),h}b.rf=j;function k(a,b,c,e,f,h,i,j,k,l,m,n,o){var p,q,r,s,t,u=new g(1);return u.isFullRow=e===d.BAND_INDEX_CONST,m=m||0,n=n||0,q=c-(i?0:m),r=e-(j?0:n),s=f-(k?0:m),t=h-(l?0:n),u.isFullRow&&0===c&&f===d.MAX_ROW_COUNT-1&&(c=f=d.BAND_INDEX_CONST),u.isFullColumn=c===d.BAND_INDEX_CONST,q>s&&(p=c,c=f,f=p,p=i,i=k,k=p),r>t&&(p=e,e=h,h=p,p=j,j=l,l=p),u.row=c,u.column=e,u.endRow=f,u.endColumn=h,u.rowRelative=i,u.columnRelative=j,u.endRowRelative=k,u.endColumnRelative=l,u.isArrayReference=o,a&&(u.source=a),b&&(u.endSource=b),u}b.uf=k;function l(a,b,c){var e={row:-1,col:-1,rowCount:-1,colCount:-1},g,h,i,j;return a.isFullRow?(e.col=-1,e.colCount=-1):(a.columnRelative?(i=a.column+c,i=i>=d.MAX_COLUMN_COUNT?i%d.MAX_COLUMN_COUNT:i):i=a.column,a.sf()?(e.col=i,e.colCount=1):(a.endColumnRelative?(j=a.endColumn+c,j=j>=d.MAX_COLUMN_COUNT?j%d.MAX_COLUMN_COUNT:j):j=a.endColumn,e.col=i<=j?i:j,e.colCount=f(j-i)+1)),a.isFullColumn?(e.row=-1,e.rowCount=-1):(a.rowRelative?(g=a.row+b,g=g>=d.MAX_ROW_COUNT?g%d.MAX_ROW_COUNT:g):g=a.row,a.sf()?(e.row=g,e.rowCount=1):(a.endRowRelative?(h=a.endRow+b,h=h>=d.MAX_ROW_COUNT?h%d.MAX_ROW_COUNT:h):h=a.endRow,e.row=g<=h?g:h,e.rowCount=f(h-g)+1)),e}b.getRangeForReference=l,h=function(a){i(b,a);function b(b,c,d,e,f){var g=a.call(this,33)||this;return g.row=b,g.column=c,g.rowRelative=d,g.columnRelative=e,g.isReferenceError=f,g.sf=function(){return!this.isReferenceError},g.getRange=function(a,b){var c,d,e,f,g,h=this,i=h.source||h.contextSource;if(!h.isReferenceError&&i&&(c=l(h,a,b),d=c.row,e=c.col,f=i.getReference({row:d,col:e,spillRef:!0})))return g={spillRef:!0,row:d,col:e,rowCount:f.getRowCount(),colCount:f.getColumnCount()},f.isSpillError&&(g.isSpillError=!0),g},g.offset=function(a,b,c){var d=this,e=d.contextSource,f=d.source,g=d.endSource;return this.isReferenceError?n(e,f):m(e,f,g,d.row+(d.rowRelative||c?a:0),d.column+(d.columnRelative||c?b:0),d.rowRelative,d.columnRelative)},g}return b}(d.Expression),b.SpillReferenceExpression=h;function m(a,b,c,d,e,f,g,i){var j=new h(d,e,f,g,i);return j.contextSource=a,j.source=b,j.endSource=c,j}b.xJb=m;function n(a,b){return m(a,b,e,0,0,!1,!1,!0)}b.FLb=n},Common:function(a,b){a.exports=c("@grapecity/js-sheets-common")}}),a.exports=d.Spread.CalcEngine},"./node_modules_local/@grapecity/js-calc/index.js":function(a,b,c){a.exports=c("./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js")},"@grapecity/js-sheets-common":function(a,b){a.exports=GC.Spread}});