/*!
 * 
 * SpreadJS Library 13.0.0
 * 
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the SpreadJS Commercial License.
 * us.sales@grapecity.com
 * http://www.grapecity.com/en/licensing/grapecity/
 * 
 * 
 */
var GC="object"==typeof GC?GC:{};GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.AutoMerge=function(a){var b={};function c(d){if(b[d])return b[d].exports;var e=b[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,c),e.l=!0,e.exports}return c.m=a,c.c=b,c.d=function(a,b,d){c.o(a,b)||Object.defineProperty(a,b,{enumerable:!0,get:d})},c.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},c.t=function(a,b){var d,e;if(1&b&&(a=c(a)),8&b)return a;if(4&b&&"object"==typeof a&&a&&a.__esModule)return a;if(d=Object.create(null),c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&b&&"string"!=typeof a)for(e in a)c.d(d,e,function(b){return a[b]}.bind(null,e));return d},c.n=function(a){var b=a&&a.__esModule?function b(){return a.default}:function b(){return a};return c.d(b,"a",b),b},c.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},c.p="/assets/",c(c.s="./dist/plugins/autoMerge/autoMerge.js")}({"./dist/plugins/autoMerge/autoMerge.js":function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o=this&&this.__extends||function(){var a=function(b,c){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})(b,c)};return function(b,c){a(b,c);function d(){this.constructor=b}b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();Object.defineProperty(b,"__esModule",{value:!0}),d=c("Core"),e=c("Common"),f=c("./dist/plugins/autoMerge/autoMerge.res.en.js"),b.SR={en:f},g=new e.Common.ResourceManager(b.SR),h=g.getResource.bind(g),function(a){a[a.free=0]="free",a[a.restricted=1]="restricted"}(i=b.AutoMergeMode||(b.AutoMergeMode={})),function(a){a[a.none=0]="none",a[a.column=1]="column",a[a.row=2]="row",a[a.columnRow=3]="columnRow",a[a.rowColumn=4]="rowColumn"}(j=b.AutoMergeDirection||(b.AutoMergeDirection={})),k=function(a){o(b,a);function b(b,c){var d=a.call(this,b.row,b.col,b.rowCount,b.colCount)||this;return d.sheetArea=c,d.isAutoMerge=!0,d}return b}(d.Range),l=void 0;function p(a,b,c){return c+"_"+a+"_"+b}function q(a,b,c){return b===a||(b===d.SheetArea.viewport?c&&a===d.SheetArea.rowHeader||!c&&a===d.SheetArea.colHeader:b===d.SheetArea.rowHeader?c&&a===d.SheetArea.viewport:b===d.SheetArea.colHeader&&(!c&&a===d.SheetArea.viewport))}m=function(){function a(a){this.kj=a,this.rIb=[],this.xn={},this.Ny=[]}return a.prototype.add=function(a,b,c,e){var f,g,i,j;for(void 0===e&&(e=d.SheetArea.viewport),f=this.all(),g=0,i=f;g<i.length;g++)if(j=i[g],j.sheetArea===e&&j.range.intersect(a.row,a.col,a.rowCount,a.colCount))throw Error(h().Exp_RangeIsIntersected);this.rIb.push({range:a,direction:b,mode:c,sheetArea:e})},a.prototype.remove=function(a,b){var c,e,f;for(void 0===b&&(b=d.SheetArea.viewport),c=this.rIb,e=0;e<c.length;e++)if(f=c[e],f.sheetArea===b&&f.range.equals(a)){c.splice(e,1);break}},a.prototype.clear=function(){this.rIb=[],this.xn={},this.Ny=[]},a.prototype.all=function(){return this.rIb},a.prototype.RUa=function(a){this.rIb=a,this.sIb()},a.prototype.qIb=function(a,b,c){void 0===c&&(c=d.SheetArea.viewport);var e=this.xn[p(a,b,c)];return e?d.kf(e.row,e.col,e.rowCount,e.colCount):null},a.prototype.pIb=function(a){return void 0===a&&(a=d.SheetArea.viewport),this.Ny.filter(function(b){return b.sheetArea===a})},a.prototype.sIb=function(){var a,b,c,e,f,g,h,i,k,l;for(this.xn={},this.Ny=[],a=this.rIb,b=this.kj,c=0,e=a;c<e.length;c++)f=e[c],g=f.direction,h=f.mode,i=f.sheetArea,k=b.Tq(f.range,i),l=void 0,g===j.column?l=r(b,h,k,i):g===j.row?l=t(b,h,k,i):g===j.columnRow?l=w(b,h,k,i):g===j.rowColumn&&(l=z(b,h,k,i)),l&&(d.GC$.extend(this.xn,l.cache),this.Ny=this.Ny.concat(l.spans))},a.prototype.rI=function(a,b,c){var e,f,g,h,i,j;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0))for(e=this.rIb,f=0,g=e;f<g.length;f++)h=g[f],q(h.sheetArea,c,!0)&&(i=h.range,j=i.row,a<=j?i.row+=b:j<a&&a<j+i.rowCount&&(i.rowCount+=b))},a.prototype.tI=function(a,b,c){var e,f,g,h,i,j;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0))for(e=this.rIb,f=0,g=e;f<g.length;f++)h=g[f],q(h.sheetArea,c,!1)&&(i=h.range,j=i.col,a<=j?i.col+=b:j<a&&a<j+i.colCount&&(i.colCount+=b))},a.prototype.GR=function(a,b,c){var e,f,g,h,i,j,k,l,m;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0)){for(e=this.rIb,f=[],g=0;g<e.length;g++)h=e[g],q(h.sheetArea,c,!0)&&(i=h.range,j=i.row,k=i.rowCount,a<j?(l=a+b-j,l<=0?j-=b:(j-=l,i.rowCount-=l),j<0&&(i.rowCount+=j,j=0),i.row=j):j<=a&&a<j+k&&(i.rowCount-=Math.min(b,j+k-a)),0===i.rowCount&&f.push(g));for(m=f.length-1;m>=0;m--)e.splice(f[m],1)}},a.prototype.HR=function(a,b,c){var e,f,g,h,i,j,k,l,m;if(void 0===c&&(c=d.SheetArea.viewport),!(a<0||b<=0)){for(e=this.rIb,f=[],g=0;g<e.length;g++)h=e[g],q(h.sheetArea,c,!1)&&(i=h.range,j=i.col,k=i.colCount,a<j?(l=a+b-j,l<=0?j-=b:(j-=l,i.colCount-=l),j<0&&(i.colCount+=j,j=0),i.col=j):j<=a&&a<j+k&&(i.colCount-=Math.min(b,j+k-a)),0===i.colCount&&f.push(g));for(m=f.length-1;m>=0;m--)e.splice(f[m],1)}},a.prototype.tIb=function(a,b){var c,e,f;for(void 0===b&&(b=d.SheetArea.viewport),c=this.rIb,e=c.length-1;e>=0;e--)f=c[e].range,f.row!==-1&&q(c[e].sheetArea,b,!0)&&(f.row>a-1?c.splice(e,1):f.row+f.rowCount-1>a-1&&(f.rowCount=a-1-f.row+1))},a.prototype.uIb=function(a,b){var c,e,f;for(void 0===b&&(b=d.SheetArea.viewport),c=this.rIb,e=c.length-1;e>=0;e--)f=c[e].range,f.col!==-1&&q(c[e].sheetArea,b,!1)&&(f.col>a-1?c.splice(e,1):f.col+f.colCount-1>a-1&&(f.colCount=a-1-f.col+1))},a.prototype.toJSON=function(){return this.rIb.map(function(a){var b=a.range;return{range:{row:b.row,col:b.col,rowCount:b.rowCount,colCount:b.colCount},direction:a.direction,mode:a.mode,sheetArea:a.sheetArea}})},a.prototype.fromJSON=function(a){var b,c,e,f,g;if(a)for(b=this.rIb,c=0,e=a;c<e.length;c++)f=e[c],g=f.range,b.push({range:d.kf(g.row,g.col,g.rowCount,g.colCount),direction:f.direction,mode:f.mode,sheetArea:f.sheetArea})},a}(),d.GC$.extend(d.lUa.prototype,{vIb:function(){var a=this,b=a.zTa;b&&!b.wIb&&(b.wIb=this.oIb.all().map(function(a){var b=a.range;return{range:d.kf(b.row,b.col,b.rowCount,b.colCount),direction:a.direction,mode:a.mode,sheetArea:a.sheetArea}}))},xIb:function(a){a&&this.oIb.RUa(a)},yIb:function(a,b){this.vIb(),this.oIb.rI(a,b)},zIb:function(a,b){this.vIb(),this.oIb.GR(a,b)},AIb:function(a,b){this.vIb(),this.oIb.tI(a,b)},BIb:function(a,b){this.vIb(),this.oIb.HR(a,b)},CIb:function(a,b){this.vIb(),this.oIb.tIb(a,b)},DIb:function(a,b){this.vIb(),this.oIb.uIb(a,b)}}),n="autoMerge",d.lUa.$n(n,{init:function(){this.oIb=new m(this.kj)},undo:function(a){var b=a.wIb;b&&this.xIb(b)}}),d.Worksheet.$n(n,{init:function(){var a=this,b=a.oIb=a.ITa.oIb;a.bind(d.Events.TopRowChanged+"."+n,function(){var c,e,f,g,h,i,j,k,l=b.all();if(l.length>0)for(c=a.frozenColumnCount(),e=a.getColumnCount()-a.frozenTrailingColumnCount()-1,f=0,g=l;f<g.length;f++)h=g[f],i=h.sheetArea,j=h.range,i===d.SheetArea.viewport?((j.col===-1||j.col<c)&&a.repaint(a.getRangeRect(1,0,j)),(j.col===-1||j.col<=e&&j.col+j.colCount>=c)&&a.repaint(a.getRangeRect(1,1,j)),(j.col===-1||j.col+j.colCount>e)&&a.repaint(a.getRangeRect(1,2,j))):i===d.SheetArea.rowHeader&&(k=a.am(),a.repaint(k.fm(1)))}),a.bind(d.Events.LeftColumnChanged+"."+n,function(){var c,e,f,g,h,i,j,k,l=b.all();if(l.length>0)for(c=a.frozenRowCount(),e=a.getRowCount()-a.frozenTrailingRowCount()-1,f=0,g=l;f<g.length;f++)h=g[f],i=h.sheetArea,j=h.range,i===d.SheetArea.viewport?((j.row===-1||j.row<c)&&a.repaint(a.getRangeRect(0,1,j)),(j.row===-1||j.row<=e&&j.row+j.rowCount>=c)&&a.repaint(a.getRangeRect(1,1,j)),(j.row===-1||j.row+j.rowCount>e)&&a.repaint(a.getRangeRect(2,1,j))):i===d.SheetArea.colHeader&&(k=a.am(),a.repaint(k.gm(1)))})},dispose:function(a){a.clearCache!==!1&&(this.oIb=null,this.unbind(d.Events.TopRowChanged+"."+n),this.unbind(d.Events.LeftColumnChanged+"."+n))},onLayoutChanged:function(a){var b=a.changeType,c=a.row,d=a.rowCount,e=a.col,f=a.colCount,g=a.sheetArea,h=this.ITa;"addRows"===b?h.yIb(c,d):"deleteRows"===b?h.zIb(c,d):"addColumns"===b?h.AIb(e,f):"deleteColumns"===b?h.BIb(e,f):"setRowCount"===b?h.CIb(d,g):"setColumnCount"===b&&h.DIb(f,g),"invalidateLayout"===b&&this.Xq<=0&&this.oIb.sIb()},toJson:function(a,b){var c,e,f,g=b&&b.ignoreStyle;g||(a.autoMergeRangeInfos=this.oIb.toJSON(),b&&b.includeAutoMergedCells&&(c=this.oIb.pIb(d.SheetArea.viewport),c.length>0&&(a.spans?a.spans=a.spans.concat(c):a.spans=c),e=this.oIb.pIb(d.SheetArea.rowHeader),e.length>0&&(a.rowHeaderSpan?a.rowHeaderSpan=a.rowHeaderSpan.concat(e):a.rowHeaderSpan=e),f=this.oIb.pIb(d.SheetArea.colHeader),f.length>0&&(a.colHeaderSpan?a.colHeaderSpan=a.colHeaderSpan.concat(f):a.colHeaderSpan=f)))},fromJson:function(a,b,c){var d=c&&c.ignoreStyle;d||this.oIb.fromJSON(a.autoMergeRangeInfos)}}),d.GC$.extend(d.Worksheet.prototype,{autoMerge:function(a,b,c,d){void 0===b&&(b=j.column),void 0===c&&(c=i.free);var e=this.oIb;return 0===arguments.length?e.all():void(a&&(this.ITa.vIb(),b===j.none?e.remove(a,d):e.add(a,b,c,d),this.$p()))}});function r(a,b,c,e){var f,g,h,j,m,n,o,p,q={},r=[],t=c.row,u=c.row+c.rowCount-1,w=c.col,x=c.col+c.colCount-1;for(f=w;f<=x;f++)if(a.getColumnVisible(f,e)&&!(a.getColumnWidth(f,e)<=0)){for(g=b===i.restricted,h=g&&f>w,j=void 0,m=t;m<=u;)if(!a.getRowVisible(m,e)||a.getRowHeight(m,e)<=0)m++;else{if(n=a._q(m,e,!0),null===n||n>u)break;if(v(a,m,f,n,f,e)){if(h&&!s(a,q,m,f,n,f,e)){j&&(o=new k(j,e),r.push(o),y(q,j,o),j=l),m=n;continue}p=n-m+1,j?j.rowCount+=p-1:j=d.kf(m,f,p,1)}else j&&(o=new k(j,e),r.push(o),y(q,j,o),j=l);m=n}j&&(o=new k(j,e),r.push(o),y(q,j,o),j=l)}return{cache:q,spans:r}}function s(a,b,c,d,e,f,g){var h=a.br(d,g),i=b[p(c,h,g)];return i&&i.sheetArea===g&&i.row<=c&&e<=i.row+i.rowCount-1}function t(a,b,c,e){var f,g,h,j,m,n,o,p,q={},r=[],s=c.row,t=c.row+c.rowCount-1,w=c.col,x=c.col+c.colCount-1;for(f=s;f<=t;f++)if(a.getRowVisible(f,e)&&!(a.getRowHeight(f,e)<=0)){for(g=b===i.restricted,h=g&&f>s,j=void 0,m=w;m<=x;)if(!a.getColumnVisible(m,e)||a.getColumnWidth(m,e)<=0)m++;else{if(n=a.Zq(m,e,!0),null===n||n>x)break;if(v(a,f,m,f,n,e)){if(h&&!u(a,q,f,m,f,n,e)){j&&(o=new k(j,e),r.push(o),y(q,j,o),j=l),m=n;continue}p=n-m+1,j?j.colCount+=p-1:j=d.kf(f,m,1,p)}else j&&(o=new k(j,e),r.push(o),y(q,j,o),j=l);m=n}j&&(o=new k(j,e),r.push(o),y(q,j,o),j=l)}return{cache:q,spans:r}}function u(a,b,c,d,e,f,g){var h=a.gr(c,g),i=b[p(h,d,g)];return i&&i.sheetArea===g&&i.col<=d&&f<=i.col+i.colCount-1}function v(a,b,c,d,e,f){var g=a.ITa,h=a.getText(b,c,f),i=a.getText(d,e,f);return""!==h&&""!==i&&(h===i&&(!g.findSpan(b,c,f)&&!g.findSpan(d,e,f)))}function w(a,b,c,e){var f,g,h,i,j,l,m,n=r(a,b,c,e),o=n.cache,q=n.spans,s=c.row,t=c.row+c.rowCount-1,u=c.col,w=c.col+c.colCount-1;for(f=s;f<=t;f++)if(a.getRowVisible(f,e)&&!(a.getRowHeight(f,e)<=0))for(g=u;g<=w;g++)if(a.getColumnVisible(g,e)&&!(a.getColumnWidth(g,e)<=0)){if(h=a.Zq(g,e,!0),null===h||h>w)break;v(a,f,g,f,h,e)&&(i=o[p(f,g,e)],j=o[p(f,h,e)],i&&j?i.row===f&&j.row===f&&i.rowCount===j.rowCount&&(i.colCount+=h-g,x(q,j),y(o,j,i)):i?1===i.rowCount&&(i.colCount+=h-g,y(o,new d.Range(f,h,1,1),i)):j?1===j.rowCount&&(j.col=g,j.colCount+=h-g,y(o,new d.Range(f,g,1,1),j)):(l=new d.Range(f,g,1,h-g+1),m=new k(l,e),q.push(m),y(o,l,m)))}return{cache:o,spans:q}}function x(a,b){var c,d;for(c=0;c<a.length;c++)if(d=a[c],d.sheetArea===b.sheetArea&&d.equals(b)){a.splice(c,1);break}}function y(a,b,c){var d,e,f=c.sheetArea;for(d=0;d<b.rowCount;d++)for(e=0;e<b.colCount;e++)a[p(b.row+d,b.col+e,f)]=c}function z(a,b,c,e){var f,g,h,i,j,l,m,n=t(a,b,c,e),o=n.cache,q=n.spans,r=c.row,s=c.row+c.rowCount-1,u=c.col,w=c.col+c.colCount-1;for(f=u;f<=w;f++)if(a.getColumnVisible(f,e)&&!(a.getColumnWidth(f,e)<=0))for(g=r;g<=s;g++)if(a.getRowVisible(g,e)&&!(a.getRowHeight(g,e)<=0)){if(h=a._q(g,e,!0),null===h||h>s)break;v(a,g,f,h,f,e)&&(i=o[p(g,f,e)],j=o[p(h,f,e)],i&&j?i.col===f&&j.col===f&&i.colCount===j.colCount&&(i.rowCount+=h-g,x(q,j),y(o,j,i)):i?1===i.colCount&&(i.rowCount+=h-g,y(o,new d.Range(h,f,1,1),i)):j?1===j.colCount&&(j.row=g,j.rowCount+=h-g,y(o,new d.Range(g,f,1,1),j)):(l=new d.Range(g,f,h-g+1,1),m=new k(l,e),q.push(m),y(o,l,m)))}return{cache:o,spans:q}}},"./dist/plugins/autoMerge/autoMerge.res.en.js":function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Exp_RangeIsIntersected="The range should not intersect with exsit ranges."},Common:function(a,b){a.exports=GC.Spread},Core:function(a,b){a.exports=GC.Spread.Sheets}});